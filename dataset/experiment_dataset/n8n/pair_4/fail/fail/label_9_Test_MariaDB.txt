2025-04-15T08:23:25.1508689Z ##[group]Run pnpm test:mariadb --testTimeout 30000
2025-04-15T08:23:25.1509102Z [36;1mpnpm test:mariadb --testTimeout 30000[0m
2025-04-15T08:23:25.1556576Z shell: /usr/bin/bash -e {0}
2025-04-15T08:23:25.1556810Z env:
2025-04-15T08:23:25.1557002Z   DB_MYSQLDB_PASSWORD: password
2025-04-15T08:23:25.1557239Z   TURBOGHA_PORT: 41230
2025-04-15T08:23:25.1557470Z   TURBO_API: http://localhost:41230
2025-04-15T08:23:25.1557708Z   TURBO_TOKEN: turbogha
2025-04-15T08:23:25.1557908Z   TURBO_TEAM: turbogha
2025-04-15T08:23:25.1558099Z ##[endgroup]
2025-04-15T08:23:25.5159299Z 
2025-04-15T08:23:25.5160507Z > n8n@1.89.0 test:mariadb /home/runner/work/n8n/n8n/packages/cli
2025-04-15T08:23:25.5161718Z > N8N_LOG_LEVEL=silent DB_TYPE=mariadb DB_TABLE_PREFIX=test_ jest --no-coverage --testTimeout 30000
2025-04-15T08:23:25.5162443Z 
2025-04-15T08:23:39.2838305Z /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/@n8n/typeorm/driver/mysql/MysqlQueryRunner.js:165
2025-04-15T08:23:39.2845067Z                         return fail(new QueryFailedError_1.QueryFailedError(query, parameters, err));
2025-04-15T08:23:39.2845798Z                                     ^
2025-04-15T08:23:39.2848126Z 
2025-04-15T08:23:39.2848710Z QueryFailedError: Can't add new command when connection is in closed state
2025-04-15T08:23:39.2850700Z     at Query.onResult (/home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:246:33)
2025-04-15T08:23:39.2854212Z     at PoolConnection._addCommandClosedState (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:169:11)
2025-04-15T08:23:39.2861574Z     at PoolConnection.query (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:575:17)
2025-04-15T08:23:39.2864052Z     at /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:207:36
2025-04-15T08:23:39.2865766Z     at processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-04-15T08:23:39.2866851Z   query: 'DELETE FROM `test_insights_by_period` WHERE `periodStart` < DATE_SUB(CURRENT_DATE, INTERVAL 10 DAY)',
2025-04-15T08:23:39.2867642Z   parameters: [],
2025-04-15T08:23:39.2868239Z   driverError: Error: Can't add new command when connection is in closed state
2025-04-15T08:23:39.2869683Z       at PoolConnection._addCommandClosedState (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:164:17)
2025-04-15T08:23:39.2871927Z       at PoolConnection.query (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:575:17)
2025-04-15T08:23:39.2874321Z       at /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:207:36
2025-04-15T08:23:39.2876173Z       at processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-04-15T08:23:39.2876842Z     fatal: true
2025-04-15T08:23:39.2877157Z   },
2025-04-15T08:23:39.2877432Z   fatal: true
2025-04-15T08:23:39.2877766Z }
2025-04-15T08:23:39.2877929Z 
2025-04-15T08:23:39.2878086Z Node.js v20.19.0
2025-04-15T08:23:43.2372561Z PASS test/integration/workflows/workflows.controller.ee.test.ts (16.413 s)
2025-04-15T08:23:43.2393933Z   router should switch based on flag
2025-04-15T08:23:43.2395104Z     âœ“ when sharing is disabled (133 ms)
2025-04-15T08:23:43.2396122Z     âœ“ when sharing is enabled (53 ms)
2025-04-15T08:23:43.2396838Z   PUT /workflows/:workflowId/share
2025-04-15T08:23:43.2397488Z     âœ“ should save sharing with new users (38 ms)
2025-04-15T08:23:43.2398805Z     âœ“ should succeed when sharing with invalid user-id (28 ms)
2025-04-15T08:23:43.2399562Z     âœ“ should allow sharing with pending users (41 ms)
2025-04-15T08:23:43.2400286Z     âœ“ should allow sharing with multiple users (28 ms)
2025-04-15T08:23:43.2400896Z     âœ“ should override sharing (39 ms)
2025-04-15T08:23:43.2401580Z     âœ“ should allow sharing by the owner of the workflow (29 ms)
2025-04-15T08:23:43.2421328Z     âœ“ should allow sharing by the instance owner (46 ms)
2025-04-15T08:23:43.2422174Z     âœ“ should not allow sharing by another shared member (30 ms)
2025-04-15T08:23:43.2423332Z     âœ“ should not allow sharing with self by another non-shared member (25 ms)
2025-04-15T08:23:43.2424339Z     âœ“ should not allow sharing by another non-shared member (27 ms)
2025-04-15T08:23:43.2425323Z     âœ“ should not call internal hooks listener for email sent if emailing is disabled (34 ms)
2025-04-15T08:23:43.2426150Z     âœ“ should ignore sharing with owner project (23 ms)
2025-04-15T08:23:43.2426993Z     âœ“ should ignore sharing with project that already has it shared (26 ms)
2025-04-15T08:23:43.2427540Z   GET /workflows/new
2025-04-15T08:23:43.2428265Z     âœ“ should return an auto-incremented name, even when sharing is enabled (28 ms)
2025-04-15T08:23:43.2429285Z     âœ“ should return an auto-incremented name, even when sharing is disabled (25 ms)
2025-04-15T08:23:43.2429913Z   GET /workflows/:workflowId
2025-04-15T08:23:43.2430513Z     âœ“ should fail with invalid id due to route rule (32 ms)
2025-04-15T08:23:43.2431262Z     âœ“ should return 404 for non existing workflow (14 ms)
2025-04-15T08:23:43.2431957Z     âœ“ project viewers can view workflows (37 ms)
2025-04-15T08:23:43.2432608Z     âœ“ should return a workflow with owner (31 ms)
2025-04-15T08:23:43.2439164Z     âœ“ should return tags (37 ms)
2025-04-15T08:23:43.2439849Z     âœ“ should return shared workflow with user data (34 ms)
2025-04-15T08:23:43.2440526Z     âœ“ should return all sharees (39 ms)
2025-04-15T08:23:43.2441252Z     âœ“ should return workflow with credentials owned by user (39 ms)
2025-04-15T08:23:43.2442434Z     âœ“ should return workflow with credentials saying owner does have access even when not shared (45 ms)
2025-04-15T08:23:43.2444615Z     âœ“ should return workflow with credentials saying admin does have access even when not shared (63 ms)
2025-04-15T08:23:43.2445868Z     âœ“ should return workflow with credentials for all users with or without access (87 ms)
2025-04-15T08:23:43.2446962Z     âœ“ should return workflow with credentials for all users with access (72 ms)
2025-04-15T08:23:43.2453737Z     âœ“ should return workflow credentials home project and shared with projects (52 ms)
2025-04-15T08:23:43.2455953Z   POST /workflows
2025-04-15T08:23:43.2458286Z     âœ“ project viewers cannot create workflows (42 ms)
2025-04-15T08:23:43.2459024Z     âœ“ Should create a workflow that uses no credential (35 ms)
2025-04-15T08:23:43.2462643Z     âœ“ Should save a new workflow with credentials (26 ms)
2025-04-15T08:23:43.2463746Z     âœ“ Should not allow saving a workflow using credential you have no access (19 ms)
2025-04-15T08:23:43.2464771Z     âœ“ Should allow owner to save a workflow using credential owned by others (35 ms)
2025-04-15T08:23:43.2465883Z     âœ“ Should allow saving a workflow using a credential owned by others and shared with you (43 ms)
2025-04-15T08:23:43.2466881Z     âœ“ Should create workflow history version when licensed (37 ms)
2025-04-15T08:23:43.2467737Z     âœ“ Should not create workflow history version when not licensed (27 ms)
2025-04-15T08:23:43.2468365Z   PATCH /workflows/:workflowId
2025-04-15T08:23:43.2468994Z     âœ“ project viewers cannot update workflows (21 ms)
2025-04-15T08:23:43.2469604Z     validate credential permissions to user
2025-04-15T08:23:43.2470433Z       âœ“ Should succeed when saving unchanged workflow nodes (80 ms)
2025-04-15T08:23:43.2471488Z       âœ“ Should allow owner to add node containing credential not shared with the owner (61 ms)
2025-04-15T08:23:43.2473629Z       âœ“ Tamper proofing kicks in if the workflow is owned by the owner and shared with the member, the credentials is owned by the owner, and the member tries to use the credential in the workflow (38 ms)
2025-04-15T08:23:43.2476208Z       âœ“ Tamper proofing kicks in if the workflow is owned by team 1, the credentials is owned by the member, and the member tries to use the credential in the workflow (31 ms)
2025-04-15T08:23:43.2478211Z       âœ“ Tamper proofing kicks in if the workflow is owned by team 1, the credentials is owned by team 2, and the member tries to use the credential in the workflow (45 ms)
2025-04-15T08:23:43.2480233Z       âœ“ Tamper proofing kicks in if the workflow is owned by the member, the credentials is owned by the owner, and the member tries to use the credential in the workflow (58 ms)
2025-04-15T08:23:43.2482399Z       âœ“ Tamper proofing kicks in if the workflow is owned by the member, the credentials is owned by team 2, and the member tries to use the credential in the workflow (51 ms)
2025-04-15T08:23:43.2484383Z       âœ“ Should succeed but prevent modifying node attributes other than position, name and disabled (105 ms)
2025-04-15T08:23:43.2485193Z     validate interim updates
2025-04-15T08:23:43.2486026Z       âœ“ should block owner updating workflow nodes on interim update by member (119 ms)
2025-04-15T08:23:43.2487122Z       âœ“ should block member updating workflow nodes on interim update by owner (141 ms)
2025-04-15T08:23:43.2488216Z       âœ“ should block owner activation on interim activation by member (117 ms)
2025-04-15T08:23:43.2489241Z       âœ“ should block member activation on interim activation by owner (141 ms)
2025-04-15T08:23:43.2490387Z       âœ“ should block member updating workflow settings on interim update by owner (109 ms)
2025-04-15T08:23:43.2491421Z       âœ“ should block member updating workflow name on interim update by owner (113 ms)
2025-04-15T08:23:43.2492016Z     workflow history
2025-04-15T08:23:43.2492520Z       âœ“ Should create workflow history version when licensed (42 ms)
2025-04-15T08:23:43.2493570Z       âœ“ Should not create workflow history version when not licensed (55 ms)
2025-04-15T08:23:43.2494236Z     activate workflow
2025-04-15T08:23:43.2496847Z       âœ“ should activate workflow without changing version ID (46 ms)
2025-04-15T08:23:43.2497562Z       âœ“ should deactivate workflow without changing version ID (33 ms)
2025-04-15T08:23:43.2498041Z   PUT /:workflowId/transfer
2025-04-15T08:23:43.2501289Z     âœ“ cannot transfer into the same project (28 ms)
2025-04-15T08:23:43.2502049Z     âœ“ cannot transfer somebody elses workflow (26 ms)
2025-04-15T08:23:43.2503112Z     âœ“ cannot transfer if you're not a member of the destination project (29 ms)
2025-04-15T08:23:43.2503931Z     âœ“ project:editors cannot transfer workflows (26 ms)
2025-04-15T08:23:43.2505007Z     âœ“ project:viewers cannot transfer workflows (27 ms)
2025-04-15T08:23:43.2505896Z     âœ“ global owners can transfer workflows from a team project to a team project (40 ms)
2025-04-15T08:23:43.2507049Z     âœ“ global owners can transfer workflows from a team project to a personal project (38 ms)
2025-04-15T08:23:43.2508176Z     âœ“ global owners can transfer workflows from a personal project to a team project (38 ms)
2025-04-15T08:23:43.2509206Z     âœ“ global admins can transfer workflows from a team project to a team project (38 ms)
2025-04-15T08:23:43.2510184Z     âœ“ global admins can transfer workflows from a team project to a personal project (48 ms)
2025-04-15T08:23:43.2511175Z     âœ“ global admins can transfer workflows from a personal project to a team project (43 ms)
2025-04-15T08:23:43.2512385Z     âœ“ removes and re-adds the workflow from the active workflow manager during the transfer (43 ms)
2025-04-15T08:23:43.2513514Z     âœ“ should detach workflow from parent folder in source project (60 ms)
2025-04-15T08:23:43.2514808Z     âœ“ deactivates the workflow if it cannot be added to the active workflow manager again and returns the WorkflowActivationError as data (66 ms)
2025-04-15T08:23:43.2516198Z     âœ“ owner transfers workflow from project they are not part of, e.g. test global cred sharing scope (85 ms)
2025-04-15T08:23:43.2517656Z     âœ“ admin transfers workflow from project they are not part of, e.g. test global cred sharing scope (76 ms)
2025-04-15T08:23:43.2519042Z     âœ“ member transfers workflow from personal project to team project and wf contains a credential that they can use but not share (57 ms)
2025-04-15T08:23:43.2520526Z     âœ“ member transfers workflow from their personal project to another team project in which they have editor role (50 ms)
2025-04-15T08:23:43.2521970Z     âœ“ member transfers workflow from a team project as project admin to another team project in which they have editor role (65 ms)
2025-04-15T08:23:43.2555555Z     âœ“ member transfers workflow from a team project as project admin to another team project in which they have editor role but cannot share the credential that is only shared into the source project (52 ms)
2025-04-15T08:23:43.2560162Z     âœ“ member transfers workflow from a team project as project admin to another team project in which they have editor role but cannot share all the credentials (85 ms)
2025-04-15T08:23:43.2561662Z     âœ“ returns a 500 if the workflow cannot be activated due to an unknown error (47 ms)
2025-04-15T08:23:43.2562343Z   POST /workflows/:workflowId/run
2025-04-15T08:23:43.2572265Z     âœ“ project viewers cannot run workflows (22 ms)
2025-04-15T08:23:43.2572670Z 
2025-04-15T08:23:44.1369450Z PASS test/integration/workflows/workflows.controller.test.ts (17.339 s)
2025-04-15T08:23:44.1376702Z   POST /workflows
2025-04-15T08:23:44.1377721Z     âœ“ should store pin data for node in workflow (133 ms)
2025-04-15T08:23:44.1378713Z     âœ“ should set pin data to null if no pin data (61 ms)
2025-04-15T08:23:44.1380133Z     âœ“ should return scopes on created workflow (60 ms)
2025-04-15T08:23:44.1381341Z     âœ“ should create workflow history version when licensed (56 ms)
2025-04-15T08:23:44.1384287Z     âœ“ should not create workflow history version when not licensed (47 ms)
2025-04-15T08:23:44.1385534Z     âœ“ create workflow in personal project by default (108 ms)
2025-04-15T08:23:44.1386893Z     âœ“ creates workflow in a specific project if the projectId is passed (84 ms)
2025-04-15T08:23:44.1388288Z     âœ“ does not create the workflow in a specific project if the user is not part of the project (75 ms)
2025-04-15T08:23:44.1390725Z     âœ“ does not create the workflow in a specific project if the user does not have the right role to do so (48 ms)
2025-04-15T08:23:44.1392979Z     âœ“ create link workflow with folder if one is provided (74 ms)
2025-04-15T08:23:44.1394153Z     âœ“ create workflow without parent folder if no folder is provided (57 ms)
2025-04-15T08:23:44.1395670Z     âœ“ create workflow without parent is provided folder does not exist in the project (54 ms)
2025-04-15T08:23:44.1397813Z   GET /workflows/:workflowId
2025-04-15T08:23:44.1398688Z     âœ“ should return pin data (69 ms)
2025-04-15T08:23:44.1399450Z     âœ“ should return tags (54 ms)
2025-04-15T08:23:44.1400012Z   GET /workflows
2025-04-15T08:23:44.1400935Z     âœ“ should return zero workflows if none exist (35 ms)
2025-04-15T08:23:44.1403312Z     âœ“ should return workflows (79 ms)
2025-04-15T08:23:44.1404409Z     âœ“ should return workflows with scopes when ?includeScopes=true (138 ms)
2025-04-15T08:23:44.1405998Z     filter
2025-04-15T08:23:44.1407374Z       âœ“ should filter workflows by field: name (49 ms)
2025-04-15T08:23:44.1408346Z       âœ“ should filter workflows by field: active (57 ms)
2025-04-15T08:23:44.1410079Z       âœ“ should filter workflows by field: tags (AND operator) (101 ms)
2025-04-15T08:23:44.1411028Z       âœ“ should filter workflows by projectId (67 ms)
2025-04-15T08:23:44.1411855Z       âœ“ should filter workflows by parentFolderId (70 ms)
2025-04-15T08:23:44.1439713Z       âœ“ should return homeProject when filtering workflows by projectId (63 ms)
2025-04-15T08:23:44.1440414Z     select
2025-04-15T08:23:44.1440971Z       âœ“ should select workflow field: name (48 ms)
2025-04-15T08:23:44.1441644Z       âœ“ should select workflow field: active (50 ms)
2025-04-15T08:23:44.1442345Z       âœ“ should select workflow field: tags (62 ms)
2025-04-15T08:23:44.1443784Z       âœ“ should select workflow fields: createdAt and updatedAt (66 ms)
2025-04-15T08:23:44.1444651Z       âœ“ should select workflow field: versionId (64 ms)
2025-04-15T08:23:44.1445411Z       âœ“ should select workflow field: ownedBy (63 ms)
2025-04-15T08:23:44.1446168Z       âœ“ should select workflow field: parentFolder (55 ms)
2025-04-15T08:23:44.1446692Z     sortBy
2025-04-15T08:23:44.1447402Z       âœ“ should fail when trying to sort by non sortable column (40 ms)
2025-04-15T08:23:44.1448178Z       âœ“ should sort by createdAt column (73 ms)
2025-04-15T08:23:44.1448836Z       âœ“ should sort by name column (71 ms)
2025-04-15T08:23:44.1449506Z       âœ“ should sort by updatedAt column (62 ms)
2025-04-15T08:23:44.1450017Z     pagination
2025-04-15T08:23:44.1450648Z       âœ“ should fail when skip is provided without take (76 ms)
2025-04-15T08:23:44.1451431Z       âœ“ should handle skip with take parameter (88 ms)
2025-04-15T08:23:44.1452194Z       âœ“ should handle pagination with sorting (81 ms)
2025-04-15T08:23:44.1453805Z       âœ“ should handle pagination with filtering (88 ms)
2025-04-15T08:23:44.1454758Z       âœ“ should return empty array when pagination exceeds total count (70 ms)
2025-04-15T08:23:44.1455886Z       âœ“ should return all results when no pagination parameters are provided (71 ms)
2025-04-15T08:23:44.1456623Z   GET /workflows?includeFolders=true
2025-04-15T08:23:44.1457413Z     âœ“ should return zero workflows and folders if none exist (35 ms)
2025-04-15T08:23:44.1458225Z     âœ“ should return workflows and folders (66 ms)
2025-04-15T08:23:44.1459226Z     âœ“ should return workflows with scopes and folders when ?includeScopes=true (130 ms)
2025-04-15T08:23:44.1459953Z     filter
2025-04-15T08:23:44.1460592Z       âœ“ should filter workflows and folders by field: name (59 ms)
2025-04-15T08:23:44.1461517Z       âœ“ should filter workflows and folders by field: active (44 ms)
2025-04-15T08:23:44.1462556Z       âœ“ should filter workflows and folders by field: tags (AND operator) (75 ms)
2025-04-15T08:23:44.1463697Z       âœ“ should filter workflows by projectId (58 ms)
2025-04-15T08:23:44.1464802Z       âœ“ should filter workflows by parentFolderId and its descendants when filtering by name (74 ms)
2025-04-15T08:23:44.1466093Z       âœ“ should return homeProject when filtering workflows and folders by projectId (69 ms)
2025-04-15T08:23:44.1466785Z     sortBy
2025-04-15T08:23:44.1467446Z       âœ“ should fail when trying to sort by non sortable column (42 ms)
2025-04-15T08:23:44.1468229Z       âœ“ should sort by createdAt column (90 ms)
2025-04-15T08:23:44.1468885Z       âœ“ should sort by name column (119 ms)
2025-04-15T08:23:44.1469507Z       âœ“ should sort by updatedAt column (73 ms)
2025-04-15T08:23:44.1470301Z     pagination
2025-04-15T08:23:44.1470935Z       âœ“ should fail when skip is provided without take (64 ms)
2025-04-15T08:23:44.1471708Z       âœ“ should handle skip with take parameter (72 ms)
2025-04-15T08:23:44.1472433Z       âœ“ should handle pagination with sorting (78 ms)
2025-04-15T08:23:44.1473479Z       âœ“ should handle pagination with filtering (113 ms)
2025-04-15T08:23:44.1474370Z       âœ“ should return empty array when pagination exceeds total count (86 ms)
2025-04-15T08:23:44.1475460Z       âœ“ should return all results when no pagination parameters are provided (72 ms)
2025-04-15T08:23:44.1476183Z   PATCH /workflows/:workflowId
2025-04-15T08:23:44.1476899Z     âœ“ should create workflow history version when licensed (72 ms)
2025-04-15T08:23:44.1477811Z     âœ“ should not create workflow history version when not licensed (63 ms)
2025-04-15T08:23:44.1478700Z     âœ“ should activate workflow without changing version ID (60 ms)
2025-04-15T08:23:44.1479592Z     âœ“ should deactivate workflow without changing version ID (60 ms)
2025-04-15T08:23:44.1480356Z     âœ“ should update workflow meta (61 ms)
2025-04-15T08:23:44.1480988Z     âœ“ should move workflow to folder (61 ms)
2025-04-15T08:23:44.1481647Z     âœ“ should move workflow to project root (64 ms)
2025-04-15T08:23:44.1483014Z     âœ“ should fail if trying update workflow parent folder with a folder that does not belong to project (67 ms)
2025-04-15T08:23:44.1484199Z   POST /workflows/:workflowId/run
2025-04-15T08:23:44.1484912Z     âœ“ should prevent tampering if sharing is enabled (47 ms)
2025-04-15T08:23:44.1485824Z     âœ“ should skip tampering prevention if sharing is disabled (55 ms)
2025-04-15T08:23:44.1486451Z   DELETE /workflows/:workflowId
2025-04-15T08:23:44.1487052Z     âœ“ deletes a workflow owned by the user (44 ms)
2025-04-15T08:23:44.1487992Z     âœ“ deletes a workflow owned by the user, even if the user is just a member (48 ms)
2025-04-15T08:23:44.1488966Z     âœ“ does not delete a workflow that is not owned by the user (47 ms)
2025-04-15T08:23:44.1489839Z     âœ“ allows the owner to delete workflows they don't own (51 ms)
2025-04-15T08:23:44.1490258Z 
2025-04-15T08:23:47.2008006Z /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/@n8n/typeorm/driver/mysql/MysqlQueryRunner.js:165
2025-04-15T08:23:47.2034612Z                         return fail(new QueryFailedError_1.QueryFailedError(query, parameters, err));
2025-04-15T08:23:47.2040721Z                                     ^
2025-04-15T08:23:47.2042960Z 
2025-04-15T08:23:47.2045865Z QueryFailedError: Can't add new command when connection is in closed state
2025-04-15T08:23:47.2073195Z     at Query.onResult (/home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:246:33)
2025-04-15T08:23:47.2105445Z     at PoolConnection._addCommandClosedState (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:169:11)
2025-04-15T08:23:47.2107380Z     at PoolConnection.query (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:575:17)
2025-04-15T08:23:47.2109624Z     at /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:207:36
2025-04-15T08:23:47.2111404Z     at processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-04-15T08:23:47.2112543Z   query: 'DELETE FROM `test_insights_by_period` WHERE `periodStart` < DATE_SUB(CURRENT_DATE, INTERVAL 10 DAY)',
2025-04-15T08:23:47.2113580Z   parameters: [],
2025-04-15T08:23:47.2114207Z   driverError: Error: Can't add new command when connection is in closed state
2025-04-15T08:23:47.2115642Z       at PoolConnection._addCommandClosedState (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:164:17)
2025-04-15T08:23:47.2118161Z       at PoolConnection.query (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:575:17)
2025-04-15T08:23:47.2120300Z       at /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:207:36
2025-04-15T08:23:47.2122014Z       at processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-04-15T08:23:47.2122647Z     fatal: true
2025-04-15T08:23:47.2123158Z   },
2025-04-15T08:23:47.2123441Z   fatal: true
2025-04-15T08:23:47.2123769Z }
2025-04-15T08:23:47.2123944Z 
2025-04-15T08:23:47.2124091Z Node.js v20.19.0
2025-04-15T08:23:54.1803633Z PASS test/integration/credentials/credentials.api.test.ts (10.661 s)
2025-04-15T08:23:54.1806635Z   GET /credentials
2025-04-15T08:23:54.1809506Z     âœ“ should return all creds for owner (108 ms)
2025-04-15T08:23:54.1811413Z     âœ“ should return only own creds for member (71 ms)
2025-04-15T08:23:54.1812138Z     âœ“ should return scopes when ?includeScopes=true (104 ms)
2025-04-15T08:23:54.1812992Z     âœ“ should return data when ?includeData=true (100 ms)
2025-04-15T08:23:54.1814073Z     âœ“ should return data when ?includeData=true for owners (56 ms)
2025-04-15T08:23:54.1814522Z     should return
2025-04-15T08:23:54.1814958Z       âœ“ all credentials for owner (95 ms)
2025-04-15T08:23:54.1815518Z       âœ“ only own credentials for member (63 ms)
2025-04-15T08:23:54.1815921Z     filter
2025-04-15T08:23:54.1816510Z       âœ“ should filter credentials by field: name - full match (57 ms)
2025-04-15T08:23:54.1817375Z       âœ“ should filter credentials by field: name - partial match (50 ms)
2025-04-15T08:23:54.1818222Z       âœ“ should filter credentials by field: type - full match (53 ms)
2025-04-15T08:23:54.1819069Z       âœ“ should filter credentials by field: type - partial match (41 ms)
2025-04-15T08:23:54.1819832Z       âœ“ should filter credentials by projectId (46 ms)
2025-04-15T08:23:54.1820680Z       âœ“ should return homeProject when filtering credentials by projectId (61 ms)
2025-04-15T08:23:54.1821696Z       âœ“ should return all credentials in a team project that member is part of (58 ms)
2025-04-15T08:23:54.1822917Z       âœ“ should return no credentials in a team project that member not is part of (50 ms)
2025-04-15T08:23:54.1824213Z       âœ“ should return only owned and explicitly shared credentials when filtering by any personal project id (58 ms)
2025-04-15T08:23:54.1825659Z       âœ“ should not ignore the project filter when the request is done by an owner and also includes the scopes (69 ms)
2025-04-15T08:23:54.1826442Z     select
2025-04-15T08:23:54.1826896Z       âœ“ should select credential field: id (45 ms)
2025-04-15T08:23:54.1827515Z       âœ“ should select credential field: name (42 ms)
2025-04-15T08:23:54.1828118Z       âœ“ should select credential field: type (40 ms)
2025-04-15T08:23:54.1828535Z     take
2025-04-15T08:23:54.1829038Z       âœ“ should return n credentials or less, without skip (57 ms)
2025-04-15T08:23:54.1829726Z       âœ“ should return n credentials or less, with skip (51 ms)
2025-04-15T08:23:54.1830176Z   POST /credentials
2025-04-15T08:23:54.1830578Z     âœ“ should create cred (54 ms)
2025-04-15T08:23:54.1831060Z     âœ“ should fail with invalid inputs (55 ms)
2025-04-15T08:23:54.1831575Z     âœ“ should ignore ID in payload (59 ms)
2025-04-15T08:23:54.1832204Z     âœ“ creates credential in personal project by default (56 ms)
2025-04-15T08:23:54.1833171Z     âœ“ creates credential in a specific project if the projectId is passed (62 ms)
2025-04-15T08:23:54.1834263Z     âœ“ does not create the credential in a specific project if the user is not part of the project (69 ms)
2025-04-15T08:23:54.1834953Z   DELETE /credentials/:id
2025-04-15T08:23:54.1835431Z     âœ“ should delete owned cred for owner (56 ms)
2025-04-15T08:23:54.1836019Z     âœ“ should delete non-owned cred for owner (49 ms)
2025-04-15T08:23:54.1836872Z     âœ“ should delete owned cred for member (56 ms)
2025-04-15T08:23:54.1837479Z     âœ“ should not delete non-owned cred for member (62 ms)
2025-04-15T08:23:54.1838191Z     âœ“ should not delete non-owned but shared cred for member (64 ms)
2025-04-15T08:23:54.1838836Z     âœ“ should fail if cred not found (62 ms)
2025-04-15T08:23:54.1839232Z   PATCH /credentials/:id
2025-04-15T08:23:54.1839713Z     âœ“ should update owned cred for owner (55 ms)
2025-04-15T08:23:54.1840319Z     âœ“ should update non-owned cred for owner (50 ms)
2025-04-15T08:23:54.1840923Z     âœ“ should update owned cred for member (69 ms)
2025-04-15T08:23:54.1841553Z     âœ“ should not update non-owned cred for member (38 ms)
2025-04-15T08:23:54.1842282Z     âœ“ should not update non-owned but shared cred for member (46 ms)
2025-04-15T08:23:54.1843288Z     âœ“ should update non-owned but shared cred for instance owner (55 ms)
2025-04-15T08:23:54.1844141Z     âœ“ should not allow to overwrite oauthTokenData (74 ms)
2025-04-15T08:23:54.1844841Z     âœ“ should fail with invalid inputs (132 ms)
2025-04-15T08:23:54.1845929Z     âœ“ should fail with a 404 if the credential does not exist and the actor has the global credential:update scope (44 ms)
2025-04-15T08:23:54.1847406Z     âœ“ should fail with a 403 if the credential does not exist and the actor does not have the global credential:update scope (39 ms)
2025-04-15T08:23:54.1848701Z     âœ“ should fail with a 400 is credential is managed (60 ms)
2025-04-15T08:23:54.1849194Z   GET /credentials/new
2025-04-15T08:23:54.1849898Z     âœ“ should return default name for new credential or its increment (133 ms)
2025-04-15T08:23:54.1850858Z     âœ“ should return name from query for new credential or its increment (104 ms)
2025-04-15T08:23:54.1851439Z   GET /credentials/:id
2025-04-15T08:23:54.1851945Z     âœ“ should retrieve owned cred for owner (69 ms)
2025-04-15T08:23:54.1882900Z     âœ“ should redact the data when `includeData:true` is passed (71 ms)
2025-04-15T08:23:54.1883995Z     âœ“ should omit oauth data when `includeData:true` is passed (49 ms)
2025-04-15T08:23:54.1884723Z     âœ“ should retrieve owned cred for member (74 ms)
2025-04-15T08:23:54.1885378Z     âœ“ should retrieve non-owned cred for owner (49 ms)
2025-04-15T08:23:54.1886046Z     âœ“ should not retrieve non-owned cred for member (50 ms)
2025-04-15T08:23:54.1886758Z     âœ“ should return 404 if cred not found (44 ms)
2025-04-15T08:23:54.1887248Z   POST /credentials/test
2025-04-15T08:23:54.1887861Z     âœ“ should test a credential with unredacted data (39 ms)
2025-04-15T08:23:54.1888580Z     âœ“ should test a credential with redacted data (47 ms)
2025-04-15T08:23:54.1888925Z 
2025-04-15T08:23:55.3404121Z /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/@n8n/typeorm/driver/mysql/MysqlQueryRunner.js:165
2025-04-15T08:23:55.3406191Z                         return fail(new QueryFailedError_1.QueryFailedError(query, parameters, err));
2025-04-15T08:23:55.3407011Z                                     ^
2025-04-15T08:23:55.3407303Z 
2025-04-15T08:23:55.3407838Z QueryFailedError: Can't add new command when connection is in closed state
2025-04-15T08:23:55.3409832Z     at Query.onResult (/home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:246:33)
2025-04-15T08:23:55.3412243Z     at PoolConnection._addCommandClosedState (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:169:11)
2025-04-15T08:23:55.3414311Z     at PoolConnection.query (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:575:17)
2025-04-15T08:23:55.3416564Z     at /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:207:36
2025-04-15T08:23:55.3418876Z     at processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-04-15T08:23:55.3420045Z   query: 'DELETE FROM `test_insights_by_period` WHERE `periodStart` < DATE_SUB(CURRENT_DATE, INTERVAL 10 DAY)',
2025-04-15T08:23:55.3420875Z   parameters: [],
2025-04-15T08:23:55.3421521Z   driverError: Error: Can't add new command when connection is in closed state
2025-04-15T08:23:55.3423187Z       at PoolConnection._addCommandClosedState (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:164:17)
2025-04-15T08:23:55.3424969Z       at PoolConnection.query (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:575:17)
2025-04-15T08:23:55.3427167Z       at /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:207:36
2025-04-15T08:23:55.3428950Z       at processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-04-15T08:23:55.3429621Z     fatal: true
2025-04-15T08:23:55.3429933Z   },
2025-04-15T08:23:55.3430221Z   fatal: true
2025-04-15T08:23:55.3431456Z }
2025-04-15T08:23:55.3431643Z 
2025-04-15T08:23:55.3431786Z Node.js v20.19.0
2025-04-15T08:23:55.9920719Z PASS test/integration/public-api/workflows.test.ts (11.589 s)
2025-04-15T08:23:55.9921436Z   GET /workflows
2025-04-15T08:23:55.9922162Z     âœ“ should fail due to missing API Key (39 ms)
2025-04-15T08:23:55.9923029Z     âœ“ should fail due to invalid API Key (16 ms)
2025-04-15T08:23:55.9923669Z     âœ“ should return all owned workflows (1333 ms)
2025-04-15T08:23:55.9924407Z     âœ“ should return all owned workflows with pagination (71 ms)
2025-04-15T08:23:55.9925199Z     âœ“ should return all owned workflows filtered by tag (40 ms)
2025-04-15T08:23:55.9926005Z     âœ“ should return all owned workflows filtered by tags (68 ms)
2025-04-15T08:23:55.9927001Z     âœ“ for owner, should return all workflows filtered by `projectId` (53 ms)
2025-04-15T08:23:55.9928153Z     âœ“ for member, should return all member-accessible workflows filtered by `projectId` (36 ms)
2025-04-15T08:23:55.9929182Z     âœ“ should return all owned workflows filtered by name (45 ms)
2025-04-15T08:23:55.9929994Z     âœ“ should return all workflows for owner (52 ms)
2025-04-15T08:23:55.9930875Z     âœ“ should return all owned workflows without pinned data (37 ms)
2025-04-15T08:23:55.9931453Z   GET /workflows/:id
2025-04-15T08:23:55.9932043Z     âœ“ should fail due to missing API Key (13 ms)
2025-04-15T08:23:55.9932957Z     âœ“ should fail due to invalid API Key (11 ms)
2025-04-15T08:23:55.9933723Z     âœ“ should fail due to non-existing workflow (24 ms)
2025-04-15T08:23:55.9934370Z     âœ“ should retrieve workflow (38 ms)
2025-04-15T08:23:55.9935034Z     âœ“ should retrieve non-owned workflow for owner (27 ms)
2025-04-15T08:23:55.9935838Z     âœ“ should retrieve workflow without pinned data (42 ms)
2025-04-15T08:23:55.9936413Z   DELETE /workflows/:id
2025-04-15T08:23:55.9937070Z     âœ“ should fail due to missing API Key (14 ms)
2025-04-15T08:23:55.9937763Z     âœ“ should fail due to invalid API Key (11 ms)
2025-04-15T08:23:55.9938418Z     âœ“ should fail due to non-existing workflow (39 ms)
2025-04-15T08:23:55.9939066Z     âœ“ should delete the workflow (35 ms)
2025-04-15T08:23:55.9939682Z     âœ“ should delete non-owned workflow when owner (49 ms)
2025-04-15T08:23:55.9940184Z   POST /workflows/:id/activate
2025-04-15T08:23:55.9940723Z     âœ“ should fail due to missing API Key (9 ms)
2025-04-15T08:23:55.9941348Z     âœ“ should fail due to invalid API Key (11 ms)
2025-04-15T08:23:55.9941996Z     âœ“ should fail due to non-existing workflow (23 ms)
2025-04-15T08:23:55.9948205Z     âœ“ should fail due to trying to activate a workflow without any nodes (38 ms)
2025-04-15T08:23:55.9949285Z     âœ“ should fail due to trying to activate a workflow without a trigger (35 ms)
2025-04-15T08:23:55.9950454Z     âœ“ should set workflow as active (106 ms)
2025-04-15T08:23:55.9951149Z     âœ“ should set non-owned workflow as active when owner (94 ms)
2025-04-15T08:23:55.9951724Z   POST /workflows/:id/deactivate
2025-04-15T08:23:55.9952274Z     âœ“ should fail due to missing API Key (11 ms)
2025-04-15T08:23:55.9953107Z     âœ“ should fail due to invalid API Key (10 ms)
2025-04-15T08:23:55.9953764Z     âœ“ should fail due to non-existing workflow (26 ms)
2025-04-15T08:23:55.9954362Z     âœ“ should deactivate workflow (68 ms)
2025-04-15T08:23:55.9955020Z     âœ“ should deactivate non-owned workflow when owner (69 ms)
2025-04-15T08:23:55.9955513Z   POST /workflows
2025-04-15T08:23:55.9955988Z     âœ“ should fail due to missing API Key (11 ms)
2025-04-15T08:23:55.9956587Z     âœ“ should fail due to invalid API Key (10 ms)
2025-04-15T08:23:55.9958145Z     âœ“ should fail due to invalid body (50 ms)
2025-04-15T08:23:55.9958698Z     âœ“ should create workflow (35 ms)
2025-04-15T08:23:55.9959399Z     âœ“ should create workflow history version when licensed (22 ms)
2025-04-15T08:23:55.9960286Z     âœ“ should not create workflow history version when not licensed (20 ms)
2025-04-15T08:23:55.9961231Z     âœ“ should not add a starting node if the payload has no starting nodes (22 ms)
2025-04-15T08:23:55.9961827Z   PUT /workflows/:id
2025-04-15T08:23:55.9962561Z     âœ“ should fail due to missing API Key (15 ms)
2025-04-15T08:23:55.9963320Z     âœ“ should fail due to invalid API Key (16 ms)
2025-04-15T08:23:55.9963951Z     âœ“ should fail due to non-existing workflow (42 ms)
2025-04-15T08:23:55.9964561Z     âœ“ should fail due to invalid body (10 ms)
2025-04-15T08:23:55.9965099Z     âœ“ should update workflow (29 ms)
2025-04-15T08:23:55.9965776Z     âœ“ should create workflow history version when licensed (40 ms)
2025-04-15T08:23:55.9966574Z     âœ“ should not create workflow history when not licensed (37 ms)
2025-04-15T08:23:55.9967291Z     âœ“ should update non-owned workflow if owner (36 ms)
2025-04-15T08:23:55.9967757Z   GET /workflows/:id/tags
2025-04-15T08:23:55.9968278Z     âœ“ should fail due to missing API Key (12 ms)
2025-04-15T08:23:55.9968864Z     âœ“ should fail due to invalid API Key (10 ms)
2025-04-15T08:23:55.9969491Z     âœ“ should fail if N8N_WORKFLOW_TAGS_DISABLED (26 ms)
2025-04-15T08:23:55.9970145Z     âœ“ should fail due to non-existing workflow (14 ms)
2025-04-15T08:23:55.9970802Z     âœ“ should return all tags of owned workflow (40 ms)
2025-04-15T08:23:55.9971570Z     âœ“ should return empty array if workflow does not have tags (33 ms)
2025-04-15T08:23:55.9972121Z   PUT /workflows/:id/tags
2025-04-15T08:23:55.9972621Z     âœ“ should fail due to missing API Key (12 ms)
2025-04-15T08:23:55.9973354Z     âœ“ should fail due to invalid API Key (10 ms)
2025-04-15T08:23:55.9973973Z     âœ“ should fail if N8N_WORKFLOW_TAGS_DISABLED (25 ms)
2025-04-15T08:23:55.9974443Z     âœ“ should fail due to non-existing workflow (17 ms)
2025-04-15T08:23:55.9974905Z     âœ“ should add the tags, workflow have not got tags previously (41 ms)
2025-04-15T08:23:55.9975418Z     âœ“ should add the tags, workflow have some tags previously (45 ms)
2025-04-15T08:23:55.9976006Z     âœ“ should fail to add the tags as one does not exist, workflow should maintain previous tags (73 ms)
2025-04-15T08:23:55.9976418Z   PUT /workflows/:id/transfer
2025-04-15T08:23:55.9976739Z     âœ“ should transfer workflow to project (84 ms)
2025-04-15T08:23:55.9977123Z     âœ“ if no destination project, should reject (52 ms)
2025-04-15T08:23:55.9977333Z 
2025-04-15T08:24:00.4991293Z PASS src/events/__tests__/telemetry-event-relay.test.ts
2025-04-15T08:24:00.4991960Z   TelemetryEventRelay
2025-04-15T08:24:00.4992302Z     init
2025-04-15T08:24:00.4993386Z       âœ“ with diagnostics enabled, should init telemetry and register listeners (6 ms)
2025-04-15T08:24:00.4994519Z       âœ“ with diagnostics disabled, should neither init telemetry nor register listeners (6 ms)
2025-04-15T08:24:00.4996993Z     project events
2025-04-15T08:24:00.4997615Z       âœ“ should track on `team-project-updated` event (2 ms)
2025-04-15T08:24:00.4998764Z       âœ“ should track on `team-project-deleted` event (1 ms)
2025-04-15T08:24:00.4999472Z       âœ“ should track on `team-project-created` event (1 ms)
2025-04-15T08:24:00.4999962Z     source control events
2025-04-15T08:24:00.5000585Z       âœ“ should track on `source-control-settings-updated` event
2025-04-15T08:24:00.5001418Z       âœ“ should track on `source-control-user-started-pull-ui` event
2025-04-15T08:24:00.5002264Z       âœ“ should track on `source-control-user-finished-pull-ui` event
2025-04-15T08:24:00.5003340Z       âœ“ should track on `source-control-user-pulled-api` event (1 ms)
2025-04-15T08:24:00.5004230Z       âœ“ should track on `source-control-user-started-push-ui` event (1 ms)
2025-04-15T08:24:00.5005160Z       âœ“ should track on `source-control-user-finished-push-ui` event (1 ms)
2025-04-15T08:24:00.5005772Z     license events
2025-04-15T08:24:00.5006345Z       âœ“ should track on `license-renewal-attempted` event
2025-04-15T08:24:00.5006844Z     variable events
2025-04-15T08:24:00.5007411Z       âœ“ should track on `variable-created` event
2025-04-15T08:24:00.5007878Z     external secrets events
2025-04-15T08:24:00.5008648Z       âœ“ should track on `external-secrets-provider-settings-saved` event (1 ms)
2025-04-15T08:24:00.5009302Z     public API events
2025-04-15T08:24:00.5009862Z       âœ“ should track on `public-api-invoked` event
2025-04-15T08:24:00.5010869Z       âœ“ should track on `public-api-key-created` event
2025-04-15T08:24:00.5011608Z       âœ“ should track on `public-api-key-deleted` event (1 ms)
2025-04-15T08:24:00.5012137Z     community package events
2025-04-15T08:24:00.5013001Z       âœ“ should track on `community-package-installed` event (1 ms)
2025-04-15T08:24:00.5013779Z       âœ“ should track on `community-package-updated` event
2025-04-15T08:24:00.5014544Z       âœ“ should track on `community-package-deleted` event (1 ms)
2025-04-15T08:24:00.5015130Z     credentials events
2025-04-15T08:24:00.5015787Z       âœ“ should track on `credentials-created` event (1 ms)
2025-04-15T08:24:00.5016596Z       âœ“ should track on `credentials-shared` event (1 ms)
2025-04-15T08:24:00.5017272Z       âœ“ should track on `credentials-updated` event
2025-04-15T08:24:00.5017961Z       âœ“ should track on `credentials-deleted` event (1 ms)
2025-04-15T08:24:00.5018442Z     LDAP events
2025-04-15T08:24:00.5019049Z       âœ“ should track on `ldap-general-sync-finished` event
2025-04-15T08:24:00.5019851Z       âœ“ should track on `ldap-settings-updated` event
2025-04-15T08:24:00.5020683Z       âœ“ should track on `ldap-login-sync-failed` event (1 ms)
2025-04-15T08:24:00.5021562Z       âœ“ should track on `login-failed-due-to-ldap-disabled` event
2025-04-15T08:24:00.5022112Z     workflow events
2025-04-15T08:24:00.5022874Z       âœ“ should track on `workflow-created` event (4 ms)
2025-04-15T08:24:00.5023555Z       âœ“ should track on `workflow-deleted` event (2 ms)
2025-04-15T08:24:00.5024327Z       âœ“ should track on `workflow-post-execute` event (3 ms)
2025-04-15T08:24:00.5025078Z       âœ“ should track on `workflow-saved` event (8 ms)
2025-04-15T08:24:00.5025826Z       âœ“ should track on `workflow-sharing-updated` event
2025-04-15T08:24:00.5026325Z     user events
2025-04-15T08:24:00.5026835Z       âœ“ should track on `user-updated` event (1 ms)
2025-04-15T08:24:00.5027478Z       âœ“ should track on `user-deleted` event
2025-04-15T08:24:00.5028120Z       âœ“ should track on `user-invited` event (1 ms)
2025-04-15T08:24:00.5028756Z       âœ“ should track on `user-signed-up` event
2025-04-15T08:24:00.5029595Z       âœ“ should track on `user-submitted-personalization-survey` event (1 ms)
2025-04-15T08:24:00.5030409Z       âœ“ should track on `user-changed-role` event
2025-04-15T08:24:00.5031106Z       âœ“ should track on `user-retrieved-user` event (1 ms)
2025-04-15T08:24:00.5031809Z       âœ“ should track on `user-retrieved-all-users` event
2025-04-15T08:24:00.5032298Z     lifecycle events
2025-04-15T08:24:00.5033070Z       âœ“ should track on `server-started` event (8 ms)
2025-04-15T08:24:00.5033783Z       âœ“ should track on `session-started` event (1 ms)
2025-04-15T08:24:00.5034897Z       âœ“ should track on `instance-stopped` event
2025-04-15T08:24:00.5035669Z       âœ“ should track on `instance-owner-setup` event (1 ms)
2025-04-15T08:24:00.5036245Z     workflow execution events
2025-04-15T08:24:00.5037047Z       âœ“ should track on `first-production-workflow-succeeded` event (1 ms)
2025-04-15T08:24:00.5038002Z       âœ“ should track on `first-workflow-data-loaded` event (1 ms)
2025-04-15T08:24:00.5038602Z     email events
2025-04-15T08:24:00.5039179Z       âœ“ should track on `email-failed` event (1 ms)
2025-04-15T08:24:00.5039664Z     Community+ registered
2025-04-15T08:24:00.5040415Z       âœ“ should track `license-community-plus-registered` event (1 ms)
2025-04-15T08:24:00.5041102Z     workflow post execute events
2025-04-15T08:24:00.5041799Z       âœ“ should not track when workflow has no id (2 ms)
2025-04-15T08:24:00.5042541Z       âœ“ should track successful workflow execution (8 ms)
2025-04-15T08:24:00.5043666Z       âœ“ should call telemetry.track when manual node execution finished (5 ms)
2025-04-15T08:24:00.5044954Z       âœ“ should call telemetry.track when manual node execution finished with canceled error message (3 ms)
2025-04-15T08:24:00.5046224Z       âœ“ should call telemetry.track when manual workflow execution finished (67 ms)
2025-04-15T08:24:00.5047651Z       âœ“ should call telemetry.track when manual node execution finished with is_managed and credential_type properties (7 ms)
2025-04-15T08:24:00.5049154Z       âœ“ should call telemetry.track when user ran out of free AI credits (5 ms)
2025-04-15T08:24:00.5049648Z 
2025-04-15T08:24:03.2298857Z /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/@n8n/typeorm/driver/mysql/MysqlQueryRunner.js:165
2025-04-15T08:24:03.2305033Z                         return fail(new QueryFailedError_1.QueryFailedError(query, parameters, err));
2025-04-15T08:24:03.2307533Z                                     ^
2025-04-15T08:24:03.2309563Z 
2025-04-15T08:24:03.2311833Z QueryFailedError: Can't add new command when connection is in closed state
2025-04-15T08:24:03.2315753Z     at Query.onResult (/home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:246:33)
2025-04-15T08:24:03.2319723Z     at PoolConnection._addCommandClosedState (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:169:11)
2025-04-15T08:24:03.2324033Z     at PoolConnection.query (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:575:17)
2025-04-15T08:24:03.2335667Z     at /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:207:36
2025-04-15T08:24:03.2339232Z     at processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-04-15T08:24:03.2342053Z   query: 'DELETE FROM `test_insights_by_period` WHERE `periodStart` < DATE_SUB(CURRENT_DATE, INTERVAL 10 DAY)',
2025-04-15T08:24:03.2345031Z   parameters: [],
2025-04-15T08:24:03.2354006Z   driverError: Error: Can't add new command when connection is in closed state
2025-04-15T08:24:03.2355860Z       at PoolConnection._addCommandClosedState (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:164:17)
2025-04-15T08:24:03.2357668Z       at PoolConnection.query (/home/runner/work/n8n/n8n/node_modules/.pnpm/mysql2@3.11.0/node_modules/mysql2/lib/connection.js:575:17)
2025-04-15T08:24:03.2359886Z       at /home/runner/work/n8n/n8n/node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/driver/mysql/MysqlQueryRunner.ts:207:36
2025-04-15T08:24:03.2362127Z       at processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-04-15T08:24:03.2363129Z     fatal: true
2025-04-15T08:24:03.2363630Z   },
2025-04-15T08:24:03.2364509Z   fatal: true
2025-04-15T08:24:03.2365131Z }
2025-04-15T08:24:03.2365497Z 
2025-04-15T08:24:03.2365836Z Node.js v20.19.0
2025-04-15T08:24:03.3258688Z FAIL src/modules/insights/__tests__/insights.service.test.ts
2025-04-15T08:24:03.3263013Z   â— Test suite failed to run
2025-04-15T08:24:03.3263474Z 
2025-04-15T08:24:03.3264068Z     Jest worker encountered 4 child process exceptions, exceeding retry limit
2025-04-15T08:24:03.3281749Z 
2025-04-15T08:24:03.3283318Z       at ChildProcessWorker.initialize (../../node_modules/.pnpm/jest-worker@29.6.2/node_modules/jest-worker/build/workers/ChildProcessWorker.js:181:21)
2025-04-15T08:24:03.3284795Z 
2025-04-15T08:24:05.5774100Z PASS test/integration/credentials/credentials.api.ee.test.ts (11.12 s)
2025-04-15T08:24:05.5780413Z   POST /credentials
2025-04-15T08:24:05.5782078Z     âœ“ project viewers cannot create credentials (181 ms)
2025-04-15T08:24:05.5784170Z   GET /credentials
2025-04-15T08:24:05.5784769Z     âœ“ should return all creds for owner (151 ms)
2025-04-15T08:24:05.5785523Z     âœ“ should return only relevant creds for member (102 ms)
2025-04-15T08:24:05.5786649Z     âœ“ should show credentials that the user has access to through a team project they are part of (71 ms)
2025-04-15T08:24:05.5787932Z   GET /credentials/for-workflow
2025-04-15T08:24:05.5788318Z     for team projects
2025-04-15T08:24:05.5789450Z       âœ“ it will only return the credentials in that project if "workflowId" is used as the query parameter and the actor is a "member" (110 ms)
2025-04-15T08:24:05.5795226Z       âœ“ it will only return the credentials in that project if "projectId" is used as the query parameter and the actor is a "member" (72 ms)
2025-04-15T08:24:05.5801002Z       âœ“ it will only return the credentials in that project if "workflowId" is used as the query parameter and the actor is a "owner" (73 ms)
2025-04-15T08:24:05.5803066Z       âœ“ it will only return the credentials in that project if "projectId" is used as the query parameter and the actor is a "owner" (79 ms)
2025-04-15T08:24:05.5804000Z     for personal projects
2025-04-15T08:24:05.5805021Z       âœ“ it returns only personal credentials for a members, if "projectId" is used as the query parameter (111 ms)
2025-04-15T08:24:05.5806447Z       âœ“ it returns only personal credentials for a members, if "workflowId" is used as the query parameter (125 ms)
2025-04-15T08:24:05.5808140Z       âœ“ if the actor is a global owner and the workflow has not been shared with them, it returns all credentials of all projects the workflow is part of (98 ms)
2025-04-15T08:24:05.5809985Z       âœ“ if the actor is a global owner and the workflow has been shared with them, it returns all credentials of all projects the workflow is part of (86 ms)
2025-04-15T08:24:05.5811475Z       âœ“ if the projectId is passed by a global owner it will return all credentials in that project (86 ms)
2025-04-15T08:24:05.5813389Z       âœ“ if the global owner owns the workflow it will return all credentials of all personal projects, when using "workflowId" as the query parameter (81 ms)
2025-04-15T08:24:05.5815288Z       âœ“ if the global owner owns the workflow it will return all credentials of all personal projects, when using "projectId" as the query parameter (87 ms)
2025-04-15T08:24:05.5816285Z   GET /credentials/:id
2025-04-15T08:24:05.5816835Z     âœ“ project viewers can view credentials (72 ms)
2025-04-15T08:24:05.5817450Z     âœ“ should retrieve owned cred for owner (95 ms)
2025-04-15T08:24:05.5818093Z     âœ“ should redact the data when `includeData:true` is passed (77 ms)
2025-04-15T08:24:05.5818721Z     âœ“ should retrieve non-owned cred for owner (105 ms)
2025-04-15T08:24:05.5819314Z     âœ“ should retrieve owned cred for member (145 ms)
2025-04-15T08:24:05.5819966Z     âœ“ should not retrieve non-owned cred for member (56 ms)
2025-04-15T08:24:05.5820608Z     âœ“ should return 404 if cred not found (57 ms)
2025-04-15T08:24:05.5821573Z   PATCH /credentials/:id
2025-04-15T08:24:05.5822132Z     âœ“ project viewer cannot update credentials (62 ms)
2025-04-15T08:24:05.5822600Z   PUT /credentials/:id/share
2025-04-15T08:24:05.5823665Z     âœ“ should share the credential with the provided userIds and unshare it for missing ones (100 ms)
2025-04-15T08:24:05.5824663Z     âœ“ should share the credential with the provided userIds (83 ms)
2025-04-15T08:24:05.5825414Z     âœ“ should respond 403 for non-existing credentials (47 ms)
2025-04-15T08:24:05.5826248Z     âœ“ should respond 403 for non-owned credentials for shared members (51 ms)
2025-04-15T08:24:05.5827328Z     âœ“ should respond 403 for non-owned credentials for non-shared members sharing with self (58 ms)
2025-04-15T08:24:05.5828428Z     âœ“ should respond 403 for non-owned credentials for non-shared members sharing (60 ms)
2025-04-15T08:24:05.5829364Z     âœ“ should respond 200 for non-owned credentials for owners (46 ms)
2025-04-15T08:24:05.5830027Z     âœ“ should not ignore pending sharee (66 ms)
2025-04-15T08:24:05.5830651Z     âœ“ should ignore non-existing sharee (52 ms)
2025-04-15T08:24:05.5831314Z     âœ“ should ignore sharing with owner project (62 ms)
2025-04-15T08:24:05.5832099Z     âœ“ should ignore sharing with project that already has it shared (50 ms)
2025-04-15T08:24:05.5833288Z     âœ“ should respond 400 if invalid payload is provided (42 ms)
2025-04-15T08:24:05.5833903Z     âœ“ should unshare the credential (59 ms)
2025-04-15T08:24:05.5834682Z     âœ“ should not call internal hooks listener for email sent if emailing is disabled (64 ms)
2025-04-15T08:24:05.5835779Z     âœ“ member should be able to share from personal project to team project that member has access to (61 ms)
2025-04-15T08:24:05.5836769Z     âœ“ member should be able to share from team project to personal project (61 ms)
2025-04-15T08:24:05.5837764Z     âœ“ member should be able to share from team project to team project that member has access to (55 ms)
2025-04-15T08:24:05.5838747Z     âœ“ admins should be able to share from any team project to any team project  (79 ms)
2025-04-15T08:24:05.5839739Z     âœ“ admins should be able to share from any team project to any user's personal project  (52 ms)
2025-04-15T08:24:05.5840721Z     âœ“ admins should be able to share from any personal project to any team project  (56 ms)
2025-04-15T08:24:05.5841328Z   PUT /:credentialId/transfer
2025-04-15T08:24:05.5841827Z     âœ“ cannot transfer into the same project (59 ms)
2025-04-15T08:24:05.5842416Z     âœ“ cannot transfer somebody elses credential (68 ms)
2025-04-15T08:24:05.5843367Z     âœ“ cannot transfer if you're not a member of the destination project (51 ms)
2025-04-15T08:24:05.5844165Z     âœ“ project:editors cannot transfer credentials (63 ms)
2025-04-15T08:24:05.5844864Z     âœ“ project:viewers cannot transfer credentials (46 ms)
2025-04-15T08:24:05.5845708Z     âœ“ owners can always transfer from a team project to a team project (52 ms)
2025-04-15T08:24:05.5846697Z     âœ“ owners can always transfer from a team project to a personal project (42 ms)
2025-04-15T08:24:05.5847740Z     âœ“ owners can always transfer from a personal project to a team project (59 ms)
2025-04-15T08:24:05.5848751Z     âœ“ admins can always transfer from a team project to a team project (57 ms)
2025-04-15T08:24:05.5849780Z     âœ“ admins can always transfer from a team project to a personal project (56 ms)
2025-04-15T08:24:05.5850840Z     âœ“ admins can always transfer from a personal project to a team project (61 ms)
2025-04-15T08:24:05.5851348Z 
2025-04-15T08:24:07.6846609Z PASS src/ldap.ee/__tests__/ldap.service.test.ts
2025-04-15T08:24:07.6855583Z   LdapService
2025-04-15T08:24:07.6859912Z     init()
2025-04-15T08:24:07.6860636Z       âœ“ should load the LDAP configuration (9 ms)
2025-04-15T08:24:07.6865323Z       âœ“ should set expected configuration variables from LDAP config if LDAP is enabled (3 ms)
2025-04-15T08:24:07.6867315Z       âœ“ should set expected configuration variables from LDAP config if LDAP is disabled (1 ms)
2025-04-15T08:24:07.6868483Z       âœ“ should show logger warning if authentication method is not ldap or email (2 ms)
2025-04-15T08:24:07.6870130Z       âœ“ should schedule syncing if config has enabled synchronization (2 ms)
2025-04-15T08:24:07.6871396Z       âœ“ should throw an error if config has enabled synchronization but no synchronizationInterval is set (43 ms)
2025-04-15T08:24:07.6872174Z     loadConfig()
2025-04-15T08:24:07.6873235Z       âœ“ should retrieve the LDAP configuration from the settings repository (1 ms)
2025-04-15T08:24:07.6874281Z       âœ“ should throw an expected error if the LDAP configuration is not found (1 ms)
2025-04-15T08:24:07.6875253Z       âœ“ should decipher the LDAP configuration admin password (1 ms)
2025-04-15T08:24:07.6876077Z       âœ“ should return the expected LDAP configuration (1 ms)
2025-04-15T08:24:07.6876604Z     updateConfig()
2025-04-15T08:24:07.6877305Z       âœ“ should throw expected error if the LDAP configuration is invalid (4 ms)
2025-04-15T08:24:07.6878470Z       âœ“ should throw expected error if login is enabled and the current authentication method is "saml" (2 ms)
2025-04-15T08:24:07.6879538Z       âœ“ should encrypt the binding admin password (2 ms)
2025-04-15T08:24:07.6880546Z       âœ“ should delete all ldap identities if login is disabled and ldap users exist (2 ms)
2025-04-15T08:24:07.6882350Z       âœ“ should not delete ldap identities if login is disabled and there are no ldap identities (2 ms)
2025-04-15T08:24:07.6885069Z       âœ“ should update the LDAP configuration in the settings repository (1 ms)
2025-04-15T08:24:07.6885991Z       âœ“ should update the LDAP login label in the config (2 ms)
2025-04-15T08:24:07.6886511Z     setConfig()
2025-04-15T08:24:07.6887313Z       âœ“ should stop synchronization if the timer is running and the config is disabled (1 ms)
2025-04-15T08:24:07.6888539Z       âœ“ should schedule synchronization if the timer is not running and the config is enabled (1 ms)
2025-04-15T08:24:07.6889998Z       âœ“ should throw an error if the timer is not running and the config is enabled but the synchronizationInterval is not set (2 ms)
2025-04-15T08:24:07.6892185Z       âœ“ should restart synchronization if the timer is running and the config is enabled (2 ms)
2025-04-15T08:24:07.6893135Z     searchWithAdminBinding()
2025-04-15T08:24:07.6893701Z       âœ“ should bind admin client (1 ms)
2025-04-15T08:24:07.6894400Z       âœ“ should call client search with expected parameters (1 ms)
2025-04-15T08:24:07.6895472Z       âœ“ should call client search with expected parameters when searchPageSize is 0 (1 ms)
2025-04-15T08:24:07.6896371Z       âœ“ should unbind client after search (1 ms)
2025-04-15T08:24:07.6902191Z       âœ“ should return expected search entries
2025-04-15T08:24:07.6902612Z     validUser()
2025-04-15T08:24:07.6903468Z       âœ“ should throw expected error if no configuration has been set
2025-04-15T08:24:07.6904395Z       âœ“ should bind the ldap client with the expected distinguished name and password
2025-04-15T08:24:07.6905222Z       âœ“ should throw expected error if binding fails (1 ms)
2025-04-15T08:24:07.6905853Z       âœ“ should unbind the client binding (1 ms)
2025-04-15T08:24:07.6907576Z     findAndAuthenticateLdapUser()
2025-04-15T08:24:07.6908216Z       âœ“ should search for expected admin login ID (1 ms)
2025-04-15T08:24:07.6908920Z       âœ“ should emit expected error if admin search fails (1 ms)
2025-04-15T08:24:07.6909619Z       âœ“ should return undefined if no user is found (1 ms)
2025-04-15T08:24:07.6910214Z       âœ“ should validate found user (1 ms)
2025-04-15T08:24:07.6910837Z       âœ“ should validate last user if more than one is found
2025-04-15T08:24:07.6911544Z       âœ“ should return undefined if invalid user is found (1 ms)
2025-04-15T08:24:07.6915139Z       âœ“ should resolve binary attributes for found user (1 ms)
2025-04-15T08:24:07.6916205Z       âœ“ should return found user (1 ms)
2025-04-15T08:24:07.6916627Z     testConnection()
2025-04-15T08:24:07.6917232Z       âœ“ should throw expected error if init() is not called first
2025-04-15T08:24:07.6918238Z       âœ“ should create a new client without TLS if connectionSecurity is set to "none" (1 ms)
2025-04-15T08:24:07.6919948Z       âœ“ should create a new client with TLS enabled if connectionSecurity is set to "tls" and allowing unauthorized certificates (1 ms)
2025-04-15T08:24:07.6921501Z       âœ“ should create a new client with TLS enabled if connectionSecurity is set to "tls" and not allowing unauthorized certificates
2025-04-15T08:24:07.6923438Z       âœ“ should create a new client and start TLS if connectionSecurity is set to "startTls" (1 ms)
2025-04-15T08:24:07.6924479Z       âœ“ should not create a new client if one has already been created (1 ms)
2025-04-15T08:24:07.6924988Z     runSync()
2025-04-15T08:24:07.6925511Z       âœ“ should search for users with expected parameters (1 ms)
2025-04-15T08:24:07.6926195Z       âœ“ should resolve binary attributes for users (1 ms)
2025-04-15T08:24:07.6926840Z       âœ“ should throw expected error if search fails (1 ms)
2025-04-15T08:24:07.6927592Z       âœ“ should process expected users if mode is "live" (1 ms)
2025-04-15T08:24:07.6928296Z       âœ“ should sync expected LDAP data when no errors (1 ms)
2025-04-15T08:24:07.6929097Z       âœ“ should sync expected LDAP data when users fail to process (1 ms)
2025-04-15T08:24:07.6929952Z       âœ“ should emit expected event if synchronization is enabled (6 ms)
2025-04-15T08:24:07.6930763Z       âœ“ should emit expected event if synchronization is disabled (1 ms)
2025-04-15T08:24:07.6932033Z       âœ“ should emit expected event with error message if processUsers fails (2 ms)
2025-04-15T08:24:07.6932663Z     stopSync()
2025-04-15T08:24:07.6933462Z       âœ“ should clear the scheduled timer
2025-04-15T08:24:07.6933784Z 
2025-04-15T08:24:11.1795619Z PASS test/integration/folder/folder.controller.test.ts (10.457 s)
2025-04-15T08:24:11.1802055Z   POST /projects/:projectId/folders
2025-04-15T08:24:11.1807277Z     âœ“ should not create folder when project does not exist (119 ms)
2025-04-15T08:24:11.1808219Z     âœ“ should not create folder when name is empty (41 ms)
2025-04-15T08:24:11.1809200Z     âœ“ should not create folder if user has project:viewer role in team project (45 ms)
2025-04-15T08:24:11.1810356Z     âœ“ should not allow creating folder in another user's personal project (31 ms)
2025-04-15T08:24:11.1811428Z     âœ“ should create folder if user has project:editor role in team project (41 ms)
2025-04-15T08:24:11.1812492Z     âœ“ should create folder if user has project:admin role in team project (38 ms)
2025-04-15T08:24:11.1813825Z     âœ“ should not allow creating folder with parent that exists in another project (66 ms)
2025-04-15T08:24:11.1814763Z     âœ“ should create folder in root of specified project (43 ms)
2025-04-15T08:24:11.1815680Z     âœ“ should create folder in specified project within another folder (46 ms)
2025-04-15T08:24:11.1816520Z     âœ“ should create folder in personal project (48 ms)
2025-04-15T08:24:11.1817115Z   GET /projects/:projectId/folders/:folderId/tree
2025-04-15T08:24:11.1817874Z     âœ“ should not get folder tree when project does not exist (55 ms)
2025-04-15T08:24:11.1818726Z     âœ“ should not get folder tree when folder does not exist (36 ms)
2025-04-15T08:24:11.1819629Z     âœ“ should not get folder tree if user has no access to project (39 ms)
2025-04-15T08:24:11.1820650Z     âœ“ should not allow getting folder tree from another user's personal project (32 ms)
2025-04-15T08:24:11.1821492Z     âœ“ should get nested folder structure (39 ms)
2025-04-15T08:24:11.1822059Z   PATCH /projects/:projectId/folders/:folderId
2025-04-15T08:24:11.1822978Z     âœ“ should not update folder when project does not exist (32 ms)
2025-04-15T08:24:11.1823798Z     âœ“ should not update folder when folder does not exist (31 ms)
2025-04-15T08:24:11.1824542Z     âœ“ should not update folder when name is empty (40 ms)
2025-04-15T08:24:11.1825457Z     âœ“ should not update folder if user has project:viewer role in team project (39 ms)
2025-04-15T08:24:11.1826487Z     âœ“ should not allow updating folder in another user's personal project (29 ms)
2025-04-15T08:24:11.1827482Z     âœ“ should update folder if user has project:editor role in team project (53 ms)
2025-04-15T08:24:11.1828976Z     âœ“ should update folder if user has project:admin role in team project (41 ms)
2025-04-15T08:24:11.1829830Z     âœ“ should update folder in personal project (42 ms)
2025-04-15T08:24:11.1830446Z     âœ“ should update folder tags (49 ms)
2025-04-15T08:24:11.1831139Z     âœ“ should replace existing folder tags with new ones (61 ms)
2025-04-15T08:24:11.1831858Z     âœ“ should update folder parent folder ID (55 ms)
2025-04-15T08:24:11.1832901Z     âœ“ should not update folder parent when target folder does not exist (37 ms)
2025-04-15T08:24:11.1833934Z     âœ“ should not update folder parent when target folder is in another project (44 ms)
2025-04-15T08:24:11.1834946Z     âœ“ should allow moving a folder to root level by setting parentFolderId to "0" (44 ms)
2025-04-15T08:24:11.1835968Z     âœ“ should not update folder parent if user has project:viewer role in team project (43 ms)
2025-04-15T08:24:11.1837083Z     âœ“ should update folder parent folder if user has project:editor role in team project (50 ms)
2025-04-15T08:24:11.1837967Z     âœ“ should not allow setting a folder as its own parent (50 ms)
2025-04-15T08:24:11.1838561Z   DELETE /projects/:projectId/folders/:folderId
2025-04-15T08:24:11.1839275Z     âœ“ should not delete folder when project does not exist (31 ms)
2025-04-15T08:24:11.1840269Z     âœ“ should not delete folder when folder does not exist (41 ms)
2025-04-15T08:24:11.1841126Z     âœ“ should not delete folder if user has project:viewer role in team project (38 ms)
2025-04-15T08:24:11.1842087Z     âœ“ should not allow deleting folder in another user's personal project (34 ms)
2025-04-15T08:24:11.1843378Z     âœ“ should delete folder if user has project:editor role in team project (38 ms)
2025-04-15T08:24:11.1844358Z     âœ“ should delete folder if user has project:admin role in team project (36 ms)
2025-04-15T08:24:11.1845105Z     âœ“ should delete folder in personal project (37 ms)
2025-04-15T08:24:11.1846161Z     âœ“ should delete folder, all child folders, and contained workflows when no transfer folder is specified (57 ms)
2025-04-15T08:24:11.1847338Z     âœ“ should transfer folder contents when transferToFolderId is specified (74 ms)
2025-04-15T08:24:11.1848297Z     âœ“ should not transfer folder contents when transfer folder does not exist (38 ms)
2025-04-15T08:24:11.1849365Z     âœ“ should not transfer folder contents when transfer folder is in another project (41 ms)
2025-04-15T08:24:11.1850593Z     âœ“ should not allow transferring contents to the same folder being deleted (41 ms)
2025-04-15T08:24:11.1851664Z     âœ“ should transfer folder contents to project root when transferToFolderId is "0" (65 ms)
2025-04-15T08:24:11.1852401Z   GET /projects/:projectId/folders
2025-04-15T08:24:11.1853299Z     âœ“ should not list folders when project does not exist (43 ms)
2025-04-15T08:24:11.1854172Z     âœ“ should not list folders if user has no access to project (33 ms)
2025-04-15T08:24:11.1855156Z     âœ“ should not allow listing folders from another user's personal project (25 ms)
2025-04-15T08:24:11.1856221Z     âœ“ should list folders if user has project:viewer role in team project (51 ms)
2025-04-15T08:24:11.1857070Z     âœ“ should list folders from personal project (41 ms)
2025-04-15T08:24:11.1857696Z     âœ“ should filter folders by name (36 ms)
2025-04-15T08:24:11.1858341Z     âœ“ should filter folders by parent folder ID (47 ms)
2025-04-15T08:24:11.1859166Z     âœ“ should filter root-level folders when parentFolderId=0 (36 ms)
2025-04-15T08:24:11.1859909Z     âœ“ should filter folders by tag (58 ms)
2025-04-15T08:24:11.1860687Z     âœ“ should filter folders by multiple tags (AND operator) (47 ms)
2025-04-15T08:24:11.1861559Z     âœ“ should filter folders by excludeFolderIdAndDescendants (43 ms)
2025-04-15T08:24:11.1862403Z     âœ“ should apply pagination with take parameter (71 ms)
2025-04-15T08:24:11.1863433Z     âœ“ should apply pagination with skip parameter (44 ms)
2025-04-15T08:24:11.1864218Z     âœ“ should apply combined skip and take parameters (40 ms)
2025-04-15T08:24:11.1864945Z     âœ“ should sort folders by name ascending (39 ms)
2025-04-15T08:24:11.1865976Z     âœ“ should sort folders by name descending (42 ms)
2025-04-15T08:24:11.1866639Z     âœ“ should sort folders by updatedAt (36 ms)
2025-04-15T08:24:11.1867483Z     âœ“ should select specific fields when requested (41 ms)
2025-04-15T08:24:11.1868287Z     âœ“ should combine multiple query parameters correctly (44 ms)
2025-04-15T08:24:11.1869152Z     âœ“ should filter by projectId automatically based on URL (36 ms)
2025-04-15T08:24:11.1869793Z   GET /projects/:projectId/folders/content
2025-04-15T08:24:11.1870533Z     âœ“ should not list folders when project does not exist (30 ms)
2025-04-15T08:24:11.1871484Z     âœ“ should not return folder content if user has no access to project (31 ms)
2025-04-15T08:24:11.1872567Z     âœ“ should not return folder content if folder does not belong to project (32 ms)
2025-04-15T08:24:11.1904015Z     âœ“ should return folder content if user has project:viewer role in team project (60 ms)
2025-04-15T08:24:11.1904980Z     âœ“ should return folder content (89 ms)
2025-04-15T08:24:11.1905330Z 
2025-04-15T08:24:13.2823604Z PASS src/evaluation.ee/test-runner/__tests__/test-runner.service.ee.test.ts (5.355 s)
2025-04-15T08:24:13.2830496Z   TestRunnerService
2025-04-15T08:24:13.2835627Z     âœ“ should create an instance of TestRunnerService (9 ms)
2025-04-15T08:24:13.2839545Z     âœ“ should create and run test cases from past executions (26 ms)
2025-04-15T08:24:13.2853721Z     âœ“ should run both workflow under test and evaluation workflow (18 ms)
2025-04-15T08:24:13.2854708Z     âœ“ should properly count passed and failed executions (14 ms)
2025-04-15T08:24:13.2855566Z     âœ“ should properly count failed test executions (26 ms)
2025-04-15T08:24:13.2856353Z     âœ“ should properly count failed evaluations (35 ms)
2025-04-15T08:24:13.2857265Z     âœ“ should specify correct start nodes when running workflow under test (34 ms)
2025-04-15T08:24:13.2858131Z     âœ“ should properly choose trigger and start nodes (2 ms)
2025-04-15T08:24:13.2858931Z     âœ“ should properly choose trigger and start nodes 2 (1 ms)
2025-04-15T08:24:13.2859792Z     âœ“ should properly run test when nodes were renamed (50 ms)
2025-04-15T08:24:13.2860646Z     âœ“ should properly choose trigger when it was renamed (2 ms)
2025-04-15T08:24:13.2861598Z     âœ“ should create proper execution data for queue mode in runTestCase (6 ms)
2025-04-15T08:24:13.2862633Z     âœ“ should create proper execution data for regular mode in runTestCase (5 ms)
2025-04-15T08:24:13.2863903Z     âœ“ should run workflow with metrics defined in the middle of the workflow (12 ms)
2025-04-15T08:24:13.2864955Z     âœ“ should properly override metrics from earlier nodes with later ones (10 ms)
2025-04-15T08:24:13.2865563Z     Test Run cancellation
2025-04-15T08:24:13.2866061Z       âœ“ should cancel test run (20 ms)
2025-04-15T08:24:13.2866361Z 
2025-04-15T08:24:14.6857762Z PASS test/integration/project.api.test.ts (8.808 s)
2025-04-15T08:24:14.6861207Z   GET /projects/
2025-04-15T08:24:14.6863090Z     âœ“ member should get all personal projects and team projects they are apart of (142 ms)
2025-04-15T08:24:14.6865004Z     âœ“ owner should get all projects (54 ms)
2025-04-15T08:24:14.6866536Z   GET /projects/count
2025-04-15T08:24:14.6867363Z     âœ“ should return correct number of projects (36 ms)
2025-04-15T08:24:14.6868027Z   GET /projects/my-projects
2025-04-15T08:24:14.6868837Z     âœ“ member should get all projects they are apart of (80 ms)
2025-04-15T08:24:14.6869776Z     âœ“ owner should get all projects they are apart of (64 ms)
2025-04-15T08:24:14.6880365Z   GET /projects/personal
2025-04-15T08:24:14.6881240Z     âœ“ should return the user's personal project (18 ms)
2025-04-15T08:24:14.6882277Z     âœ“ should return 404 if user doesn't have a personal project (34 ms)
2025-04-15T08:24:14.6892221Z   POST /projects/
2025-04-15T08:24:14.6893209Z     âœ“ should create a team project (26 ms)
2025-04-15T08:24:14.6894199Z     âœ“ should allow to create a team projects if below the quota (26 ms)
2025-04-15T08:24:14.6895256Z     âœ“ should fail to create a team project if at quota (22 ms)
2025-04-15T08:24:14.6896336Z     âœ“ should fail to create a team project if above the quota (19 ms)
2025-04-15T08:24:14.6897036Z   PATCH /projects/:projectId
2025-04-15T08:24:14.6897714Z     âœ“ should update a team project name (27 ms)
2025-04-15T08:24:14.6898573Z     âœ“ should not allow viewers to edit team project name (21 ms)
2025-04-15T08:24:14.6899860Z     âœ“ should not allow owners to edit personal project name (29 ms)
2025-04-15T08:24:14.6900544Z     member management
2025-04-15T08:24:14.6901246Z       âœ“ should add or remove users from a project (86 ms)
2025-04-15T08:24:14.6902430Z       âœ“ `project:viewer`s should not be able to add, update or remove users from a project (33 ms)
2025-04-15T08:24:14.6904733Z       âœ“ `project:editor`s should not be able to add, update or remove users from a project (44 ms)
2025-04-15T08:24:14.6907223Z       âœ“ should not be able to add a user with the role project:viewer if it's not licensed (28 ms)
2025-04-15T08:24:14.6908417Z       âœ“ should not be able to add a user with the role project:editor if it's not licensed (29 ms)
2025-04-15T08:24:14.6909586Z       âœ“ should not edit a relation of a project when changing a user's role to an unlicensed role (44 ms)
2025-04-15T08:24:14.6911143Z       âœ“ should  edit a relation of a project when changing a user's role to an licensed role but unlicensed roles are present (42 ms)
2025-04-15T08:24:14.6912492Z       âœ“ should not add or remove users from a personal project (28 ms)
2025-04-15T08:24:14.6913296Z   GET /project/:projectId
2025-04-15T08:24:14.6913970Z     âœ“ should get project details and relations (54 ms)
2025-04-15T08:24:14.6914494Z   DELETE /project/:projectId
2025-04-15T08:24:14.6915162Z     âœ“ allows the project:owner to delete a project (86 ms)
2025-04-15T08:24:14.6916168Z     âœ“ allows the instance owner to delete a team project their are not related to (34 ms)
2025-04-15T08:24:14.6917262Z     âœ“ does not allow instance members to delete their personal project (13 ms)
2025-04-15T08:24:14.6918256Z     âœ“ does not allow instance owners to delete their personal projects (16 ms)
2025-04-15T08:24:14.6919349Z     âœ“ does not allow users with the role project:editor to delete a project (18 ms)
2025-04-15T08:24:14.6920422Z     âœ“ does not allow users with the role project:viewer to delete a project (17 ms)
2025-04-15T08:24:14.6921659Z     âœ“ deletes all workflows and credentials it owns as well as the sharings into other projects (99 ms)
2025-04-15T08:24:14.6923234Z     âœ“ unshares all workflows and credentials that were shared with the project (80 ms)
2025-04-15T08:24:14.6924115Z     âœ“ deletes the project relations (48 ms)
2025-04-15T08:24:14.6924858Z     âœ“ should fail if the project to delete does not exist (11 ms)
2025-04-15T08:24:14.6925919Z     âœ“ should fail to delete if project to migrate to and the project to delete are the same (21 ms)
2025-04-15T08:24:14.6927615Z     âœ“ does not migrate credentials and projects if the user does not have the permissions to create workflows or credentials in the target project (27 ms)
2025-04-15T08:24:14.6929676Z     âœ“ migrates folders, workflows and credentials to another project if `migrateToProject` is passed (70 ms)
2025-04-15T08:24:14.6931082Z     âœ“ should upgrade a projects role if the workflow/credential is already shared with it (51 ms)
2025-04-15T08:24:14.6931668Z 
2025-04-15T08:24:17.9505107Z PASS src/task-runners/task-broker/__tests__/task-broker.service.test.ts
2025-04-15T08:24:17.9506066Z   TaskBroker
2025-04-15T08:24:17.9507989Z     expireTasks
2025-04-15T08:24:17.9510271Z       âœ“ should remove expired task offers and keep valid task offers (8 ms)
2025-04-15T08:24:17.9512511Z       âœ“ should not expire non-expiring task offers (6 ms)
2025-04-15T08:24:17.9530609Z     registerRunner
2025-04-15T08:24:17.9531262Z       âœ“ should add a runner to known runners (2 ms)
2025-04-15T08:24:17.9531974Z       âœ“ should send node types to runner (1 ms)
2025-04-15T08:24:17.9532478Z     registerRequester
2025-04-15T08:24:17.9533351Z       âœ“ should add a requester to known requesters (1 ms)
2025-04-15T08:24:17.9533891Z     deregisterRunner
2025-04-15T08:24:17.9534494Z       âœ“ should remove a runner from known runners
2025-04-15T08:24:17.9535228Z       âœ“ should remove any pending offers for that runner
2025-04-15T08:24:17.9536029Z       âœ“ should fail any running tasks for that runner (1 ms)
2025-04-15T08:24:17.9536573Z     deregisterRequester
2025-04-15T08:24:17.9537621Z       âœ“ should remove a requester from known requesters (1 ms)
2025-04-15T08:24:17.9538161Z     taskRequested
2025-04-15T08:24:17.9538835Z       âœ“ should match a pending offer to an incoming request (1 ms)
2025-04-15T08:24:17.9539394Z     taskOffered
2025-04-15T08:24:17.9540046Z       âœ“ should match a pending request to an incoming offer (1 ms)
2025-04-15T08:24:17.9540590Z     settleTasks
2025-04-15T08:24:17.9541289Z       âœ“ should match task offers with task requests by task type (2 ms)
2025-04-15T08:24:17.9542371Z       âœ“ should not match a request whose acceptance is in progress (2 ms)
2025-04-15T08:24:17.9543397Z       âœ“ should expire tasks before settling
2025-04-15T08:24:17.9543892Z     onRunnerMessage
2025-04-15T08:24:17.9544509Z       âœ“ should handle `runner:taskaccepted` message (3 ms)
2025-04-15T08:24:17.9545272Z       âœ“ should handle `runner:taskrejected` message (1 ms)
2025-04-15T08:24:17.9545988Z       âœ“ should handle `runner:taskdone` message (1 ms)
2025-04-15T08:24:17.9546683Z       âœ“ should handle `runner:taskerror` message (1 ms)
2025-04-15T08:24:17.9547451Z       âœ“ should handle `runner:taskdatarequest` message (1 ms)
2025-04-15T08:24:17.9548160Z       âœ“ should handle `runner:rpc` message
2025-04-15T08:24:17.9548850Z       âœ“ should handle `runner:nodetypesrequest` message
2025-04-15T08:24:17.9549743Z       âœ“ should handle `runner:taskoffer` message with expiring offer (2 ms)
2025-04-15T08:24:17.9550788Z       âœ“ should handle `runner:taskoffer` message with non-expiring offer (1 ms)
2025-04-15T08:24:17.9551436Z     onRequesterMessage
2025-04-15T08:24:17.9552140Z       âœ“ should handle `requester:nodetypesresponse` message (1 ms)
2025-04-15T08:24:17.9554003Z     task timeouts
2025-04-15T08:24:17.9554708Z       âœ“ on sending task, we should set up task timeout (2 ms)
2025-04-15T08:24:17.9555466Z       âœ“ on task completion, we should clear timeout
2025-04-15T08:24:17.9556148Z       âœ“ on task error, we should clear timeout
2025-04-15T08:24:17.9557318Z       âœ“ [internal mode] on timeout, we should emit `runner:timed-out-during-task` event and send error to requester (2 ms)
2025-04-15T08:24:17.9558824Z       âœ“ [external mode] on timeout, we should instruct the runner to cancel and send error to requester (2 ms)
2025-04-15T08:24:17.9559476Z 
2025-04-15T08:24:19.1597357Z PASS src/events/__tests__/log-streaming-event-relay.test.ts (5.625 s)
2025-04-15T08:24:19.1607906Z   LogStreamingEventRelay
2025-04-15T08:24:19.1608251Z     workflow events
2025-04-15T08:24:19.1608893Z       âœ“ should log on `workflow-created` event (7 ms)
2025-04-15T08:24:19.1609416Z       âœ“ should log on `workflow-deleted` event
2025-04-15T08:24:19.1609956Z       âœ“ should log on `workflow-saved` event (1 ms)
2025-04-15T08:24:19.1611302Z       âœ“ should log on `workflow-pre-execute` event (1 ms)
2025-04-15T08:24:19.1612429Z       âœ“ should log on `workflow-post-execute` for successful execution (1 ms)
2025-04-15T08:24:19.1613822Z       âœ“ should log on `workflow-post-execute` event for failed execution (1 ms)
2025-04-15T08:24:19.1620925Z     user events
2025-04-15T08:24:19.1717422Z       âœ“ should log on `user-updated` event
2025-04-15T08:24:19.1718261Z       âœ“ should log on `user-deleted` event (1 ms)
2025-04-15T08:24:19.1718899Z       âœ“ should log on `user-invited` event (1 ms)
2025-04-15T08:24:19.1719514Z       âœ“ should log on `user-reinvited` event (6 ms)
2025-04-15T08:24:19.1720110Z       âœ“ should log on `user-signed-up` event
2025-04-15T08:24:19.1720670Z       âœ“ should log on `user-logged-in` event (1 ms)
2025-04-15T08:24:19.1721087Z     click events
2025-04-15T08:24:19.1721646Z       âœ“ should log on `user-password-reset-request-click` event
2025-04-15T08:24:19.1722357Z       âœ“ should log on `user-invite-email-click` event
2025-04-15T08:24:19.1723296Z       âœ“ should log on `user-password-reset-email-click` event (1 ms)
2025-04-15T08:24:19.1723833Z     node events
2025-04-15T08:24:19.1724276Z       âœ“ should log on `node-pre-execute` event
2025-04-15T08:24:19.1724828Z       âœ“ should log on `node-post-execute` event
2025-04-15T08:24:19.1725551Z     credentials events
2025-04-15T08:24:19.1726032Z       âœ“ should log on `credentials-shared` event
2025-04-15T08:24:19.1726646Z       âœ“ should log on `credentials-created` event (1 ms)
2025-04-15T08:24:19.1727248Z       âœ“ should log on `credentials-deleted` event
2025-04-15T08:24:19.1727875Z       âœ“ should log on `credentials-updated` event (1 ms)
2025-04-15T08:24:19.1728291Z     auth events
2025-04-15T08:24:19.1728714Z       âœ“ should log on `user-login-failed` event
2025-04-15T08:24:19.1729137Z     community package events
2025-04-15T08:24:19.1729723Z       âœ“ should log on `community-package-updated` event (4 ms)
2025-04-15T08:24:19.1730459Z       âœ“ should log on `community-package-installed` event (1 ms)
2025-04-15T08:24:19.1731149Z       âœ“ should log on `community-package-deleted` event
2025-04-15T08:24:19.1731589Z     email events
2025-04-15T08:24:19.1732004Z       âœ“ should log on `email-failed` event
2025-04-15T08:24:19.1732404Z     public API events
2025-04-15T08:24:19.1733079Z       âœ“ should log on `public-api-key-created` event (1 ms)
2025-04-15T08:24:19.1733757Z       âœ“ should log on `public-api-key-deleted` event (1 ms)
2025-04-15T08:24:19.1734194Z     execution events
2025-04-15T08:24:19.1734774Z       âœ“ should log on `execution-started-during-bootup` event (1 ms)
2025-04-15T08:24:19.1735447Z       âœ“ should log on `execution-throttled` event
2025-04-15T08:24:19.1735855Z     AI events
2025-04-15T08:24:19.1736380Z       âœ“ should log on `ai-messages-retrieved-from-memory` event
2025-04-15T08:24:19.1737123Z       âœ“ should log on `ai-message-added-to-memory` event (1 ms)
2025-04-15T08:24:19.1737826Z       âœ“ should log on `ai-output-parsed` event (1 ms)
2025-04-15T08:24:19.1738526Z       âœ“ should log on `ai-documents-retrieved` event
2025-04-15T08:24:19.1739198Z       âœ“ should log on `ai-document-embedded` event (1 ms)
2025-04-15T08:24:19.1739804Z       âœ“ should log on `ai-query-embedded` event
2025-04-15T08:24:19.1740392Z       âœ“ should log on `ai-document-processed` event
2025-04-15T08:24:19.1740996Z       âœ“ should log on `ai-text-split` event (1 ms)
2025-04-15T08:24:19.1741552Z       âœ“ should log on `ai-tool-called` event
2025-04-15T08:24:19.1742172Z       âœ“ should log on `ai-vector-store-searched` event (1 ms)
2025-04-15T08:24:19.1747427Z       âœ“ should log on `ai-llm-generated-output` event
2025-04-15T08:24:19.1748132Z       âœ“ should log on `ai-llm-errored` event (1 ms)
2025-04-15T08:24:19.1748822Z       âœ“ should log on `ai-vector-store-populated` event (1 ms)
2025-04-15T08:24:19.1749476Z       âœ“ should log on `ai-vector-store-updated` event
2025-04-15T08:24:19.1749809Z 
2025-04-15T08:24:19.6527821Z PASS test/integration/users.api.test.ts (8.238 s)
2025-04-15T08:24:19.6529045Z   GET /users
2025-04-15T08:24:19.6529764Z     âœ“ should return all users (78 ms)
2025-04-15T08:24:19.6530202Z     list query options
2025-04-15T08:24:19.6530585Z       filter
2025-04-15T08:24:19.6531044Z         âœ“ should filter users by field: email (24 ms)
2025-04-15T08:24:19.6531701Z         âœ“ should filter users by field: firstName (16 ms)
2025-04-15T08:24:19.6532305Z         âœ“ should filter users by field: lastName (16 ms)
2025-04-15T08:24:19.6533107Z         âœ“ should filter users by computed field: isOwner (18 ms)
2025-04-15T08:24:19.6533527Z       select
2025-04-15T08:24:19.6533944Z         âœ“ should select user field: id (9 ms)
2025-04-15T08:24:19.6534502Z         âœ“ should select user field: email (7 ms)
2025-04-15T08:24:19.6535099Z         âœ“ should select user field: firstName (8 ms)
2025-04-15T08:24:19.6535698Z         âœ“ should select user field: lastName (8 ms)
2025-04-15T08:24:19.6536109Z       take
2025-04-15T08:24:19.6536606Z         âœ“ should return n users or less, without skip (27 ms)
2025-04-15T08:24:19.6537306Z         âœ“ should return n users or less, with skip (15 ms)
2025-04-15T08:24:19.6537759Z       auxiliary fields
2025-04-15T08:24:19.6538692Z         âœ“ should support options that require auxiliary fields (8 ms)
2025-04-15T08:24:19.6539313Z   GET /users/:id/password-reset-link
2025-04-15T08:24:19.6540432Z     âœ“ should allow owners to generate password reset links for admins and members (33 ms)
2025-04-15T08:24:19.6541635Z     âœ“ should allow admins to generate password reset links for admins and members, but not owners (46 ms)
2025-04-15T08:24:19.6544446Z     âœ“ should not allow members to generate password reset links for anyone (16 ms)
2025-04-15T08:24:19.6545108Z   DELETE /users/:id
2025-04-15T08:24:19.6545638Z     âœ“ should delete user and their resources (110 ms)
2025-04-15T08:24:19.6546568Z     âœ“ should delete user and team relations and transfer their personal resources to user (137 ms)
2025-04-15T08:24:19.6547599Z     âœ“ should delete user and transfer their personal resources to team project (70 ms)
2025-04-15T08:24:19.6548395Z     âœ“ should fail to delete self (13 ms)
2025-04-15T08:24:19.6548970Z     âœ“ should fail to delete the instance owner (15 ms)
2025-04-15T08:24:19.6549637Z     âœ“ should fail to delete a user that does not exist (7 ms)
2025-04-15T08:24:19.6550401Z     âœ“ should fail to transfer to a project that does not exist (15 ms)
2025-04-15T08:24:19.6551183Z     âœ“ should fail to delete if user to delete is transferee (15 ms)
2025-04-15T08:24:19.6551676Z   PATCH /users/:id/role
2025-04-15T08:24:19.6552474Z     âœ“ should clear credential external secrets usability cache when changing a user's role (59 ms)
2025-04-15T08:24:19.6553303Z     unauthenticated user
2025-04-15T08:24:19.6553744Z       âœ“ should receive 401 (3 ms)
2025-04-15T08:24:19.6554229Z     Invalid payload should return 400 when newRoleName
2025-04-15T08:24:19.6554736Z       âœ“ is missing (6 ms)
2025-04-15T08:24:19.6555111Z       âœ“ is `owner` (3 ms)
2025-04-15T08:24:19.6555468Z       âœ“ is an array (4 ms)
2025-04-15T08:24:19.6555790Z     member
2025-04-15T08:24:19.6556227Z       âœ“ should fail to demote owner to member (5 ms)
2025-04-15T08:24:19.6556813Z       âœ“ should fail to demote owner to admin (5 ms)
2025-04-15T08:24:19.6557392Z       âœ“ should fail to demote admin to member (6 ms)
2025-04-15T08:24:19.6558016Z       âœ“ should fail to promote other member to owner (7 ms)
2025-04-15T08:24:19.6558676Z       âœ“ should fail to promote other member to admin (5 ms)
2025-04-15T08:24:19.6559285Z       âœ“ should fail to promote self to admin (6 ms)
2025-04-15T08:24:19.6559856Z       âœ“ should fail to promote self to owner (5 ms)
2025-04-15T08:24:19.6560256Z     admin
2025-04-15T08:24:19.6560710Z       âœ“ should receive 404 on unknown target user (6 ms)
2025-04-15T08:24:19.6561298Z       âœ“ should fail to demote owner to admin (10 ms)
2025-04-15T08:24:19.6561879Z       âœ“ should fail to demote owner to member (6 ms)
2025-04-15T08:24:19.6562614Z       âœ“ should fail to promote member to admin if not licensed (11 ms)
2025-04-15T08:24:19.6563716Z       âœ“ should be able to demote admin to member (25 ms)
2025-04-15T08:24:19.6564380Z       âœ“ should be able to demote self to member (19 ms)
2025-04-15T08:24:19.6565127Z       âœ“ should be able to promote member to admin if licensed (20 ms)
2025-04-15T08:24:19.6565642Z     owner
2025-04-15T08:24:19.6566112Z       âœ“ should fail to demote self to admin (6 ms)
2025-04-15T08:24:19.6566724Z       âœ“ should fail to demote self to member (6 ms)
2025-04-15T08:24:19.6567466Z       âœ“ should fail to promote member to admin if not licensed (4 ms)
2025-04-15T08:24:19.6568269Z       âœ“ should be able to promote member to admin if licensed (18 ms)
2025-04-15T08:24:19.6568984Z       âœ“ should be able to demote admin to member (21 ms)
2025-04-15T08:24:19.6569320Z 
2025-04-15T08:24:24.0273908Z PASS src/execution-lifecycle/__tests__/execution-lifecycle-hooks.test.ts
2025-04-15T08:24:24.0296266Z   Execution Lifecycle Hooks
2025-04-15T08:24:24.0297125Z     getLifecycleHooksForRegularMain
2025-04-15T08:24:24.0298242Z       âœ“ should setup the correct set of hooks (2 ms)
2025-04-15T08:24:24.0299036Z       workflowExecuteBefore
2025-04-15T08:24:24.0300155Z         âœ“ should emit workflow-pre-execute events (6 ms)
2025-04-15T08:24:24.0301765Z         âœ“ should run workflow.preExecute hook (1 ms)
2025-04-15T08:24:24.0302955Z         âœ“ should send executionStarted push event (1 ms)
2025-04-15T08:24:24.0324084Z         âœ“ should run workflow.preExecute external hook (1 ms)
2025-04-15T08:24:24.0330360Z       workflowExecuteAfter
2025-04-15T08:24:24.0332216Z         âœ“ should emit workflow-post-execute events (2 ms)
2025-04-15T08:24:24.0339928Z         âœ“ should not emit workflow-post-execute events for waiting executions (1 ms)
2025-04-15T08:24:24.0340923Z         âœ“ should run workflow.postExecute hook (1 ms)
2025-04-15T08:24:24.0341630Z         âœ“ should send executionFinished push event (1 ms)
2025-04-15T08:24:24.0342320Z         âœ“ should send executionWaiting push event (1 ms)
2025-04-15T08:24:24.0343436Z         âœ“ should restore binary data IDs after workflow execution for webhooks (1 ms)
2025-04-15T08:24:24.0344139Z         saving static data
2025-04-15T08:24:24.0344898Z           âœ“ should skip saving static data for manual executions (1 ms)
2025-04-15T08:24:24.0345784Z           âœ“ should save static data for prod executions (2 ms)
2025-04-15T08:24:24.0346584Z           âœ“ should handle static data saving errors (1 ms)
2025-04-15T08:24:24.0353634Z         saving execution data
2025-04-15T08:24:24.0354353Z           âœ“ should update execution with proper data (2 ms)
2025-04-15T08:24:24.0355058Z           âœ“ should not delete unfinished executions (2 ms)
2025-04-15T08:24:24.0355707Z           âœ“ should not delete waiting executions (1 ms)
2025-04-15T08:24:24.0356621Z           âœ“ should soft delete manual executions when manual saving is disabled (9 ms)
2025-04-15T08:24:24.0357644Z           âœ“ should not soft delete manual executions with waitTill (1 ms)
2025-04-15T08:24:24.0358206Z         error workflow
2025-04-15T08:24:24.0361226Z           âœ“ should not execute error workflow for manual executions (1 ms)
2025-04-15T08:24:24.0362295Z           âœ“ should execute error workflow for failed non-manual executions (2 ms)
2025-04-15T08:24:24.0363117Z       nodeExecuteBefore
2025-04-15T08:24:24.0363736Z         âœ“ should emit node-pre-execute event
2025-04-15T08:24:24.0364493Z         âœ“ should send nodeExecuteBefore push event (1 ms)
2025-04-15T08:24:24.0365022Z       nodeExecuteAfter
2025-04-15T08:24:24.0365630Z         âœ“ should emit node-post-execute event (1 ms)
2025-04-15T08:24:24.0366419Z         âœ“ should send nodeExecuteAfter push event (3 ms)
2025-04-15T08:24:24.0367193Z         âœ“ should save execution progress when enabled (1 ms)
2025-04-15T08:24:24.0368011Z         âœ“ should not save execution progress when disabled (1 ms)
2025-04-15T08:24:24.0368662Z       statistics events
2025-04-15T08:24:24.0369608Z         âœ“ workflowExecuteAfter should emit workflowExecutionCompleted statistics event (1 ms)
2025-04-15T08:24:24.0371694Z         âœ“ nodeFetchedData should handle nodeFetchedData statistics event
2025-04-15T08:24:24.0372984Z       when pushRef isn't set
2025-04-15T08:24:24.0373667Z         âœ“ should not setup any push hooks (2 ms)
2025-04-15T08:24:24.0374264Z     getLifecycleHooksForScalingMain
2025-04-15T08:24:24.0374974Z       âœ“ should setup the correct set of hooks (1 ms)
2025-04-15T08:24:24.0375517Z       workflowExecuteBefore
2025-04-15T08:24:24.0376140Z         âœ“ should emit workflow-pre-execute events
2025-04-15T08:24:24.0376831Z         âœ“ should run workflow.preExecute hook
2025-04-15T08:24:24.0377590Z         âœ“ should run the workflow.preExecute external hook
2025-04-15T08:24:24.0378136Z       workflowExecuteAfter
2025-04-15T08:24:24.0378767Z         âœ“ should emit workflow-post-execute events
2025-04-15T08:24:24.0379728Z         âœ“ should not emit workflow-post-execute events for waiting executions (1 ms)
2025-04-15T08:24:24.0380612Z         âœ“ should run workflow.postExecute hook
2025-04-15T08:24:24.0381565Z         âœ“ should delete successful executions when success saving is disabled (1 ms)
2025-04-15T08:24:24.0382665Z         âœ“ should delete failed executions when error saving is disabled (1 ms)
2025-04-15T08:24:24.0383573Z     getLifecycleHooksForScalingWorker
2025-04-15T08:24:24.0384277Z       âœ“ should setup the correct set of hooks (1 ms)
2025-04-15T08:24:24.0385117Z       nodeExecuteBefore
2025-04-15T08:24:24.0385747Z         âœ“ should emit node-pre-execute event (1 ms)
2025-04-15T08:24:24.0386249Z       nodeExecuteAfter
2025-04-15T08:24:24.0386819Z         âœ“ should emit node-post-execute event
2025-04-15T08:24:24.0387313Z       workflowExecuteBefore
2025-04-15T08:24:24.0387962Z         âœ“ should run workflow.preExecute hook (1 ms)
2025-04-15T08:24:24.0388476Z       workflowExecuteAfter
2025-04-15T08:24:24.0389068Z         âœ“ should run workflow.postExecute hook (1 ms)
2025-04-15T08:24:24.0389552Z       statistics events
2025-04-15T08:24:24.0390423Z         âœ“ workflowExecuteAfter should emit workflowExecutionCompleted statistics event (1 ms)
2025-04-15T08:24:24.0391591Z         âœ“ nodeFetchedData should handle nodeFetchedData statistics event (1 ms)
2025-04-15T08:24:24.0392250Z       saving static data
2025-04-15T08:24:24.0393256Z         âœ“ should skip saving static data for manual executions (1 ms)
2025-04-15T08:24:24.0394115Z         âœ“ should save static data for prod executions (1 ms)
2025-04-15T08:24:24.0394917Z         âœ“ should handle static data saving errors (1 ms)
2025-04-15T08:24:24.0395435Z       error workflow
2025-04-15T08:24:24.0396153Z         âœ“ should not execute error workflow for manual executions (1 ms)
2025-04-15T08:24:24.0397131Z         âœ“ should execute error workflow for failed non-manual executions (2 ms)
2025-04-15T08:24:24.0397864Z     getLifecycleHooksForSubExecutions
2025-04-15T08:24:24.0398533Z       âœ“ should setup the correct set of hooks (2 ms)
2025-04-15T08:24:24.0399026Z       workflowExecuteBefore
2025-04-15T08:24:24.0399707Z         âœ“ should emit workflow-pre-execute events (1 ms)
2025-04-15T08:24:24.0400417Z         âœ“ should run workflow.preExecute hook (1 ms)
2025-04-15T08:24:24.0400937Z       workflowExecuteAfter
2025-04-15T08:24:24.0401586Z         âœ“ should emit workflow-post-execute events (1 ms)
2025-04-15T08:24:24.0402560Z         âœ“ should not emit workflow-post-execute events for waiting executions (1 ms)
2025-04-15T08:24:24.0403646Z         âœ“ should run workflow.postExecute hook (1 ms)
2025-04-15T08:24:24.0404167Z       nodeExecuteBefore
2025-04-15T08:24:24.0404753Z         âœ“ should emit node-pre-execute event (1 ms)
2025-04-15T08:24:24.0405269Z       nodeExecuteAfter
2025-04-15T08:24:24.0405852Z         âœ“ should emit node-post-execute event
2025-04-15T08:24:24.0406331Z       statistics events
2025-04-15T08:24:24.0407250Z         âœ“ workflowExecuteAfter should emit workflowExecutionCompleted statistics event (1 ms)
2025-04-15T08:24:24.0408389Z         âœ“ nodeFetchedData should handle nodeFetchedData statistics event
2025-04-15T08:24:24.0408893Z 
2025-04-15T08:24:25.5253762Z PASS src/scaling/__tests__/pubsub-handler.test.ts (5.61 s)
2025-04-15T08:24:25.5256662Z   PubSubHandler
2025-04-15T08:24:25.5261028Z     in webhook process
2025-04-15T08:24:25.5266027Z       âœ“ should set up handlers in webhook process (9 ms)
2025-04-15T08:24:25.5270815Z       âœ“ should reload license on `reload-license` event (8 ms)
2025-04-15T08:24:25.5275884Z       âœ“ should restart event bus on `restart-event-bus` event (1 ms)
2025-04-15T08:24:25.5280791Z       âœ“ should reload providers on `reload-external-secrets-providers` event (1 ms)
2025-04-15T08:24:25.5283498Z       âœ“ should install community package on `community-package-install` event (1 ms)
2025-04-15T08:24:25.5284924Z       âœ“ should update community package on `community-package-update` event (1 ms)
2025-04-15T08:24:25.5287081Z       âœ“ should uninstall community package on `community-package-uninstall` event (1 ms)
2025-04-15T08:24:25.5289233Z     in worker process
2025-04-15T08:24:25.5290263Z       âœ“ should set up handlers in worker process (1 ms)
2025-04-15T08:24:25.5291773Z       âœ“ should reload license on `reload-license` event (1 ms)
2025-04-15T08:24:25.5294598Z       âœ“ should restart event bus on `restart-event-bus` event (1 ms)
2025-04-15T08:24:25.5296286Z       âœ“ should reload providers on `reload-external-secrets-providers` event (1 ms)
2025-04-15T08:24:25.5299139Z       âœ“ should install community package on `community-package-install` event (1 ms)
2025-04-15T08:24:25.5304699Z       âœ“ should update community package on `community-package-update` event
2025-04-15T08:24:25.5306138Z       âœ“ should uninstall community package on `community-package-uninstall` event (1 ms)
2025-04-15T08:24:25.5307884Z       âœ“ should generate status on `get-worker-status` event (1 ms)
2025-04-15T08:24:25.5310200Z     in main process
2025-04-15T08:24:25.5313007Z       âœ“ should set up command and worker response handlers in main process (2 ms)
2025-04-15T08:24:25.5315369Z       âœ“ should reload license on `reload-license` event
2025-04-15T08:24:25.5316417Z       âœ“ should restart event bus on `restart-event-bus` event (1 ms)
2025-04-15T08:24:25.5318078Z       âœ“ should reload providers on `reload-external-secrets-providers` event
2025-04-15T08:24:25.5320523Z       âœ“ should install community package on `community-package-install` event
2025-04-15T08:24:25.5328614Z       âœ“ should update community package on `community-package-update` event (1 ms)
2025-04-15T08:24:25.5331207Z       âœ“ should uninstall community package on `community-package-uninstall` event
2025-04-15T08:24:25.5332868Z       multi-main setup
2025-04-15T08:24:25.5335288Z         âœ“ if leader, should handle `add-webhooks-triggers-and-pollers` event (4 ms)
2025-04-15T08:24:25.5338024Z         âœ“ if follower, should skip `add-webhooks-triggers-and-pollers` event (11 ms)
2025-04-15T08:24:25.5339782Z         âœ“ if leader, should handle `remove-triggers-and-pollers` event (18 ms)
2025-04-15T08:24:25.5342123Z         âœ“ if follower, should skip `remove-triggers-and-pollers` event (14 ms)
2025-04-15T08:24:25.5343592Z         âœ“ should handle `display-workflow-activation` event (3 ms)
2025-04-15T08:24:25.5346204Z         âœ“ should handle `display-workflow-deactivation` event (4 ms)
2025-04-15T08:24:25.5347558Z         âœ“ should handle `display-workflow-activation-error` event (1 ms)
2025-04-15T08:24:25.5349297Z         âœ“ should handle `relay-execution-lifecycle-event` event (1 ms)
2025-04-15T08:24:25.5351083Z         âœ“ should handle `clear-test-webhooks` event (8 ms)
2025-04-15T08:24:25.5352354Z         âœ“ should handle `response-to-get-worker-status event (7 ms)
2025-04-15T08:24:25.5353318Z 
2025-04-15T08:24:26.0856315Z PASS test/integration/execution.service.integration.test.ts (7.899 s)
2025-04-15T08:24:26.0859590Z   ExecutionService
2025-04-15T08:24:26.0859963Z     findRangeWithCount
2025-04-15T08:24:26.0860706Z       âœ“ should return execution summaries (65 ms)
2025-04-15T08:24:26.0861293Z       âœ“ should limit executions (60 ms)
2025-04-15T08:24:26.0862023Z       âœ“ should retrieve executions before `lastId`, excluding it (38 ms)
2025-04-15T08:24:26.0863092Z       âœ“ should retrieve executions after `firstId`, excluding it (22 ms)
2025-04-15T08:24:26.0864303Z       âœ“ should filter executions by `status` (32 ms)
2025-04-15T08:24:26.0864967Z       âœ“ should filter executions by `workflowId` (28 ms)
2025-04-15T08:24:26.0865715Z       âœ“ should filter executions by `startedBefore` (24 ms)
2025-04-15T08:24:26.0866515Z       âœ“ should filter executions by `startedAfter` (16 ms)
2025-04-15T08:24:26.0867261Z       âœ“ should filter executions by `metadata` (16 ms)
2025-04-15T08:24:26.0867972Z       âœ“ should filter executions by `projectId` (39 ms)
2025-04-15T08:24:26.0868812Z       âœ“ should filter executions by `projectId` and expected `status` (31 ms)
2025-04-15T08:24:26.0869802Z       âœ“ should filter executions by `projectId` and expected `waitTill` (28 ms)
2025-04-15T08:24:26.0870734Z       âœ“ should filter executions by `projectId` and expected `metadata` (31 ms)
2025-04-15T08:24:26.0871711Z       âœ“ should filter executions by `projectId` and expected `startedAfter` (27 ms)
2025-04-15T08:24:26.0872922Z       âœ“ should filter executions by `projectId` and expected `startedBefore` (23 ms)
2025-04-15T08:24:26.0873862Z       âœ“ should exclude executions by inaccessible `workflowId` (20 ms)
2025-04-15T08:24:26.0874557Z       âœ“ should support advanced filters (16 ms)
2025-04-15T08:24:26.0875050Z     findLatestCurrentAndCompleted
2025-04-15T08:24:26.0876026Z       âœ“ should return latest current and completed executions (80 ms)
2025-04-15T08:24:26.0876739Z       âœ“ should handle zero current executions (26 ms)
2025-04-15T08:24:26.0877457Z       âœ“ should handle zero completed executions (28 ms)
2025-04-15T08:24:26.0878164Z       âœ“ should handle zero executions (15 ms)
2025-04-15T08:24:26.0878951Z       âœ“ should prioritize `running` over `new` executions (36 ms)
2025-04-15T08:24:26.0879519Z     annotation
2025-04-15T08:24:26.0880136Z       âœ“ should add and retrieve annotation (36 ms)
2025-04-15T08:24:26.0880767Z       âœ“ should update annotation (23 ms)
2025-04-15T08:24:26.0881418Z       âœ“ should filter by annotation tags (33 ms)
2025-04-15T08:24:26.0882135Z       âœ“ should filter by annotation vote (28 ms)
2025-04-15T08:24:26.0882468Z 
2025-04-15T08:24:28.4767572Z PASS src/sso.ee/saml/__tests__/saml-validator.test.ts
2025-04-15T08:24:28.4772115Z   saml-validator
2025-04-15T08:24:28.4798862Z     validateMetadata
2025-04-15T08:24:28.4803855Z       âœ“ successfully validates metadata containing ws federation tags (169 ms)
2025-04-15T08:24:28.4805951Z       âœ“ rejects invalid metadata (186 ms)
2025-04-15T08:24:28.4808046Z       âœ“ rejects malformed XML metadata (178 ms)
2025-04-15T08:24:28.4809280Z       âœ“ rejects metadata missing SingleSignOnService (198 ms)
2025-04-15T08:24:28.4810330Z       âœ“ rejects metadata with invalid X.509 certificate (152 ms)
2025-04-15T08:24:28.4811074Z     validateResponse
2025-04-15T08:24:28.4811940Z       âœ“ successfully validates response (221 ms)
2025-04-15T08:24:28.4812918Z       âœ“ rejects invalid response (148 ms)
2025-04-15T08:24:28.4813789Z       âœ“ rejects expired SAML response (139 ms)
2025-04-15T08:24:28.4814480Z 
2025-04-15T08:24:32.4539775Z PASS src/concurrency/__tests__/concurrency-control.service.test.ts
2025-04-15T08:24:32.4544460Z   ConcurrencyControlService
2025-04-15T08:24:32.4545595Z     constructor
2025-04-15T08:24:32.4547249Z       âœ“ should be enabled if production cap is positive (8 ms)
2025-04-15T08:24:32.4550014Z       âœ“ should be enabled if evaluation cap is positive (1 ms)
2025-04-15T08:24:32.4552940Z       âœ“ should throw if production cap is 0 (2 ms)
2025-04-15T08:24:32.4554125Z       âœ“ should throw if evaluation cap is 0 (1 ms)
2025-04-15T08:24:32.4555340Z       âœ“ should be disabled if both production and evaluation caps are -1 (1 ms)
2025-04-15T08:24:32.4556638Z       âœ“ should be disabled if production cap is lower than -1
2025-04-15T08:24:32.4557728Z       âœ“ should be disabled if evaluation cap is lower than -1
2025-04-15T08:24:32.4558692Z       âœ“ should be disabled on queue mode (1 ms)
2025-04-15T08:24:32.4559378Z     if enabled
2025-04-15T08:24:32.4573869Z       throttle
2025-04-15T08:24:32.4579037Z         âœ“ should do nothing on cli mode (1 ms)
2025-04-15T08:24:32.4584002Z         âœ“ should do nothing on error mode (1 ms)
2025-04-15T08:24:32.4588679Z         âœ“ should do nothing on integrated mode
2025-04-15T08:24:32.4604014Z         âœ“ should do nothing on internal mode
2025-04-15T08:24:32.4612621Z         âœ“ should do nothing on manual mode (1 ms)
2025-04-15T08:24:32.4621176Z         âœ“ should do nothing on retry mode (1 ms)
2025-04-15T08:24:32.4621928Z         âœ“ should enqueue on webhook mode
2025-04-15T08:24:32.4622515Z         âœ“ should enqueue on trigger mode
2025-04-15T08:24:32.4623459Z         âœ“ should enqueue on evaluation mode (1 ms)
2025-04-15T08:24:32.4623931Z       release
2025-04-15T08:24:32.4624417Z         âœ“ should do nothing on cli mode (1 ms)
2025-04-15T08:24:32.4625043Z         âœ“ should do nothing on error mode (1 ms)
2025-04-15T08:24:32.4625715Z         âœ“ should do nothing on integrated mode
2025-04-15T08:24:32.4626413Z         âœ“ should do nothing on internal mode (1 ms)
2025-04-15T08:24:32.4627198Z         âœ“ should do nothing on manual mode (1 ms)
2025-04-15T08:24:32.4627845Z         âœ“ should do nothing on retry mode
2025-04-15T08:24:32.4628411Z         âœ“ should dequeue on webhook mode (1 ms)
2025-04-15T08:24:32.4628915Z         âœ“ should dequeue on trigger mode
2025-04-15T08:24:32.4629792Z         âœ“ should dequeue on evaluation mode (1 ms)
2025-04-15T08:24:32.4631893Z       remove
2025-04-15T08:24:32.4632397Z         âœ“ should do nothing on cli mode
2025-04-15T08:24:32.4633295Z         âœ“ should do nothing on error mode (1 ms)
2025-04-15T08:24:32.4633941Z         âœ“ should do nothing on integrated mode
2025-04-15T08:24:32.4634600Z         âœ“ should do nothing on internal mode (1 ms)
2025-04-15T08:24:32.4635238Z         âœ“ should do nothing on manual mode
2025-04-15T08:24:32.4635881Z         âœ“ should do nothing on retry mode
2025-04-15T08:24:32.4636488Z         âœ“ should remove an execution on webhook mode
2025-04-15T08:24:32.4637234Z         âœ“ should remove an execution on trigger mode (1 ms)
2025-04-15T08:24:32.4638067Z         âœ“ should remove an execution on evaluation mode (1 ms)
2025-04-15T08:24:32.4638576Z       removeAll
2025-04-15T08:24:32.4639217Z         âœ“ should remove all executions from the production queue (2 ms)
2025-04-15T08:24:32.4640107Z         âœ“ should remove all executions from the evaluation queue (1 ms)
2025-04-15T08:24:32.4640681Z       get queue
2025-04-15T08:24:32.4641197Z         âœ“ should choose the production queue
2025-04-15T08:24:32.4641869Z         âœ“ should choose the evaluation queue (1 ms)
2025-04-15T08:24:32.4642354Z     if disabled
2025-04-15T08:24:32.4642651Z       throttle
2025-04-15T08:24:32.4643256Z         âœ“ should do nothing
2025-04-15T08:24:32.4643894Z         âœ“ should do nothing for evaluation executions (1 ms)
2025-04-15T08:24:32.4644376Z       release
2025-04-15T08:24:32.4644753Z         âœ“ should do nothing
2025-04-15T08:24:32.4645350Z         âœ“ should do nothing for evaluation executions (1 ms)
2025-04-15T08:24:32.4645863Z       remove
2025-04-15T08:24:32.4646212Z         âœ“ should do nothing
2025-04-15T08:24:32.4646759Z         âœ“ should do nothing for evaluation executions
2025-04-15T08:24:32.4647207Z     telemetry
2025-04-15T08:24:32.4647491Z       on cloud
2025-04-15T08:24:32.4648140Z         âœ“ for capacity 5, should report temp cloud threshold if reached (1 ms)
2025-04-15T08:24:32.4649086Z         âœ“ for capacity 10, should report temp cloud threshold if reached (1 ms)
2025-04-15T08:24:32.4649999Z         âœ“ for capacity 20, should report temp cloud threshold if reached
2025-04-15T08:24:32.4650902Z         âœ“ for capacity 50, should report temp cloud threshold if reached (1 ms)
2025-04-15T08:24:32.4652253Z         âœ“ for capacity 100, should report temp cloud threshold if reached
2025-04-15T08:24:32.4653414Z         âœ“ for capacity 200, should report temp cloud threshold if reached (1 ms)
2025-04-15T08:24:32.4654391Z         âœ“ for capacity 4, should not report temp cloud threshold if not reached
2025-04-15T08:24:32.4655419Z         âœ“ for capacity 9, should not report temp cloud threshold if not reached (1 ms)
2025-04-15T08:24:32.4657744Z         âœ“ for capacity 19, should not report temp cloud threshold if not reached
2025-04-15T08:24:32.4658868Z         âœ“ for capacity 49, should not report temp cloud threshold if not reached (1 ms)
2025-04-15T08:24:32.4659945Z         âœ“ for capacity 99, should not report temp cloud threshold if not reached
2025-04-15T08:24:32.4660984Z         âœ“ for capacity 199, should not report temp cloud threshold if not reached (1 ms)
2025-04-15T08:24:32.4662005Z         âœ“ for capacity 6, should not report temp cloud threshold if exceeded
2025-04-15T08:24:32.4663262Z         âœ“ for capacity 11, should not report temp cloud threshold if exceeded (1 ms)
2025-04-15T08:24:32.4664266Z         âœ“ for capacity 21, should not report temp cloud threshold if exceeded
2025-04-15T08:24:32.4665132Z         âœ“ for capacity 51, should not report temp cloud threshold if exceeded
2025-04-15T08:24:32.4666037Z         âœ“ for capacity 101, should not report temp cloud threshold if exceeded
2025-04-15T08:24:32.4667023Z         âœ“ for capacity 201, should not report temp cloud threshold if exceeded
2025-04-15T08:24:32.4667474Z 
2025-04-15T08:24:32.4834764Z PASS src/databases/repositories/__tests__/folder.repository.test.ts (6.134 s)
2025-04-15T08:24:32.4837563Z   FolderRepository
2025-04-15T08:24:32.4837980Z     getMany
2025-04-15T08:24:32.4838347Z       filters
2025-04-15T08:24:32.4839134Z         âœ“ should return all folders if not filter is provided (27 ms)
2025-04-15T08:24:32.4839840Z         âœ“ should filter folders by IDs (25 ms)
2025-04-15T08:24:32.4840453Z         âœ“ should filter folders by project ID (25 ms)
2025-04-15T08:24:32.4841216Z         âœ“ should filter folders by name case-insensitively (16 ms)
2025-04-15T08:24:32.4841955Z         âœ“ should filter folders by parent folder ID (25 ms)
2025-04-15T08:24:32.4842617Z         âœ“ should filter folders by a single tag (22 ms)
2025-04-15T08:24:32.4843583Z         âœ“ should filter folders by multiple tags (AND operator) (25 ms)
2025-04-15T08:24:32.4844364Z         âœ“ should apply multiple filters together (22 ms)
2025-04-15T08:24:32.4844826Z       select
2025-04-15T08:24:32.4845429Z         âœ“ should select only id and name when specified (15 ms)
2025-04-15T08:24:32.4846150Z         âœ“ should return id, name and tags when specified (14 ms)
2025-04-15T08:24:32.4846954Z         âœ“ should return id, name and project when specified (12 ms)
2025-04-15T08:24:32.4847787Z         âœ“ should return id, name and parentFolder when specified (15 ms)
2025-04-15T08:24:32.4848651Z         âœ“ should return id, name and workflowCount when specified (17 ms)
2025-04-15T08:24:32.4849531Z         âœ“ should return id, name and subFolderCount when specified (15 ms)
2025-04-15T08:24:32.4850307Z         âœ“ should return timestamps when specified (12 ms)
2025-04-15T08:24:32.4851102Z         âœ“ should return all properties when no select is specified (13 ms)
2025-04-15T08:24:32.4851660Z       pagination
2025-04-15T08:24:32.4852221Z         âœ“ should limit results when take is specified (43 ms)
2025-04-15T08:24:32.4853157Z         âœ“ should skip results when skip is specified (19 ms)
2025-04-15T08:24:32.4853872Z         âœ“ should handle skip and take together (17 ms)
2025-04-15T08:24:32.4854584Z         âœ“ should handle take larger than remaining items (12 ms)
2025-04-15T08:24:32.4855370Z         âœ“ should handle zero take by returning all results (12 ms)
2025-04-15T08:24:32.4855868Z       sorting
2025-04-15T08:24:32.4856401Z         âœ“ should sort by default (updatedAt:desc) (12 ms)
2025-04-15T08:24:32.4857031Z         âœ“ should sort by name:asc (13 ms)
2025-04-15T08:24:32.4857587Z         âœ“ should sort by name:desc (12 ms)
2025-04-15T08:24:32.4859243Z         âœ“ should sort by name:desc when select does not include the name (14 ms)
2025-04-15T08:24:32.4859966Z         âœ“ should sort by createdAt:asc (21 ms)
2025-04-15T08:24:32.4860534Z         âœ“ should sort by createdAt:desc (16 ms)
2025-04-15T08:24:32.4861097Z         âœ“ should sort by updatedAt:asc (14 ms)
2025-04-15T08:24:32.4861901Z         âœ“ should sort by updatedAt:desc (17 ms)
2025-04-15T08:24:32.4862555Z         âœ“ should default to asc if order not specified (10 ms)
2025-04-15T08:24:32.4863066Z 
2025-04-15T08:24:34.4025562Z PASS test/integration/ldap/ldap.api.test.ts (8.577 s)
2025-04-15T08:24:34.4033968Z   âœ“ Member role should not be able to access ldap routes (95 ms)
2025-04-15T08:24:34.4034980Z   âœ“ GET /ldap/config route should retrieve current configuration (28 ms)
2025-04-15T08:24:34.4037890Z   âœ“ GET /ldap/sync should return paginated synchronizations (27 ms)
2025-04-15T08:24:34.4038973Z   PUT /ldap/config
2025-04-15T08:24:34.4039723Z     âœ“ route should validate payload (52 ms)
2025-04-15T08:24:34.4040531Z     âœ“ route should update model (23 ms)
2025-04-15T08:24:34.4042868Z     âœ“ route should fail due to trying to enable LDAP login with SSO as current authentication method (15 ms)
2025-04-15T08:24:34.4044294Z     âœ“ should apply "Convert all LDAP users to email users" strategy when LDAP login disabled (40 ms)
2025-04-15T08:24:34.4045111Z   POST /ldap/test-connection
2025-04-15T08:24:34.4045692Z     âœ“ route should success (21 ms)
2025-04-15T08:24:34.4046226Z     âœ“ route should fail (14 ms)
2025-04-15T08:24:34.4046617Z   POST /ldap/sync
2025-04-15T08:24:34.4046929Z     dry mode
2025-04-15T08:24:34.4048084Z       âœ“ should detect new user but not persist change in model (29 ms)
2025-04-15T08:24:34.4049021Z       âœ“ should detect updated user but not persist change in model (32 ms)
2025-04-15T08:24:34.4050053Z       âœ“ should detect disabled user but not persist change in model (29 ms)
2025-04-15T08:24:34.4050672Z     live mode
2025-04-15T08:24:34.4051350Z       âœ“ should detect new user and persist change in model (42 ms)
2025-04-15T08:24:34.4052252Z       âœ“ should detect updated user and persist change in model (67 ms)
2025-04-15T08:24:34.4053435Z       âœ“ should detect disabled user and persist change in model (46 ms)
2025-04-15T08:24:34.4054623Z       âœ“ should remove user instance access once the user is disabled during synchronization (38 ms)
2025-04-15T08:24:34.4055415Z   POST /login
2025-04-15T08:24:34.4056100Z     âœ“ should allow new LDAP user to login and synchronize data (50 ms)
2025-04-15T08:24:34.4057070Z     âœ“ should allow existing LDAP user to login and synchronize data (191 ms)
2025-04-15T08:24:34.4058242Z     âœ“ should allow instance owner to sign in with email/password when LDAP is enabled (161 ms)
2025-04-15T08:24:34.4059385Z     âœ“ should transform email user into LDAP user when match found (142 ms)
2025-04-15T08:24:34.4060149Z   Instance owner should able to delete LDAP users
2025-04-15T08:24:34.4061473Z     âœ“ don't transfer workflows (22 ms)
2025-04-15T08:24:34.4062169Z     âœ“ transfer workflows and credentials (18 ms)
2025-04-15T08:24:34.4062523Z 
2025-04-15T08:24:39.7377769Z PASS src/services/__tests__/community-packages.service.test.ts (5.099 s)
2025-04-15T08:24:39.7382938Z   CommunityPackagesService
2025-04-15T08:24:39.7385232Z     parseNpmPackageName()
2025-04-15T08:24:39.7387730Z       âœ“ should fail with empty package name (43 ms)
2025-04-15T08:24:39.7403558Z       âœ“ should fail with invalid package prefix name (1 ms)
2025-04-15T08:24:39.7404278Z       âœ“ should parse valid package name (1 ms)
2025-04-15T08:24:39.7404967Z       âœ“ should parse valid package name and version (1 ms)
2025-04-15T08:24:39.7405779Z       âœ“ should parse valid package name, scope and version (1 ms)
2025-04-15T08:24:39.7406314Z     executeCommand()
2025-04-15T08:24:39.7406852Z       âœ“ should call command with valid options (2 ms)
2025-04-15T08:24:39.7407479Z       âœ“ should make sure folder exists (1 ms)
2025-04-15T08:24:39.7408194Z       âœ“ should try to create folder if it does not exist (12 ms)
2025-04-15T08:24:39.7409007Z       âœ“ should throw especial error when package is not found (2 ms)
2025-04-15T08:24:39.7409577Z     crossInformationPackage()
2025-04-15T08:24:39.7410322Z       âœ“ should return same list if availableUpdates is undefined (2 ms)
2025-04-15T08:24:39.7411191Z       âœ“ should correctly match update versions for packages (1 ms)
2025-04-15T08:24:39.7412484Z       âœ“ should correctly match update versions for single package (1 ms)
2025-04-15T08:24:39.7413299Z     matchMissingPackages()
2025-04-15T08:24:39.7413989Z       âœ“ should not match failed packages that do not exist (1 ms)
2025-04-15T08:24:39.7414817Z       âœ“ should match failed packages that should be present
2025-04-15T08:24:39.7415602Z       âœ“ should match failed packages even if version is wrong
2025-04-15T08:24:39.7416158Z     checkNpmPackageStatus()
2025-04-15T08:24:39.7416717Z       âœ“ should call axios.post (1 ms)
2025-04-15T08:24:39.7417311Z       âœ“ should not fail if request fails
2025-04-15T08:24:39.7417917Z       âœ“ should warn if package is banned (1 ms)
2025-04-15T08:24:39.7418430Z     hasPackageLoadedSuccessfully()
2025-04-15T08:24:39.7419120Z       âœ“ should return true when failed package list does not exist
2025-04-15T08:24:39.7420012Z       âœ“ should return true when package is not in the list of missing packages
2025-04-15T08:24:39.7421075Z       âœ“ should return false when package is in the list of missing packages (1 ms)
2025-04-15T08:24:39.7421820Z     removePackageFromMissingList()
2025-04-15T08:24:39.7422456Z       âœ“ should do nothing if key does not exist
2025-04-15T08:24:39.7423322Z       âœ“ should remove only correct package from list
2025-04-15T08:24:39.7424271Z       âœ“ should not remove if package is not in the list (1 ms)
2025-04-15T08:24:39.7424694Z     updateNpmModule
2025-04-15T08:24:39.7425219Z       âœ“ should call `exec` with the correct command and registry (3 ms)
2025-04-15T08:24:39.7425791Z       âœ“ should throw when not licensed (1 ms)
2025-04-15T08:24:39.7426041Z 
2025-04-15T08:24:41.3137499Z PASS test/integration/public-api/executions.test.ts (8.597 s)
2025-04-15T08:24:41.3138600Z   GET /executions/:id
2025-04-15T08:24:41.3139597Z     âœ“ should fail due to missing API Key (43 ms)
2025-04-15T08:24:41.3140455Z     âœ“ should fail due to invalid API Key (14 ms)
2025-04-15T08:24:41.3141470Z     âœ“ owner should be able to get an execution owned by him (201 ms)
2025-04-15T08:24:41.3142936Z     âœ“ owner should be able to read executions of other users (32 ms)
2025-04-15T08:24:41.3144030Z     âœ“ member should be able to fetch his own executions (29 ms)
2025-04-15T08:24:41.3145202Z     âœ“ member should not be able to fetch custom data when includeData is not set (28 ms)
2025-04-15T08:24:41.3146451Z     âœ“ member should be able to fetch custom data when includeData=true (66 ms)
2025-04-15T08:24:41.3147776Z     âœ“ member should not get an execution of another user without the workflow being shared (28 ms)
2025-04-15T08:24:41.3149134Z     âœ“ member should be able to fetch executions of workflows shared with him (36 ms)
2025-04-15T08:24:41.3149991Z   DELETE /executions/:id
2025-04-15T08:24:41.3150724Z     âœ“ should fail due to missing API Key (11 ms)
2025-04-15T08:24:41.3151543Z     âœ“ should fail due to invalid API Key (10 ms)
2025-04-15T08:24:41.3152334Z     âœ“ should delete an execution (58 ms)
2025-04-15T08:24:41.3153105Z   GET /executions
2025-04-15T08:24:41.3153830Z     âœ“ should fail due to missing API Key (11 ms)
2025-04-15T08:24:41.3154795Z     âœ“ should fail due to invalid API Key (9 ms)
2025-04-15T08:24:41.3155744Z     âœ“ should retrieve all successful executions (43 ms)
2025-04-15T08:24:41.3156592Z     âœ“ should paginate two executions (55 ms)
2025-04-15T08:24:41.3157462Z     âœ“ should retrieve all error executions (35 ms)
2025-04-15T08:24:41.3158355Z     âœ“ should return all waiting executions (52 ms)
2025-04-15T08:24:41.3159377Z     âœ“ should retrieve all executions of specific workflow (53 ms)
2025-04-15T08:24:41.3160739Z     âœ“ should return executions filtered by project ID (46 ms)
2025-04-15T08:24:41.3161850Z     âœ“ owner should retrieve all executions regardless of ownership (84 ms)
2025-04-15T08:24:41.3163706Z     âœ“ member should not see executions of workflows not shared with him (74 ms)
2025-04-15T08:24:41.3165018Z     âœ“ member should also see executions of workflows shared with him (78 ms)
2025-04-15T08:24:41.3165858Z 
2025-04-15T08:24:41.3367372Z PASS test/integration/evaluation/test-definitions.api.test.ts (8.642 s)
2025-04-15T08:24:41.3372170Z   GET /evaluation/test-definitions
2025-04-15T08:24:41.3377460Z     âœ“ should retrieve empty test definitions list (83 ms)
2025-04-15T08:24:41.3379851Z     âœ“ should retrieve test definitions list (44 ms)
2025-04-15T08:24:41.3387869Z     âœ“ should retrieve test definitions list with pagination (61 ms)
2025-04-15T08:24:41.3388760Z     âœ“ should retrieve test definitions list for a workflow (56 ms)
2025-04-15T08:24:41.3389790Z     âœ“ should return error if user has no access to the workflowId specified in filter (58 ms)
2025-04-15T08:24:41.3390539Z   GET /evaluation/test-definitions/:id
2025-04-15T08:24:41.3391140Z     âœ“ should retrieve test definition (38 ms)
2025-04-15T08:24:41.3391859Z     âœ“ should return 404 for non-existent test definition (27 ms)
2025-04-15T08:24:41.3392885Z     âœ“ should retrieve test definition with evaluation workflow (40 ms)
2025-04-15T08:24:41.3394025Z     âœ“ should not retrieve test definition if user does not have access to workflow under test (38 ms)
2025-04-15T08:24:41.3394849Z   POST /evaluation/test-definitions
2025-04-15T08:24:41.3395428Z     âœ“ should create test definition (38 ms)
2025-04-15T08:24:41.3396179Z     âœ“ should create test definition with evaluation workflow (36 ms)
2025-04-15T08:24:41.3397432Z     âœ“ should create test definition with all fields (34 ms)
2025-04-15T08:24:41.3398130Z     âœ“ should return error if name is empty (37 ms)
2025-04-15T08:24:41.3398922Z     âœ“ should return error if user has no access to the workflow (31 ms)
2025-04-15T08:24:41.3399885Z     âœ“ should return error if user has no access to the evaluation workflow (36 ms)
2025-04-15T08:24:41.3400587Z   PATCH /evaluation/test-definitions/:id
2025-04-15T08:24:41.3401185Z     âœ“ should update test definition (46 ms)
2025-04-15T08:24:41.3401924Z     âœ“ should return 404 if user has no access to the workflow (33 ms)
2025-04-15T08:24:41.3402961Z     âœ“ should update test definition with evaluation workflow (46 ms)
2025-04-15T08:24:41.3403960Z     âœ“ should return error if user has no access to the evaluation workflow (50 ms)
2025-04-15T08:24:41.3404716Z     âœ“ should disallow workflowId (32 ms)
2025-04-15T08:24:41.3405294Z     âœ“ should update annotationTagId (49 ms)
2025-04-15T08:24:41.3405999Z     âœ“ should return error if annotationTagId is invalid (61 ms)
2025-04-15T08:24:41.3406804Z     âœ“ should update pinned nodes (60 ms)
2025-04-15T08:24:41.3407504Z     âœ“ should return error if pinned nodes are invalid (61 ms)
2025-04-15T08:24:41.3408370Z     âœ“ should return error if pinned nodes are not in the workflow (30 ms)
2025-04-15T08:24:41.3409035Z   DELETE /evaluation/test-definitions/:id
2025-04-15T08:24:41.3409626Z     âœ“ should delete test definition (43 ms)
2025-04-15T08:24:41.3410333Z     âœ“ should return 404 if test definition does not exist (38 ms)
2025-04-15T08:24:41.3411171Z     âœ“ should return 404 if user has no access to the workflow (39 ms)
2025-04-15T08:24:41.3411804Z   POST /evaluation/test-definitions/:id/run
2025-04-15T08:24:41.3412404Z     âœ“ should trigger the test run (34 ms)
2025-04-15T08:24:41.3412846Z 
2025-04-15T08:24:44.9062378Z PASS src/auth/__tests__/auth.service.test.ts
2025-04-15T08:24:44.9083428Z   AuthService
2025-04-15T08:24:44.9085529Z     createJWTHash
2025-04-15T08:24:44.9086728Z       âœ“ should generate unique hashes (6 ms)
2025-04-15T08:24:44.9087487Z     authMiddleware
2025-04-15T08:24:44.9088263Z       âœ“ should 401 if no cookie is set (1 ms)
2025-04-15T08:24:44.9089306Z       âœ“ should 401 and clear the cookie if the JWT is expired (4 ms)
2025-04-15T08:24:44.9090554Z       âœ“ should 401 and clear the cookie if the JWT has been invalidated (2 ms)
2025-04-15T08:24:44.9091674Z       âœ“ should refresh the cookie before it expires (3 ms)
2025-04-15T08:24:44.9092418Z     issueCookie
2025-04-15T08:24:44.9093477Z       âœ“ should issue a cookie with the correct options (2 ms)
2025-04-15T08:24:44.9094474Z       âœ“ should allow changing cookie options (1 ms)
2025-04-15T08:24:44.9095202Z     issueJWT
2025-04-15T08:24:44.9096307Z       when not setting userManagement.jwtSessionDuration
2025-04-15T08:24:44.9097304Z         âœ“ should default to expire in 7 days (2 ms)
2025-04-15T08:24:44.9098737Z       when setting userManagement.jwtSessionDuration
2025-04-15T08:24:44.9099696Z         âœ“ should apply it to tokens (2 ms)
2025-04-15T08:24:44.9100397Z     resolveJwt
2025-04-15T08:24:44.9101132Z       âœ“ should throw on invalid tokens (35 ms)
2025-04-15T08:24:44.9102034Z       âœ“ should throw on expired tokens (3 ms)
2025-04-15T08:24:44.9103156Z       âœ“ should throw on tampered tokens (2 ms)
2025-04-15T08:24:44.9104175Z       âœ“ should throw on hijacked tokens (2 ms)
2025-04-15T08:24:44.9105414Z       âœ“ should throw if no user is found (2 ms)
2025-04-15T08:24:44.9106356Z       âœ“ should throw if the user is disabled (2 ms)
2025-04-15T08:24:44.9107606Z       âœ“ should throw if user password does not match the one on the token (2 ms)
2025-04-15T08:24:44.9109080Z       âœ“ should throw if user email does not match the one on the token (1 ms)
2025-04-15T08:24:44.9110246Z       âœ“ should refresh the cookie before it expires (4 ms)
2025-04-15T08:24:44.9111496Z       âœ“ should refresh the cookie only if less than 1/4th of time is left (3 ms)
2025-04-15T08:24:44.9115166Z       âœ“ should not refresh the cookie if jwtRefreshTimeoutHours is set to -1 (2 ms)
2025-04-15T08:24:44.9116392Z     generatePasswordResetUrl
2025-04-15T08:24:44.9117158Z       âœ“ should generate a valid url (2 ms)
2025-04-15T08:24:44.9117845Z     generatePasswordResetToken
2025-04-15T08:24:44.9118660Z       âœ“ should generate valid password-reset tokens (1 ms)
2025-04-15T08:24:44.9119356Z     resolvePasswordResetToken
2025-04-15T08:24:44.9120331Z       âœ“ should not return a user if the token in invalid (1 ms)
2025-04-15T08:24:44.9121429Z       âœ“ should not return a user if the token in expired (2 ms)
2025-04-15T08:24:44.9122625Z       âœ“ should not return a user if the user does not exist in the DB (2 ms)
2025-04-15T08:24:44.9124037Z       âœ“ should not return a user if the password sha does not match (2 ms)
2025-04-15T08:24:44.9125118Z       âœ“ should not return the user if all checks pass (3 ms)
2025-04-15T08:24:44.9126270Z     invalidateToken
2025-04-15T08:24:44.9126903Z       âœ“ should invalidate the token (1 ms)
2025-04-15T08:24:44.9127349Z 
2025-04-15T08:24:45.5697621Z PASS test/integration/deduplication/deduplication-helper.test.ts (5.518 s)
2025-04-15T08:24:45.5698495Z   Deduplication.DeduplicationHelper
2025-04-15T08:24:45.5699636Z     âœ“ Deduplication (mode: entries): DeduplicationHelper should record and check data correctly (25 ms)
2025-04-15T08:24:45.5701010Z     âœ“ Deduplication (mode: entries): DeduplicationHelper different contexts should not interfere with each other (15 ms)
2025-04-15T08:24:45.5702177Z     âœ“ Deduplication (mode: entries): DeduplicationHelper check maxEntries (11 ms)
2025-04-15T08:24:45.5703230Z     âœ“ removeProcessed should throw error for latest modes (28 ms)
2025-04-15T08:24:45.5704302Z     âœ“ clearAllProcessedItems should delete all processed items for workflow scope (5 ms)
2025-04-15T08:24:45.5706098Z     âœ“ clearAllProcessedItems should delete all processed items for node scope (4 ms)
2025-04-15T08:24:45.5707443Z     âœ“ clearAllProcessedItems should not clear workflow processed items when clearing node scope (7 ms)
2025-04-15T08:24:45.5708883Z     âœ“ clearAllProcessedItems should not clear node processed items when clearing workflow scope (8 ms)
2025-04-15T08:24:45.5710232Z     âœ“ getProcessedDataCount should return correct count for different modes (4 ms)
2025-04-15T08:24:45.5711475Z     Deduplication (mode: latestIncrementalKey): DeduplicationHelper should record and check data correctly
2025-04-15T08:24:45.5712397Z       âœ“ dates (35 ms)
2025-04-15T08:24:45.5712974Z       âœ“ numbers (8 ms)
2025-04-15T08:24:45.5713199Z 
2025-04-15T08:24:49.3511464Z PASS test/integration/controllers/invitation/invitation.controller.integration.test.ts (7.775 s)
2025-04-15T08:24:49.3524978Z   InvitationController
2025-04-15T08:24:49.3528296Z     POST /invitations/:id/accept
2025-04-15T08:24:49.3529183Z       âœ“ should fill out a member shell (208 ms)
2025-04-15T08:24:49.3530170Z       âœ“ should fill out an admin shell (110 ms)
2025-04-15T08:24:49.3531383Z       âœ“ should fail with invalid payloads (33 ms)
2025-04-15T08:24:49.3533954Z       âœ“ should fail with already accepted invite (124 ms)
2025-04-15T08:24:49.3535503Z     POST /invitations
2025-04-15T08:24:49.3536390Z       âœ“ should fail with invalid payloads (55 ms)
2025-04-15T08:24:49.3537303Z       âœ“ should return 200 on empty payload (13 ms)
2025-04-15T08:24:49.3539754Z       âœ“ should return 200 if emailing is not set up (17 ms)
2025-04-15T08:24:49.3540806Z       âœ“ should create member shell (16 ms)
2025-04-15T08:24:49.3543258Z       âœ“ should create personal project for shell account (23 ms)
2025-04-15T08:24:49.3545199Z       âœ“ should create admin shell when advanced permissions is licensed (16 ms)
2025-04-15T08:24:49.3546375Z       âœ“ should reinvite member when sharing is licensed (29 ms)
2025-04-15T08:24:49.3548845Z       âœ“ should reinvite admin when advanced permissions is licensed (27 ms)
2025-04-15T08:24:49.3550370Z       âœ“ should return 403 on creating admin shell when advanced permissions is unlicensed (9 ms)
2025-04-15T08:24:49.3551925Z       âœ“ should email invites and create user shells, without inviting existing users (35 ms)
2025-04-15T08:24:49.3553629Z       âœ“ should return 200 and surface error when invite method throws error (23 ms)
2025-04-15T08:24:49.3556486Z 
2025-04-15T08:24:50.6453514Z PASS src/controllers/oauth/__tests__/oauth2-credential.controller.test.ts (5.479 s)
2025-04-15T08:24:50.6454290Z   OAuth2CredentialController
2025-04-15T08:24:50.6454636Z     getAuthUri
2025-04-15T08:24:50.6455503Z       âœ“ should throw a BadRequestError when credentialId is missing in the query (41 ms)
2025-04-15T08:24:50.6456505Z       âœ“ should throw a NotFoundError when no matching credential is found for the user (2 ms)
2025-04-15T08:24:50.6457253Z       âœ“ should return a valid auth URI (9 ms)
2025-04-15T08:24:50.6457670Z     handleCallback
2025-04-15T08:24:50.6458309Z       âœ“ should render the error page when required query params are missing (2 ms)
2025-04-15T08:24:50.6459187Z       âœ“ should render the error page when `state` query param is invalid (1 ms)
2025-04-15T08:24:50.6460018Z       âœ“ should render the error page when credential is not found in DB (1 ms)
2025-04-15T08:24:50.6461063Z       âœ“ should render the error page when csrfSecret on the saved credential does not match the state (2 ms)
2025-04-15T08:24:50.6462026Z       âœ“ should render the error page when state is older than 5 minutes (2 ms)
2025-04-15T08:24:50.6462965Z       âœ“ should render the error page when code exchange fails (92 ms)
2025-04-15T08:24:50.6463768Z       âœ“ should exchange the code for a valid token, and save it to DB (26 ms)
2025-04-15T08:24:50.6464531Z       âœ“ merges oauthTokenData if it already exists (25 ms)
2025-04-15T08:24:50.6465167Z       âœ“ overwrites oauthTokenData if it is a string (25 ms)
2025-04-15T08:24:50.6465493Z 
2025-04-15T08:24:52.2326873Z PASS src/__tests__/load-nodes-and-credentials.test.ts
2025-04-15T08:24:52.2327585Z   LoadNodesAndCredentials
2025-04-15T08:24:52.2327983Z     resolveIcon
2025-04-15T08:24:52.2334010Z       âœ“ should return undefined if the loader for the package is not found (9 ms)
2025-04-15T08:24:52.2335494Z       âœ“ should return undefined if the resolved file path is outside the loader directory (4 ms)
2025-04-15T08:24:52.2336758Z       âœ“ should return the file path if the file is within the loader directory (1 ms)
2025-04-15T08:24:52.2337875Z       âœ“ should return undefined if the URL is outside the package directory (1 ms)
2025-04-15T08:24:52.2338529Z     convertNodeToAiTool
2025-04-15T08:24:52.2339069Z       âœ“ should modify the name and displayName correctly
2025-04-15T08:24:52.2339699Z       âœ“ should update inputs and outputs (2 ms)
2025-04-15T08:24:52.2340274Z       âœ“ should remove the usableAsTool property
2025-04-15T08:24:52.2340938Z       âœ“ should add toolDescription property if it doesn't exist (1 ms)
2025-04-15T08:24:52.2341614Z       âœ“ should set codex categories correctly (1 ms)
2025-04-15T08:24:52.2342307Z       âœ“ should preserve existing properties
2025-04-15T08:24:52.2343297Z       âœ“ should handle nodes with resource property (1 ms)
2025-04-15T08:24:52.2344091Z       âœ“ should handle nodes with operation property (1 ms)
2025-04-15T08:24:52.2345192Z       âœ“ should handle nodes with both resource and operation properties (1 ms)
2025-04-15T08:24:52.2346366Z       âœ“ should handle nodes with empty properties (2 ms)
2025-04-15T08:24:52.2347183Z       âœ“ should handle nodes with existing codex property (1 ms)
2025-04-15T08:24:52.2348119Z       âœ“ should handle nodes with existing codex with tool subcategory overwrite
2025-04-15T08:24:52.2348995Z       âœ“ should handle nodes with very long names (1 ms)
2025-04-15T08:24:52.2349846Z       âœ“ should handle nodes with special characters in name and displayName
2025-04-15T08:24:52.2350435Z     resolveSchema
2025-04-15T08:24:52.2351035Z       âœ“ should return undefined if the node is not known (1 ms)
2025-04-15T08:24:52.2351888Z       âœ“ should return the correct path if the node is known (1 ms)
2025-04-15T08:24:52.2353057Z       âœ“ should return the correct path if there is no resource or operation (1 ms)
2025-04-15T08:24:52.2353730Z     createAiTools
2025-04-15T08:24:52.2354519Z       âœ“ should create AI tools for nodes marked as usableAsTool (2 ms)
2025-04-15T08:24:52.2355334Z       âœ“ should duplicate supportedNodes for AI tools (1 ms)
2025-04-15T08:24:52.2356178Z       âœ“ should not modify nodes without usableAsTool property
2025-04-15T08:24:52.2357185Z       âœ“ should handle nodes with usableAsTool as an object with replacements (1 ms)
2025-04-15T08:24:52.2357730Z 
2025-04-15T08:24:53.1470868Z PASS test/integration/variables.test.ts (7.403 s)
2025-04-15T08:24:53.1471509Z   GET /variables
2025-04-15T08:24:53.1472883Z     âœ“ should return an empty array if there is nothing in the cache (58 ms)
2025-04-15T08:24:53.1473982Z     âœ“ should return all variables for an owner (20 ms)
2025-04-15T08:24:53.1474890Z     âœ“ should return all variables for a member (18 ms)
2025-04-15T08:24:53.1475490Z     state:empty
2025-04-15T08:24:53.1475994Z       âœ“ only return empty variables (13 ms)
2025-04-15T08:24:53.1476468Z   GET /variables/:id
2025-04-15T08:24:53.1477595Z     âœ“ should return a single variable for an owner (15 ms)
2025-04-15T08:24:53.1478422Z     âœ“ should return a single variable for a member (12 ms)
2025-04-15T08:24:53.1478947Z   POST /variables
2025-04-15T08:24:53.1479606Z     âœ“ should create a new variable and return it for an owner (10 ms)
2025-04-15T08:24:53.1480554Z     âœ“ should not create a new variable and return it for a member (8 ms)
2025-04-15T08:24:53.1481653Z     âœ“ should not create a new variable and return it if the instance doesn't have a license (6 ms)
2025-04-15T08:24:53.1483130Z     âœ“ should fail to create a new variable and if one with the same key exists (77 ms)
2025-04-15T08:24:53.1484112Z     âœ“ should not fail if variable limit not reached (16 ms)
2025-04-15T08:24:53.1485395Z     âœ“ should fail if variable limit reached (36 ms)
2025-04-15T08:24:53.1486049Z     âœ“ should fail if key too long (9 ms)
2025-04-15T08:24:53.1486655Z     âœ“ should fail if value too long (7 ms)
2025-04-15T08:24:53.1487433Z     âœ“ should fail if key contain's prohibited characters (8 ms)
2025-04-15T08:24:53.1519240Z   PATCH /variables/:id
2025-04-15T08:24:53.1520015Z     âœ“ should modify existing variable if use is an owner (15 ms)
2025-04-15T08:24:53.1520914Z     âœ“ should modify existing variable if use is an owner (12 ms)
2025-04-15T08:24:53.1521823Z     âœ“ should not modify existing variable if use is a member (11 ms)
2025-04-15T08:24:53.1522986Z     âœ“ should not modify existing variable if one with the same key exists (16 ms)
2025-04-15T08:24:53.1523665Z   DELETE /variables/:id
2025-04-15T08:24:53.1524344Z     âœ“ should delete a single variable for an owner (15 ms)
2025-04-15T08:24:53.1525170Z     âœ“ should not delete a single variable for a member (14 ms)
2025-04-15T08:24:53.1525537Z 
2025-04-15T08:24:56.8512349Z PASS src/workflows/__tests__/workflow-execution.service.test.ts
2025-04-15T08:24:56.8534692Z   WorkflowExecutionService
2025-04-15T08:24:56.8536200Z     runWorkflow()
2025-04-15T08:24:56.8549432Z       âœ“ should call `WorkflowRunner.run()` (5 ms)
2025-04-15T08:24:56.8550574Z     executeManually()
2025-04-15T08:24:56.8552128Z       âœ“ should call `WorkflowRunner.run()` with correct parameters with default partial execution logic (2 ms)
2025-04-15T08:24:56.8553377Z       âœ“ removes runData if the destination node is a trigger (8 ms)
2025-04-15T08:24:56.8554292Z       âœ“ should call WorkflowRunner.run() with pinned trigger with type trigger (1 ms)
2025-04-15T08:24:56.8555257Z       âœ“ should call WorkflowRunner.run() with pinned trigger with type webhook (2 ms)
2025-04-15T08:24:56.8555979Z       âœ“ should start from pinned trigger (1 ms)
2025-04-15T08:24:56.8556671Z       âœ“ should ignore pinned trigger and start from unexecuted trigger (1 ms)
2025-04-15T08:24:56.8557250Z     selectPinnedActivatorStarter()
2025-04-15T08:24:56.8557754Z       âœ“ should return `null` if no pindata
2025-04-15T08:24:56.8558291Z       âœ“ should return `null` if no starter nodes (1 ms)
2025-04-15T08:24:56.8558848Z       âœ“ should select webhook node if only choice
2025-04-15T08:24:56.8559348Z       âœ“ should return `null` if no choice
2025-04-15T08:24:56.8559905Z       âœ“ should return ignore Respond to Webhook (1 ms)
2025-04-15T08:24:56.8560526Z       âœ“ should select execute workflow trigger if only choice
2025-04-15T08:24:56.8561231Z       âœ“ should favor webhook node over execute workflow trigger (1 ms)
2025-04-15T08:24:56.8561949Z       âœ“ should favor first webhook node over second webhook node
2025-04-15T08:24:56.8562467Z       offloading manual executions to workers
2025-04-15T08:24:56.8563420Z         âœ“ when receiving no `runData`, should set `runData` to undefined in `executionData`
2025-04-15T08:24:56.8563900Z 
2025-04-15T08:24:58.2471538Z PASS src/controllers/__tests__/me.controller.test.ts
2025-04-15T08:24:58.2472176Z   MeController
2025-04-15T08:24:58.2472516Z     updateCurrentUser
2025-04-15T08:24:58.2473700Z       âœ“ should update the user in the DB, and issue a new cookie (16 ms)
2025-04-15T08:24:58.2474731Z       âœ“ should throw BadRequestError if beforeUpdate hook throws BadRequestError (35 ms)
2025-04-15T08:24:58.2475413Z       when mfa is enabled
2025-04-15T08:24:58.2476036Z         âœ“ should throw BadRequestError if mfa code is missing (2 ms)
2025-04-15T08:24:58.2476926Z         âœ“ should throw InvalidMfaCodeError if mfa code is invalid (1 ms)
2025-04-15T08:24:58.2477732Z         âœ“ should update the user's email if mfa code is valid (2 ms)
2025-04-15T08:24:58.2478237Z     updatePassword
2025-04-15T08:24:58.2478828Z       âœ“ should throw if the user does not have a password set (2 ms)
2025-04-15T08:24:58.2479729Z       âœ“ should throw if currentPassword does not match the user's password (113 ms)
2025-04-15T08:24:58.2480684Z       âœ“ should update the password in the DB, and issue a new cookie (188 ms)
2025-04-15T08:24:58.2481863Z       should throw if newPassword is not valid
2025-04-15T08:24:58.2482368Z         âœ“ pass (92 ms)
2025-04-15T08:24:58.2482917Z         âœ“ password (94 ms)
2025-04-15T08:24:58.2483355Z         âœ“ password1 (96 ms)
2025-04-15T08:24:58.2483698Z       mfa enabled
2025-04-15T08:24:58.2484272Z         âœ“ should throw BadRequestError if mfa code is missing (133 ms)
2025-04-15T08:24:58.2485170Z         âœ“ should throw InvalidMfaCodeError if invalid mfa code is given (101 ms)
2025-04-15T08:24:58.2485950Z         âœ“ should succeed when mfa code is correct (179 ms)
2025-04-15T08:24:58.2486415Z     storeSurveyAnswers
2025-04-15T08:24:58.2487095Z       âœ“ should throw BadRequestError if answers are missing in the payload (1 ms)
2025-04-15T08:24:58.2487924Z       âœ“ should not flag XSS attempt for `<` sign in company size (9 ms)
2025-04-15T08:24:58.2488876Z       âœ“ should throw BadRequestError on XSS attempt for an array field automationGoalDevops (3 ms)
2025-04-15T08:24:58.2490021Z       âœ“ should throw BadRequestError on XSS attempt for an array field companyIndustryExtended (2 ms)
2025-04-15T08:24:58.2491253Z       âœ“ should throw BadRequestError on XSS attempt for an array field otherCompanyIndustryExtended (1 ms)
2025-04-15T08:24:58.2492398Z       âœ“ should throw BadRequestError on XSS attempt for an array field automationGoalSm (1 ms)
2025-04-15T08:24:58.2493880Z       âœ“ should throw BadRequestError on XSS attempt for an array field usageModes (1 ms)
2025-04-15T08:24:58.2494993Z       âœ“ should throw BadRequestError on XSS attempt for a string field automationGoalDevopsOther (1 ms)
2025-04-15T08:24:58.2496114Z       âœ“ should throw BadRequestError on XSS attempt for a string field companySize (1 ms)
2025-04-15T08:24:58.2497175Z       âœ“ should throw BadRequestError on XSS attempt for a string field companyType (2 ms)
2025-04-15T08:24:58.2498263Z       âœ“ should throw BadRequestError on XSS attempt for a string field automationGoalSmOther (1 ms)
2025-04-15T08:24:58.2499325Z       âœ“ should throw BadRequestError on XSS attempt for a string field roleOther (1 ms)
2025-04-15T08:24:58.2500409Z       âœ“ should throw BadRequestError on XSS attempt for a string field reportedSource (1 ms)
2025-04-15T08:24:58.2501529Z       âœ“ should throw BadRequestError on XSS attempt for a string field reportedSourceOther (10 ms)
2025-04-15T08:24:58.2502101Z 
2025-04-15T08:24:59.1104542Z PASS test/integration/mfa/mfa.api.test.ts (8.229 s)
2025-04-15T08:24:59.1105220Z   Enable MFA setup
2025-04-15T08:24:59.1105557Z     Step one
2025-04-15T08:24:59.1106394Z       âœ“ GET /qr should fail due to unauthenticated user (65 ms)
2025-04-15T08:24:59.1107396Z       âœ“ GET /qr should reuse secret and recovery codes until setup is complete (85 ms)
2025-04-15T08:24:59.1108432Z       âœ“ GET /qr should return qr, secret and recovery codes (27 ms)
2025-04-15T08:24:59.1108976Z     Step two
2025-04-15T08:24:59.1109608Z       âœ“ POST /verify should fail due to unauthenticated user (22 ms)
2025-04-15T08:24:59.1110430Z       âœ“ POST /verify should fail due to invalid MFA code (39 ms)
2025-04-15T08:24:59.1111328Z       âœ“ POST /verify should fail due to missing mfaCode parameter (27 ms)
2025-04-15T08:24:59.1112118Z       âœ“ POST /verify should validate MFA code (33 ms)
2025-04-15T08:24:59.1112592Z     Step three
2025-04-15T08:24:59.1113433Z       âœ“ POST /enable should fail due to unauthenticated user (10 ms)
2025-04-15T08:24:59.1114324Z       âœ“ POST /verify should fail due to missing mfaCode parameter (16 ms)
2025-04-15T08:24:59.1115135Z       âœ“ POST /enable should fail due to invalid MFA code (36 ms)
2025-04-15T08:24:59.1116027Z       âœ“ POST /enable should fail due to empty secret and recovery codes (14 ms)
2025-04-15T08:24:59.1116855Z       âœ“ POST /enable should enable MFA in account (43 ms)
2025-04-15T08:24:59.1117707Z       âœ“ POST /enable should not enable MFA if pre check fails (40 ms)
2025-04-15T08:24:59.1118254Z   Disable MFA setup
2025-04-15T08:24:59.1118841Z     âœ“ POST /disable should disable login with MFA (42 ms)
2025-04-15T08:24:59.1119705Z     âœ“ POST /disable should fail if invalid MFA recovery code is given (26 ms)
2025-04-15T08:24:59.1121162Z     âœ“ POST /disable should fail if invalid MFA code is given (28 ms)
2025-04-15T08:24:59.1122144Z     âœ“ POST /disable should fail if neither MFA code nor recovery code is sent (30 ms)
2025-04-15T08:24:59.1123084Z   Change password with MFA enabled
2025-04-15T08:24:59.1123931Z     âœ“ POST /change-password should fail due to missing MFA code (26 ms)
2025-04-15T08:24:59.1124916Z     âœ“ POST /change-password should fail due to invalid MFA code (25 ms)
2025-04-15T08:24:59.1125782Z     âœ“ POST /change-password should update password (227 ms)
2025-04-15T08:24:59.1126332Z   MFA before enable checks
2025-04-15T08:24:59.1127136Z     âœ“ POST /can-enable should throw error if mfa.beforeSetup returns error (11 ms)
2025-04-15T08:24:59.1128183Z     âœ“ POST /can-enable should not throw error if mfa.beforeSetup does not exist (13 ms)
2025-04-15T08:24:59.1128811Z   Login
2025-04-15T08:24:59.1129500Z     âœ“ POST /login with email/password should succeed when mfa is disabled (21 ms)
2025-04-15T08:24:59.1130681Z     âœ“ GET /login should not include mfaSecret and mfaRecoveryCodes property in response (11 ms)
2025-04-15T08:24:59.1131761Z     âœ“ POST /login with email/password should fail when mfa is enabled (24 ms)
2025-04-15T08:24:59.1132376Z     Login with MFA token
2025-04-15T08:24:59.1133678Z       âœ“ POST /login should fail due to invalid MFA token (23 ms)
2025-04-15T08:24:59.1134475Z       âœ“ POST /login should fail due two MFA step needed (21 ms)
2025-04-15T08:24:59.1135218Z       âœ“ POST /login should succeed with MFA token (23 ms)
2025-04-15T08:24:59.1135736Z     Login with recovery code
2025-04-15T08:24:59.1136504Z       âœ“ POST /login should fail due to invalid MFA recovery code (26 ms)
2025-04-15T08:24:59.1137358Z       âœ“ POST /login should succeed with MFA recovery code (31 ms)
2025-04-15T08:24:59.1137780Z 
2025-04-15T08:25:00.1141464Z PASS src/__tests__/manual-execution.service.test.ts
2025-04-15T08:25:00.1146469Z   ManualExecutionService
2025-04-15T08:25:00.1150956Z     getExecutionStartNode
2025-04-15T08:25:00.1155852Z       âœ“ Should return undefined (5 ms)
2025-04-15T08:25:00.1160504Z       âœ“ Should return startNode (1 ms)
2025-04-15T08:25:00.1165458Z       âœ“ Should return triggerToStartFrom trigger node
2025-04-15T08:25:00.1193390Z     runManually
2025-04-15T08:25:00.1194834Z       âœ“ should correctly process triggerToStartFrom data when data.triggerToStartFrom.data is present (5 ms)
2025-04-15T08:25:00.1196483Z       âœ“ should correctly include destinationNode in executionData when provided (1 ms)
2025-04-15T08:25:00.1197958Z       âœ“ should call workflowExecute.run for full execution when no runData or startNodes (1 ms)
2025-04-15T08:25:00.1199307Z       âœ“ should use execution start node when available for full execution (2 ms)
2025-04-15T08:25:00.1200833Z       âœ“ should handle partial execution with provided runData, startNodes and no destinationNode (1 ms)
2025-04-15T08:25:00.1202251Z       âœ“ should handle partial execution with partialExecutionVersion=2 (2 ms)
2025-04-15T08:25:00.1203706Z       âœ“ should validate nodes exist before execution (1 ms)
2025-04-15T08:25:00.1204784Z       âœ“ should handle pinData correctly when provided (2 ms)
2025-04-15T08:25:00.1205401Z 
2025-04-15T08:25:04.0654304Z PASS src/webhooks/__tests__/webhook-helpers.test.ts
2025-04-15T08:25:04.0690661Z   autoDetectResponseMode
2025-04-15T08:25:04.0709011Z     âœ“ should return undefined if start node is WAIT_NODE_TYPE with resume not equal to form (7 ms)
2025-04-15T08:25:04.0710567Z     âœ“ should return responseNode when start node is FORM_NODE_TYPE and method is POST (2 ms)
2025-04-15T08:25:04.0711905Z     âœ“ should return undefined when start node is FORM_NODE_TYPE with no other form child nodes (1 ms)
2025-04-15T08:25:04.0713468Z     âœ“ should return undefined for non-matching node type and method (1 ms)
2025-04-15T08:25:04.0714297Z   handleFormRedirectionCase
2025-04-15T08:25:04.0715305Z     âœ“ should return data unchanged if start node is WAIT_NODE_TYPE with resume not equal to form (1 ms)
2025-04-15T08:25:04.0717168Z     âœ“ should modify data if start node type matches and responseCode is a redirect (1 ms)
2025-04-15T08:25:04.0718372Z     âœ“ should not modify data if location header is missing (1 ms)
2025-04-15T08:25:04.0719047Z   getResponseOnReceived
2025-04-15T08:25:04.0731320Z     âœ“ should return response with no data when responseData is "noData" (1 ms)
2025-04-15T08:25:04.0733541Z     âœ“ should return response with responseData when it is defined (4 ms)
2025-04-15T08:25:04.0735872Z     âœ“ should return response with webhookResponse when responseData is falsy but webhookResponse exists (1 ms)
2025-04-15T08:25:04.0738226Z     âœ“ should return default response message when responseData and webhookResponse are falsy (1 ms)
2025-04-15T08:25:04.0740056Z   setupResponseNodePromise
2025-04-15T08:25:04.0742245Z     âœ“ should handle regular response object (12 ms)
2025-04-15T08:25:04.0744383Z     âœ“ should handle binary data with ID (6 ms)
2025-04-15T08:25:04.0745978Z     âœ“ should handle buffer response (2 ms)
2025-04-15T08:25:04.0747623Z     âœ“ should handle errors properly (8 ms)
2025-04-15T08:25:04.0749071Z   prepareExecutionData
2025-04-15T08:25:04.0750770Z     âœ“ should create new execution data when not provided (8 ms)
2025-04-15T08:25:04.0752895Z     âœ“ should update existing runExecutionData when executionId is defined (1 ms)
2025-04-15T08:25:04.0755319Z     âœ“ should set destination node when provided (1 ms)
2025-04-15T08:25:04.0757031Z     âœ“ should update execution data with execution data merge
2025-04-15T08:25:04.0758757Z     âœ“ should set pinData when execution mode is manual (7 ms)
2025-04-15T08:25:04.0760676Z     âœ“ should not set pinData when execution mode is not manual or evaluation (1 ms)
2025-04-15T08:25:04.0762153Z 
2025-04-15T08:25:06.4904440Z PASS test/integration/me.api.test.ts (8.008 s)
2025-04-15T08:25:06.4905060Z   Owner shell
2025-04-15T08:25:06.4905881Z     âœ“ PATCH /me should succeed with valid inputs (110 ms)
2025-04-15T08:25:06.4906674Z     âœ“ PATCH /me should fail with invalid inputs (110 ms)
2025-04-15T08:25:06.4907465Z     âœ“ PATCH /me/password should fail for shell (151 ms)
2025-04-15T08:25:06.4908289Z     âœ“ POST /me/survey should succeed with valid inputs (47 ms)
2025-04-15T08:25:06.4908832Z   Member
2025-04-15T08:25:06.4909408Z     âœ“ PATCH /me should succeed with valid inputs (61 ms)
2025-04-15T08:25:06.4910186Z     âœ“ PATCH /me should fail with invalid inputs (104 ms)
2025-04-15T08:25:06.4910981Z     âœ“ PATCH /me/password should succeed with valid inputs (163 ms)
2025-04-15T08:25:06.4911830Z     âœ“ PATCH /me/password should fail with invalid inputs (92 ms)
2025-04-15T08:25:06.4913037Z     âœ“ POST /me/survey should succeed with valid inputs (56 ms)
2025-04-15T08:25:06.4913667Z   Owner
2025-04-15T08:25:06.4914279Z     âœ“ PATCH /me should succeed with valid inputs (38 ms)
2025-04-15T08:25:06.4914687Z 
2025-04-15T08:25:08.4562198Z (node:2876) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 uncaughtException listeners added to [process]. MaxListeners is 10. Use emitter.setMaxListeners() to increase limit
2025-04-15T08:25:08.4564887Z (Use `node --trace-warnings ...` to show where the warning was created)
2025-04-15T08:25:08.6653101Z PASS test/integration/commands/ldap/reset.test.ts (8.312 s)
2025-04-15T08:25:08.6654745Z   âœ“ fails if neither `--userId` nor `--projectId` nor `--deleteWorkflowsAndCredentials` is passed (49 ms)
2025-04-15T08:25:08.6656337Z   âœ“ fails if more than one of `--userId`, `--projectId`, `--deleteWorkflowsAndCredentials` are passed (6 ms)
2025-04-15T08:25:08.6657743Z   âœ“ fails if more than one of `--userId`, `--projectId`, `--deleteWorkflowsAndCredentials` are passed (4 ms)
2025-04-15T08:25:08.6659148Z   âœ“ fails if more than one of `--userId`, `--projectId`, `--deleteWorkflowsAndCredentials` are passed (5 ms)
2025-04-15T08:25:08.6660541Z   âœ“ fails if more than one of `--userId`, `--projectId`, `--deleteWorkflowsAndCredentials` are passed (4 ms)
2025-04-15T08:25:08.6661488Z   --deleteWorkflowsAndCredentials
2025-04-15T08:25:08.6662563Z     âœ“ deletes personal projects, workflows and credentials owned by LDAP managed users (136 ms)
2025-04-15T08:25:08.6664171Z     âœ“ deletes the LDAP sync history (19 ms)
2025-04-15T08:25:08.6664859Z     âœ“ resets LDAP settings (20 ms)
2025-04-15T08:25:08.6665447Z   --userId
2025-04-15T08:25:08.6666083Z     âœ“ fails if the user does not exist (9 ms)
2025-04-15T08:25:08.6666956Z     âœ“ fails if the user to migrate to is also an LDAP user (17 ms)
2025-04-15T08:25:08.6667992Z     âœ“ transfers all workflows and credentials to the user's personal project (89 ms)
2025-04-15T08:25:08.6668724Z   --projectId
2025-04-15T08:25:08.6669292Z     âœ“ fails if the project does not exist (7 ms)
2025-04-15T08:25:08.6670085Z     âœ“ fails if the user to migrate to is also an LDAP user (14 ms)
2025-04-15T08:25:08.6671022Z     âœ“ transfers all workflows and credentials to a personal project (72 ms)
2025-04-15T08:25:08.6671996Z     âœ“ transfers all workflows and credentials to a team project (82 ms)
2025-04-15T08:25:08.6672598Z 
2025-04-15T08:25:11.7258372Z PASS src/webhooks/__tests__/webhook.service.test.ts
2025-04-15T08:25:11.7261448Z   WebhookService
2025-04-15T08:25:11.7285833Z     findWebhook() - static case [cache enabled]
2025-04-15T08:25:11.7289931Z       âœ“ should return the webhook if found (6 ms)
2025-04-15T08:25:11.7291606Z       âœ“ should return null if not found (1 ms)
2025-04-15T08:25:11.7293736Z     findWebhook() - dynamic case [cache enabled]
2025-04-15T08:25:11.7295429Z       âœ“ should return the webhook if found (2 ms)
2025-04-15T08:25:11.7297233Z       âœ“ should handle subset dynamic path case (1 ms)
2025-04-15T08:25:11.7298970Z       âœ“ should handle single-segment dynamic path case (1 ms)
2025-04-15T08:25:11.7315340Z       âœ“ should return null if not found (1 ms)
2025-04-15T08:25:11.7316421Z     findWebhook() - static case [cache disabled]
2025-04-15T08:25:11.7317137Z       âœ“ should return the webhook if found (1 ms)
2025-04-15T08:25:11.7317785Z       âœ“ should return null if not found (1 ms)
2025-04-15T08:25:11.7318342Z     findWebhook() - dynamic case [cache disabled]
2025-04-15T08:25:11.7319016Z       âœ“ should return the webhook if found (1 ms)
2025-04-15T08:25:11.7319673Z       âœ“ should handle subset dynamic path case (1 ms)
2025-04-15T08:25:11.7320434Z       âœ“ should handle single-segment dynamic path case (1 ms)
2025-04-15T08:25:11.7321068Z       âœ“ should return null if not found (1 ms)
2025-04-15T08:25:11.7321494Z     getWebhookMethods()
2025-04-15T08:25:11.7322620Z       âœ“ should return all methods for webhook (1 ms)
2025-04-15T08:25:11.7323448Z       âœ“ should return empty array if no webhooks found (1 ms)
2025-04-15T08:25:11.7323947Z     deleteWorkflowWebhooks()
2025-04-15T08:25:11.7324525Z       âœ“ should delete all webhooks of the workflow (1 ms)
2025-04-15T08:25:11.7325207Z       âœ“ should not delete any webhooks if none found (1 ms)
2025-04-15T08:25:11.7325691Z     createWebhook()
2025-04-15T08:25:11.7326623Z       âœ“ should store webhook in DB (1 ms)
2025-04-15T08:25:11.7327696Z     getNodeWebhooks()
2025-04-15T08:25:11.7328276Z       âœ“ should return empty array if node is disabled (1 ms)
2025-04-15T08:25:11.7330979Z       âœ“ should return webhooks for node with webhook definitions (2 ms)
2025-04-15T08:25:11.7331607Z     createWebhookIfNotExists()
2025-04-15T08:25:11.7332199Z       âœ“ should create webhook if it does not exist (2 ms)
2025-04-15T08:25:11.7333094Z       âœ“ should not create webhook if it already exists (1 ms)
2025-04-15T08:25:11.7333855Z       âœ“ should handle case when webhook methods are not defined
2025-04-15T08:25:11.7334357Z     deleteWebhook()
2025-04-15T08:25:11.7335588Z       âœ“ should call runWebhookMethod with delete (1 ms)
2025-04-15T08:25:11.7336058Z     runWebhook()
2025-04-15T08:25:11.7336605Z       âœ“ should throw error if node does not have webhooks (25 ms)
2025-04-15T08:25:11.7337311Z       âœ“ should execute webhook and return response data (2 ms)
2025-04-15T08:25:11.7337655Z 
2025-04-15T08:25:11.7894130Z PASS test/integration/auth.api.test.ts (7.51 s)
2025-04-15T08:25:11.7895190Z   POST /login
2025-04-15T08:25:11.7896102Z     âœ“ should log user in (84 ms)
2025-04-15T08:25:11.7898929Z     âœ“ should log user with MFA enabled (42 ms)
2025-04-15T08:25:11.7900110Z     âœ“ should throw AuthError for non-owner if not within users limit quota (64 ms)
2025-04-15T08:25:11.7901670Z     âœ“ should not throw AuthError for owner if not within users limit quota (29 ms)
2025-04-15T08:25:11.7903764Z     âœ“ should fail with invalid email in the payload is the current authentication method is "email" (17 ms)
2025-04-15T08:25:11.7904817Z   GET /login
2025-04-15T08:25:11.7905556Z     âœ“ should return 401 Unauthorized if no cookie (9 ms)
2025-04-15T08:25:11.7906705Z     âœ“ should return 401 Unauthorized if invalid cookie (6 ms)
2025-04-15T08:25:11.7908462Z     âœ“ should return logged-in owner shell (14 ms)
2025-04-15T08:25:11.7909560Z     âœ“ should return logged-in member shell (18 ms)
2025-04-15T08:25:11.7911021Z     âœ“ should return logged-in owner (21 ms)
2025-04-15T08:25:11.7912068Z     âœ“ should return logged-in member (26 ms)
2025-04-15T08:25:11.7913488Z   GET /resolve-signup-token
2025-04-15T08:25:11.7914490Z     âœ“ should validate invite token (27 ms)
2025-04-15T08:25:11.7915996Z     âœ“ should return 403 if user quota reached (21 ms)
2025-04-15T08:25:11.7917103Z     âœ“ should fail with invalid inputs (48 ms)
2025-04-15T08:25:11.7918338Z   POST /logout
2025-04-15T08:25:11.7920711Z     âœ“ should log user out (27 ms)
2025-04-15T08:25:11.7921026Z 
2025-04-15T08:25:13.4438790Z PASS test/integration/environments/source-control-import.service.test.ts (6.701 s)
2025-04-15T08:25:13.4440173Z   SourceControlImportService
2025-04-15T08:25:13.4474089Z     importCredentialsFromWorkFolder()
2025-04-15T08:25:13.4475399Z       if user email specified by `ownedBy` exists at target instance
2025-04-15T08:25:13.4476849Z         âœ“ should assign credential ownership to original user (66 ms)
2025-04-15T08:25:13.4478117Z       if user email specified by `ownedBy` is `null`
2025-04-15T08:25:13.4479292Z         âœ“ should assign credential ownership to importing user (25 ms)
2025-04-15T08:25:13.4482424Z       if user email specified by `ownedBy` does not exist at target instance
2025-04-15T08:25:13.4487332Z         âœ“ should assign credential ownership to importing user (15 ms)
2025-04-15T08:25:13.4488178Z     if owner specified by `ownedBy` does not exist at target instance
2025-04-15T08:25:13.4489660Z       âœ“ should assign the credential ownership to the importing user if it was owned by a personal project in the source instance (15 ms)
2025-04-15T08:25:13.4491352Z       âœ“ should create a new team project if the credential was owned by a team project in the source instance (21 ms)
2025-04-15T08:25:13.4492384Z     if owner specified by `ownedBy` does exist at target instance
2025-04-15T08:25:13.4493809Z       âœ“ should use the existing team project if credential owning project is found (15 ms)
2025-04-15T08:25:13.4495958Z       âœ“ should not change the owner if the credential is owned by somebody else on the target instance (22 ms)
2025-04-15T08:25:13.4496632Z 
2025-04-15T08:25:15.0244041Z PASS src/executions/pre-execution-checks/__tests__/subworkflow-policy-checker.test.ts
2025-04-15T08:25:15.0244953Z   SubworkflowPolicyChecker
2025-04-15T08:25:15.0249590Z     no caller policy
2025-04-15T08:25:15.0252458Z       âœ“ should fall back to `N8N_WORKFLOW_CALLER_POLICY_DEFAULT_OPTION` (18 ms)
2025-04-15T08:25:15.0255672Z     `workflows-from-list` caller policy
2025-04-15T08:25:15.0256486Z       âœ“ should allow if caller list contains parent workflow ID (2 ms)
2025-04-15T08:25:15.0257254Z       âœ“ should deny if caller list does not contain parent workflow ID (8 ms)
2025-04-15T08:25:15.0257775Z     `any` caller policy
2025-04-15T08:25:15.0258341Z       âœ“ should not throw on a regular subworkflow call (1 ms)
2025-04-15T08:25:15.0258909Z     `workflows-from-same-owner` caller policy
2025-04-15T08:25:15.0259679Z       âœ“ should deny if the two workflows are owned by different projects (2 ms)
2025-04-15T08:25:15.0260561Z       âœ“ should allow if both workflows are owned by the same project (1 ms)
2025-04-15T08:25:15.0261491Z     error details
2025-04-15T08:25:15.0262036Z       âœ“ should contain description for accessible case (1 ms)
2025-04-15T08:25:15.0263095Z       âœ“ should contain description for inaccessible personal project case (1 ms)
2025-04-15T08:25:15.0264044Z       âœ“ should contain description for inaccessible team project case (1 ms)
2025-04-15T08:25:15.0265004Z       âœ“ should contain description for default (e.g. error workflow) case (1 ms)
2025-04-15T08:25:15.0265467Z 
2025-04-15T08:25:17.4668968Z PASS src/__tests__/active-executions.test.ts
2025-04-15T08:25:17.4669604Z   ActiveExecutions
2025-04-15T08:25:17.4670468Z     âœ“ Should initialize activeExecutions with empty list (7 ms)
2025-04-15T08:25:17.4671310Z     âœ“ Should add execution to active execution list (11 ms)
2025-04-15T08:25:17.4672514Z     âœ“ Should update execution if add is called with execution ID (2 ms)
2025-04-15T08:25:17.4673818Z     âœ“ Should attach and resolve response promise to existing execution (2 ms)
2025-04-15T08:25:17.4675206Z     âœ“ Should copy over startedAt and responsePromise when resuming a waiting execution (2 ms)
2025-04-15T08:25:17.4676191Z     attachWorkflowExecution
2025-04-15T08:25:17.4677059Z       âœ“ Should fail attaching execution to invalid executionId (28 ms)
2025-04-15T08:25:17.4678076Z       âœ“ Should successfully attach execution to valid executionId (1 ms)
2025-04-15T08:25:17.4679277Z     finalizeExecution
2025-04-15T08:25:17.4679953Z       âœ“ Should not remove a waiting execution (2 ms)
2025-04-15T08:25:17.4680713Z       âœ“ Should remove an existing execution (2 ms)
2025-04-15T08:25:17.4681744Z       âœ“ Should not try to resolve a post-execute promise for an inactive execution (1 ms)
2025-04-15T08:25:17.4682982Z       âœ“ Should resolve post execute promise on removal (5 ms)
2025-04-15T08:25:17.4683622Z     getPostExecutePromise
2025-04-15T08:25:17.4684516Z       âœ“ Should throw error when trying to create a promise with invalid execution (1 ms)
2025-04-15T08:25:17.4685233Z     stopExecution
2025-04-15T08:25:17.4713679Z       âœ“ Should cancel ongoing executions (6 ms)
2025-04-15T08:25:17.4714493Z       âœ“ Should cancel waiting executions (1 ms)
2025-04-15T08:25:17.4715049Z     shutdown
2025-04-15T08:25:17.4715920Z       âœ“ Should cancel only executions with response-promises by default (8 ms)
2025-04-15T08:25:17.4717060Z       âœ“ Should cancel all executions when cancelAll is true (5 ms)
2025-04-15T08:25:17.4717563Z 
2025-04-15T08:25:20.2890260Z PASS test/integration/public-api/credentials.test.ts (8.303 s)
2025-04-15T08:25:20.2891473Z   POST /credentials
2025-04-15T08:25:20.2892241Z     âœ“ should create credentials (247 ms)
2025-04-15T08:25:20.2896034Z     âœ“ should fail with invalid inputs (47 ms)
2025-04-15T08:25:20.2899984Z   DELETE /credentials/:id
2025-04-15T08:25:20.2911826Z     âœ“ should delete owned cred for owner (28 ms)
2025-04-15T08:25:20.2916736Z     âœ“ should delete non-owned cred for owner (18 ms)
2025-04-15T08:25:20.2921168Z     âœ“ should delete owned cred for member (25 ms)
2025-04-15T08:25:20.2926211Z     âœ“ should delete owned cred for member but leave others untouched (57 ms)
2025-04-15T08:25:20.2930961Z     âœ“ should not delete non-owned cred for member (16 ms)
2025-04-15T08:25:20.2935666Z     âœ“ should fail if cred not found (9 ms)
2025-04-15T08:25:20.2939660Z   GET /credentials/schema/:credentialType
2025-04-15T08:25:20.2946775Z     âœ“ should fail due to not found type (17 ms)
2025-04-15T08:25:20.2948681Z     âœ“ should retrieve credential type (10 ms)
2025-04-15T08:25:20.2950357Z   PUT /credentials/:id/transfer
2025-04-15T08:25:20.2952116Z     âœ“ should transfer credential to project (54 ms)
2025-04-15T08:25:20.2974995Z     âœ“ should transfer the right credential, not the first one it finds (35 ms)
2025-04-15T08:25:20.2975784Z     âœ“ if no destination project, should reject (15 ms)
2025-04-15T08:25:20.2976098Z 
2025-04-15T08:25:22.8997873Z PASS test/integration/eventbus.ee.test.ts (7.614 s)
2025-04-15T08:25:22.8999121Z   âœ“ should have a running logwriter process (5 ms)
2025-04-15T08:25:22.9000463Z   âœ“ should have logwriter log messages (33 ms)
2025-04-15T08:25:22.9001830Z   âœ“ should anonymize audit message to syslog  (10 ms)
2025-04-15T08:25:22.9002444Z   âœ“ should send message to webhook  (6 ms)
2025-04-15T08:25:22.9003193Z   âœ“ should send message to sentry  (7 ms)
2025-04-15T08:25:22.9003872Z   âœ“ DELETE /eventbus/destination delete all destinations by id (20 ms)
2025-04-15T08:25:22.9004503Z   GET /eventbus/destination
2025-04-15T08:25:22.9005102Z     âœ“ should fail due to missing authentication (23 ms)
2025-04-15T08:25:22.9005841Z     âœ“ all returned destinations should exist in eventbus (13 ms)
2025-04-15T08:25:22.9006379Z   POST /eventbus/destination
2025-04-15T08:25:22.9006910Z     âœ“ create syslog destination (9 ms)
2025-04-15T08:25:22.9007263Z     âœ“ create sentry destination (7 ms)
2025-04-15T08:25:22.9007586Z     âœ“ create webhook destination (8 ms)
2025-04-15T08:25:22.9007767Z 
2025-04-15T08:25:24.0398653Z PASS src/telemetry/__tests__/telemetry.test.ts
2025-04-15T08:25:24.0399247Z   Telemetry
2025-04-15T08:25:24.0399563Z     trackWorkflowExecution
2025-04-15T08:25:24.0400391Z       âœ“ should count executions correctly (9 ms)
2025-04-15T08:25:24.0401256Z       âœ“ should fire "Workflow execution errored" event for failed executions (14 ms)
2025-04-15T08:25:24.0402186Z       âœ“ should track production executions count correctly (8 ms)
2025-04-15T08:25:24.0433166Z     Rudderstack
2025-04-15T08:25:24.0434317Z       âœ“ should call rudderStack.identify() with a fake IP address to instruct Rudderstack to not use the user's IP address (2 ms)
2025-04-15T08:25:24.0435893Z       âœ“ should call rudderStack.track() with a fake IP address to instruct Rudderstack to not use the user's IP address (4 ms)
2025-04-15T08:25:24.0436584Z 
2025-04-15T08:25:25.4673805Z PASS test/integration/external-secrets/external-secrets.api.test.ts (7.751 s)
2025-04-15T08:25:25.4674671Z   GET /external-secrets/providers
2025-04-15T08:25:25.4675458Z     âœ“ can retrieve providers as owner (47 ms)
2025-04-15T08:25:25.4676136Z     âœ“ can not retrieve providers as non-owner (11 ms)
2025-04-15T08:25:25.4676810Z     âœ“ does obscure passwords (12 ms)
2025-04-15T08:25:25.4677321Z   GET /external-secrets/providers/:provider
2025-04-15T08:25:25.4677931Z     âœ“ can retrieve provider as owner (11 ms)
2025-04-15T08:25:25.4678570Z     âœ“ can not retrieve provider as non-owner (10 ms)
2025-04-15T08:25:25.4679190Z     âœ“ does obscure passwords (11 ms)
2025-04-15T08:25:25.4679696Z   POST /external-secrets/providers/:provider
2025-04-15T08:25:25.4680289Z     âœ“ can update provider settings (18 ms)
2025-04-15T08:25:25.4680989Z     âœ“ can update provider settings with blanking value (20 ms)
2025-04-15T08:25:25.4681647Z   POST /external-secrets/providers/:provider/connect
2025-04-15T08:25:25.4682316Z     âœ“ can change provider connected state (17 ms)
2025-04-15T08:25:25.4683147Z   POST /external-secrets/providers/:provider/test
2025-04-15T08:25:25.4683712Z     âœ“ can test provider (8 ms)
2025-04-15T08:25:25.4684182Z     âœ“ can test provider fail (9 ms)
2025-04-15T08:25:25.4684725Z   POST /external-secrets/providers/:provider/update
2025-04-15T08:25:25.4685354Z     âœ“ can update provider (9 ms)
2025-04-15T08:25:25.4685914Z     âœ“ can not update errored provider (21 ms)
2025-04-15T08:25:25.4686612Z     âœ“ can not update provider without a valid license (9 ms)
2025-04-15T08:25:25.4687167Z   GET /external-secrets/secrets
2025-04-15T08:25:25.4687720Z     âœ“ can get secret names as owner (9 ms)
2025-04-15T08:25:25.4688338Z     âœ“ can not get secret names as non-owner (9 ms)
2025-04-15T08:25:25.4688682Z 
2025-04-15T08:25:30.5883371Z PASS test/integration/active-workflow-manager.test.ts (7.436 s)
2025-04-15T08:25:30.5884074Z   init()
2025-04-15T08:25:30.5884808Z     âœ“ should load workflows into memory (112 ms)
2025-04-15T08:25:30.5885461Z     âœ“ should call external hook (18 ms)
2025-04-15T08:25:30.5886159Z     âœ“ should check that workflow can be activated (33 ms)
2025-04-15T08:25:30.5886676Z   isActive()
2025-04-15T08:25:30.5887292Z     âœ“ should return `true` for active workflow in storage (22 ms)
2025-04-15T08:25:30.5888180Z     âœ“ should return `false` for inactive workflow in storage (14 ms)
2025-04-15T08:25:30.5889202Z   add()
2025-04-15T08:25:30.5889988Z     âœ“ should count workflow triggers correctly when node has multiple webhooks (15 ms)
2025-04-15T08:25:30.5890659Z     in single-main mode
2025-04-15T08:25:30.5891573Z       âœ“ should add webhooks, triggers and pollers for workflow in 'activate' activation mode (19 ms)
2025-04-15T08:25:30.5893117Z       âœ“ should add webhooks, triggers and pollers for workflow in 'update' activation mode (20 ms)
2025-04-15T08:25:30.5893857Z   removeAll()
2025-04-15T08:25:30.5894492Z     âœ“ should remove all active workflows from memory (30 ms)
2025-04-15T08:25:30.5894997Z   remove()
2025-04-15T08:25:30.5895283Z     in single-main mode
2025-04-15T08:25:30.5895970Z       âœ“ should remove all webhooks of a workflow from database (21 ms)
2025-04-15T08:25:30.5896898Z       âœ“ should remove all webhooks of a workflow from external service (16 ms)
2025-04-15T08:25:30.5897727Z       âœ“ should stop running triggers and pollers (16 ms)
2025-04-15T08:25:30.5898232Z   executeErrorWorkflow()
2025-04-15T08:25:30.5898877Z     âœ“ should be called on failure to activate due to 401 (21 ms)
2025-04-15T08:25:30.5899381Z   addWebhooks()
2025-04-15T08:25:30.5899935Z     âœ“ should call `WebhookService.storeWebhook()` (23 ms)
2025-04-15T08:25:30.5900619Z 
2025-04-15T08:25:32.1589617Z PASS test/integration/evaluation/test-runs.api.test.ts (7.878 s)
2025-04-15T08:25:32.1596775Z   GET /evaluation/test-definitions/:testDefinitionId/runs
2025-04-15T08:25:32.1597927Z     âœ“ should retrieve empty list of runs for a test definition (65 ms)
2025-04-15T08:25:32.1598865Z     âœ“ should return 404 if test definition does not exist (52 ms)
2025-04-15T08:25:32.1599800Z     âœ“ should return 404 if user does not have access to test definition (31 ms)
2025-04-15T08:25:32.1600742Z     âœ“ should retrieve list of runs for a test definition (36 ms)
2025-04-15T08:25:32.1601693Z     âœ“ should retrieve list of runs for a test definition with pagination (51 ms)
2025-04-15T08:25:32.1602577Z   GET /evaluation/test-definitions/:testDefinitionId/runs/:id
2025-04-15T08:25:32.1603682Z     âœ“ should retrieve test run for a test definition (32 ms)
2025-04-15T08:25:32.1604561Z     âœ“ should return 404 if test run does not exist (27 ms)
2025-04-15T08:25:32.1605489Z     âœ“ should return 404 if user does not have access to test definition (34 ms)
2025-04-15T08:25:32.1606634Z     âœ“ should retrieve test run for a test definition of a shared workflow (68 ms)
2025-04-15T08:25:32.1607535Z   DELETE /evaluation/test-definitions/:testDefinitionId/runs/:id
2025-04-15T08:25:32.1608434Z     âœ“ should delete test run for a test definition (33 ms)
2025-04-15T08:25:32.1609237Z     âœ“ should return 404 if test run does not exist (29 ms)
2025-04-15T08:25:32.1610205Z     âœ“ should return 404 if user does not have access to test definition (25 ms)
2025-04-15T08:25:32.1611102Z   POST /evaluation/test-definitions/:testDefinitionId/runs/:id/cancel
2025-04-15T08:25:32.1611866Z     âœ“ should cancel test run (40 ms)
2025-04-15T08:25:32.1612547Z     âœ“ should return 404 if test run does not exist (33 ms)
2025-04-15T08:25:32.1613576Z     âœ“ should return 404 if test definition does not exist (31 ms)
2025-04-15T08:25:32.1614621Z     âœ“ should return 404 if user does not have access to test definition (32 ms)
2025-04-15T08:25:32.1615163Z 
2025-04-15T08:25:33.0740900Z PASS test/integration/prometheus-metrics.test.ts (7.341 s)
2025-04-15T08:25:33.0744782Z   PrometheusMetricsService
2025-04-15T08:25:33.0745573Z     âœ“ should return n8n version (32 ms)
2025-04-15T08:25:33.0746267Z     âœ“ should return default metrics if enabled (14 ms)
2025-04-15T08:25:33.0752245Z     âœ“ should not return default metrics if disabled (4 ms)
2025-04-15T08:25:33.0753273Z     âœ“ should return cache metrics if enabled (4 ms)
2025-04-15T08:25:33.0753988Z     âœ“ should not return cache metrics if disabled (4 ms)
2025-04-15T08:25:33.0754714Z     âœ“ should return route metrics if enabled (15 ms)
2025-04-15T08:25:33.0755530Z     âœ“ should include last activity metric with route metrics (30 ms)
2025-04-15T08:25:33.0756980Z     âœ“ should return labels in route metrics if enabled (8 ms)
2025-04-15T08:25:33.0757725Z     âœ“ should return queue metrics if enabled (4 ms)
2025-04-15T08:25:33.0758583Z     âœ“ should set queue metrics in response to `job-counts-updated` event (3 ms)
2025-04-15T08:25:33.0759491Z     âœ“ should return active workflow count (20 ms)
2025-04-15T08:25:33.0759864Z 
2025-04-15T08:25:38.0236023Z PASS src/commands/__tests__/community-node.test.ts (5.631 s)
2025-04-15T08:25:38.0237300Z   uninstallCredential
2025-04-15T08:25:38.0238234Z     âœ“ should delete a credential (10 ms)
2025-04-15T08:25:38.0238868Z     âœ“ should return if the user is not found (1 ms)
2025-04-15T08:25:38.0239545Z     âœ“ should return if the credential is not found (2 ms)
2025-04-15T08:25:38.0240190Z     âœ“ should delete multiple credentials (2 ms)
2025-04-15T08:25:38.0240640Z   uninstallPackage
2025-04-15T08:25:38.0241099Z     âœ“ should uninstall the package (3 ms)
2025-04-15T08:25:38.0241831Z     âœ“ should uninstall all nodes from a package (2 ms)
2025-04-15T08:25:38.0242542Z     âœ“ should return if a package is not found (1 ms)
2025-04-15T08:25:38.0243634Z     âœ“ should return if nodes are not found (1 ms)
2025-04-15T08:25:38.0243983Z 
2025-04-15T08:25:38.9960241Z PASS test/integration/public-api/projects.test.ts (8.218 s)
2025-04-15T08:25:38.9966016Z   Projects in Public API
2025-04-15T08:25:38.9966394Z     GET /projects
2025-04-15T08:25:38.9967233Z       âœ“ if licensed, should return all projects with pagination (215 ms)
2025-04-15T08:25:38.9967977Z       âœ“ if not authenticated, should reject (12 ms)
2025-04-15T08:25:38.9968571Z       âœ“ if not licensed, should reject (21 ms)
2025-04-15T08:25:38.9969146Z       âœ“ if missing scope, should reject (20 ms)
2025-04-15T08:25:38.9969591Z     POST /projects
2025-04-15T08:25:38.9970177Z       âœ“ if licensed, should create a new project (29 ms)
2025-04-15T08:25:38.9970840Z       âœ“ if not authenticated, should reject (6 ms)
2025-04-15T08:25:38.9971475Z       âœ“ if not licensed, should reject (17 ms)
2025-04-15T08:25:38.9972087Z       âœ“ if missing scope, should reject (18 ms)
2025-04-15T08:25:38.9972609Z     DELETE /projects/:id
2025-04-15T08:25:38.9973297Z       âœ“ if licensed, should delete a project (82 ms)
2025-04-15T08:25:38.9973886Z       âœ“ if not authenticated, should reject (8 ms)
2025-04-15T08:25:38.9974442Z       âœ“ if not licensed, should reject (18 ms)
2025-04-15T08:25:38.9974959Z       âœ“ if missing scope, should reject (18 ms)
2025-04-15T08:25:38.9975371Z     PUT /projects/:id
2025-04-15T08:25:38.9975838Z       âœ“ if licensed, should update a project (32 ms)
2025-04-15T08:25:38.9976436Z       âœ“ if not authenticated, should reject (6 ms)
2025-04-15T08:25:38.9976977Z       âœ“ if not licensed, should reject (15 ms)
2025-04-15T08:25:38.9977510Z       âœ“ if missing scope, should reject (16 ms)
2025-04-15T08:25:38.9977795Z 
2025-04-15T08:25:40.2865878Z PASS src/executions/__tests__/execution-recovery.service.test.ts (6.982 s)
2025-04-15T08:25:40.2870871Z   ExecutionRecoveryService
2025-04-15T08:25:40.2873188Z     recoverFromLogs
2025-04-15T08:25:40.2873553Z       if follower
2025-04-15T08:25:40.2874181Z         âœ“ should do nothing (29 ms)
2025-04-15T08:25:40.2874649Z       if leader, with 0 messages
2025-04-15T08:25:40.2875273Z         âœ“ should return `null` if no execution found (6 ms)
2025-04-15T08:25:40.2876009Z         âœ“ should update `status` and `stoppedAt` (40 ms)
2025-04-15T08:25:40.2876505Z       if leader, with 1+ messages
2025-04-15T08:25:40.2877220Z         âœ“ for successful dataful execution, should return `null` (15 ms)
2025-04-15T08:25:40.2877975Z         âœ“ should return `null` if no execution found (5 ms)
2025-04-15T08:25:40.2878978Z         âœ“ for successful dataless execution, should update `status`, `stoppedAt` and `data` (55 ms)
2025-04-15T08:25:40.2880323Z         âœ“ for running execution, should update `status`, `stoppedAt` and `data` if last node did not finish (18 ms)
2025-04-15T08:25:40.2881517Z         âœ“ should update `status`, `stoppedAt` and `data` if last node finished (17 ms)
2025-04-15T08:25:40.2882439Z 
2025-04-15T08:25:44.4734519Z PASS src/controllers/oauth/__tests__/oauth1-credential.controller.test.ts (5.246 s)
2025-04-15T08:25:44.4735626Z   OAuth1CredentialController
2025-04-15T08:25:44.4736142Z     getAuthUri
2025-04-15T08:25:44.4737222Z       âœ“ should throw a BadRequestError when credentialId is missing in the query (32 ms)
2025-04-15T08:25:44.4738403Z       âœ“ should throw a NotFoundError when no matching credential is found for the user (2 ms)
2025-04-15T08:25:44.4739329Z       âœ“ should return a valid auth URI (87 ms)
2025-04-15T08:25:44.4739849Z     handleCallback
2025-04-15T08:25:44.4740733Z       âœ“ should render the error page when required query params are missing (1 ms)
2025-04-15T08:25:44.4741777Z       âœ“ should render the error page when `state` query param is invalid (4 ms)
2025-04-15T08:25:44.4742989Z       âœ“ should render the error page when credential is not found in DB (3 ms)
2025-04-15T08:25:44.4744217Z       âœ“ should render the error page when state differs from the stored state in the credential (1 ms)
2025-04-15T08:25:44.4745361Z       âœ“ should render the error page when state is older than 5 minutes (1 ms)
2025-04-15T08:25:44.4746371Z       âœ“ should exchange the code for a valid token, and save it to DB (36 ms)
2025-04-15T08:25:44.4747314Z 
2025-04-15T08:25:45.3350943Z PASS src/scaling/__tests__/scaling.service.test.ts
2025-04-15T08:25:45.3352134Z   ScalingService
2025-04-15T08:25:45.3352890Z     setupQueue
2025-04-15T08:25:45.3353426Z       if leader main
2025-04-15T08:25:45.3354494Z         âœ“ should set up queue + listeners + queue recovery (10 ms)
2025-04-15T08:25:45.3355253Z       if follower main
2025-04-15T08:25:45.3355960Z         âœ“ should set up queue + listeners (2 ms)
2025-04-15T08:25:45.3356556Z       if worker
2025-04-15T08:25:45.3357214Z         âœ“ should set up queue + listeners (1 ms)
2025-04-15T08:25:45.3357802Z       webhook
2025-04-15T08:25:45.3358452Z         âœ“ should set up a queue + listeners (2 ms)
2025-04-15T08:25:45.3359104Z     setupWorker
2025-04-15T08:25:45.3359901Z       âœ“ should set up a worker with concurrency (2 ms)
2025-04-15T08:25:45.3360887Z       âœ“ should throw if called on a non-worker instance (27 ms)
2025-04-15T08:25:45.3361841Z       âœ“ should throw if called before queue is ready (3 ms)
2025-04-15T08:25:45.3362507Z     stop
2025-04-15T08:25:45.3363113Z       if main
2025-04-15T08:25:45.3363925Z         âœ“ should pause queue, stop queue recovery and queue metrics (2 ms)
2025-04-15T08:25:45.3364800Z       if worker
2025-04-15T08:25:45.3365630Z         âœ“ should pause queue and wait for running jobs to finish (2 ms)
2025-04-15T08:25:45.3366352Z     pingQueue
2025-04-15T08:25:45.3369748Z       âœ“ should ping the queue (1 ms)
2025-04-15T08:25:45.3370592Z     addJob
2025-04-15T08:25:45.3372418Z       âœ“ should add a job (2 ms)
2025-04-15T08:25:45.3373040Z     getJob
2025-04-15T08:25:45.3373495Z       âœ“ should get a job (2 ms)
2025-04-15T08:25:45.3373899Z     findJobsByStatus
2025-04-15T08:25:45.3374446Z       âœ“ should find jobs by status (1 ms)
2025-04-15T08:25:45.3375129Z       âœ“ should filter out `null` in Redis response (1 ms)
2025-04-15T08:25:45.3375623Z     stopJob
2025-04-15T08:25:45.3376084Z       âœ“ should stop an active job (3 ms)
2025-04-15T08:25:45.3376684Z       âœ“ should stop an inactive job (1 ms)
2025-04-15T08:25:45.3377343Z       âœ“ should report failure to stop a job (2 ms)
2025-04-15T08:25:45.3377685Z 
2025-04-15T08:25:46.0618905Z PASS test/integration/api-keys.api.test.ts (7.74 s)
2025-04-15T08:25:46.0623909Z   When public API is disabled
2025-04-15T08:25:46.0629166Z     âœ“ POST /api-keys should 404 (80 ms)
2025-04-15T08:25:46.0633831Z     âœ“ GET /api-keys should 404 (27 ms)
2025-04-15T08:25:46.0638202Z     âœ“ DELETE /api-key/:id should 404 (28 ms)
2025-04-15T08:25:46.0642367Z   Owner shell
2025-04-15T08:25:46.0647098Z     âœ“ POST /api-keys should create an api key with no expiration (29 ms)
2025-04-15T08:25:46.0651821Z     âœ“ POST /api-keys should create an api key with expiration (25 ms)
2025-04-15T08:25:46.0657242Z     âœ“ GET /api-keys should fetch the api key redacted (40 ms)
2025-04-15T08:25:46.0661772Z     âœ“ DELETE /api-keys/:id should delete the api key (46 ms)
2025-04-15T08:25:46.0665912Z   Member
2025-04-15T08:25:46.0667865Z     âœ“ POST /api-keys should create an api key with no expiration (40 ms)
2025-04-15T08:25:46.0669576Z     âœ“ POST /api-keys should create an api key with expiration (24 ms)
2025-04-15T08:25:46.0671982Z     âœ“ POST /api-keys should fail if max number of API keys reached (26 ms)
2025-04-15T08:25:46.0673390Z     âœ“ GET /api-keys should fetch the api key redacted (34 ms)
2025-04-15T08:25:46.0675561Z     âœ“ DELETE /api-keys/:id should delete the api key (32 ms)
2025-04-15T08:25:46.0678163Z 
2025-04-15T08:25:48.1474800Z PASS src/task-runners/task-managers/__tests__/data-request-response-stripper.test.ts
2025-04-15T08:25:48.1495706Z   DataRequestResponseStripper
2025-04-15T08:25:48.1500094Z     all data
2025-04-15T08:25:48.1501569Z       âœ“ should build the runExecutionData as is when everything is requested (8 ms)
2025-04-15T08:25:48.1502590Z     envProviderState
2025-04-15T08:25:48.1503750Z       âœ“ should filter out envProviderState when it's not requested (1 ms)
2025-04-15T08:25:48.1504428Z     input data
2025-04-15T08:25:48.1504997Z       âœ“ drops input data from result (1 ms)
2025-04-15T08:25:48.1506130Z       âœ“ returns only chunked data (1 ms)
2025-04-15T08:25:48.1506686Z     nodes
2025-04-15T08:25:48.1507480Z       âœ“ should return empty run data when only Code node is requested (1 ms)
2025-04-15T08:25:48.1508599Z       âœ“ should return empty run data when only Code node is requested (1 ms)
2025-04-15T08:25:48.1509924Z       âœ“ should return only DebugHelper's data when only DebugHelper node is requested (2 ms)
2025-04-15T08:25:48.1510953Z       âœ“ should return DebugHelper's data when only prevNode node is requested (1 ms)
2025-04-15T08:25:48.1511530Z     passthrough properties
2025-04-15T08:25:48.1511980Z       âœ“ it doesn't change workflow
2025-04-15T08:25:48.1512525Z       âœ“ it doesn't change connectionInputSource (1 ms)
2025-04-15T08:25:48.1513319Z       âœ“ it doesn't change node (1 ms)
2025-04-15T08:25:48.1513803Z       âœ“ it doesn't change runIndex
2025-04-15T08:25:48.1514295Z       âœ“ it doesn't change itemIndex (1 ms)
2025-04-15T08:25:48.1514818Z       âœ“ it doesn't change activeNodeName
2025-04-15T08:25:48.1515373Z       âœ“ it doesn't change siblingParameters
2025-04-15T08:25:48.1515864Z       âœ“ it doesn't change mode
2025-04-15T08:25:48.1516349Z       âœ“ it doesn't change defaultReturnRunIndex
2025-04-15T08:25:48.1516884Z       âœ“ it doesn't change selfData (1 ms)
2025-04-15T08:25:48.1517411Z       âœ“ it doesn't change contextNodeName
2025-04-15T08:25:48.1517899Z       âœ“ it doesn't change additionalData
2025-04-15T08:25:48.1518165Z 
2025-04-15T08:25:53.4671485Z PASS test/integration/public-api/tags.test.ts (8.739 s)
2025-04-15T08:25:53.4679377Z   GET /tags
2025-04-15T08:25:53.4683910Z     âœ“ should fail due to missing API Key (38 ms)
2025-04-15T08:25:53.4686972Z     âœ“ should fail due to invalid API Key (9 ms)
2025-04-15T08:25:53.4694727Z     âœ“ should return all tags (253 ms)
2025-04-15T08:25:53.4697001Z     âœ“ should return all tags with pagination (29 ms)
2025-04-15T08:25:53.4719279Z   GET /tags/:id
2025-04-15T08:25:53.4720649Z     âœ“ should fail due to missing API Key (8 ms)
2025-04-15T08:25:53.4722545Z     âœ“ should fail due to invalid API Key (8 ms)
2025-04-15T08:25:53.4726964Z     âœ“ should fail due to non-existing tag (20 ms)
2025-04-15T08:25:53.4729773Z     âœ“ should retrieve tag (14 ms)
2025-04-15T08:25:53.4731743Z   DELETE /tags/:id
2025-04-15T08:25:53.4732194Z     âœ“ should fail due to missing API Key (6 ms)
2025-04-15T08:25:53.4734204Z     âœ“ should fail due to invalid API Key (6 ms)
2025-04-15T08:25:53.4735911Z     âœ“ should fail due to non-existing tag (19 ms)
2025-04-15T08:25:53.4737695Z     âœ“ owner should delete the tag (14 ms)
2025-04-15T08:25:53.4738275Z     âœ“ non-owner should not delete tag (11 ms)
2025-04-15T08:25:53.4738697Z   POST /tags
2025-04-15T08:25:53.4739150Z     âœ“ should fail due to missing API Key (5 ms)
2025-04-15T08:25:53.4740097Z     âœ“ should fail due to invalid API Key (4 ms)
2025-04-15T08:25:53.4740685Z     âœ“ should fail due to invalid body (23 ms)
2025-04-15T08:25:53.4741214Z     âœ“ should create tag (13 ms)
2025-04-15T08:25:53.4741842Z     âœ“ should not create tag if tag with same name exists (11 ms)
2025-04-15T08:25:53.4742386Z   PUT /tags/:id
2025-04-15T08:25:53.4742967Z     âœ“ should fail due to missing API Key (5 ms)
2025-04-15T08:25:53.4745592Z     âœ“ should fail due to invalid API Key (4 ms)
2025-04-15T08:25:53.4746193Z     âœ“ should fail due to non-existing tag (12 ms)
2025-04-15T08:25:53.4746793Z     âœ“ should fail due to invalid body (5 ms)
2025-04-15T08:25:53.4747306Z     âœ“ should update tag (15 ms)
2025-04-15T08:25:53.4747973Z     âœ“ should fail if there is already a tag with a the new name (20 ms)
2025-04-15T08:25:53.4748397Z 
2025-04-15T08:25:54.7860708Z PASS test/integration/password-reset.api.test.ts (8.482 s)
2025-04-15T08:25:54.7861437Z   POST /forgot-password
2025-04-15T08:25:54.7862328Z     âœ“ should send password reset email (94 ms)
2025-04-15T08:25:54.7864128Z     âœ“ should fail if emailing is not set up (58 ms)
2025-04-15T08:25:54.7866038Z     âœ“ should fail if SAML is authentication method (41 ms)
2025-04-15T08:25:54.7866999Z     âœ“ should succeed if SAML is authentication method and requestor is owner (41 ms)
2025-04-15T08:25:54.7868354Z     âœ“ should fail with invalid inputs (40 ms)
2025-04-15T08:25:54.7868986Z     âœ“ should fail if user is not found (25 ms)
2025-04-15T08:25:54.7869474Z   GET /resolve-password-token
2025-04-15T08:25:54.7870053Z     âœ“ should succeed with valid inputs (23 ms)
2025-04-15T08:25:54.7870679Z     âœ“ should fail with invalid inputs (29 ms)
2025-04-15T08:25:54.7871285Z     âœ“ should fail if user is not found (22 ms)
2025-04-15T08:25:54.7871901Z     âœ“ should fail if token is expired (22 ms)
2025-04-15T08:25:54.7872549Z     âœ“ should fail after password has changed (23 ms)
2025-04-15T08:25:54.7873570Z   POST /change-password
2025-04-15T08:25:54.7874162Z     âœ“ should succeed with valid inputs (238 ms)
2025-04-15T08:25:54.7874771Z     âœ“ should fail with invalid inputs (46 ms)
2025-04-15T08:25:54.7875637Z     âœ“ should fail when token has expired (28 ms)
2025-04-15T08:25:54.7876723Z     âœ“ owner should be able to reset its password when quota:users = 1 (231 ms)
2025-04-15T08:25:54.7877726Z     âœ“ member should not be able to reset its password when quota:users = 1 (122 ms)
2025-04-15T08:25:54.7878193Z 
2025-04-15T08:25:57.2540814Z PASS test/integration/saml/saml.api.test.ts (8.849 s)
2025-04-15T08:25:57.2541516Z   Instance owner
2025-04-15T08:25:57.2544851Z     PATCH /me
2025-04-15T08:25:57.2545621Z       âœ“ should succeed with valid inputs (71 ms)
2025-04-15T08:25:57.2546585Z       âœ“ should throw BadRequestError if email is changed when SAML is enabled (31 ms)
2025-04-15T08:25:57.2547290Z     PATCH /password
2025-04-15T08:25:57.2548170Z       âœ“ should throw BadRequestError if password is changed when SAML is enabled (16 ms)
2025-04-15T08:25:57.2549384Z     POST /sso/saml/config
2025-04-15T08:25:57.2550059Z       âœ“ should post saml config (349 ms)
2025-04-15T08:25:57.2560449Z       âœ“ should return 400 on invalid config (26 ms)
2025-04-15T08:25:57.2564776Z     POST /sso/saml/config/toggle
2025-04-15T08:25:57.2570593Z       âœ“ should toggle saml as default authentication method (71 ms)
2025-04-15T08:25:57.2572092Z       âœ“ should fail enable saml if default authentication is not email (50 ms)
2025-04-15T08:25:57.2574438Z   Check endpoint permissions
2025-04-15T08:25:57.2575256Z     Owner
2025-04-15T08:25:57.2577784Z       âœ“ should be able to access GET /sso/saml/metadata (18 ms)
2025-04-15T08:25:57.2578679Z       âœ“ should be able to access GET /sso/saml/config (13 ms)
2025-04-15T08:25:57.2579529Z       âœ“ should be able to access POST /sso/saml/config (29 ms)
2025-04-15T08:25:57.2580404Z       âœ“ should be able to access POST /sso/saml/config/toggle (13 ms)
2025-04-15T08:25:57.2581201Z       âœ“ should be able to access GET /sso/saml/acs (15 ms)
2025-04-15T08:25:57.2582025Z       âœ“ should be able to access POST /sso/saml/acs (10 ms)
2025-04-15T08:25:57.2583005Z       âœ“ should be able to access GET /sso/saml/initsso (16 ms)
2025-04-15T08:25:57.2583852Z       âœ“ should be able to access GET /sso/saml/config/test (11 ms)
2025-04-15T08:25:57.2584403Z     Authenticated Member
2025-04-15T08:25:57.2585427Z       âœ“ should be able to access GET /sso/saml/metadata (6 ms)
2025-04-15T08:25:57.2586226Z       âœ“ should be able to access GET /sso/saml/config (10 ms)
2025-04-15T08:25:57.2587032Z       âœ“ should NOT be able to access POST /sso/saml/config (10 ms)
2025-04-15T08:25:57.2587872Z       âœ“ should NOT be able to access POST /sso/saml/config/toggle (9 ms)
2025-04-15T08:25:57.2588666Z       âœ“ should be able to access GET /sso/saml/acs (6 ms)
2025-04-15T08:25:57.2589395Z       âœ“ should be able to access POST /sso/saml/acs (7 ms)
2025-04-15T08:25:57.2590139Z       âœ“ should be able to access GET /sso/saml/initsso (16 ms)
2025-04-15T08:25:57.2590927Z       âœ“ should NOT be able to access GET /sso/saml/config/test (9 ms)
2025-04-15T08:25:57.2591504Z     Non-Authenticated User
2025-04-15T08:25:57.2592089Z       âœ“ should be able to access /sso/saml/metadata (6 ms)
2025-04-15T08:25:57.2593087Z       âœ“ should NOT be able to access GET /sso/saml/config (6 ms)
2025-04-15T08:25:57.2593903Z       âœ“ should NOT be able to access POST /sso/saml/config (5 ms)
2025-04-15T08:25:57.2594732Z       âœ“ should NOT be able to access POST /sso/saml/config/toggle (5 ms)
2025-04-15T08:25:57.2595516Z       âœ“ should be able to access GET /sso/saml/acs (7 ms)
2025-04-15T08:25:57.2596209Z       âœ“ should be able to access POST /sso/saml/acs (6 ms)
2025-04-15T08:25:57.2597019Z       âœ“ should be able to access GET /sso/saml/initsso (7 ms)
2025-04-15T08:25:57.2597993Z       âœ“ should NOT be able to access GET /sso/saml/config/test (12 ms)
2025-04-15T08:25:57.2598631Z 
2025-04-15T08:25:58.2215127Z PASS src/executions/__tests__/execution.service.test.ts
2025-04-15T08:25:58.2230822Z   ExecutionService
2025-04-15T08:25:58.2231869Z     retry
2025-04-15T08:25:58.2233236Z       âœ“ should error on retrying a execution that was aborted before starting (33 ms)
2025-04-15T08:25:58.2234092Z     stop
2025-04-15T08:25:58.2234856Z       âœ“ should throw when stopping a missing execution (1 ms)
2025-04-15T08:25:58.2235872Z       âœ“ should throw when stopping a not-in-progress execution (1 ms)
2025-04-15T08:25:58.2236605Z       regular mode
2025-04-15T08:25:58.2237357Z         âœ“ should stop a `running` execution in regular mode (3 ms)
2025-04-15T08:25:58.2238338Z         âœ“ should stop a `waiting` execution in regular mode (2 ms)
2025-04-15T08:25:58.2246585Z         âœ“ should stop a concurrency-controlled `new` execution in regular mode (1 ms)
2025-04-15T08:25:58.2250802Z       scaling mode
2025-04-15T08:25:58.2255149Z         manual execution
2025-04-15T08:25:58.2259368Z           âœ“ should stop a `running` execution in scaling mode (2 ms)
2025-04-15T08:25:58.2263717Z         production execution
2025-04-15T08:25:58.2268064Z           âœ“ should stop a `running` execution in scaling mode (2 ms)
2025-04-15T08:25:58.2273187Z           âœ“ should stop a `waiting` execution in scaling mode (1 ms)
2025-04-15T08:25:58.2277100Z 
2025-04-15T08:26:01.1102060Z PASS src/__tests__/node-types.test.ts
2025-04-15T08:26:01.1114338Z   NodeTypes
2025-04-15T08:26:01.1114696Z     getByName
2025-04-15T08:26:01.1123652Z       âœ“ should return node type when it exists (6 ms)
2025-04-15T08:26:01.1124146Z     getByNameAndVersion
2025-04-15T08:26:01.1124779Z       âœ“ should throw an error if the package does not exist (20 ms)
2025-04-15T08:26:01.1125587Z       âœ“ should throw an error if the node-type does not exist (2 ms)
2025-04-15T08:26:01.1126371Z       âœ“ should return a regular node-type without version (1 ms)
2025-04-15T08:26:01.1127085Z       âœ“ should return a regular node-type with version
2025-04-15T08:26:01.1128072Z       âœ“ should throw when a node-type is requested as tool, but does not support being used as one (2 ms)
2025-04-15T08:26:01.1129306Z       âœ“ should throw when a node-type is requested as tool, but the original node is already a tool (1 ms)
2025-04-15T08:26:01.1130323Z       âœ“ should return the tool node-type when requested as tool (11 ms)
2025-04-15T08:26:01.1131300Z       âœ“ should return a tool node-type from a community node,  when requested as tool (2 ms)
2025-04-15T08:26:01.1132655Z       âœ“ should return a declarative node-type with an `.execute` method (2 ms)
2025-04-15T08:26:01.1133840Z       âœ“ should return a declarative node-type as a tool with an `.execute` method (4 ms)
2025-04-15T08:26:01.1134468Z     getWithSourcePath
2025-04-15T08:26:01.1135136Z       âœ“ should return description and source path for existing node (1 ms)
2025-04-15T08:26:01.1135887Z       âœ“ should throw error for non-existent node (2 ms)
2025-04-15T08:26:01.1136335Z     getKnownTypes
2025-04-15T08:26:01.1136770Z       âœ“ should return known node types
2025-04-15T08:26:01.1137191Z     getNodeTypeDescriptions
2025-04-15T08:26:01.1137744Z       âœ“ should return descriptions for valid node types
2025-04-15T08:26:01.1138385Z       âœ“ should throw error for invalid node type (1 ms)
2025-04-15T08:26:01.1138706Z 
2025-04-15T08:26:02.9594214Z PASS test/integration/pruning.service.test.ts (7.951 s)
2025-04-15T08:26:02.9596099Z   softDeleteOnPruningCycle()
2025-04-15T08:26:02.9596628Z     when EXECUTIONS_DATA_PRUNE_MAX_COUNT is set
2025-04-15T08:26:02.9597689Z       âœ“ should mark as deleted based on EXECUTIONS_DATA_PRUNE_MAX_COUNT (39 ms)
2025-04-15T08:26:02.9598523Z       âœ“ should not re-mark already marked executions (21 ms)
2025-04-15T08:26:02.9599179Z       âœ“ should prune unknown executions (19 ms)
2025-04-15T08:26:02.9599779Z       âœ“ should prune canceled executions (20 ms)
2025-04-15T08:26:02.9600369Z       âœ“ should prune crashed executions (14 ms)
2025-04-15T08:26:02.9600888Z       âœ“ should prune error executions (13 ms)
2025-04-15T08:26:02.9601381Z       âœ“ should prune success executions (13 ms)
2025-04-15T08:26:02.9601867Z       âœ“ should not prune new executions (17 ms)
2025-04-15T08:26:02.9602413Z       âœ“ should not prune running executions (14 ms)
2025-04-15T08:26:02.9603213Z       âœ“ should not prune waiting executions (13 ms)
2025-04-15T08:26:02.9603833Z       âœ“ should not prune annotated executions (34 ms)
2025-04-15T08:26:02.9604331Z     when EXECUTIONS_DATA_MAX_AGE is set
2025-04-15T08:26:02.9605039Z       âœ“ should mark as deleted based on EXECUTIONS_DATA_MAX_AGE (17 ms)
2025-04-15T08:26:02.9605793Z       âœ“ should not re-mark already marked executions (13 ms)
2025-04-15T08:26:02.9606419Z       âœ“ should prune unknown executions (8 ms)
2025-04-15T08:26:02.9606991Z       âœ“ should prune canceled executions (7 ms)
2025-04-15T08:26:02.9607549Z       âœ“ should prune crashed executions (9 ms)
2025-04-15T08:26:02.9608100Z       âœ“ should prune error executions (7 ms)
2025-04-15T08:26:02.9608654Z       âœ“ should prune success executions (7 ms)
2025-04-15T08:26:02.9609212Z       âœ“ should not prune new executions (16 ms)
2025-04-15T08:26:02.9609800Z       âœ“ should not prune running executions (12 ms)
2025-04-15T08:26:02.9610803Z       âœ“ should not prune waiting executions (12 ms)
2025-04-15T08:26:02.9611425Z       âœ“ should not prune annotated executions (26 ms)
2025-04-15T08:26:02.9611763Z 
2025-04-15T08:26:04.5984148Z PASS src/__tests__/license.test.ts
2025-04-15T08:26:04.5985010Z   License
2025-04-15T08:26:04.5985962Z     âœ“ initializes license manager (8 ms)
2025-04-15T08:26:04.5986890Z     âœ“ initializes license manager for worker (3 ms)
2025-04-15T08:26:04.5987828Z     âœ“ attempts to activate license with provided key (1 ms)
2025-04-15T08:26:04.5988709Z     âœ“ renews license (2 ms)
2025-04-15T08:26:04.5990689Z     âœ“ check if feature is enabled (1 ms)
2025-04-15T08:26:04.5991440Z     âœ“ check if sharing feature is enabled (2 ms)
2025-04-15T08:26:04.5992191Z     âœ“ check fetching entitlements (2 ms)
2025-04-15T08:26:04.5993224Z     âœ“ check fetching feature values (1 ms)
2025-04-15T08:26:04.5994307Z     âœ“ check management jwt (2 ms)
2025-04-15T08:26:04.6008377Z     âœ“ getMainPlan() returns the latest main entitlement (1 ms)
2025-04-15T08:26:04.6009276Z     âœ“ getMainPlan() returns undefined if there is no main plan (2 ms)
2025-04-15T08:26:04.6009811Z     init
2025-04-15T08:26:04.6010553Z       âœ“ when leader main with N8N_LICENSE_AUTO_RENEW_ENABLED=true, should enable renewal (9 ms)
2025-04-15T08:26:04.6011684Z       âœ“ when leader main with N8N_LICENSE_AUTO_RENEW_ENABLED=false, should disable renewal (2 ms)
2025-04-15T08:26:04.6013387Z       âœ“ when follower main with N8N_LICENSE_AUTO_RENEW_ENABLED=true, should disable renewal (2 ms)
2025-04-15T08:26:04.6014571Z       âœ“ when follower main with N8N_LICENSE_AUTO_RENEW_ENABLED=false, should disable renewal (2 ms)
2025-04-15T08:26:04.6015766Z       âœ“ when CLI command with N8N_LICENSE_AUTO_RENEW_ENABLED=true, should enable renewal (2 ms)
2025-04-15T08:26:04.6016320Z 
2025-04-15T08:26:05.7907650Z PASS test/integration/commands/import.cmd.test.ts (8.316 s)
2025-04-15T08:26:05.7914936Z   âœ“ import:workflow should import active workflow and deactivate it (99 ms)
2025-04-15T08:26:05.7943979Z   âœ“ import:workflow should import active workflow from combined file and deactivate it (42 ms)
2025-04-15T08:26:05.7945479Z   âœ“ import:workflow can import a single workflow object (30 ms)
2025-04-15T08:26:05.7947203Z   âœ“ `import:workflow --userId ...` should fail if the workflow exists already and is owned by somebody else (87 ms)
2025-04-15T08:26:05.7974122Z   âœ“ only update the workflow, don't create or update the owner if `--userId` is not passed (52 ms)
2025-04-15T08:26:05.7975963Z   âœ“ `import:workflow --projectId ...` should fail if the credential already exists and is owned by another project (49 ms)
2025-04-15T08:26:05.7977815Z   âœ“ `import:workflow --projectId ... --userId ...` fails explaining that only one of the options can be used at a time (6 ms)
2025-04-15T08:26:05.7978853Z 
2025-04-15T08:26:07.6319680Z PASS src/middlewares/list-query/__tests__/list-query.test.ts
2025-04-15T08:26:07.6325914Z   List query middleware
2025-04-15T08:26:07.6336226Z     Query filter
2025-04-15T08:26:07.6340780Z       âœ“ should not set filter on request if none sent (7 ms)
2025-04-15T08:26:07.6345533Z       âœ“ should parse valid filter (6 ms)
2025-04-15T08:26:07.6349747Z       âœ“ should ignore invalid filter (2 ms)
2025-04-15T08:26:07.6354985Z       âœ“ should throw on invalid JSON (35 ms)
2025-04-15T08:26:07.6358363Z       âœ“ should throw on valid filter with invalid type (2 ms)
2025-04-15T08:26:07.6366007Z     Query select
2025-04-15T08:26:07.6366592Z       âœ“ should not set select on request if none sent (1 ms)
2025-04-15T08:26:07.6367218Z       âœ“ should parse valid select (1 ms)
2025-04-15T08:26:07.6367705Z       âœ“ ignore invalid select
2025-04-15T08:26:07.6368205Z       âœ“ throw on invalid JSON (1 ms)
2025-04-15T08:26:07.6368830Z       âœ“ throw on non-string-array JSON for select (1 ms)
2025-04-15T08:26:07.6369280Z     Query pagination
2025-04-15T08:26:07.6369860Z       âœ“ should not set pagination options on request if none sent (1 ms)
2025-04-15T08:26:07.6370495Z       âœ“ should parse valid pagination (1 ms)
2025-04-15T08:26:07.6371560Z       âœ“ should throw on skip without take (6 ms)
2025-04-15T08:26:07.6372068Z       âœ“ should default skip to 0 (1 ms)
2025-04-15T08:26:07.6372494Z       âœ“ should cap take at 50
2025-04-15T08:26:07.6373227Z       âœ“ should throw on non-numeric-integer take (2 ms)
2025-04-15T08:26:07.6373870Z       âœ“ should throw on non-numeric-integer skip (1 ms)
2025-04-15T08:26:07.6374291Z     Query sort by
2025-04-15T08:26:07.6374823Z       âœ“ should succeed validation when sorting by name asc (1 ms)
2025-04-15T08:26:07.6375537Z       âœ“ should succeed validation when sorting by name desc (1 ms)
2025-04-15T08:26:07.6376287Z       âœ“ should succeed validation when sorting by createdAt asc (1 ms)
2025-04-15T08:26:07.6377019Z       âœ“ should succeed validation when sorting by createdAt desc
2025-04-15T08:26:07.6377757Z       âœ“ should succeed validation when sorting by updatedAt asc (2 ms)
2025-04-15T08:26:07.6378484Z       âœ“ should succeed validation when sorting by updatedAt desc
2025-04-15T08:26:07.6379228Z       âœ“ should fail validation when sorting by invalid column (2 ms)
2025-04-15T08:26:07.6380060Z       âœ“ should fail validation when sorting by valid column without order (1 ms)
2025-04-15T08:26:07.6380977Z       âœ“ should fail validation when sorting by valid column with invalid order (1 ms)
2025-04-15T08:26:07.6382123Z       âœ“ should not pass sortBy to listQueryOptions if not provided (1 ms)
2025-04-15T08:26:07.6382627Z     Combinations
2025-04-15T08:26:07.6383212Z       âœ“ should combine filter with select (1 ms)
2025-04-15T08:26:07.6383821Z       âœ“ should combine filter with pagination options (1 ms)
2025-04-15T08:26:07.6384433Z       âœ“ should combine select with pagination options
2025-04-15T08:26:07.6384743Z 
2025-04-15T08:26:07.9444711Z PASS src/environments.ee/source-control/__tests__/source-control.service.test.ts
2025-04-15T08:26:07.9445529Z   SourceControlService
2025-04-15T08:26:07.9445864Z     pushWorkfolder
2025-04-15T08:26:07.9446765Z       âœ“ should throw an error if a file is given that is not in the workfolder (45 ms)
2025-04-15T08:26:07.9447384Z     pullWorkfolder
2025-04-15T08:26:07.9447882Z       âœ“ does not filter locally created credentials (2 ms)
2025-04-15T08:26:07.9448522Z       âœ“ does not filter remotely deleted credentials (1 ms)
2025-04-15T08:26:07.9449296Z       âœ“ should throw an error if a file is given that is not in the workfolder (1 ms)
2025-04-15T08:26:07.9449849Z     getStatus
2025-04-15T08:26:07.9450324Z       âœ“ conflict depends on the value of `direction` (5 ms)
2025-04-15T08:26:07.9450652Z 
2025-04-15T08:26:09.4087856Z PASS src/environments.ee/source-control/__tests__/source-control-export.service.test.ts
2025-04-15T08:26:09.4089197Z   SourceControlExportService
2025-04-15T08:26:09.4099415Z     exportCredentialsToWorkFolder
2025-04-15T08:26:09.4100611Z       âœ“ should export credentials to work folder (13 ms)
2025-04-15T08:26:09.4101325Z       âœ“ should handle team project credentials (2 ms)
2025-04-15T08:26:09.4101956Z       âœ“ should handle missing credentials (10 ms)
2025-04-15T08:26:09.4102460Z     exportTagsToWorkFolder
2025-04-15T08:26:09.4103231Z       âœ“ should export tags to work folder (2 ms)
2025-04-15T08:26:09.4103819Z       âœ“ should not export empty tags (1 ms)
2025-04-15T08:26:09.4104265Z     exportFoldersToWorkFolder
2025-04-15T08:26:09.4104831Z       âœ“ should export folders to work folder (2 ms)
2025-04-15T08:26:09.4105467Z       âœ“ should not export empty folders (1 ms)
2025-04-15T08:26:09.4105988Z     exportVariablesToWorkFolder
2025-04-15T08:26:09.4106597Z       âœ“ should export variables to work folder (1 ms)
2025-04-15T08:26:09.4107259Z       âœ“ should not export empty variables (1 ms)
2025-04-15T08:26:09.4107772Z     exportWorkflowsToWorkFolder
2025-04-15T08:26:09.4108375Z       âœ“ should export workflows to work folder (7 ms)
2025-04-15T08:26:09.4109109Z       âœ“ should throw an error if workflow has no owner (37 ms)
2025-04-15T08:26:09.4109583Z 
2025-04-15T08:26:12.9487415Z PASS src/metrics/__tests__/prometheus-metrics.service.test.ts (5.04 s)
2025-04-15T08:26:12.9488773Z   PrometheusMetricsService
2025-04-15T08:26:12.9489181Z     constructor
2025-04-15T08:26:12.9489982Z       âœ“ should enable metrics based on global config (10 ms)
2025-04-15T08:26:12.9490503Z     init
2025-04-15T08:26:12.9491013Z       âœ“ should set up `n8n_version_info` (1 ms)
2025-04-15T08:26:12.9491872Z       âœ“ should set up default metrics collection with `prom-client` (2 ms)
2025-04-15T08:26:12.9492649Z       âœ“ should set up `n8n_cache_hits_total` (2 ms)
2025-04-15T08:26:12.9493591Z       âœ“ should set up `n8n_cache_misses_total` (2 ms)
2025-04-15T08:26:12.9494308Z       âœ“ should set up `n8n_cache_updates_total` (2 ms)
2025-04-15T08:26:12.9495137Z       âœ“ should set up route metrics with `express-prom-bundle` (3 ms)
2025-04-15T08:26:12.9495870Z       âœ“ should set up event bus metrics (1 ms)
2025-04-15T08:26:12.9496536Z       âœ“ should set up queue metrics if enabled (8 ms)
2025-04-15T08:26:12.9497290Z       âœ“ should not set up queue metrics if enabled but not on scaling mode (2 ms)
2025-04-15T08:26:12.9498250Z       âœ“ should not set up queue metrics if enabled and on scaling mode but instance is not main (1 ms)
2025-04-15T08:26:12.9498987Z       âœ“ should setup active workflow count metric (2 ms)
2025-04-15T08:26:12.9499278Z 
2025-04-15T08:26:14.2965138Z PASS src/__tests__/workflow-execute-additional-data.test.ts
2025-04-15T08:26:14.2966833Z   WorkflowExecuteAdditionalData
2025-04-15T08:26:14.2967845Z     âœ“ logAiEvent should call MessageEventBus (8 ms)
2025-04-15T08:26:14.2968575Z     executeWorkflow
2025-04-15T08:26:14.2969386Z       âœ“ should execute workflow, return data and execution id (6 ms)
2025-04-15T08:26:14.2970299Z       âœ“ should execute workflow, skip waiting (2 ms)
2025-04-15T08:26:14.2971166Z       âœ“ should set sub workflow execution as running (2 ms)
2025-04-15T08:26:14.2972198Z       âœ“ should return waitTill property when workflow execution is waiting (3 ms)
2025-04-15T08:26:14.2973265Z     getRunData
2025-04-15T08:26:14.2973941Z       âœ“ should throw error to add trigger ndoe (22 ms)
2025-04-15T08:26:14.2974682Z       âœ“ should return default data (2 ms)
2025-04-15T08:26:14.2975482Z       âœ“ should return run data with input data and metadata (2 ms)
2025-04-15T08:26:14.2976065Z 
2025-04-15T08:26:15.5681011Z PASS test/integration/community-packages.api.test.ts (7.413 s)
2025-04-15T08:26:15.5681826Z   GET /community-packages
2025-04-15T08:26:15.5687037Z     âœ“ should respond 200 if no nodes are installed (57 ms)
2025-04-15T08:26:15.5689101Z     âœ“ should return list of one installed package and node (12 ms)
2025-04-15T08:26:15.5691945Z     âœ“ should return list of multiple installed packages and nodes (12 ms)
2025-04-15T08:26:15.5694569Z     âœ“ should not check for updates if no packages installed (26 ms)
2025-04-15T08:26:15.5695446Z     âœ“ should check for updates if packages installed (11 ms)
2025-04-15T08:26:15.5696248Z     âœ“ should report package updates if available (9 ms)
2025-04-15T08:26:15.5696802Z   POST /community-packages
2025-04-15T08:26:15.5697468Z     âœ“ should reject if package name is missing (9 ms)
2025-04-15T08:26:15.5698238Z     âœ“ should reject if package is duplicate (9 ms)
2025-04-15T08:26:15.5699089Z     âœ“ should allow installing packages that could not be loaded (8 ms)
2025-04-15T08:26:15.5699894Z     âœ“ should not install a banned package (8 ms)
2025-04-15T08:26:15.5700397Z   DELETE /community-packages
2025-04-15T08:26:15.5701089Z     âœ“ should not delete if package name is empty (14 ms)
2025-04-15T08:26:15.5701847Z     âœ“ should reject if package is not installed (9 ms)
2025-04-15T08:26:15.5702541Z     âœ“ should uninstall package (8 ms)
2025-04-15T08:26:15.5703315Z   PATCH /community-packages
2025-04-15T08:26:15.5703965Z     âœ“ should reject if package name is empty (8 ms)
2025-04-15T08:26:15.5704726Z     âœ“ should reject if package is not installed (7 ms)
2025-04-15T08:26:15.5705370Z     âœ“ should update a package (24 ms)
2025-04-15T08:26:15.5705680Z 
2025-04-15T08:26:18.9329677Z PASS src/services/__tests__/workflow-statistics.service.test.ts
2025-04-15T08:26:18.9332211Z   WorkflowStatisticsService
2025-04-15T08:26:18.9334629Z     workflowExecutionCompleted
2025-04-15T08:26:18.9335606Z       âœ“ should create metrics for production successes (9 ms)
2025-04-15T08:26:18.9336508Z       âœ“ should only create metrics for production successes (1 ms)
2025-04-15T08:26:18.9337351Z       âœ“ should not send metrics for updated entries (1 ms)
2025-04-15T08:26:18.9337931Z     nodeFetchedData
2025-04-15T08:26:18.9338573Z       âœ“ should create metrics when the db is updated (1 ms)
2025-04-15T08:26:18.9339531Z       âœ“ should emit event with no `userId` if workflow is owned by team project (1 ms)
2025-04-15T08:26:18.9340612Z       âœ“ should create metrics with credentials when the db is updated (2 ms)
2025-04-15T08:26:18.9341670Z       âœ“ should not send metrics for entries that already have the flag set (2 ms)
2025-04-15T08:26:18.9342191Z 
2025-04-15T08:26:21.6592094Z PASS test/integration/workflow-history.api.test.ts (8.453 s)
2025-04-15T08:26:21.6593204Z   GET /workflow-history/:workflowId
2025-04-15T08:26:21.6594730Z     âœ“ should not work when license is not available (34 ms)
2025-04-15T08:26:21.6595577Z     âœ“ should not return anything on an invalid workflow ID (48 ms)
2025-04-15T08:26:21.6596518Z     âœ“ should not return anything if not shared with user (27 ms)
2025-04-15T08:26:21.6597663Z     âœ“ should return any empty list if no versions (32 ms)
2025-04-15T08:26:21.6598779Z     âœ“ should return versions for workflow (52 ms)
2025-04-15T08:26:21.6611545Z     âœ“ should return versions only for workflow id provided (64 ms)
2025-04-15T08:26:21.6618104Z     âœ“ should work with take parameter (38 ms)
2025-04-15T08:26:21.6618779Z     âœ“ should work with skip parameter (36 ms)
2025-04-15T08:26:21.6619452Z   GET /workflow-history/workflow/:workflowId/version/:versionId
2025-04-15T08:26:21.6620285Z     âœ“ should not work when license is not available (8 ms)
2025-04-15T08:26:21.6621110Z     âœ“ should not return anything on an invalid workflow ID (18 ms)
2025-04-15T08:26:21.6621977Z     âœ“ should not return anything on an invalid version ID (24 ms)
2025-04-15T08:26:21.6622891Z     âœ“ should return version (31 ms)
2025-04-15T08:26:21.6623626Z     âœ“ should not return anything if not shared with user (31 ms)
2025-04-15T08:26:21.6624756Z     âœ“ should not return anything if not shared with user and using workflow owned by unshared user (32 ms)
2025-04-15T08:26:21.6625433Z 
2025-04-15T08:26:22.9789391Z PASS test/integration/commands/credentials.cmd.test.ts (8.411 s)
2025-04-15T08:26:22.9791198Z   âœ“ import:credentials should import a credential (77 ms)
2025-04-15T08:26:22.9820951Z   âœ“ import:credentials should import a credential from separated files (38 ms)
2025-04-15T08:26:22.9822912Z   âœ“ `import:credentials --userId ...` should fail if the credential exists already and is owned by somebody else (91 ms)
2025-04-15T08:26:22.9824916Z   âœ“ only update credential, don't create or update owner if neither `--userId` nor `--projectId` is passed (48 ms)
2025-04-15T08:26:22.9826738Z   âœ“ `import:credential --projectId ...` should fail if the credential already exists and is owned by another project (53 ms)
2025-04-15T08:26:22.9828634Z   âœ“ `import:credential --projectId ... --userId ...` fails explaining that only one of the options can be used at a time (9 ms)
2025-04-15T08:26:22.9829754Z 
2025-04-15T08:26:23.5943561Z PASS src/__tests__/wait-tracker.test.ts
2025-04-15T08:26:23.5985657Z   WaitTracker
2025-04-15T08:26:23.5989393Z     init()
2025-04-15T08:26:23.5990275Z       âœ“ should query DB for waiting executions if leader (9 ms)
2025-04-15T08:26:23.5990980Z       âœ“ if follower, should do nothing (2 ms)
2025-04-15T08:26:23.5991634Z       âœ“ if no executions to start, should do nothing (2 ms)
2025-04-15T08:26:23.5992116Z       if execution to start
2025-04-15T08:26:23.5992972Z         âœ“ if not enough time passed, should not start execution (3 ms)
2025-04-15T08:26:23.5993746Z         âœ“ if enough time passed, should start execution (7 ms)
2025-04-15T08:26:23.5994241Z     startExecution()
2025-04-15T08:26:23.5994762Z       âœ“ should query for execution to start (3 ms)
2025-04-15T08:26:23.5996038Z       âœ“ should also resume parent execution once sub-workflow finishes (7 ms)
2025-04-15T08:26:23.5996590Z     single-main setup
2025-04-15T08:26:23.5996986Z       âœ“ should start tracking (2 ms)
2025-04-15T08:26:23.5997319Z     multi-main setup
2025-04-15T08:26:23.5997743Z       âœ“ should start tracking if leader (1 ms)
2025-04-15T08:26:23.5998292Z       âœ“ should not start tracking if follower (1 ms)
2025-04-15T08:26:23.5998603Z 
2025-04-15T08:26:25.0318090Z PASS src/services/__tests__/ownership.service.test.ts
2025-04-15T08:26:25.0319268Z   OwnershipService
2025-04-15T08:26:25.0319902Z     getWorkflowProjectCached()
2025-04-15T08:26:25.0321124Z       âœ“ should retrieve a workflow owner project (7 ms)
2025-04-15T08:26:25.0322189Z       âœ“ should throw if no workflow owner project found (15 ms)
2025-04-15T08:26:25.0323250Z     getPersonalProjectOwnerCached()
2025-04-15T08:26:25.0324067Z       âœ“ should retrieve a project owner (1 ms)
2025-04-15T08:26:25.0325075Z       âœ“ should not throw if no project owner found, should return null instead
2025-04-15T08:26:25.0326303Z       âœ“ should not use the repository if the owner was found in the cache (2 ms)
2025-04-15T08:26:25.0327115Z     getProjectOwnerCached()
2025-04-15T08:26:25.0327864Z       âœ“ should retrieve a project owner
2025-04-15T08:26:25.0329572Z       âœ“ should not throw if no project owner found, should return null instead (1 ms)
2025-04-15T08:26:25.0330482Z     addOwnedByAndSharedWith()
2025-04-15T08:26:25.0331382Z       âœ“ should add `ownedBy` and `sharedWith` to credential (2 ms)
2025-04-15T08:26:25.0332507Z       âœ“ should add `ownedBy` and `sharedWith` to workflow (1 ms)
2025-04-15T08:26:25.0333856Z       âœ“ should produce an empty sharedWith if no sharee (1 ms)
2025-04-15T08:26:25.0334788Z     getInstanceOwner()
2025-04-15T08:26:25.0335485Z       âœ“ should find owner using global owner role ID
2025-04-15T08:26:25.0335833Z 
2025-04-15T08:26:26.9994003Z PASS src/services/cache/__tests__/cache.service.test.ts
2025-04-15T08:26:26.9999043Z   memory
2025-04-15T08:26:27.0037986Z     init
2025-04-15T08:26:27.0038691Z       âœ“ should select backend based on config (7 ms)
2025-04-15T08:26:27.0039283Z       âœ“ should honor max size when enough (2 ms)
2025-04-15T08:26:27.0039848Z       âœ“ should honor max size when not enough (2 ms)
2025-04-15T08:26:27.0040280Z     set
2025-04-15T08:26:27.0040658Z       âœ“ should set a string value (4 ms)
2025-04-15T08:26:27.0041144Z       âœ“ should set a number value (1 ms)
2025-04-15T08:26:27.0041631Z       âœ“ should set an object value (3 ms)
2025-04-15T08:26:27.0042225Z       âœ“ should not cache `null` or `undefined` values (1 ms)
2025-04-15T08:26:27.0043017Z       âœ“ should disregard zero-length keys (1 ms)
2025-04-15T08:26:27.0043590Z       âœ“ should honor ttl (202 ms)
2025-04-15T08:26:27.0043974Z     get
2025-04-15T08:26:27.0044456Z       âœ“ should fall back to fallback value (1 ms)
2025-04-15T08:26:27.0045042Z       âœ“ should refresh value (2 ms)
2025-04-15T08:26:27.0045644Z       âœ“ should handle non-ASCII key (1 ms)
2025-04-15T08:26:27.0046117Z     delete
2025-04-15T08:26:27.0046586Z       âœ“ should delete a key (1 ms)
2025-04-15T08:26:27.0047142Z       âœ“ should handle non-ASCII key (2 ms)
2025-04-15T08:26:27.0047619Z     setMany
2025-04-15T08:26:27.0048164Z       âœ“ should set multiple string values (2 ms)
2025-04-15T08:26:27.0048839Z       âœ“ should set multiple number values (1 ms)
2025-04-15T08:26:27.0049486Z       âœ“ should disregard zero-length keys (1 ms)
2025-04-15T08:26:27.0049940Z     getMany
2025-04-15T08:26:27.0050512Z       âœ“ should return undefined on missing result (1 ms)
2025-04-15T08:26:27.0051023Z     setHash
2025-04-15T08:26:27.0051538Z       âœ“ should set a hash if non-existing (1 ms)
2025-04-15T08:26:27.0052210Z       âœ“ should add to a hash value if existing (1 ms)
2025-04-15T08:26:27.0052925Z     deleteFromHash
2025-04-15T08:26:27.0053479Z       âœ“ should delete a hash field (1 ms)
2025-04-15T08:26:27.0053942Z     getHashValue
2025-04-15T08:26:27.0054467Z       âœ“ should return a hash field value
2025-04-15T08:26:27.0055419Z   redis
2025-04-15T08:26:27.0055718Z     init
2025-04-15T08:26:27.0056258Z       âœ“ should select backend based on config (2 ms)
2025-04-15T08:26:27.0057057Z       âœ“ with auto backend and queue mode, should select redis (2 ms)
2025-04-15T08:26:27.0057602Z     set
2025-04-15T08:26:27.0058081Z       âœ“ should set a string value (1 ms)
2025-04-15T08:26:27.0058712Z       âœ“ should set a number value (1 ms)
2025-04-15T08:26:27.0059336Z       âœ“ should set an object value (1 ms)
2025-04-15T08:26:27.0060031Z       âœ“ should not cache `null` or `undefined` values
2025-04-15T08:26:27.0060724Z       âœ“ should disregard zero-length keys (1 ms)
2025-04-15T08:26:27.0061312Z       âœ“ should honor ttl (202 ms)
2025-04-15T08:26:27.0061690Z     get
2025-04-15T08:26:27.0062168Z       âœ“ should fall back to fallback value (1 ms)
2025-04-15T08:26:27.0062916Z       âœ“ should refresh value
2025-04-15T08:26:27.0063516Z       âœ“ should handle non-ASCII key (1 ms)
2025-04-15T08:26:27.0063967Z     delete
2025-04-15T08:26:27.0064429Z       âœ“ should delete a key (1 ms)
2025-04-15T08:26:27.0065041Z       âœ“ should handle non-ASCII key (1 ms)
2025-04-15T08:26:27.0065492Z     setMany
2025-04-15T08:26:27.0066009Z       âœ“ should set multiple string values (2 ms)
2025-04-15T08:26:27.0066651Z       âœ“ should set multiple number values (1 ms)
2025-04-15T08:26:27.0067722Z       âœ“ should disregard zero-length keys (1 ms)
2025-04-15T08:26:27.0068193Z     getMany
2025-04-15T08:26:27.0068731Z       âœ“ should return undefined on missing result (1 ms)
2025-04-15T08:26:27.0069241Z     setHash
2025-04-15T08:26:27.0069757Z       âœ“ should set a hash if non-existing (1 ms)
2025-04-15T08:26:27.0070439Z       âœ“ should add to a hash value if existing (1 ms)
2025-04-15T08:26:27.0070927Z     deleteFromHash
2025-04-15T08:26:27.0071416Z       âœ“ should delete a hash field (1 ms)
2025-04-15T08:26:27.0071871Z     getHashValue
2025-04-15T08:26:27.0072378Z       âœ“ should return a hash field value
2025-04-15T08:26:27.0072917Z 
2025-04-15T08:26:31.2581329Z PASS test/integration/executions/pre-execution-checks/credentials-permission-checker.test.ts (6.003 s)
2025-04-15T08:26:31.2586261Z   check()
2025-04-15T08:26:31.2590556Z     âœ“ should allow if workflow has no creds (24 ms)
2025-04-15T08:26:31.2591813Z     âœ“ should allow if workflow creds are valid subset (35 ms)
2025-04-15T08:26:31.2595044Z     âœ“ should deny if workflow creds are not valid subset (39 ms)
2025-04-15T08:26:31.2596385Z     âœ“ should allow all credentials if current user is instance owner (22 ms)
2025-04-15T08:26:31.2597450Z 
2025-04-15T08:26:31.6041872Z PASS test/integration/public-api/users.ee.test.ts (8.308 s)
2025-04-15T08:26:31.6044563Z   With license unlimited quota:users
2025-04-15T08:26:31.6045041Z     GET /users
2025-04-15T08:26:31.6045795Z       âœ“ should fail due to missing API Key (469 ms)
2025-04-15T08:26:31.6046506Z       âœ“ should fail due to invalid API Key (13 ms)
2025-04-15T08:26:31.6047419Z       âœ“ should fail due to member trying to access owner only endpoint (161 ms)
2025-04-15T08:26:31.6048269Z       âœ“ should return all users (32 ms)
2025-04-15T08:26:31.6048978Z       âœ“ should return users filtered by project ID (49 ms)
2025-04-15T08:26:31.6049500Z     GET /users/:id
2025-04-15T08:26:31.6050079Z       âœ“ should fail due to missing API Key (20 ms)
2025-04-15T08:26:31.6050769Z       âœ“ should fail due to invalid API Key (18 ms)
2025-04-15T08:26:31.6051645Z       âœ“ should fail due to member trying to access owner only endpoint (25 ms)
2025-04-15T08:26:31.6052465Z       âœ“ should return 404 for non-existing id  (24 ms)
2025-04-15T08:26:31.6053341Z       âœ“ should return a pending user (24 ms)
2025-04-15T08:26:31.6053829Z     GET /users/:email
2025-04-15T08:26:31.6054442Z       âœ“ with non-existing email should return 404 (23 ms)
2025-04-15T08:26:31.6055082Z       âœ“ should return a user (22 ms)
2025-04-15T08:26:31.6055576Z   With license without quota:users
2025-04-15T08:26:31.6056215Z     âœ“ GET /users should fail due to invalid license (22 ms)
2025-04-15T08:26:31.6057002Z     âœ“ GET /users/:id should fail due to invalid license (17 ms)
2025-04-15T08:26:31.6057883Z 
2025-04-15T08:26:34.9452984Z PASS src/controllers/__tests__/binary-data.controller.test.ts
2025-04-15T08:26:34.9453681Z   BinaryDataController
2025-04-15T08:26:34.9454015Z     get
2025-04-15T08:26:34.9454749Z       âœ“ should return 400 if binary data mode is missing (7 ms)
2025-04-15T08:26:34.9455548Z       âœ“ should return 400 if binary data mode is invalid (1 ms)
2025-04-15T08:26:34.9456211Z       âœ“ should return 404 if file is not found (2 ms)
2025-04-15T08:26:34.9457037Z       âœ“ should set Content-Type and Content-Length from query if provided (1 ms)
2025-04-15T08:26:34.9458053Z       âœ“ should set Content-Type and Content-Length from metadata if not provided (2 ms)
2025-04-15T08:26:34.9458946Z       âœ“ should set Content-Disposition for download action (1 ms)
2025-04-15T08:26:34.9459721Z       âœ“ should set Content-Security-Policy for HTML in view mode
2025-04-15T08:26:34.9460550Z       âœ“ should not set Content-Security-Policy for HTML in download mode
2025-04-15T08:26:34.9461311Z       âœ“ should return the file stream on success (1 ms)
2025-04-15T08:26:34.9461749Z     getSigned
2025-04-15T08:26:34.9462278Z       âœ“ should return 400 if binary data mode is missing (1 ms)
2025-04-15T08:26:34.9473375Z       âœ“ should return 400 if binary data mode is invalid (2 ms)
2025-04-15T08:26:34.9475459Z       âœ“ should return 400 if token is invalid (10 ms)
2025-04-15T08:26:34.9476105Z       âœ“ should return 404 if file is not found (1 ms)
2025-04-15T08:26:34.9476836Z       âœ“ should return the file stream on a valid signed token (1 ms)
2025-04-15T08:26:34.9477246Z 
2025-04-15T08:26:35.1973430Z PASS src/environments.ee/source-control/__tests__/source-control-helper.ee.test.ts (7.971 s)
2025-04-15T08:26:35.1980373Z   Source Control
2025-04-15T08:26:35.1981236Z     âœ“ should generate an SSH key pair (104 ms)
2025-04-15T08:26:35.1981922Z     âœ“ should generate an RSA key pair (4834 ms)
2025-04-15T08:26:35.1983080Z     âœ“ should check for git and ssh folders and create them if required (2 ms)
2025-04-15T08:26:35.1984077Z     âœ“ should get repo type from url (1 ms)
2025-04-15T08:26:35.1984827Z     âœ“ should get tracking information from pre-push results (2 ms)
2025-04-15T08:26:35.1985700Z     âœ“ should get tracking information from post-push results (1 ms)
2025-04-15T08:26:35.1986557Z     âœ“ should get tracking information from pull results
2025-04-15T08:26:35.1986952Z 
2025-04-15T08:26:38.2259774Z PASS test/integration/workflows/workflow.service.ee.test.ts (6.744 s)
2025-04-15T08:26:38.2263771Z   EnterpriseWorkflowService
2025-04-15T08:26:38.2266591Z     validateWorkflowCredentialUsage
2025-04-15T08:26:38.2269934Z       âœ“ Should throw error saving a workflow using credential without access (38 ms)
2025-04-15T08:26:38.2293002Z       âœ“ Should not throw error when saving a workflow using credential with access (2 ms)
2025-04-15T08:26:38.2294368Z       âœ“ Should not throw error when saving a workflow removing node without credential access (2 ms)
2025-04-15T08:26:38.2295523Z       âœ“ Should save fine when not making changes to workflow without access (3 ms)
2025-04-15T08:26:38.2296663Z       âœ“ Should throw error saving a workflow adding node without credential access (2 ms)
2025-04-15T08:26:38.2297356Z     getNodesWithInaccessibleCreds
2025-04-15T08:26:38.2298185Z       âœ“ Should return an empty list for a workflow without nodes (2 ms)
2025-04-15T08:26:38.2299274Z       âœ“ Should return an empty list for a workflow with nodes without credentials (2 ms)
2025-04-15T08:26:38.2300348Z       âœ“ Should return an element for a node with a credential without access (2 ms)
2025-04-15T08:26:38.2301406Z       âœ“ Should return an empty list for a node with a credential with access (2 ms)
2025-04-15T08:26:38.2302419Z       âœ“ Should return an element for a node with two credentials and mixed access (2 ms)
2025-04-15T08:26:38.2303703Z       âœ“ Should return one node for a workflow with two nodes and two credentials (1 ms)
2025-04-15T08:26:38.2304836Z       âœ“ Should return one element for a workflows with two nodes and one credential (2 ms)
2025-04-15T08:26:38.2306619Z       âœ“ Should return one element for a workflows with two nodes and partial credential access (2 ms)
2025-04-15T08:26:38.2307986Z       âœ“ Should return two elements for a workflows with two nodes and partial credential access (1 ms)
2025-04-15T08:26:38.2309320Z       âœ“ Should return two elements for a workflows with two nodes and no credential access (1 ms)
2025-04-15T08:26:38.2309927Z 
2025-04-15T08:26:39.8506452Z PASS src/environments.ee/source-control/__tests__/source-control-import.service.ee.test.ts
2025-04-15T08:26:39.8508649Z   SourceControlImportService
2025-04-15T08:26:39.8513201Z     getRemoteVersionIdsFromFiles
2025-04-15T08:26:39.8518073Z       âœ“ should parse workflow files correctly (9 ms)
2025-04-15T08:26:39.8522919Z       âœ“ should filter out files without valid workflow data
2025-04-15T08:26:39.8527412Z     getRemoteCredentialsFromFiles
2025-04-15T08:26:39.8532054Z       âœ“ should parse credential files correctly (1 ms)
2025-04-15T08:26:39.8536960Z       âœ“ should filter out files without valid credential data
2025-04-15T08:26:39.8541463Z     getRemoteVariablesFromFile
2025-04-15T08:26:39.8546220Z       âœ“ should parse variables file correctly (1 ms)
2025-04-15T08:26:39.8550977Z       âœ“ should return empty array if no variables file found (1 ms)
2025-04-15T08:26:39.8555987Z     getRemoteTagsAndMappingsFromFile
2025-04-15T08:26:39.8560538Z       âœ“ should parse tags and mappings file correctly (1 ms)
2025-04-15T08:26:39.8565563Z       âœ“ should return empty tags and mappings if no file found (1 ms)
2025-04-15T08:26:39.8570207Z     getRemoteFoldersAndMappingsFromFile
2025-04-15T08:26:39.8575453Z       âœ“ should parse folders and mappings file correctly (1 ms)
2025-04-15T08:26:39.8580374Z       âœ“ should return empty folders and mappings if no file found (1 ms)
2025-04-15T08:26:39.8584451Z     getLocalVersionIdsFromDb
2025-04-15T08:26:39.8587264Z       âœ“ should replace invalid updatedAt with current timestamp (5 ms)
2025-04-15T08:26:39.8593565Z     getLocalFoldersAndMappingsFromDb
2025-04-15T08:26:39.8594254Z       âœ“ should return data from DB (2 ms)
2025-04-15T08:26:39.8594575Z 
2025-04-15T08:26:40.1034589Z PASS src/controllers/__tests__/dynamic-node-parameters.controller.test.ts
2025-04-15T08:26:40.1035849Z   DynamicNodeParametersController
2025-04-15T08:26:40.1038385Z     getOptions
2025-04-15T08:26:40.1039339Z       âœ“ should call getOptionsViaMethodName when methodName is provided (9 ms)
2025-04-15T08:26:40.1040401Z       âœ“ should call getOptionsViaLoadOptions when loadOptions is provided (1 ms)
2025-04-15T08:26:40.1041465Z       âœ“ should return empty array when no method or load options are provided (1 ms)
2025-04-15T08:26:40.1042124Z     getResourceLocatorResults
2025-04-15T08:26:40.1043156Z       âœ“ should call getResourceLocatorResults with correct parameters (2 ms)
2025-04-15T08:26:40.1043808Z     getResourceMappingFields
2025-04-15T08:26:40.1044546Z       âœ“ should call getResourceMappingFields with correct parameters (1 ms)
2025-04-15T08:26:40.1045189Z     getLocalResourceMappingFields
2025-04-15T08:26:40.1045935Z       âœ“ should call getLocalResourceMappingFields with correct parameters (3 ms)
2025-04-15T08:26:40.1046512Z     getActionResult
2025-04-15T08:26:40.1047070Z       âœ“ should call getActionResult with correct parameters (1 ms)
2025-04-15T08:26:40.1047477Z 
2025-04-15T08:26:58.2471839Z PASS test/integration/security-audit/instance-risk-reporter.test.ts (18.136 s)
2025-04-15T08:26:58.2478892Z   âœ“ should report webhook lacking authentication (518 ms)
2025-04-15T08:26:58.2483759Z   âœ“ should not report webhooks having basic or header auth (17 ms)
2025-04-15T08:26:58.2488020Z   âœ“ should not report webhooks validated by direct children (40 ms)
2025-04-15T08:26:58.2492189Z   âœ“ should not report non-webhook node (15 ms)
2025-04-15T08:26:58.2500972Z   âœ“ should report outdated instance when outdated (8 ms)
2025-04-15T08:26:58.2503203Z   âœ“ should not report outdated instance when up to date (90 ms)
2025-04-15T08:26:58.2510792Z   âœ“ should report security settings (9 ms)
2025-04-15T08:26:58.2511524Z 
2025-04-15T08:26:58.2687115Z PASS test/integration/public-api/users.test.ts (19.787 s)
2025-04-15T08:26:58.2687713Z   Users in Public API
2025-04-15T08:26:58.2688052Z     POST /users
2025-04-15T08:26:58.2690702Z       âœ“ if not authenticated, should reject (31 ms)
2025-04-15T08:26:58.2694651Z       âœ“ if missing scope, should reject (173 ms)
2025-04-15T08:26:58.2695230Z       âœ“ should create a user (79 ms)
2025-04-15T08:26:58.2695602Z     DELETE /users/:id
2025-04-15T08:26:58.2696085Z       âœ“ if not authenticated, should reject (15 ms)
2025-04-15T08:26:58.2698860Z       âœ“ if missing scope, should reject (79 ms)
2025-04-15T08:26:58.2699533Z       âœ“ should delete a user (99 ms)
2025-04-15T08:26:58.2699913Z     PATCH /users/:id/role
2025-04-15T08:26:58.2700413Z       âœ“ if not authenticated, should reject (13 ms)
2025-04-15T08:26:58.2700970Z       âœ“ if not licensed, should reject (36 ms)
2025-04-15T08:26:58.2701527Z       âœ“ if missing scope, should reject (26 ms)
2025-04-15T08:26:58.2702144Z       âœ“ should return a 400 on invalid payload (27 ms)
2025-04-15T08:26:58.2702865Z       âœ“ should change a user's role (36 ms)
2025-04-15T08:26:58.2703162Z 
2025-04-15T08:26:58.7293232Z PASS test/integration/webhooks.api.test.ts (18.272 s)
2025-04-15T08:26:58.7293890Z   Webhook API
2025-04-15T08:26:58.7294647Z     Content-Type support
2025-04-15T08:26:58.7295369Z       âœ“ should handle JSON (43 ms)
2025-04-15T08:26:58.7295918Z       âœ“ should handle XML (16 ms)
2025-04-15T08:26:58.7296495Z       âœ“ should handle form-urlencoded (11 ms)
2025-04-15T08:26:58.7297078Z       âœ“ should handle plain text (10 ms)
2025-04-15T08:26:58.7297707Z       âœ“ should handle multipart/form-data (25 ms)
2025-04-15T08:26:58.7298189Z     Params support
2025-04-15T08:26:58.7298668Z       âœ“ should handle params (42 ms)
2025-04-15T08:26:58.7298971Z 
2025-04-15T08:27:01.1051509Z PASS src/webhooks/__tests__/webhook-request-handler.test.ts
2025-04-15T08:27:01.1053076Z   WebhookRequestHandler
2025-04-15T08:27:01.1059841Z     âœ“ should throw for unsupported methods (18 ms)
2025-04-15T08:27:01.1060327Z     preflight requests
2025-04-15T08:27:01.1060935Z       âœ“ should handle missing header for requested method (1 ms)
2025-04-15T08:27:01.1061638Z       âœ“ should handle default origin and max-age (2 ms)
2025-04-15T08:27:01.1062263Z       âœ“ should handle wildcard origin (1 ms)
2025-04-15T08:27:01.1062967Z       âœ“ should handle custom origin (1 ms)
2025-04-15T08:27:01.1063374Z     webhook requests
2025-04-15T08:27:01.1064115Z       âœ“ should delegate the request to the webhook manager and send the response (1 ms)
2025-04-15T08:27:01.1065038Z       âœ“ should send an error response if webhook execution throws (2 ms)
2025-04-15T08:27:01.1065713Z       âœ“ should handle 'DELETE' method (1 ms)
2025-04-15T08:27:01.1066259Z       âœ“ should handle 'GET' method (1 ms)
2025-04-15T08:27:01.1066805Z       âœ“ should handle 'HEAD' method (1 ms)
2025-04-15T08:27:01.1067360Z       âœ“ should handle 'PATCH' method (1 ms)
2025-04-15T08:27:01.1067945Z       âœ“ should handle 'POST' method (1 ms)
2025-04-15T08:27:01.1068474Z       âœ“ should handle 'PUT' method (1 ms)
2025-04-15T08:27:01.1068746Z 
2025-04-15T08:27:03.6485579Z PASS src/webhooks/__tests__/test-webhooks.test.ts (5.042 s)
2025-04-15T08:27:03.6489490Z   TestWebhooks
2025-04-15T08:27:03.6494068Z     needsWebhook()
2025-04-15T08:27:03.6498759Z       âœ“ if webhook is needed, should register then create webhook and return true (7 ms)
2025-04-15T08:27:03.6502544Z       âœ“ if webhook activation fails, should deactivate workflow webhooks (16 ms)
2025-04-15T08:27:03.6510343Z       âœ“ if no webhook is found to start workflow, should return false (1 ms)
2025-04-15T08:27:03.6517399Z       âœ“ returns false if a triggerToStartFrom with triggerData is given
2025-04-15T08:27:03.6518721Z       âœ“ returns true, registers and then creates webhook if triggerToStartFrom is given with no triggerData (2 ms)
2025-04-15T08:27:03.6519575Z     executeWebhook()
2025-04-15T08:27:03.6520215Z       âœ“ if webhook is not registered, should throw (11 ms)
2025-04-15T08:27:03.6521658Z       âœ“ if webhook is registered but missing from workflow, should throw (5 ms)
2025-04-15T08:27:03.6522308Z     deactivateWebhooks()
2025-04-15T08:27:03.6553322Z       âœ“ should add additional data to workflow (2 ms)
2025-04-15T08:27:03.6553768Z 
2025-04-15T08:27:20.2343288Z PASS src/__tests__/workflow-runner.test.ts (21.28 s)
2025-04-15T08:27:20.2348680Z   processError
2025-04-15T08:27:20.2350902Z     âœ“ processError should return early in Bull stalled edge case (75 ms)
2025-04-15T08:27:20.2352041Z     âœ“ processError should return early if the error is `ExecutionNotFoundError` (49 ms)
2025-04-15T08:27:20.2353129Z     âœ“ processError should process error (85 ms)
2025-04-15T08:27:20.2353585Z   run
2025-04-15T08:27:20.2354629Z     âœ“ uses recreateNodeExecutionStack to create a partial execution if a triggerToStartFrom with data is sent (29 ms)
2025-04-15T08:27:20.2356318Z     âœ“ does not use recreateNodeExecutionStack to create a partial execution if a triggerToStartFrom without data is sent (6 ms)
2025-04-15T08:27:20.2357145Z 
2025-04-15T08:27:20.7704099Z PASS test/integration/import.service.test.ts (19.462 s)
2025-04-15T08:27:20.7704826Z   ImportService
2025-04-15T08:27:20.7705641Z     âœ“ should import credless and tagless workflow (54 ms)
2025-04-15T08:27:20.7706892Z     âœ“ should make user owner of imported workflow (14 ms)
2025-04-15T08:27:20.7707640Z     âœ“ should not change the owner if it already exists (67 ms)
2025-04-15T08:27:20.7708445Z     âœ“ should deactivate imported workflow if active (13 ms)
2025-04-15T08:27:20.7711061Z     âœ“ should leave intact new-format credentials (16 ms)
2025-04-15T08:27:20.7721244Z     âœ“ should set tag by identical match (22 ms)
2025-04-15T08:27:20.7731091Z     âœ“ should set tag by name match (17 ms)
2025-04-15T08:27:20.7741279Z     âœ“ should set tag by creating if no match (20 ms)
2025-04-15T08:27:20.7752151Z 
2025-04-15T08:27:23.3479499Z PASS test/integration/security-audit/credentials-risk-reporter.test.ts (19.395 s)
2025-04-15T08:27:23.3485983Z   âœ“ should report credentials not in any use (118 ms)
2025-04-15T08:27:23.3488821Z   âœ“ should report credentials not in active use (13 ms)
2025-04-15T08:27:23.3496419Z   âœ“ should report credential in not recently executed workflow (49 ms)
2025-04-15T08:27:23.3497415Z   âœ“ should not report credentials in recently executed workflow (27 ms)
2025-04-15T08:27:23.3497939Z 
2025-04-15T08:27:24.7741892Z PASS src/webhooks/__tests__/waiting-forms.test.ts
2025-04-15T08:27:24.7748811Z   WaitingForms
2025-04-15T08:27:24.7749178Z     findCompletionPage
2025-04-15T08:27:24.7750218Z       âœ“ should return lastNodeExecuted if it is a non-disabled form completion node (20 ms)
2025-04-15T08:27:24.7751210Z       âœ“ should return undefined if lastNodeExecuted is disabled (1 ms)
2025-04-15T08:27:24.7752058Z       âœ“ should return undefined if lastNodeExecuted is not a form node
2025-04-15T08:27:24.7756825Z       âœ“ should return undefined if lastNodeExecuted operation is not completion (4 ms)
2025-04-15T08:27:24.7758091Z       âœ“ should find first valid completion form in parent nodes if lastNodeExecuted is not valid (2 ms)
2025-04-15T08:27:24.7759282Z       âœ“ should return undefined if no valid completion form is found in parent nodes (1 ms)
2025-04-15T08:27:24.7760194Z       âœ“ should skip parent nodes without runData (1 ms)
2025-04-15T08:27:24.7761069Z       âœ“ should mark as test form webhook when execution mode is manual (3 ms)
2025-04-15T08:27:24.7762098Z       âœ“ should return status of execution if suffix is WAITING_FORMS_EXECUTION_STATUS (2 ms)
2025-04-15T08:27:24.7762645Z 
2025-04-15T08:27:26.7189532Z PASS src/push/__tests__/index.test.ts
2025-04-15T08:27:26.7246806Z   Push
2025-04-15T08:27:26.7250352Z     setupPushServer
2025-04-15T08:27:26.7250749Z       sse backend
2025-04-15T08:27:26.7253454Z         âœ“ should not create a WebSocket server (8 ms)
2025-04-15T08:27:26.7253997Z       websocket backend
2025-04-15T08:27:26.7255596Z         âœ“ should not upgrade non-push urls (3 ms)
2025-04-15T08:27:26.7257195Z         âœ“ should upgrade push url, and route it to express (4 ms)
2025-04-15T08:27:26.7260068Z     handleRequest
2025-04-15T08:27:26.7261123Z       sse backend
2025-04-15T08:27:26.7261742Z         âœ“ should throw if pushRef is invalid (2 ms)
2025-04-15T08:27:26.7264301Z         âœ“ should add the connection if pushRef is valid (2 ms)
2025-04-15T08:27:26.7265710Z         should throw on invalid origin
2025-04-15T08:27:26.7267211Z           âœ“ https://subdomain.example.com (24 ms)
2025-04-15T08:27:26.7268670Z           âœ“ https://123example.com (2 ms)
2025-04-15T08:27:26.7269845Z           âœ“ undefined (2 ms)
2025-04-15T08:27:26.7270237Z       websocket backend
2025-04-15T08:27:26.7270795Z         âœ“ should throw if pushRef is invalid (1 ms)
2025-04-15T08:27:26.7271533Z         âœ“ should add the connection if pushRef is valid (1 ms)
2025-04-15T08:27:26.7272363Z         âœ“ should respond with 401 if request is not WebSocket (1 ms)
2025-04-15T08:27:26.7273174Z         should throw on invalid origin
2025-04-15T08:27:26.7273835Z           âœ“ https://subdomain.example.com (2 ms)
2025-04-15T08:27:26.7274497Z           âœ“ https://123example.com (8 ms)
2025-04-15T08:27:26.7275013Z           âœ“ undefined (2 ms)
2025-04-15T08:27:26.7275269Z 
2025-04-15T08:27:30.0854214Z PASS src/services/pruning/__tests__/pruning.service.test.ts
2025-04-15T08:27:30.0873748Z   PruningService
2025-04-15T08:27:30.0874572Z     init
2025-04-15T08:27:30.0880320Z       âœ“ should start pruning on main instance that is the leader (8 ms)
2025-04-15T08:27:30.0881336Z       âœ“ should not start pruning on main instance that is a follower (1 ms)
2025-04-15T08:27:30.0882341Z       âœ“ should register leadership events if main on multi-main setup (3 ms)
2025-04-15T08:27:30.0883278Z     isEnabled
2025-04-15T08:27:30.0883942Z       âœ“ should return `true` based on config if leader main (1 ms)
2025-04-15T08:27:30.0884748Z       âœ“ should return `false` based on config if leader main
2025-04-15T08:27:30.0885555Z       âœ“ should return `false` if non-main even if config is enabled
2025-04-15T08:27:30.0886514Z       âœ“ should return `false` if follower main even if config is enabled (1 ms)
2025-04-15T08:27:30.0887143Z     startPruning
2025-04-15T08:27:30.0887778Z       âœ“ should not start pruning if service is disabled (1 ms)
2025-04-15T08:27:30.0888705Z       âœ“ should start pruning if service is enabled and DB is migrated (1 ms)
2025-04-15T08:27:30.0889206Z 
2025-04-15T08:27:31.2019293Z PASS test/integration/task-runners/js-task-runner-execution.integration.test.ts (6.126 s)
2025-04-15T08:27:31.2025301Z   JS TaskRunner execution on internal mode
2025-04-15T08:27:31.2029532Z     Basic code execution
2025-04-15T08:27:31.2030357Z       âœ“ should execute a simple JS task (1270 ms)
2025-04-15T08:27:31.2030878Z     Internal and external libs
2025-04-15T08:27:31.2031613Z       âœ“ should allow importing allowed internal module (1394 ms)
2025-04-15T08:27:31.2032468Z       âœ“ should not allow importing disallowed internal module (9 ms)
2025-04-15T08:27:31.2036750Z       âœ“ should allow importing allowed external module (10 ms)
2025-04-15T08:27:31.2037678Z       âœ“ should not allow importing disallowed external module (6 ms)
2025-04-15T08:27:31.2038107Z 
2025-04-15T08:27:34.3399105Z PASS src/__tests__/credentials-helper.test.ts
2025-04-15T08:27:34.3423148Z   CredentialsHelper
2025-04-15T08:27:34.3423500Z     authenticate
2025-04-15T08:27:34.3424214Z       âœ“ basicAuth, default property names (24 ms)
2025-04-15T08:27:34.3424754Z       âœ“ headerAuth (2 ms)
2025-04-15T08:27:34.3425253Z       âœ“ headerAuth, key and value expressions (1 ms)
2025-04-15T08:27:34.3425721Z       âœ“ queryAuth (2 ms)
2025-04-15T08:27:34.3426088Z       âœ“ custom authentication
2025-04-15T08:27:34.3426308Z 
2025-04-15T08:27:37.6974223Z PASS src/commands/db/__tests__/revert.test.ts
2025-04-15T08:27:37.6977062Z   âœ“ don't revert migrations if there is no migration (8 ms)
2025-04-15T08:27:37.6978253Z   âœ“ don't revert the last migration if it had no down migration (1 ms)
2025-04-15T08:27:37.6981064Z   âœ“ print migration name instead of class name in error message if the migration has a name (1 ms)
2025-04-15T08:27:37.6982644Z   âœ“ don't revert the last migration if we cannot find the migration in the code (5 ms)
2025-04-15T08:27:37.6983643Z   âœ“ revert the last migration if it has a down migration (1 ms)
2025-04-15T08:27:37.6984454Z   âœ“ don't use transaction if the last migration has transaction = false
2025-04-15T08:27:37.6984910Z 
2025-04-15T08:27:40.7847750Z PASS src/services/__tests__/public-api-key.service.test.ts (19.776 s)
2025-04-15T08:27:40.7849972Z   PublicApiKeyService
2025-04-15T08:27:40.7851705Z     getAuthMiddleware
2025-04-15T08:27:40.7856422Z       âœ“ should return false if api key is invalid (14 ms)
2025-04-15T08:27:40.7861007Z       âœ“ should return false if valid api key is not in database (5 ms)
2025-04-15T08:27:40.7866220Z       âœ“ should return true if valid api key exist in the database (38 ms)
2025-04-15T08:27:40.7869790Z       âœ“ should return false if expired JWT is used (39 ms)
2025-04-15T08:27:40.7872230Z       âœ“ should work with non JWT (legacy) api keys (15 ms)
2025-04-15T08:27:40.7879256Z     redactApiKey
2025-04-15T08:27:40.7879796Z       âœ“ should redact api key (1 ms)
2025-04-15T08:27:40.7880107Z 
2025-04-15T08:27:42.6054928Z PASS src/scaling/__tests__/worker-server.test.ts
2025-04-15T08:27:42.6055474Z   WorkerServer
2025-04-15T08:27:42.6056198Z     constructor
2025-04-15T08:27:42.6056925Z       âœ“ should throw if non-worker instance type (22 ms)
2025-04-15T08:27:42.6057526Z       âœ“ should exit if port taken (2 ms)
2025-04-15T08:27:42.6057914Z     init
2025-04-15T08:27:42.6058431Z       âœ“ should mount all endpoints when all are enabled (2 ms)
2025-04-15T08:27:42.6059352Z       âœ“ should mount only health and overwrites endpoints if only those are enabled (1 ms)
2025-04-15T08:27:42.6060182Z       âœ“ should throw if no endpoints are enabled (2 ms)
2025-04-15T08:27:42.6060804Z       âœ“ should call `worker.ready` external hook
2025-04-15T08:27:42.6061110Z 
2025-04-15T08:27:45.3845288Z PASS src/deprecation/__tests__/deprecation.service.test.ts
2025-04-15T08:27:45.3846517Z   DeprecationService
2025-04-15T08:27:45.3847792Z     âœ“ should detect when N8N_BINARY_DATA_TTL is `1` (1 ms)
2025-04-15T08:27:45.3848656Z     âœ“ should detect when N8N_PERSISTED_BINARY_DATA_TTL is `1` (1 ms)
2025-04-15T08:27:45.3850268Z     âœ“ should detect when EXECUTIONS_DATA_PRUNE_TIMEOUT is `1` (1 ms)
2025-04-15T08:27:45.3881850Z     âœ“ should detect when N8N_CONFIG_FILES is `1` (1 ms)
2025-04-15T08:27:45.3883106Z     âœ“ should detect when N8N_SKIP_WEBHOOK_DEREGISTRATION_SHUTDOWN is `1` (1 ms)
2025-04-15T08:27:45.3884023Z     âœ“ should detect when N8N_PARTIAL_EXECUTION_VERSION_DEFAULT is `1`
2025-04-15T08:27:45.3884724Z     âœ“ should detect when N8N_PARTIAL_EXECUTION_VERSION_DEFAULT is `2` (1 ms)
2025-04-15T08:27:45.3885342Z     âœ“ should detect when N8N_PARTIAL_EXECUTION_VERSION_DEFAULT is `undefined` (1 ms)
2025-04-15T08:27:45.3885854Z     âœ“ should handle N8N_BINARY_DATA_MODE as default (1 ms)
2025-04-15T08:27:45.3886251Z     âœ“ should handle N8N_BINARY_DATA_MODE as filesystem
2025-04-15T08:27:45.3886649Z     âœ“ should handle N8N_BINARY_DATA_MODE as s3
2025-04-15T08:27:45.3886987Z     âœ“ should handle DB_TYPE as sqlite (1 ms)
2025-04-15T08:27:45.3887310Z     âœ“ should handle DB_TYPE as postgresdb
2025-04-15T08:27:45.3887646Z     âœ“ should handle DB_TYPE as mysqldb (1 ms)
2025-04-15T08:27:45.3887984Z     âœ“ should handle DB_TYPE as mariadb (1 ms)
2025-04-15T08:27:45.3888265Z     N8N_PARTIAL_EXECUTION_VERSION_DEFAULT
2025-04-15T08:27:45.3888711Z       âœ“ supports multiple warnings for the same environment variable (10 ms)
2025-04-15T08:27:45.3889064Z     N8N_RUNNERS_ENABLED
2025-04-15T08:27:45.3889329Z       âœ“ should handle value: false
2025-04-15T08:27:45.3889630Z       âœ“ should handle value:  (1 ms)
2025-04-15T08:27:45.3889913Z       âœ“ should handle value: true
2025-04-15T08:27:45.3890206Z       âœ“ should handle value: undefined
2025-04-15T08:27:45.3890502Z     OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS
2025-04-15T08:27:45.3890778Z       when executions.mode is queue
2025-04-15T08:27:45.3891229Z         âœ“ should warn when OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS is false (1 ms)
2025-04-15T08:27:45.3892112Z         âœ“ should warn when OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS is empty
2025-04-15T08:27:45.3892604Z         âœ“ should not warn when OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS is true
2025-04-15T08:27:45.3895854Z         âœ“ should warn when OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS is undefined (1 ms)
2025-04-15T08:27:45.3896536Z       when executions.mode is not queue
2025-04-15T08:27:45.3897038Z         âœ“ should not warn
2025-04-15T08:27:45.3897466Z 
2025-04-15T08:27:49.5172367Z PASS src/__tests__/active-workflow-manager.test.ts
2025-04-15T08:27:49.5176587Z   ActiveWorkflowManager
2025-04-15T08:27:49.5177044Z     checkIfWorkflowCanBeActivated
2025-04-15T08:27:49.5179005Z       âœ“ should skip disabled nodes (6 ms)
2025-04-15T08:27:49.5185309Z       âœ“ should skip nodes marked as ignored (1 ms)
2025-04-15T08:27:49.5185905Z       âœ“ should skip unknown nodes (1 ms)
2025-04-15T08:27:49.5186480Z       âœ“ should skip nodes with no trigger method (1 ms)
2025-04-15T08:27:49.5187129Z       âœ“ should activate if poll method exists (7 ms)
2025-04-15T08:27:49.5187741Z       âœ“ should activate if trigger method exists (2 ms)
2025-04-15T08:27:49.5188352Z       âœ“ should activate if webhook method exists (1 ms)
2025-04-15T08:27:49.5188777Z     shouldAddWebhooks
2025-04-15T08:27:49.5189502Z       if leader
2025-04-15T08:27:49.5189916Z         âœ“ should return `true` for `init`
2025-04-15T08:27:49.5190527Z         âœ“ should return `false` for `leadershipChange` (1 ms)
2025-04-15T08:27:49.5191208Z         âœ“ should return `true` for `update` or `activate` (1 ms)
2025-04-15T08:27:49.5191666Z       if follower
2025-04-15T08:27:49.5192139Z         âœ“ should return `false` for `update` or `activate`
2025-04-15T08:27:49.5192577Z       add
2025-04-15T08:27:49.5193366Z         âœ“ should skip inactive workflow in `init` activation mode (1 ms)
2025-04-15T08:27:49.5194269Z         âœ“ should skip inactive workflow in `leadershipChange` activation mode (1 ms)
2025-04-15T08:27:49.5194758Z 
2025-04-15T08:27:51.8483712Z PASS test/integration/controllers/dynamic-node-parameters.controller.test.ts (21.522 s)
2025-04-15T08:27:51.8488800Z   DynamicNodeParametersController
2025-04-15T08:27:51.8493546Z     POST /dynamic-node-parameters/options
2025-04-15T08:27:51.8518716Z       âœ“ should take params via body (50 ms)
2025-04-15T08:27:51.8520786Z       âœ“ should take params with loadOptions (12 ms)
2025-04-15T08:27:51.8526619Z       âœ“ should return empty array when no method or loadOptions provided (10 ms)
2025-04-15T08:27:51.8528061Z     POST /dynamic-node-parameters/resource-locator-results
2025-04-15T08:27:51.8529408Z       âœ“ should return resource locator results (8 ms)
2025-04-15T08:27:51.8530568Z       âœ“ should handle resource locator results without pagination (8 ms)
2025-04-15T08:27:51.8531803Z       âœ“ should return a 400 if methodName is not defined (9 ms)
2025-04-15T08:27:51.8532881Z     POST /dynamic-node-parameters/resource-mapper-fields
2025-04-15T08:27:51.8533932Z       âœ“ should return resource mapper fields (8 ms)
2025-04-15T08:27:51.8535117Z       âœ“ should return a 400 if methodName is not defined (8 ms)
2025-04-15T08:27:51.8535950Z     POST /dynamic-node-parameters/local-resource-mapper-fields
2025-04-15T08:27:51.8536813Z       âœ“ should return local resource mapper fields (9 ms)
2025-04-15T08:27:51.8537633Z       âœ“ should return a 400 if methodName is not defined (8 ms)
2025-04-15T08:27:51.8538315Z     POST /dynamic-node-parameters/action-result
2025-04-15T08:27:51.8539078Z       âœ“ should return action result with handler (8 ms)
2025-04-15T08:27:51.8539856Z       âœ“ should return a 400 if handler is not defined (7 ms)
2025-04-15T08:27:51.8540242Z 
2025-04-15T08:27:54.4148081Z PASS src/executions/__tests__/executions.controller.test.ts
2025-04-15T08:27:54.4159634Z   ExecutionsController
2025-04-15T08:27:54.4164451Z     getOne
2025-04-15T08:27:54.4198248Z       âœ“ should 400 when execution is not a number (25 ms)
2025-04-15T08:27:54.4198993Z     getMany
2025-04-15T08:27:54.4200057Z       if either status or range provided
2025-04-15T08:27:54.4200753Z         âœ“ should fetch executions per query (4 ms)
2025-04-15T08:27:54.4201457Z         âœ“ should fetch executions per query (2 ms)
2025-04-15T08:27:54.4202148Z         âœ“ should fetch executions per query (2 ms)
2025-04-15T08:27:54.4203494Z         âœ“ should fetch executions per query (1 ms)
2025-04-15T08:27:54.4204053Z       if neither status nor range provided
2025-04-15T08:27:54.4204686Z         âœ“ should fetch executions per query (1 ms)
2025-04-15T08:27:54.4205320Z         âœ“ should fetch executions per query (1 ms)
2025-04-15T08:27:54.4205859Z       if both status and range provided
2025-04-15T08:27:54.4206508Z         âœ“ should fetch executions per query (2 ms)
2025-04-15T08:27:54.4207203Z     stop
2025-04-15T08:27:54.4208048Z       âœ“ should 404 when execution is inaccessible for user (1 ms)
2025-04-15T08:27:54.4209051Z       âœ“ should call ask for an execution to be stopped
2025-04-15T08:27:54.4209551Z 
2025-04-15T08:27:56.7361628Z PASS src/metrics/__tests__/prometheus-metrics.service.unmocked.test.ts
2025-04-15T08:27:56.7393416Z   workflow_success_total
2025-04-15T08:27:56.7395481Z     âœ“ support workflow id labels (67 ms)
2025-04-15T08:27:56.7397151Z     âœ“ support a custom prefix (3 ms)
2025-04-15T08:27:56.7398627Z   Active workflow count
2025-04-15T08:27:56.7400238Z     âœ“ should prioritize cached value (7 ms)
2025-04-15T08:27:56.7402013Z     âœ“ should query value from database if cache misses (2 ms)
2025-04-15T08:27:56.7403687Z 
2025-04-15T08:27:59.1732393Z PASS src/shutdown/__tests__/shutdown.service.test.ts
2025-04-15T08:27:59.1767788Z   ShutdownService
2025-04-15T08:27:59.1776411Z     shutdown
2025-04-15T08:27:59.1777050Z       âœ“ should signal shutdown (5 ms)
2025-04-15T08:27:59.1777674Z       âœ“ should signal shutdown in the priority order (2 ms)
2025-04-15T08:27:59.1778454Z       âœ“ should throw error if shutdown is already in progress (12 ms)
2025-04-15T08:27:59.1779266Z       âœ“ should report error if component shutdown fails (2 ms)
2025-04-15T08:27:59.1779844Z     waitForShutdown
2025-04-15T08:27:59.1780300Z       âœ“ should wait for shutdown (1 ms)
2025-04-15T08:27:59.1781018Z       âœ“ should throw error if app is not shutting down (1 ms)
2025-04-15T08:27:59.1781513Z     isShuttingDown
2025-04-15T08:27:59.1782002Z       âœ“ should return true if app is shutting down
2025-04-15T08:27:59.1782673Z       âœ“ should return false if app is not shutting down (1 ms)
2025-04-15T08:27:59.1783324Z     validate
2025-04-15T08:27:59.1784039Z       âœ“ should throw error if component is not registered with the DI container (1 ms)
2025-04-15T08:27:59.1785051Z       âœ“ should throw error if component is missing the shutdown method (2 ms)
2025-04-15T08:27:59.1785523Z 
2025-04-15T08:28:01.8426400Z PASS test/integration/collaboration/collaboration.service.test.ts (20.854 s)
2025-04-15T08:28:01.8429329Z   CollaborationService
2025-04-15T08:28:01.8429751Z     workflow opened message
2025-04-15T08:28:01.8430742Z       âœ“ should emit collaboratorsChanged after workflowOpened (38 ms)
2025-04-15T08:28:01.8432497Z       âœ“ should not emit collaboratorsChanged if user don't have access to the workflow (5 ms)
2025-04-15T08:28:01.8433465Z     workflow closed message
2025-04-15T08:28:01.8436677Z       âœ“ should not emit collaboratorsChanged after workflowClosed when there are no active users (15 ms)
2025-04-15T08:28:01.8446438Z       âœ“ should emit collaboratorsChanged after workflowClosed when there are active users (26 ms)
2025-04-15T08:28:01.8447767Z       âœ“ should not emit collaboratorsChanged if user don't have access to the workflow (12 ms)
2025-04-15T08:28:01.8448375Z 
2025-04-15T08:28:02.1319827Z PASS src/services/__tests__/hooks.service.test.ts
2025-04-15T08:28:02.1320476Z   HooksService
2025-04-15T08:28:02.1321985Z     âœ“ hooksService.inviteUsers should call userService.inviteUsers (6 ms)
2025-04-15T08:28:02.1323337Z     âœ“ hooksService.issueCookie should call authService.issueCookie (1 ms)
2025-04-15T08:28:02.1324447Z     âœ“ hooksService.findOneUser should call authUserRepository.findOne (1 ms)
2025-04-15T08:28:02.1325412Z     âœ“ hooksService.saveUser should call userRepository.save
2025-04-15T08:28:02.1326376Z     âœ“ hooksService.updateSettings should call settingRepository.update (1 ms)
2025-04-15T08:28:02.1327439Z     âœ“ hooksService.workflowsCount should call workflowRepository.count
2025-04-15T08:28:02.1328948Z     âœ“ hooksService.credentialsCount should call credentialRepository.count
2025-04-15T08:28:02.1329995Z     âœ“ hooksService.settingsCount should call settingsRepository.count
2025-04-15T08:28:02.1331017Z     âœ“ hooksService.authMiddleware should call authService.authMiddleware
2025-04-15T08:28:02.1332051Z     âœ“ hooksService.dbCollections should return valid repositories (2 ms)
2025-04-15T08:28:02.1333073Z     âœ“ hooksService.getRudderStackClient (1 ms)
2025-04-15T08:28:04.7993722Z 
2025-04-15T08:28:04.7994639Z PASS src/execution-lifecycle/__tests__/restore-binary-data-id.test.ts
2025-04-15T08:28:04.7995346Z   on filesystem-v2 mode
2025-04-15T08:28:04.7996248Z     âœ“ should restore if binary data ID is missing execution ID (8 ms)
2025-04-15T08:28:04.7997212Z     âœ“ should do nothing if binary data ID is not missing execution ID (1 ms)
2025-04-15T08:28:04.7998001Z     âœ“ should do nothing if no binary data ID (1 ms)
2025-04-15T08:28:04.7998647Z     âœ“ should do nothing on itemless case (1 ms)
2025-04-15T08:28:04.7999317Z     âœ“ should do nothing if data is undefined (1 ms)
2025-04-15T08:28:04.8000136Z     âœ“ should do nothing if workflow execution mode is not `webhook` (1 ms)
2025-04-15T08:28:04.8000905Z     âœ“ should ignore error thrown on renaming (2 ms)
2025-04-15T08:28:04.8001363Z   on s3 mode
2025-04-15T08:28:04.8001985Z     âœ“ should restore if binary data ID is missing execution ID (1 ms)
2025-04-15T08:28:04.8003117Z     âœ“ should do nothing if binary data ID is not missing execution ID
2025-04-15T08:28:04.8003869Z     âœ“ should do nothing if no binary data ID
2025-04-15T08:28:04.8004479Z     âœ“ should do nothing on itemless case (1 ms)
2025-04-15T08:28:04.8005110Z     âœ“ should do nothing if data is undefined (2 ms)
2025-04-15T08:28:04.8005896Z     âœ“ should do nothing if workflow execution mode is not `webhook`
2025-04-15T08:28:04.8006638Z     âœ“ should ignore error thrown on renaming (1 ms)
2025-04-15T08:28:04.8007093Z   on default mode
2025-04-15T08:28:04.8007520Z     âœ“ should do nothing (1 ms)
2025-04-15T08:28:04.8007794Z 
2025-04-15T08:28:08.9059490Z PASS src/executions/__tests__/parse-range-query.middleware.test.ts
2025-04-15T08:28:08.9068176Z   `parseRangeQuery` middleware
2025-04-15T08:28:08.9068594Z     errors
2025-04-15T08:28:08.9069271Z       âœ“ should fail on invalid JSON (22 ms)
2025-04-15T08:28:08.9069889Z       âœ“ should fail on invalid schema (7 ms)
2025-04-15T08:28:08.9070317Z     filter
2025-04-15T08:28:08.9070828Z       âœ“ should parse status and mode fields (2 ms)
2025-04-15T08:28:08.9071462Z       âœ“ should parse date-related fields (6 ms)
2025-04-15T08:28:08.9072095Z       âœ“ should parse ID-related fields (2 ms)
2025-04-15T08:28:08.9073127Z       âœ“ should parse `projectId` field (1 ms)
2025-04-15T08:28:08.9074295Z       âœ“ should delete invalid fields (2 ms)
2025-04-15T08:28:08.9074721Z     range
2025-04-15T08:28:08.9075190Z       âœ“ should parse first and last IDs (1 ms)
2025-04-15T08:28:08.9075796Z       âœ“ should parse limit (1 ms)
2025-04-15T08:28:08.9076430Z       âœ“ should default limit to 20 if absent (1 ms)
2025-04-15T08:28:08.9076804Z 
2025-04-15T08:28:15.2439737Z PASS test/integration/services/project.service.test.ts (20.571 s)
2025-04-15T08:28:15.2440833Z   ProjectService
2025-04-15T08:28:15.2442515Z     addUser
2025-04-15T08:28:15.2445797Z       âœ“ creates a relation between the user and the project using the role project:viewer (35 ms)
2025-04-15T08:28:15.2459683Z       âœ“ creates a relation between the user and the project using the role project:admin (15 ms)
2025-04-15T08:28:15.2460775Z       âœ“ creates a relation between the user and the project using the role project:editor (14 ms)
2025-04-15T08:28:15.2461900Z       âœ“ creates a relation between the user and the project using the role project:personalOwner (13 ms)
2025-04-15T08:28:15.2463466Z       âœ“ changes the role the user has in the project if the user is already part of the project, instead of creating a new relationship (24 ms)
2025-04-15T08:28:15.2464275Z     getProjectWithScope
2025-04-15T08:28:15.2465557Z       âœ“ should return the project if the user has the role project:admin and wants the scope workflow:list (18 ms)
2025-04-15T08:28:15.2466794Z       âœ“ should return the project if the user has the role project:admin and wants the scope workflow:create (14 ms)
2025-04-15T08:28:15.2468038Z       âœ“ should return the project if the user has the role project:viewer and wants the scope workflow:create (13 ms)
2025-04-15T08:28:15.2469301Z       âœ“ should return the project if the user has the role project:viewer and wants the scope credential:create (12 ms)
2025-04-15T08:28:15.2470302Z       âœ“ should not return the project if the user is not part of it (9 ms)
2025-04-15T08:28:15.2470708Z 
2025-04-15T08:28:17.3376489Z PASS src/__tests__/credentials-overwrites.test.ts
2025-04-15T08:28:17.3377114Z   CredentialsOverwrites
2025-04-15T08:28:17.3377447Z     constructor
2025-04-15T08:28:17.3378231Z       âœ“ should parse and set overwrite data from config (10 ms)
2025-04-15T08:28:17.3382425Z     setData
2025-04-15T08:28:17.3383359Z       âœ“ should reset resolvedTypes when setting new data (1 ms)
2025-04-15T08:28:17.3383894Z     applyOverwrite
2025-04-15T08:28:17.3384434Z       âœ“ should apply overwrites only for empty fields (1 ms)
2025-04-15T08:28:17.3385159Z       âœ“ should return original data if no overwrites exist (1 ms)
2025-04-15T08:28:17.3385639Z     getOverwrites
2025-04-15T08:28:17.3386265Z       âœ“ should return undefined for unrecognized credential type (1 ms)
2025-04-15T08:28:17.3386932Z       âœ“ should cache resolved types (1 ms)
2025-04-15T08:28:17.3387511Z       âœ“ should merge overwrites from parent types (2 ms)
2025-04-15T08:28:17.3387842Z 
2025-04-15T08:28:20.4322235Z PASS src/controllers/__tests__/owner.controller.test.ts
2025-04-15T08:28:20.4330158Z   OwnerController
2025-04-15T08:28:20.4330542Z     setupOwner
2025-04-15T08:28:20.4331536Z       âœ“ should throw a BadRequestError if the instance owner is already setup (29 ms)
2025-04-15T08:28:20.4332471Z       âœ“ should setup the instance owner successfully (5 ms)
2025-04-15T08:28:20.4333233Z     dismissBanner
2025-04-15T08:28:20.4333921Z       âœ“ should not call dismissBanner if no banner is provided (1 ms)
2025-04-15T08:28:20.4334776Z       âœ“ should call dismissBanner with the correct banner name
2025-04-15T08:28:20.4335177Z 
2025-04-15T08:28:22.8392262Z PASS test/integration/credentials-helper.test.ts (20.759 s)
2025-04-15T08:28:22.8398871Z   CredentialsHelper
2025-04-15T08:28:22.8399557Z     credentialOwnedBySuperUsers
2025-04-15T08:28:22.8400398Z       âœ“ owners are super users (31 ms)
2025-04-15T08:28:22.8400977Z       âœ“ admins are super users (13 ms)
2025-04-15T08:28:22.8401560Z       âœ“ owners need to own the credential (11 ms)
2025-04-15T08:28:22.8402074Z       âœ“ admins need to own the credential (12 ms)
2025-04-15T08:28:22.8403236Z       âœ“ members are no super users (10 ms)
2025-04-15T08:28:22.8404161Z       âœ“ credential in team project with instance owner as an admin can use external secrets (21 ms)
2025-04-15T08:28:22.8405328Z       âœ“ credential in team project with instance admin as an admin can use external secrets (16 ms)
2025-04-15T08:28:22.8406538Z       âœ“ credential in team project with instance owner as an editor cannot use external secrets (15 ms)
2025-04-15T08:28:22.8407740Z       âœ“ credential in team project with instance admin as an editor cannot use external secrets (13 ms)
2025-04-15T08:28:22.8409082Z       âœ“ credential in team project with no instance admin or owner as part of the project cannot use external secrets (10 ms)
2025-04-15T08:28:22.8409752Z 
2025-04-15T08:28:23.5531442Z PASS src/execution-lifecycle/__tests__/save-execution-progress.test.ts
2025-04-15T08:28:23.5543323Z   saveExecutionProgress
2025-04-15T08:28:23.5544439Z     âœ“ should not try to update non-existent executions (7 ms)
2025-04-15T08:28:23.5545570Z     âœ“ should handle DB errors on execution lookup (2 ms)
2025-04-15T08:28:23.5546612Z     âœ“ should handle DB errors when updating the execution (1 ms)
2025-04-15T08:28:23.5547462Z     âœ“ should not try to update finished executions
2025-04-15T08:28:23.5548694Z     âœ“ should populate `.data` when it is missing (2 ms)
2025-04-15T08:28:23.5549764Z     âœ“ should augment `.data` if it already exists (1 ms)
2025-04-15T08:28:23.5550705Z     âœ“ should set last executed node correctly
2025-04-15T08:28:23.5551223Z 
2025-04-15T08:28:30.5023736Z PASS test/integration/security-audit/database-risk-reporter.test.ts (21.36 s)
2025-04-15T08:28:30.5033399Z   âœ“ should report expressions in queries (108 ms)
2025-04-15T08:28:30.5036906Z   âœ“ should report expressions in query params (14 ms)
2025-04-15T08:28:30.5037658Z   âœ“ should report unused query params (11 ms)
2025-04-15T08:28:30.5038333Z   âœ“ should not report non-database node (5 ms)
2025-04-15T08:28:30.5038706Z 
2025-04-15T08:28:46.8353696Z PASS test/integration/binary-data.api.test.ts (23.813 s)
2025-04-15T08:28:46.8359874Z   GET /binary-data
2025-04-15T08:28:46.8360704Z     should reject on missing or invalid binary data ID
2025-04-15T08:28:46.8362527Z       âœ“ on request to view (58 ms)
2025-04-15T08:28:46.8363394Z       âœ“ on request to download (15 ms)
2025-04-15T08:28:46.8363895Z     should return binary data [filesystem]
2025-04-15T08:28:46.8367547Z       âœ“ on request to view (11 ms)
2025-04-15T08:28:46.8374284Z       âœ“ on request to download (8 ms)
2025-04-15T08:28:46.8374847Z     should handle non-ASCII filename [filesystem]
2025-04-15T08:28:46.8375450Z       âœ“ on request to download (8 ms)
2025-04-15T08:28:46.8375986Z     should return 404 on file not found [filesystem]
2025-04-15T08:28:46.8376598Z       âœ“ on request to view (7 ms)
2025-04-15T08:28:46.8377119Z       âœ“ on request to download (9 ms)
2025-04-15T08:28:46.8377594Z     should return binary data [s3]
2025-04-15T08:28:46.8378134Z       âœ“ on request to view (7 ms)
2025-04-15T08:28:46.8378678Z       âœ“ on request to download (7 ms)
2025-04-15T08:28:46.8379169Z     should return 404 on file not found [s3]
2025-04-15T08:28:46.8379723Z       âœ“ on request to view (8 ms)
2025-04-15T08:28:46.8380233Z       âœ“ on request to download (6 ms)
2025-04-15T08:28:46.8380549Z 
2025-04-15T08:28:47.6512999Z PASS test/integration/role.api.test.ts (23.858 s)
2025-04-15T08:28:47.6513867Z   GET /roles/
2025-04-15T08:28:47.6514673Z     âœ“ should return all role categories (38 ms)
2025-04-15T08:28:47.6515411Z     âœ“ should return fixed global roles (11 ms)
2025-04-15T08:28:47.6516204Z     âœ“ should return fixed project roles (10 ms)
2025-04-15T08:28:47.6516957Z     âœ“ should return fixed credential sharing roles (8 ms)
2025-04-15T08:28:47.6520895Z     âœ“ should return fixed workflow sharing roles (9 ms)
2025-04-15T08:28:47.6523341Z 
2025-04-15T08:28:49.7010869Z PASS src/push/__tests__/websocket.push.test.ts
2025-04-15T08:28:49.7011520Z   WebSocketPush
2025-04-15T08:28:49.7013007Z     âœ“ can add a connection (8 ms)
2025-04-15T08:28:49.7013712Z     âœ“ closes a connection (1 ms)
2025-04-15T08:28:49.7014301Z     âœ“ sends data to one connection (2 ms)
2025-04-15T08:28:49.7014950Z     âœ“ sends data to all connections (1 ms)
2025-04-15T08:28:49.7015598Z     âœ“ pings all connections (2 ms)
2025-04-15T08:28:49.7016309Z     âœ“ sends data to all users connections (1 ms)
2025-04-15T08:28:49.7017121Z     âœ“ emits message event when connection receives data (3 ms)
2025-04-15T08:28:49.7017949Z     âœ“ emits doesn' emit message for client heartbeat (1 ms)
2025-04-15T08:28:49.7018356Z 
2025-04-15T08:28:51.0383073Z PASS src/external-secrets.ee/__tests__/external-secrets-manager.ee.test.ts
2025-04-15T08:28:51.0391145Z   External Secrets Manager
2025-04-15T08:28:51.0395449Z     âœ“ should get secret (8 ms)
2025-04-15T08:28:51.0399680Z     âœ“ should not throw errors during init (3 ms)
2025-04-15T08:28:51.0404224Z     âœ“ should not throw errors during shutdown (2 ms)
2025-04-15T08:28:51.0408406Z     âœ“ should save provider settings (3 ms)
2025-04-15T08:28:51.0413163Z     âœ“ should call provider update functions on a timer (4 ms)
2025-04-15T08:28:51.0418056Z     âœ“ should not call provider update functions if the not licensed (1 ms)
2025-04-15T08:28:51.0423382Z     âœ“ should not call provider update functions if the provider has an error (1 ms)
2025-04-15T08:28:51.0428931Z     âœ“ should reinitialize a provider when save provider settings (2 ms)
2025-04-15T08:28:51.0433613Z 
2025-04-15T08:28:52.5621814Z PASS src/execution-lifecycle/__tests__/to-save-settings.test.ts
2025-04-15T08:28:52.5622591Z   failed production executions
2025-04-15T08:28:52.5624092Z     âœ“ should favor workflow settings over defaults (7 ms)
2025-04-15T08:28:52.5626837Z     âœ“ should fall back to default if no workflow setting (7 ms)
2025-04-15T08:28:52.5627782Z   successful production executions
2025-04-15T08:28:52.5630748Z     âœ“ should favor workflow settings over defaults (1 ms)
2025-04-15T08:28:52.5634626Z     âœ“ should fall back to default if no workflow setting (1 ms)
2025-04-15T08:28:52.5636129Z   manual executions
2025-04-15T08:28:52.5636773Z     âœ“ should favor workflow setting over default (1 ms)
2025-04-15T08:28:52.5637751Z     âœ“ should favor fall back to default if workflow setting is explicit default (1 ms)
2025-04-15T08:28:52.5638719Z     âœ“ should fall back to default if no workflow setting (1 ms)
2025-04-15T08:28:52.5639323Z   execution progress
2025-04-15T08:28:52.5639947Z     âœ“ should favor workflow setting over default (1 ms)
2025-04-15T08:28:52.5640892Z     âœ“ should favor fall back to default if workflow setting is explicit default (1 ms)
2025-04-15T08:28:52.5641781Z     âœ“ should fall back to default if no workflow setting
2025-04-15T08:28:52.5642145Z 
2025-04-15T08:28:52.6726443Z PASS test/integration/database/repositories/project.repository.test.ts (21.956 s)
2025-04-15T08:28:52.6728431Z   ProjectRepository
2025-04-15T08:28:52.6728788Z     getPersonalProjectForUser
2025-04-15T08:28:52.6729512Z       âœ“ returns the personal project (46 ms)
2025-04-15T08:28:52.6730174Z       âœ“ does not return non personal projects (19 ms)
2025-04-15T08:28:52.6730701Z     getPersonalProjectForUserOrFail
2025-04-15T08:28:52.6731248Z       âœ“ returns the personal project (16 ms)
2025-04-15T08:28:52.6731837Z       âœ“ does not return non personal projects (45 ms)
2025-04-15T08:28:52.6732353Z     update personal project name
2025-04-15T08:28:52.6733476Z       âœ“ do not pass a User instance with circular references into `UserRepository.create` (43 ms)
2025-04-15T08:28:52.6734025Z 
2025-04-15T08:28:55.6501084Z PASS src/webhooks/__tests__/webhook-form-data.test.ts
2025-04-15T08:28:55.6501818Z   webhook-form-data
2025-04-15T08:28:55.6502177Z     createMultiFormDataParser
2025-04-15T08:28:55.6503386Z       âœ“ should parse fields from the multipart form data (66 ms)
2025-04-15T08:28:55.6504259Z       âœ“ should parse text/plain file from the multipart form data (15 ms)
2025-04-15T08:28:55.6505222Z       âœ“ should parse multiple files and fields from the multipart form data (11 ms)
2025-04-15T08:28:55.6506469Z       âœ“ should ignore file that is too large (8 ms)
2025-04-15T08:28:55.6506799Z 
2025-04-15T08:29:17.1702519Z PASS test/integration/license.api.test.ts (25.876 s)
2025-04-15T08:29:17.1705285Z   GET /license
2025-04-15T08:29:17.1707836Z     âœ“ should return license information to the instance owner (57 ms)
2025-04-15T08:29:17.1710384Z     âœ“ should return license information to a regular user (14 ms)
2025-04-15T08:29:17.1712483Z   POST /license/enterprise/request_trial
2025-04-15T08:29:17.1714852Z     âœ“ should work for instance owner (41 ms)
2025-04-15T08:29:17.1716970Z     âœ“ does not work for regular users (12 ms)
2025-04-15T08:29:17.1718882Z   POST /license/activate
2025-04-15T08:29:17.1723717Z     âœ“ should work for instance owner (14 ms)
2025-04-15T08:29:17.1725133Z     âœ“ does not work for regular users (13 ms)
2025-04-15T08:29:17.1725964Z     âœ“ errors out properly (30 ms)
2025-04-15T08:29:17.1728054Z   POST /license/renew
2025-04-15T08:29:17.1728635Z     âœ“ should work for instance owner (12 ms)
2025-04-15T08:29:17.1729292Z     âœ“ does not work for regular users (11 ms)
2025-04-15T08:29:17.1729861Z     âœ“ errors out properly (12 ms)
2025-04-15T08:29:17.1730150Z 
2025-04-15T08:29:18.4079291Z PASS test/integration/controllers/oauth/oauth2.api.test.ts (25.496 s)
2025-04-15T08:29:18.4083435Z   OAuth2 API
2025-04-15T08:29:18.4088980Z     âœ“ should return a valid auth URL when the auth flow is initiated (132 ms)
2025-04-15T08:29:18.4093792Z     âœ“ should fail on auth when callback is called as another user (60 ms)
2025-04-15T08:29:18.4095074Z     âœ“ should handle a valid callback without auth (99 ms)
2025-04-15T08:29:18.4095498Z 
2025-04-15T08:29:20.0201477Z PASS src/task-runners/__tests__/task-runner-process.test.ts
2025-04-15T08:29:20.0202121Z   TaskRunnerProcess
2025-04-15T08:29:20.0202438Z     constructor
2025-04-15T08:29:20.0203471Z       âœ“ should throw if runner mode is external (21 ms)
2025-04-15T08:29:20.0204348Z       âœ“ should register listener for `runner:failed-heartbeat-check` event (2 ms)
2025-04-15T08:29:20.0205333Z       âœ“ should register listener for `runner:timed-out-during-task` event
2025-04-15T08:29:20.0205868Z     start
2025-04-15T08:29:20.0206313Z       âœ“ should propagate PATH from env as is (2 ms)
2025-04-15T08:29:20.0207078Z       âœ“ should propagate NODE_FUNCTION_ALLOW_BUILTIN from env as is (1 ms)
2025-04-15T08:29:20.0207980Z       âœ“ should propagate NODE_FUNCTION_ALLOW_EXTERNAL from env as is (1 ms)
2025-04-15T08:29:20.0208766Z       âœ“ should propagate N8N_SENTRY_DSN from env as is (1 ms)
2025-04-15T08:29:20.0209454Z       âœ“ should propagate N8N_VERSION from env as is (1 ms)
2025-04-15T08:29:20.0210126Z       âœ“ should propagate ENVIRONMENT from env as is (3 ms)
2025-04-15T08:29:20.0210820Z       âœ“ should propagate DEPLOYMENT_NAME from env as is (2 ms)
2025-04-15T08:29:20.0211502Z       âœ“ should propagate NODE_PATH from env as is (1 ms)
2025-04-15T08:29:20.0212198Z       âœ“ should propagate GENERIC_TIMEZONE from env as is (1 ms)
2025-04-15T08:29:20.0213319Z       âœ“ should pass NODE_OPTIONS env if maxOldSpaceSize is configured (1 ms)
2025-04-15T08:29:20.0214382Z       âœ“ should not pass NODE_OPTIONS env if maxOldSpaceSize is not configured (10 ms)
2025-04-15T08:29:20.0215652Z       âœ“ should use --disallow-code-generation-from-strings and --disable-proto=delete flags (2 ms)
2025-04-15T08:29:20.0216342Z 
2025-04-15T08:29:21.1158802Z PASS test/integration/credentials/credentials.service.test.ts (25.194 s)
2025-04-15T08:29:21.1161555Z   credentials service
2025-04-15T08:29:21.1163709Z     replaceCredentialContentsForSharee
2025-04-15T08:29:21.1166384Z       âœ“ should replace the contents of the credential for sharee (25 ms)
2025-04-15T08:29:21.1168984Z       âœ“ should replace the contents of the credential for project viewer (42 ms)
2025-04-15T08:29:21.1171602Z       âœ“ should not replace the contents of the credential for project editor (27 ms)
2025-04-15T08:29:21.1176694Z 
2025-04-15T08:29:21.7233617Z PASS src/sso.ee/saml/__tests__/saml.service.ee.test.ts
2025-04-15T08:29:21.7234339Z   SamlService
2025-04-15T08:29:21.7235647Z     getAttributesFromLoginResponse
2025-04-15T08:29:21.7236486Z       âœ“ throws when any attribute is missing (150 ms)
2025-04-15T08:29:21.7236948Z     init
2025-04-15T08:29:21.7237543Z       âœ“ calls `reset` if an InvalidSamlMetadataError is thrown (2 ms)
2025-04-15T08:29:21.7238326Z       âœ“ calls `reset` if a SyntaxError is thrown (1 ms)
2025-04-15T08:29:21.7239106Z       âœ“ does not call reset and rethrows if another error is thrown (2 ms)
2025-04-15T08:29:21.7239848Z       âœ“ does not call reset if no error is thrown (1 ms)
2025-04-15T08:29:21.7240298Z     reset
2025-04-15T08:29:21.7240979Z       âœ“ disables saml login and deletes the saml `features.saml` key in the db (2 ms)
2025-04-15T08:29:21.7241467Z 
2025-04-15T08:29:23.3194733Z PASS src/__tests__/external-hooks.test.ts
2025-04-15T08:29:23.3200591Z   ExternalHooks
2025-04-15T08:29:23.3202623Z     init()
2025-04-15T08:29:23.3213359Z       âœ“ should not load hooks if no external hook files are configured (6 ms)
2025-04-15T08:29:23.3214456Z       âœ“ should throw an error if hook file cannot be loaded (13 ms)
2025-04-15T08:29:23.3215362Z       âœ“ should successfully load hooks from valid hook file (3 ms)
2025-04-15T08:29:23.3215922Z     run()
2025-04-15T08:29:23.3219472Z       âœ“ should not throw if no hooks are registered (1 ms)
2025-04-15T08:29:23.3220705Z       âœ“ should execute registered hooks (1 ms)
2025-04-15T08:29:23.3221435Z       âœ“ should report error if hook execution fails (2 ms)
2025-04-15T08:29:23.3221822Z 
2025-04-15T08:29:26.6188139Z PASS src/credentials/__tests__/credentials.service.test.ts
2025-04-15T08:29:26.6189027Z   CredentialsService
2025-04-15T08:29:26.6189383Z     redact
2025-04-15T08:29:26.6190048Z       âœ“ should redact sensitive values (5 ms)
2025-04-15T08:29:26.6193338Z     decrypt
2025-04-15T08:29:26.6194626Z       âœ“ should redact sensitive values by default (2 ms)
2025-04-15T08:29:26.6195556Z       âœ“ should return sensitive values if `includeRawData` is true (1 ms)
2025-04-15T08:29:26.6196541Z       âœ“ should return return an empty object if decryption fails (2 ms)
2025-04-15T08:29:26.6197077Z 
2025-04-15T08:29:45.1020963Z PASS test/integration/workflows/workflow-sharing.service.test.ts (23.741 s)
2025-04-15T08:29:45.1024309Z   WorkflowSharingService
2025-04-15T08:29:45.1026021Z     getSharedWorkflowIds
2025-04-15T08:29:45.1030422Z       âœ“ should show all workflows to owners (40 ms)
2025-04-15T08:29:45.1031106Z       âœ“ should show shared workflows to users (38 ms)
2025-04-15T08:29:45.1032144Z       âœ“ should show workflows that the user has access to through a team project they are part of (17 ms)
2025-04-15T08:29:45.1033441Z       âœ“ should show workflows that the user has update access to (29 ms)
2025-04-15T08:29:45.1033908Z 
2025-04-15T08:29:49.7588076Z PASS test/integration/public-api/variables.test.ts (26.191 s)
2025-04-15T08:29:49.7593307Z   Variables in Public API
2025-04-15T08:29:49.7597575Z     GET /variables
2025-04-15T08:29:49.7602442Z       âœ“ if licensed, should return all variables with pagination (426 ms)
2025-04-15T08:29:49.7607423Z       âœ“ if not licensed, should reject (28 ms)
2025-04-15T08:29:49.7611805Z     POST /variables
2025-04-15T08:29:49.7616452Z       âœ“ if licensed, should create a new variable (39 ms)
2025-04-15T08:29:49.7621116Z       âœ“ if not licensed, should reject (21 ms)
2025-04-15T08:29:49.7625749Z     DELETE /variables/:id
2025-04-15T08:29:49.7630264Z       âœ“ if licensed, should delete a variable (64 ms)
2025-04-15T08:29:49.7635050Z       âœ“ if not licensed, should reject (22 ms)
2025-04-15T08:29:49.7639223Z 
2025-04-15T08:29:53.2189213Z PASS src/services/__tests__/ai.service.test.ts
2025-04-15T08:29:53.2197655Z   AiService
2025-04-15T08:29:53.2211635Z     init
2025-04-15T08:29:53.2214948Z       âœ“ should not initialize client if AI assistant is not enabled (8 ms)
2025-04-15T08:29:53.2217000Z       âœ“ should initialize client when AI assistant is enabled (2 ms)
2025-04-15T08:29:53.2217630Z     chat
2025-04-15T08:29:53.2218287Z       âœ“ should call client chat method after initialization (2 ms)
2025-04-15T08:29:53.2219897Z       âœ“ should throw error if client is not initialized (13 ms)
2025-04-15T08:29:53.2220436Z     applySuggestion
2025-04-15T08:29:53.2220956Z       âœ“ should call client applySuggestion (2 ms)
2025-04-15T08:29:53.2224941Z       âœ“ should throw error if client is not initialized (1 ms)
2025-04-15T08:29:53.2227316Z     askAi
2025-04-15T08:29:53.2228774Z       âœ“ should call client askAi method after initialization (9 ms)
2025-04-15T08:29:53.2230859Z       âœ“ should throw error if client is not initialized (1 ms)
2025-04-15T08:29:53.2233349Z 
2025-04-15T08:29:53.3055737Z PASS test/integration/executions.controller.test.ts (26.434 s)
2025-04-15T08:29:53.3064503Z   GET /executions
2025-04-15T08:29:53.3066208Z     âœ“ only returns executions of shared workflows if sharing is enabled (193 ms)
2025-04-15T08:29:53.3067802Z     âœ“ should return a scopes array for each execution (50 ms)
2025-04-15T08:29:53.3068539Z   GET /executions/:id
2025-04-15T08:29:53.3076395Z     âœ“ project viewers can view executions for workflows in the project (93 ms)
2025-04-15T08:29:53.3079728Z     âœ“ only returns executions of shared workflows if sharing is enabled (68 ms)
2025-04-15T08:29:53.3094448Z   POST /executions/delete
2025-04-15T08:29:53.3095442Z     âœ“ should hard-delete an execution (58 ms)
2025-04-15T08:29:53.3096386Z 
2025-04-15T08:29:56.3217144Z PASS src/executions/pre-execution-checks/__tests__/credentials-permission-checker.test.ts
2025-04-15T08:29:56.3218262Z   CredentialsPermissionChecker
2025-04-15T08:29:56.3220325Z     âœ“ should throw if a node has a credential without an id (15 ms)
2025-04-15T08:29:56.3221000Z     âœ“ should throw if a credential is not accessible (2 ms)
2025-04-15T08:29:56.3221696Z     âœ“ should not throw an error if the workflow has no credentials (1 ms)
2025-04-15T08:29:56.3222533Z     âœ“ should not throw an error if all credentials are accessible (1 ms)
2025-04-15T08:29:56.3223742Z     âœ“ should skip credential checks if the home project owner has global scope (1 ms)
2025-04-15T08:29:56.3224308Z 
2025-04-15T08:29:56.9357188Z PASS src/decorators/__tests__/controller.registry.test.ts
2025-04-15T08:29:56.9360061Z   ControllerRegistry
2025-04-15T08:29:56.9360643Z     Rate limiting
2025-04-15T08:29:56.9361478Z       âœ“ should not rate-limit by default (83 ms)
2025-04-15T08:29:56.9362159Z       âœ“ should rate-limit when configured (26 ms)
2025-04-15T08:29:56.9362886Z     Authorization
2025-04-15T08:29:56.9363541Z       âœ“ should not require auth if configured to skip (7 ms)
2025-04-15T08:29:56.9364227Z       âœ“ should require auth by default (12 ms)
2025-04-15T08:29:56.9364696Z     License checks
2025-04-15T08:29:56.9365260Z       âœ“ should disallow when feature is missing (5 ms)
2025-04-15T08:29:56.9365945Z       âœ“ should allow when feature is available (5 ms)
2025-04-15T08:29:56.9366430Z     Args
2025-04-15T08:29:56.9366935Z       âœ“ should pass in correct args to the route handler (6 ms)
2025-04-15T08:29:59.0396782Z 
2025-04-15T08:29:59.0397508Z PASS src/__tests__/credential-types.test.ts
2025-04-15T08:29:59.0449266Z   CredentialTypes
2025-04-15T08:29:59.0449850Z     getByName
2025-04-15T08:29:59.0451358Z       âœ“ Should throw error when calling invalid credential name (18 ms)
2025-04-15T08:29:59.0452984Z       âœ“ Should return correct credential type for valid name (1 ms)
2025-04-15T08:29:59.0470350Z     recognizes
2025-04-15T08:29:59.0471213Z       âœ“ Should recognize credential type that exists in knownCredentials (1 ms)
2025-04-15T08:29:59.0472324Z       âœ“ Should recognize credential type that exists in loadedCredentials (1 ms)
2025-04-15T08:29:59.0473427Z       âœ“ Should not recognize unknown credential type
2025-04-15T08:29:59.0473973Z     getSupportedNodes
2025-04-15T08:29:59.0474750Z       âœ“ Should return supported nodes for known credential type (2 ms)
2025-04-15T08:29:59.0475827Z       âœ“ Should return empty array for unknown credential type supported nodes (1 ms)
2025-04-15T08:29:59.0476481Z     getParentTypes
2025-04-15T08:29:59.0477177Z       âœ“ Should return parent types for credential type with extends (2 ms)
2025-04-15T08:29:59.0478666Z       âœ“ Should return empty array for credential type without extends (1 ms)
2025-04-15T08:29:59.0479793Z       âœ“ Should return empty array for unknown credential type parent types
2025-04-15T08:29:59.0480281Z 
2025-04-15T08:30:02.0525049Z PASS test/integration/webhooks.test.ts
2025-04-15T08:30:02.0527627Z   WebhookServer
2025-04-15T08:30:02.0529655Z     CORS
2025-04-15T08:30:02.0531503Z       for webhook
2025-04-15T08:30:02.0534149Z         âœ“ should handle preflight requests (181 ms)
2025-04-15T08:30:02.0536511Z         âœ“ should handle regular requests (9 ms)
2025-04-15T08:30:02.0538533Z       for webhookTest
2025-04-15T08:30:02.0540747Z         âœ“ should handle preflight requests (6 ms)
2025-04-15T08:30:02.0543317Z         âœ“ should handle regular requests (6 ms)
2025-04-15T08:30:02.0545414Z     Routing for Waiting Webhooks
2025-04-15T08:30:02.0551309Z       âœ“ should handle URLs without suffix (5 ms)
2025-04-15T08:30:02.0554662Z       âœ“ should handle URLs with suffix (4 ms)
2025-04-15T08:30:02.0555290Z 
2025-04-15T08:30:02.4913804Z PASS src/controllers/__tests__/user-settings.controller.test.ts
2025-04-15T08:30:02.4914542Z   UserSettingsController
2025-04-15T08:30:02.4914916Z     NPS Survey
2025-04-15T08:30:02.4915752Z       âœ“ updates user settings, setting response state to done (5 ms)
2025-04-15T08:30:02.4917375Z       âœ“ updates user settings, setting response state to done, ignoring other keys like waitForResponse
2025-04-15T08:30:02.4918734Z       âœ“ updates user settings, setting response state to done, ignoring other keys like ignoredCount (1 ms)
2025-04-15T08:30:02.4920032Z       âœ“ updates user settings, setting response state to done, ignoring other unknown keys (1 ms)
2025-04-15T08:30:02.4920940Z       âœ“ updates user settings, updating ignore count
2025-04-15T08:30:02.4921679Z       âœ“ updates user settings, resetting to waiting state (1 ms)
2025-04-15T08:30:02.4922620Z       âœ“ updates user settings, updating ignore count, ignoring unknown keys (1 ms)
2025-04-15T08:30:02.4923738Z       âœ“ updates user settings, setting response state to done
2025-04-15T08:30:02.4924489Z       âœ“ updates user settings, updating ignore count (1 ms)
2025-04-15T08:30:02.4925265Z       âœ“ throws error when request payload is is missing (9 ms)
2025-04-15T08:30:02.4926077Z       âœ“ throws error when request payload is is undefined (1 ms)
2025-04-15T08:30:02.4927084Z       âœ“ throws error when request payload is is responded but missing lastShownAt (1 ms)
2025-04-15T08:30:02.4928265Z       âœ“ throws error when request payload is is waitingForResponse but missing lastShownAt (1 ms)
2025-04-15T08:30:02.4929495Z       âœ“ throws error when request payload is is waitingForResponse but missing ignoredCount (1 ms)
2025-04-15T08:30:02.4930105Z 
2025-04-15T08:30:05.4187676Z PASS src/scaling/__tests__/publisher.service.test.ts
2025-04-15T08:30:05.4193272Z   Publisher
2025-04-15T08:30:05.4200508Z     constructor
2025-04-15T08:30:05.4250042Z       âœ“ should init Redis client in scaling mode (5 ms)
2025-04-15T08:30:05.4250960Z       âœ“ should not init Redis client in regular mode (1 ms)
2025-04-15T08:30:05.4251482Z     shutdown
2025-04-15T08:30:05.4252012Z       âœ“ should disconnect Redis client
2025-04-15T08:30:05.4268498Z     publishCommand
2025-04-15T08:30:05.4270922Z       âœ“ should do nothing if not in scaling mode (1 ms)
2025-04-15T08:30:05.4280692Z       âœ“ should publish command into `n8n.commands` pubsub channel (1 ms)
2025-04-15T08:30:05.4281597Z       âœ“ should not debounce `add-webhooks-triggers-and-pollers` (1 ms)
2025-04-15T08:30:05.4282381Z       âœ“ should not debounce `remove-triggers-and-pollers`
2025-04-15T08:30:05.4283067Z     publishWorkerResponse
2025-04-15T08:30:05.4283835Z       âœ“ should publish worker response into `n8n.worker-response` pubsub channel
2025-04-15T08:30:05.4284316Z 
2025-04-15T08:30:08.1864674Z PASS src/license/__tests__/license.service.test.ts
2025-04-15T08:30:08.1865776Z   LicenseService
2025-04-15T08:30:08.1866244Z     getLicenseData
2025-04-15T08:30:08.1867814Z       âœ“ should return usage and license data (8 ms)
2025-04-15T08:30:08.1868808Z     activateLicense
2025-04-15T08:30:08.1869356Z       âœ“ should handle SCHEMA_VALIDATION error (20 ms)
2025-04-15T08:30:08.1870075Z       âœ“ should handle RESERVATION_EXHAUSTED error (1 ms)
2025-04-15T08:30:08.1870766Z       âœ“ should handle RESERVATION_EXPIRED error (1 ms)
2025-04-15T08:30:08.1871420Z       âœ“ should handle NOT_FOUND error (1 ms)
2025-04-15T08:30:08.1872060Z       âœ“ should handle RESERVATION_CONFLICT error (1 ms)
2025-04-15T08:30:08.1872977Z       âœ“ should handle RESERVATION_DUPLICATE error (1 ms)
2025-04-15T08:30:08.1873468Z     renewLicense
2025-04-15T08:30:08.1873867Z       âœ“ on success (1 ms)
2025-04-15T08:30:08.1874256Z       âœ“ on failure (2 ms)
2025-04-15T08:30:08.1874617Z     registerCommunityEdition
2025-04-15T08:30:08.1875069Z       âœ“ on success (1 ms)
2025-04-15T08:30:08.1875717Z       âœ“ on failure (2 ms)
2025-04-15T08:30:08.1876075Z 
2025-04-15T08:30:11.2798983Z PASS test/integration/owner.api.test.ts (25.89 s)
2025-04-15T08:30:11.2799708Z   POST /owner/setup
2025-04-15T08:30:11.2800598Z     âœ“ should create owner and enable isInstanceOwnerSetUp (321 ms)
2025-04-15T08:30:11.2805408Z     âœ“ should create owner with lowercased email (122 ms)
2025-04-15T08:30:11.2805897Z     âœ“ should fail with invalid inputs (31 ms)
2025-04-15T08:30:11.2806448Z 
2025-04-15T08:30:13.8319052Z PASS src/task-runners/task-managers/__tests__/task-manager.test.ts
2025-04-15T08:30:13.8323731Z   TaskRequester
2025-04-15T08:30:13.8328031Z     handleRpc
2025-04-15T08:30:13.8332939Z       âœ“ should handle logNodeOutput rpc call (10 ms)
2025-04-15T08:30:13.8337688Z       âœ“ should handle helpers.assertBinaryData rpc call (1 ms)
2025-04-15T08:30:13.8342140Z       âœ“ should handle helpers.getBinaryDataBuffer rpc call (1 ms)
2025-04-15T08:30:13.8349343Z       âœ“ should handle helpers.prepareBinaryData rpc call (1 ms)
2025-04-15T08:30:13.8353684Z       âœ“ should handle helpers.setBinaryDataBuffer rpc call (1 ms)
2025-04-15T08:30:13.8354566Z       âœ“ should handle helpers.binaryToString rpc call (1 ms)
2025-04-15T08:30:13.8355395Z       âœ“ should handle helpers.httpRequest rpc call (1 ms)
2025-04-15T08:30:13.8356226Z       âœ“ converts any serialized buffer arguments into buffers (1 ms)
2025-04-15T08:30:13.8356761Z       errors
2025-04-15T08:30:13.8357416Z         âœ“ sends method not allowed error if method is not in the allow list
2025-04-15T08:30:13.8358165Z         âœ“ sends error if method throws (1 ms)
2025-04-15T08:30:13.8358491Z 
2025-04-15T08:30:16.8474667Z PASS src/databases/repositories/__tests__/execution.repository.test.ts
2025-04-15T08:30:16.8488603Z   ExecutionRepository
2025-04-15T08:30:16.8493168Z     getWaitingExecutions()
2025-04-15T08:30:16.8496365Z       âœ“ on sqlite, should be called with expected args (9 ms)
2025-04-15T08:30:16.8499417Z       âœ“ on postgresdb, should be called with expected args (1 ms)
2025-04-15T08:30:16.8502124Z     deleteExecutionsByFilter
2025-04-15T08:30:16.8514256Z       âœ“ should delete binary data (2 ms)
2025-04-15T08:30:16.8515825Z     updateExistingExecution
2025-04-15T08:30:16.8516642Z       âœ“ should update execution and data in transaction on sqlite (2 ms)
2025-04-15T08:30:16.8517605Z       âœ“ should update execution and data in transaction on postgresdb (1 ms)
2025-04-15T08:30:16.8518549Z       âœ“ should update execution and data in transaction on mysqldb (2 ms)
2025-04-15T08:30:16.8519041Z 
2025-04-15T08:30:26.6406736Z PASS test/integration/workflow-history-manager.test.ts (24.324 s)
2025-04-15T08:30:26.6414226Z   Workflow History Manager
2025-04-15T08:30:26.6415182Z     âœ“ should prune on interval (14 ms)
2025-04-15T08:30:26.6416306Z     âœ“ should not prune when not licensed (75 ms)
2025-04-15T08:30:26.6417285Z     âœ“ should not prune when licensed but disabled (25 ms)
2025-04-15T08:30:26.6419176Z     âœ“ should not prune when both prune times are -1 (infinite) (19 ms)
2025-04-15T08:30:26.6420514Z     âœ“ should prune when config prune time is not -1 (infinite) (20 ms)
2025-04-15T08:30:26.6421737Z     âœ“ should prune when license prune time is not -1 (infinite) (18 ms)
2025-04-15T08:30:26.6423516Z     âœ“ should only prune versions older than prune time (39 ms)
2025-04-15T08:30:26.6426206Z 
2025-04-15T08:30:31.6955612Z PASS src/environments.ee/source-control/__tests__/source-control.controller.ee.test.ts
2025-04-15T08:30:31.6962563Z   SourceControlController
2025-04-15T08:30:31.6970155Z     pushWorkfolder
2025-04-15T08:30:31.6971284Z       âœ“ should push workfolder with expected parameters (9 ms)
2025-04-15T08:30:31.6971837Z     pullWorkfolder
2025-04-15T08:30:31.6972467Z       âœ“ should pull workfolder with expected parameters (1 ms)
2025-04-15T08:30:31.6973263Z     getStatus
2025-04-15T08:30:31.6973879Z       âœ“ should call getStatus with expected parameters (2 ms)
2025-04-15T08:30:31.6974403Z     status
2025-04-15T08:30:31.6974953Z       âœ“ should call getStatus with expected parameters (2 ms)
2025-04-15T08:30:31.6975341Z 
2025-04-15T08:30:32.5945848Z PASS src/modules/insights/__tests__/insights.controller.test.ts (24.179 s)
2025-04-15T08:30:32.5947865Z   InsightsController
2025-04-15T08:30:32.5948260Z     getInsightsSummary
2025-04-15T08:30:32.5949126Z       âœ“ should return default insights if no data (8 ms)
2025-04-15T08:30:32.5950386Z       âœ“ should return the insights summary with null deviation if insights exist only for current period (1 ms)
2025-04-15T08:30:32.5952140Z       âœ“ should return the insights summary if insights exist for both periods (1 ms)
2025-04-15T08:30:32.5953072Z 
2025-04-15T08:30:34.1197572Z PASS src/push/__tests__/sse.push.test.ts
2025-04-15T08:30:34.1198108Z   SSEPush
2025-04-15T08:30:34.1198715Z     âœ“ pings all connections (3 ms)
2025-04-15T08:30:34.1199236Z     âœ“ closes all connections (2 ms)
2025-04-15T08:30:34.1199622Z     add
2025-04-15T08:30:34.1199987Z       âœ“ adds a connection (13 ms)
2025-04-15T08:30:34.1200362Z     closes a connection
2025-04-15T08:30:34.1200746Z       âœ“ on "end" event (4 ms)
2025-04-15T08:30:34.1201188Z       âœ“ on "close" event (4 ms)
2025-04-15T08:30:34.1201639Z       âœ“ on "finish" event (1 ms)
2025-04-15T08:30:34.1202033Z     sends data
2025-04-15T08:30:34.1202415Z       âœ“ to one connection (5 ms)
2025-04-15T08:30:34.1203079Z       âœ“ to all connections (2 ms)
2025-04-15T08:30:34.1203559Z       âœ“ to a specific user (2 ms)
2025-04-15T08:30:34.1203806Z 
2025-04-15T08:30:35.7830287Z PASS src/services/__tests__/active-workflows.service.test.ts
2025-04-15T08:30:35.7838407Z   ActiveWorkflowsService
2025-04-15T08:30:35.7840060Z     getAllActiveIdsInStorage
2025-04-15T08:30:35.7841503Z       âœ“ should filter out any workflow ids that have activation errors (8 ms)
2025-04-15T08:30:35.7843220Z     getAllActiveIdsFor
2025-04-15T08:30:35.7845290Z       âœ“ should return all workflow ids when user has full access (2 ms)
2025-04-15T08:30:35.7846729Z       âœ“ should filter out workflow ids that the user does not have access to (2 ms)
2025-04-15T08:30:35.7847741Z     getActivationError
2025-04-15T08:30:35.7849320Z       âœ“ should throw a BadRequestError a user does not have access to the workflow id (13 ms)
2025-04-15T08:30:35.7851773Z       âœ“ should return the error when the user has access (1 ms)
2025-04-15T08:30:35.7852987Z 
2025-04-15T08:30:39.1982532Z PASS src/workflows/workflow-history.ee/__tests__/workflow-history.service.ee.test.ts
2025-04-15T08:30:39.1983543Z   WorkflowHistoryService
2025-04-15T08:30:39.1983938Z     saveVersion
2025-04-15T08:30:39.1985040Z       âœ“ should save a new version when workflow history is enabled and nodes and connections are present (6 ms)
2025-04-15T08:30:39.1986136Z       âœ“ should not save a new version when workflow history is disabled (1 ms)
2025-04-15T08:30:39.1987076Z       âœ“ should not save a new version when nodes or connections are missing (1 ms)
2025-04-15T08:30:39.1988042Z       âœ“ should log an error when failed to save workflow history version (1 ms)
2025-04-15T08:30:39.1988508Z 
2025-04-15T08:30:43.3306664Z PASS test/integration/commands/reset.cmd.test.ts (26.259 s)
2025-04-15T08:30:43.3309899Z   âœ“ user-management:reset should reset DB to default user state (113 ms)
2025-04-15T08:30:43.3333302Z 
2025-04-15T08:30:45.9238544Z PASS src/task-runners/task-broker/auth/__tests__/task-broker-auth.controller.test.ts
2025-04-15T08:30:45.9243609Z   TaskBrokerAuthController
2025-04-15T08:30:45.9299049Z     createGrantToken
2025-04-15T08:30:45.9301886Z       âœ“ should throw BadRequestError when auth token is missing (13 ms)
2025-04-15T08:30:45.9303123Z       âœ“ should throw ForbiddenError when auth token is invalid (1 ms)
2025-04-15T08:30:45.9303945Z       âœ“ should return rant token when auth token is valid (3 ms)
2025-04-15T08:30:45.9304449Z     authMiddleware
2025-04-15T08:30:45.9305037Z       âœ“ should respond with 401 when grant token is missing (2 ms)
2025-04-15T08:30:45.9305865Z       âœ“ should respond with 403 when grant token is invalid (1 ms)
2025-04-15T08:30:45.9306669Z       âœ“ should call next() when grant token is valid (1 ms)
2025-04-15T08:30:45.9307042Z 
2025-04-15T08:30:48.1590755Z PASS src/task-runners/task-managers/__tests__/data-request-response-builder.test.ts
2025-04-15T08:30:48.1596471Z   DataRequestResponseBuilder
2025-04-15T08:30:48.1601183Z     âœ“ picks only specific properties for additional data (9 ms)
2025-04-15T08:30:48.1605968Z     âœ“ picks only specific properties for workflow (3 ms)
2025-04-15T08:30:48.1610300Z     âœ“ clears nodeExecutionStack, waitingExecution and waitingExecutionSource from runExecutionData (2 ms)
2025-04-15T08:30:48.1613778Z 
2025-04-15T08:30:48.6764763Z PASS test/integration/task-runners/task-runner-process.test.ts (9.303 s)
2025-04-15T08:30:48.6766142Z   TaskRunnerProcess
2025-04-15T08:30:48.6766935Z     âœ“ should start and connect the task runner (1255 ms)
2025-04-15T08:30:48.6767652Z     âœ“ should stop an disconnect the task runner (1631 ms)
2025-04-15T08:30:48.6768354Z     âœ“ should restart the task runner if it exits (2680 ms)
2025-04-15T08:30:48.6769360Z     âœ“ should work together with restart loop detector (1036 ms)
2025-04-15T08:30:48.6769941Z 
2025-04-15T08:30:53.2527267Z PASS src/controllers/__tests__/ai.controller.test.ts
2025-04-15T08:30:53.2541970Z   AiController
2025-04-15T08:30:53.2542371Z     chat
2025-04-15T08:30:53.2543357Z       âœ“ should handle chat request successfully (10 ms)
2025-04-15T08:30:53.2544155Z       âœ“ should throw InternalServerError if chat fails (11 ms)
2025-04-15T08:30:53.2544711Z     applySuggestion
2025-04-15T08:30:53.2545310Z       âœ“ should apply suggestion successfully (2 ms)
2025-04-15T08:30:53.2546160Z       âœ“ should throw InternalServerError if applying suggestion fails (1 ms)
2025-04-15T08:30:53.2546771Z     askAi method
2025-04-15T08:30:53.2547244Z       âœ“ should ask AI successfully (2 ms)
2025-04-15T08:30:53.2547983Z       âœ“ should throw InternalServerError if asking AI fails (1 ms)
2025-04-15T08:30:53.2548394Z 
2025-04-15T08:30:56.5216176Z PASS src/databases/repositories/__tests__/shared-credentials.repository.test.ts
2025-04-15T08:30:56.5224724Z   SharedCredentialsRepository
2025-04-15T08:30:56.5225218Z     findCredentialForUser
2025-04-15T08:30:56.5226207Z       âœ“ should allow instance owner access to all credentials (9 ms)
2025-04-15T08:30:56.5226998Z       âœ“ should allow members (2 ms)
2025-04-15T08:30:56.5227782Z       âœ“ should return null when no shared credential is found (1 ms)
2025-04-15T08:30:56.5228207Z 
2025-04-15T08:30:58.8280711Z PASS src/task-runners/__tests__/forward-to-logger.test.ts
2025-04-15T08:30:58.8286054Z   forwardToLogger
2025-04-15T08:30:58.8286784Z     âœ“ should forward stdout data to logger.info (7 ms)
2025-04-15T08:30:58.8287437Z     âœ“ should forward stderr data to logger.error (1 ms)
2025-04-15T08:30:58.8288096Z     âœ“ should remove trailing newline from stdout (2 ms)
2025-04-15T08:30:58.8288744Z     âœ“ should remove trailing newline from stderr (1 ms)
2025-04-15T08:30:58.8289352Z     âœ“ should forward stderr data to logger.error
2025-04-15T08:30:58.8290008Z     âœ“ should include prefix if provided for stdout (1 ms)
2025-04-15T08:30:58.8290700Z     âœ“ should include prefix if provided for stderr (1 ms)
2025-04-15T08:30:58.8291490Z     âœ“ should make sure there is no duplicate space after prefix for stdout
2025-04-15T08:30:58.8293224Z     âœ“ should make sure there is no duplicate space after prefix for stderr (5 ms)
2025-04-15T08:30:58.8293725Z 
2025-04-15T08:30:59.5220724Z PASS test/integration/security-audit/nodes-risk-reporter.test.ts (25.158 s)
2025-04-15T08:30:59.5226660Z   âœ“ should report risky official nodes (103 ms)
2025-04-15T08:30:59.5227480Z   âœ“ should not report non-risky official nodes (20 ms)
2025-04-15T08:30:59.5228144Z   âœ“ should report community nodes (12 ms)
2025-04-15T08:30:59.5228476Z 
2025-04-15T08:31:01.8052218Z PASS src/services/__tests__/user.service.test.ts
2025-04-15T08:31:01.8058765Z   UserService
2025-04-15T08:31:01.8064337Z     toPublic
2025-04-15T08:31:01.8066097Z       âœ“ should remove sensitive properties (7 ms)
2025-04-15T08:31:01.8066824Z       âœ“ should add scopes if requested (2 ms)
2025-04-15T08:31:01.8067728Z       âœ“ should add invite URL if requested (2 ms)
2025-04-15T08:31:01.8068238Z     update
2025-04-15T08:31:01.8068801Z       âœ“ should use `save` instead of `update` (3 ms)
2025-04-15T08:31:01.8069499Z 
2025-04-15T08:31:02.8546223Z PASS src/controllers/__tests__/api-keys.controller.test.ts
2025-04-15T08:31:02.8549198Z   ApiKeysController
2025-04-15T08:31:02.8549832Z     createAPIKey
2025-04-15T08:31:02.8552277Z       âœ“ should create and save an API key (10 ms)
2025-04-15T08:31:02.8553775Z     getAPIKeys
2025-04-15T08:31:02.8555513Z       âœ“ should return the users api keys redacted (2 ms)
2025-04-15T08:31:02.8556176Z     deleteAPIKey
2025-04-15T08:31:02.8557854Z       âœ“ should delete the API key (5 ms)
2025-04-15T08:31:02.8558331Z 
2025-04-15T08:31:05.6235750Z PASS src/validators/__tests__/no-xss.validator.test.ts
2025-04-15T08:31:05.6240943Z   NoXss
2025-04-15T08:31:05.6241222Z     Scripts
2025-04-15T08:31:05.6241862Z       âœ“ should block <script src/> (6 ms)
2025-04-15T08:31:05.6242489Z       âœ“ should block <script>alert('xss')</script> (1 ms)
2025-04-15T08:31:05.6243314Z       âœ“ should block <a href="#">Jack</a>
2025-04-15T08:31:05.6243707Z     Names
2025-04-15T08:31:05.6245832Z       âœ“ should allow Johann StrauÃŸ (1 ms)
2025-04-15T08:31:05.6246450Z       âœ“ should allow Ð’Ð°Ð³Ð¸Ñ„ Ð¡Ó™Ð¼Ó™Ð´Ð¾Ò“Ð»Ñƒ
2025-04-15T08:31:05.6246973Z       âœ“ should allow RenÃ© Magritte
2025-04-15T08:31:05.6247470Z       âœ“ should allow à¦¸à§à¦•à§à¦®à¦¾à¦° à¦°à¦¾à§Ÿ
2025-04-15T08:31:05.6248002Z       âœ“ should allow à½˜à½‚à½¼à½“à¼‹à½”à½¼à¼‹à½¢à¾¡à½¼à¼‹à½¢à¾—à½ºà¼ (1 ms)
2025-04-15T08:31:05.6248584Z       âœ“ should allow Ø¹Ø¨Ø¯Ø§Ù„Ø­Ù„ÙŠÙ… Ø­Ø§ÙØ¸
2025-04-15T08:31:05.6248971Z     ISO-8601 timestamps
2025-04-15T08:31:05.6249446Z       âœ“ should allow 2022-01-01T00:00:00.000Z (1 ms)
2025-04-15T08:31:05.6249991Z       âœ“ should allow 2022-01-01T00:00:00.000+02:00
2025-04-15T08:31:05.6250362Z     Semver versions
2025-04-15T08:31:05.6250701Z       âœ“ should allow 1.0.0
2025-04-15T08:31:05.6251113Z       âœ“ should allow 1.0.0-alpha.1
2025-04-15T08:31:05.6251465Z     Miscellaneous strings
2025-04-15T08:31:05.6251825Z       âœ“ should allow CI/CD
2025-04-15T08:31:05.6252126Z     Array of strings
2025-04-15T08:31:05.6269271Z       âœ“ should allow array: ["cloud-infrastructure-orchestration","ci-cd","reporting"]
2025-04-15T08:31:05.6270552Z       âœ“ should allow array: ["automationGoalDevops","cloudComputing","containerization"] (1 ms)
2025-04-15T08:31:05.6271906Z       âœ“ should reject array containing invalid string: ["valid-string","<script>alert(\"xss\")</script>","another-valid-string"] (1 ms)
2025-04-15T08:31:05.6273503Z       âœ“ should reject array containing invalid string: ["<img src=\"x\" onerror=\"alert('XSS')\">","valid-string"]
2025-04-15T08:31:05.6274092Z 
2025-04-15T08:31:14.6145525Z PASS test/integration/project.service.integration.test.ts (25.646 s)
2025-04-15T08:31:14.6146265Z   ProjectService
2025-04-15T08:31:14.6146593Z     findRolesInProjects
2025-04-15T08:31:14.6147107Z       when user has roles in projects where workflow is accessible
2025-04-15T08:31:14.6147934Z         âœ“ should return roles and project IDs (50 ms)
2025-04-15T08:31:14.6148536Z       when user has no roles in projects where workflow is accessible
2025-04-15T08:31:14.6149251Z         âœ“ should return project IDs but no roles (30 ms)
2025-04-15T08:31:14.6150357Z       when user has roles in projects where workflow is inaccessible
2025-04-15T08:31:14.6151080Z         âœ“ should return project IDs but no roles (44 ms)
2025-04-15T08:31:14.6151403Z 
2025-04-15T08:31:30.4049715Z PASS test/integration/ai/ai.api.test.ts (28.349 s)
2025-04-15T08:31:30.4051775Z   POST /ai/free-credits
2025-04-15T08:31:30.4058987Z     âœ“ should create OpenAI managed credential (109 ms)
2025-04-15T08:31:30.4059397Z 
2025-04-15T08:31:32.7750968Z PASS test/integration/activation-errors.service.test.ts
2025-04-15T08:31:32.7755959Z   ActivationErrorsService
2025-04-15T08:31:32.7760136Z     register
2025-04-15T08:31:32.7765304Z       âœ“ should register an activation error for a workflow (7 ms)
2025-04-15T08:31:32.7768316Z     deregister
2025-04-15T08:31:32.7770604Z       âœ“ should deregister an activation error for a workflow (1 ms)
2025-04-15T08:31:32.7772256Z     get
2025-04-15T08:31:32.7779637Z       âœ“ should retrieve an activation error for a workflow (1 ms)
2025-04-15T08:31:32.7780676Z       âœ“ should return `null` if no activation error found for a workflow
2025-04-15T08:31:32.7781249Z     getAll
2025-04-15T08:31:32.7781769Z       âœ“ should retrieve all activation errors (2 ms)
2025-04-15T08:31:32.7782499Z       âœ“ should return an empty object if no activation errors
2025-04-15T08:31:32.7784969Z     clearAll()
2025-04-15T08:31:32.7785452Z       âœ“ should clear activation errors (1 ms)
2025-04-15T08:31:32.7785725Z 
2025-04-15T08:31:34.3281433Z PASS test/integration/tags.api.test.ts (28.479 s)
2025-04-15T08:31:34.3282058Z   POST /tags
2025-04-15T08:31:34.3282950Z     âœ“ should create tag (44 ms)
2025-04-15T08:31:34.3283571Z     âœ“ should not create duplicate tag (79 ms)
2025-04-15T08:31:34.3284174Z     âœ“ should delete tag (13 ms)
2025-04-15T08:31:34.3284721Z     âœ“ should update tag name (28 ms)
2025-04-15T08:31:34.3285298Z     âœ“ should retrieve all tags (15 ms)
2025-04-15T08:31:34.3285974Z     âœ“ should retrieve all tags with with usage count (16 ms)
2025-04-15T08:31:34.3286460Z 
2025-04-15T08:31:35.1745601Z PASS src/webhooks/__tests__/test-webhook-registrations.service.test.ts
2025-04-15T08:31:35.1757059Z   TestWebhookRegistrationsService
2025-04-15T08:31:35.1761143Z     register()
2025-04-15T08:31:35.1762582Z       âœ“ should register a test webhook registration (8 ms)
2025-04-15T08:31:35.1765378Z       âœ“ should skip setting TTL in single-main setup (6 ms)
2025-04-15T08:31:35.1768014Z     deregister()
2025-04-15T08:31:35.1768675Z       âœ“ should deregister a test webhook registration (1 ms)
2025-04-15T08:31:35.1769187Z     get()
2025-04-15T08:31:35.1769739Z       âœ“ should retrieve a test webhook registration (1 ms)
2025-04-15T08:31:35.1770682Z       âœ“ should return undefined if no such test webhook registration was found (1 ms)
2025-04-15T08:31:35.1771325Z     getAllKeys()
2025-04-15T08:31:35.1771896Z       âœ“ should retrieve all test webhook registration keys
2025-04-15T08:31:35.1772404Z     getAllRegistrations()
2025-04-15T08:31:35.1773181Z       âœ“ should retrieve all test webhook registrations
2025-04-15T08:31:35.1773706Z     deregisterAll()
2025-04-15T08:31:35.1774346Z       âœ“ should deregister all test webhook registrations (1 ms)
2025-04-15T08:31:35.1775937Z     toKey()
2025-04-15T08:31:35.1776530Z       âœ“ should convert a test webhook registration to a key
2025-04-15T08:31:35.1776937Z 
2025-04-15T08:31:38.6728079Z PASS src/services/__tests__/naming.service.test.ts
2025-04-15T08:31:38.6733131Z   NamingService
2025-04-15T08:31:38.6737586Z     getUniqueWorkflowName()
2025-04-15T08:31:38.6742514Z       âœ“ should return requested name if already unique (8 ms)
2025-04-15T08:31:38.6747648Z       âœ“ should return requested name suffixed if already existing once
2025-04-15T08:31:38.6752900Z       âœ“ should return requested name with incremented suffix if already suffixed (1 ms)
2025-04-15T08:31:38.6757525Z     getUniqueCredentialName()
2025-04-15T08:31:38.6759648Z       âœ“ should return requested name if already unique (1 ms)
2025-04-15T08:31:38.6774309Z       âœ“ should return requested name suffixed if already existing once (1 ms)
2025-04-15T08:31:38.6776356Z       âœ“ should return requested name with incremented suffix if already suffixed (1 ms)
2025-04-15T08:31:38.6777373Z 
2025-04-15T08:31:43.5309847Z PASS test/integration/commands/worker.cmd.test.ts (28.739 s)
2025-04-15T08:31:43.5320950Z   âœ“ worker initializes all its components (166 ms)
2025-04-15T08:31:43.5321344Z 
2025-04-15T08:31:46.6931317Z PASS src/user-management/email/__tests__/user-management-mailer.test.ts
2025-04-15T08:31:46.6932068Z   UserManagementMailer
2025-04-15T08:31:46.6932487Z     when SMTP is not configured
2025-04-15T08:31:46.6933441Z       âœ“ should not setup email transport (5 ms)
2025-04-15T08:31:46.6934002Z       âœ“ should not send emails (1 ms)
2025-04-15T08:31:46.6934402Z     when SMTP is configured
2025-04-15T08:31:46.6934877Z       âœ“ should setup email transport (1 ms)
2025-04-15T08:31:46.6935429Z       âœ“ should send invitation emails (22 ms)
2025-04-15T08:31:46.6936001Z       âœ“ should send password reset emails (3 ms)
2025-04-15T08:31:46.6936379Z 
2025-04-15T08:32:03.7937883Z PASS test/integration/insights/insights.api.test.ts (29.209 s)
2025-04-15T08:32:03.7943750Z   GET /insights routes work for owner and admins for server with dashboard license
2025-04-15T08:32:03.7945139Z     âœ“ Call should work and return empty summary for user owner (51 ms)
2025-04-15T08:32:03.7946522Z     âœ“ Call should work and return empty summary for user admin (20 ms)
2025-04-15T08:32:03.7947250Z     âœ“ Call should work and return empty summary for user member (13 ms)
2025-04-15T08:32:03.7948015Z   GET /insights routes return 403 for dashboard routes when summary license only
2025-04-15T08:32:03.7948916Z     âœ“ Call should work and return empty summary for user owner (15 ms)
2025-04-15T08:32:03.7949749Z     âœ“ Call should work and return empty summary for user admin (13 ms)
2025-04-15T08:32:03.7950583Z     âœ“ Call should work and return empty summary for user member (13 ms)
2025-04-15T08:32:03.7951142Z   GET /insights/by-workflow
2025-04-15T08:32:03.7951746Z     âœ“ Call should work with valid query parameters (9 ms)
2025-04-15T08:32:03.7952910Z     âœ“ Call should return internal server error with invalid pagination query parameters (24 ms)
2025-04-15T08:32:03.7954096Z     âœ“ Call should return internal server error with invalid pagination query parameters (5 ms)
2025-04-15T08:32:03.7955183Z     âœ“ Call should return bad request with invalid sortby query parameters (5 ms)
2025-04-15T08:32:03.7955659Z 
2025-04-15T08:32:05.5235309Z PASS test/integration/database/repositories/execution.repository.test.ts (26.646 s)
2025-04-15T08:32:05.5242930Z   ExecutionRepository
2025-04-15T08:32:05.5243337Z     createNewExecution
2025-04-15T08:32:05.5243973Z       âœ“ should save execution data (38 ms)
2025-04-15T08:32:05.5244672Z       âœ“ should not create execution if execution data insert fails (18 ms)
2025-04-15T08:32:05.5245108Z 
2025-04-15T08:32:10.5085376Z PASS src/webhooks/__tests__/waiting-webhooks.test.ts
2025-04-15T08:32:10.5087674Z   WaitingWebhooks
2025-04-15T08:32:10.5088747Z     âœ“ should throw NotFoundError if there is no execution to resume (31 ms)
2025-04-15T08:32:10.5089855Z     âœ“ should throw ConflictError if the execution to resume is already running (2 ms)
2025-04-15T08:32:10.5090959Z     âœ“ should throw ConflictError if the execution to resume already finished (3 ms)
2025-04-15T08:32:10.5091970Z     âœ“ should mark as test webhook when execution mode is manual (5 ms)
2025-04-15T08:32:10.5092418Z 
2025-04-15T08:32:13.8980565Z PASS src/modules/insights/__tests__/insights.module.test.ts
2025-04-15T08:32:13.8983299Z   InsightsModule
2025-04-15T08:32:13.8984393Z     backgroundProcess
2025-04-15T08:32:13.8985489Z       âœ“ should start background process if instance is main and leader (9 ms)
2025-04-15T08:32:13.8986569Z       âœ“ should not start background process if instance is main but not leader (1 ms)
2025-04-15T08:32:13.8987537Z       âœ“ should start background process on leader takeover (1 ms)
2025-04-15T08:32:13.8988329Z       âœ“ should stop background process on leader stepdown (2 ms)
2025-04-15T08:32:13.8989289Z 
2025-04-15T08:32:14.4845349Z PASS test/integration/license-metrics.repository.test.ts (27.565 s)
2025-04-15T08:32:14.4847628Z   LicenseMetricsRepository
2025-04-15T08:32:14.4850077Z     getLicenseRenewalMetrics
2025-04-15T08:32:14.4852397Z       âœ“ should return license renewal metrics (111 ms)
2025-04-15T08:32:14.4854771Z       âœ“ should handle zero execution statistics correctly (22 ms)
2025-04-15T08:32:14.4856465Z 
2025-04-15T08:32:17.1529927Z PASS src/evaluation.ee/test-runner/__tests__/create-pin-data.ee.test.ts
2025-04-15T08:32:17.1530885Z   createPinData
2025-04-15T08:32:17.1531801Z     âœ“ should create pin data from past execution data (7 ms)
2025-04-15T08:32:17.1532908Z     âœ“ should not create pin data for non-existing mocked nodes (1 ms)
2025-04-15T08:32:17.1533782Z     âœ“ should create pin data for all mocked nodes (1 ms)
2025-04-15T08:32:17.1534608Z     âœ“ should return empty object if no mocked nodes are provided
2025-04-15T08:32:17.1535575Z     âœ“ should create pin data for all mocked nodes with renamed nodes
2025-04-15T08:32:17.1536055Z 
2025-04-15T08:32:21.2119187Z PASS src/controllers/__tests__/auth.controller.test.ts
2025-04-15T08:32:21.2119812Z   AuthController
2025-04-15T08:32:21.2120122Z     login
2025-04-15T08:32:21.2121470Z       âœ“ should not validate email in "emailOrLdapLoginId" if LDAP is enabled (7 ms)
2025-04-15T08:32:21.2121905Z 
2025-04-15T08:32:23.5737625Z PASS src/concurrency/__tests__/concurrency-queue.test.ts
2025-04-15T08:32:23.5738400Z   ConcurrencyQueue
2025-04-15T08:32:23.5739128Z     âœ“ should limit concurrency (10 ms)
2025-04-15T08:32:23.5740096Z     âœ“ should debounce emitting of the `concurrency-check` event (1 ms)
2025-04-15T08:32:23.5741009Z 
2025-04-15T08:32:34.0107979Z PASS test/integration/workflows/workflow.service.test.ts (30.029 s)
2025-04-15T08:32:34.0110639Z   update()
2025-04-15T08:32:34.0113921Z     âœ“ should remove and re-add to active workflows on `active: true` payload (77 ms)
2025-04-15T08:32:34.0118923Z     âœ“ should remove from active workflows on `active: false` payload (29 ms)
2025-04-15T08:32:34.0119405Z 
2025-04-15T08:32:37.1065094Z PASS src/task-runners/task-broker/auth/__tests__/task-broker-auth.service.test.ts
2025-04-15T08:32:37.1066257Z   TaskBrokerAuthService
2025-04-15T08:32:37.1069021Z     isValidAuthToken
2025-04-15T08:32:37.1070813Z       âœ“ should be valid for the configured token (5 ms)
2025-04-15T08:32:37.1071536Z       âœ“ should be invalid for anything else (1 ms)
2025-04-15T08:32:37.1072023Z     createGrantToken
2025-04-15T08:32:37.1072533Z       âœ“ should generate a random token (2 ms)
2025-04-15T08:32:37.1073417Z       âœ“ should store the generated token in cache (1 ms)
2025-04-15T08:32:37.1073886Z     tryConsumeGrantToken
2025-04-15T08:32:37.1074503Z       âœ“ should return false for an invalid grant token (1 ms)
2025-04-15T08:32:37.1075203Z       âœ“ should return true for a valid grant token (1 ms)
2025-04-15T08:32:37.1075940Z       âœ“ should return false for a already used grant token (1 ms)
2025-04-15T08:32:37.1077084Z       âœ“ should return false for an expired grant token (310 ms)
2025-04-15T08:32:37.1077472Z 
2025-04-15T08:32:44.8137883Z PASS test/integration/commands/update/workflow.test.ts (30.685 s)
2025-04-15T08:32:44.8139092Z   âœ“ update:workflow can activate all workflows (64 ms)
2025-04-15T08:32:44.8139931Z   âœ“ update:workflow can deactivate all workflows (17 ms)
2025-04-15T08:32:44.8140752Z   âœ“ update:workflow can activate a specific workflow (29 ms)
2025-04-15T08:32:44.8141603Z   âœ“ update:workflow can deactivate a specific workflow (14 ms)
2025-04-15T08:32:44.8142032Z 
2025-04-15T08:32:47.6326815Z PASS src/external-secrets.ee/providers/__tests__/gcp-secrets-manager.test.ts
2025-04-15T08:32:47.6373525Z   GCP Secrets Manager
2025-04-15T08:32:47.6377027Z     âœ“ should update cached secrets (9 ms)
2025-04-15T08:32:47.6379933Z 
2025-04-15T08:32:52.2102419Z PASS src/credentials/__tests__/credentials.controller.test.ts
2025-04-15T08:32:52.2103325Z   CredentialsController
2025-04-15T08:32:52.2103792Z     createCredentials
2025-04-15T08:32:52.2104698Z       âœ“ should create new credentials and emit "credentials-created" (6 ms)
2025-04-15T08:32:52.2105164Z 
2025-04-15T08:32:54.9983133Z PASS test/integration/environments/source-control.api.test.ts (31.243 s)
2025-04-15T08:32:54.9984384Z   GET /sourceControl/preferences
2025-04-15T08:32:54.9985276Z     âœ“ should return Source Control preferences (35 ms)
2025-04-15T08:32:54.9987892Z     âœ“ should return repo sync status (15 ms)
2025-04-15T08:32:54.9989191Z     âœ“ refreshing key pairsshould return new rsa key (1420 ms)
2025-04-15T08:32:54.9991513Z 
2025-04-15T08:32:56.2787680Z PASS src/scaling/__tests__/job-processor.service.test.ts
2025-04-15T08:32:56.2788889Z   JobProcessor
2025-04-15T08:32:56.2790180Z     âœ“ should refrain from processing a crashed execution (7 ms)
2025-04-15T08:32:56.2791646Z     âœ“ should use manualExecutionService to process a job in "manual" mode (13 ms)
2025-04-15T08:32:56.2793317Z     âœ“ should use manualExecutionService to process a job in "evaluation" mode (2 ms)
2025-04-15T08:32:56.2883639Z 
2025-04-15T08:32:57.8135843Z PASS src/collaboration/__tests__/collaboration.state.test.ts
2025-04-15T08:32:57.8138911Z   CollaborationState
2025-04-15T08:32:57.8140041Z     addCollaborator
2025-04-15T08:32:57.8142987Z       âœ“ should add workflow user with correct cache key and value (9 ms)
2025-04-15T08:32:57.8143710Z     removeCollaborator
2025-04-15T08:32:57.8144426Z       âœ“ should remove workflow user with correct cache key (1 ms)
2025-04-15T08:32:57.8144983Z     getCollaborators
2025-04-15T08:32:57.8163694Z       âœ“ should get workflows with correct cache key (1 ms)
2025-04-15T08:32:57.8164598Z       âœ“ should get workflow users that are not expired (9 ms)
2025-04-15T08:32:57.8166542Z 
2025-04-15T08:32:59.2295609Z PASS src/decorators/__tests__/on-shutdown.test.ts
2025-04-15T08:32:59.2300649Z   OnShutdown
2025-04-15T08:32:59.2302112Z     âœ“ should register a methods that is decorated with OnShutdown (8 ms)
2025-04-15T08:32:59.2304733Z     âœ“ should register multiple methods in the same class (10 ms)
2025-04-15T08:32:59.2308706Z     âœ“ should use the given priority (1 ms)
2025-04-15T08:32:59.2311238Z     âœ“ should throw an error if the decorated member is not a function (14 ms)
2025-04-15T08:32:59.2313943Z     âœ“ should throw if the priority is invalid (6 ms)
2025-04-15T08:32:59.2315953Z 
2025-04-15T08:33:00.3260379Z PASS src/evaluation.ee/test-runner/__tests__/evaluation-metrics.ee.test.ts
2025-04-15T08:33:00.3313396Z   EvaluationMetrics
2025-04-15T08:33:00.3315028Z     âœ“ should aggregate metrics correctly (7 ms)
2025-04-15T08:33:00.3316078Z     âœ“ should throw when metric value is not number (14 ms)
2025-04-15T08:33:00.3320453Z     âœ“ should handle empty metrics
2025-04-15T08:33:00.3325054Z     âœ“ should handle empty testMetrics (1 ms)
2025-04-15T08:33:00.3329521Z     âœ“ should ignore non-relevant values
2025-04-15T08:33:00.3334649Z     âœ“ should report info on added metrics (2 ms)
2025-04-15T08:33:00.3335791Z 
2025-04-15T08:33:05.0454742Z PASS test/integration/database/repositories/workflow.repository.test.ts (27.702 s)
2025-04-15T08:33:05.0456039Z   WorkflowRepository
2025-04-15T08:33:05.0456381Z     activateAll
2025-04-15T08:33:05.0457085Z       âœ“ should activate all workflows (107 ms)
2025-04-15T08:33:05.0457568Z     deactivateAll
2025-04-15T08:33:05.0458117Z       âœ“ should deactivate all workflows (20 ms)
2025-04-15T08:33:05.0458563Z     getActiveIds
2025-04-15T08:33:05.0459189Z       âœ“ should return all active workflow IDs when invoked without maxResults (29 ms)
2025-04-15T08:33:05.0460285Z       âœ“ should return a capped number of active workflow IDs when invoked with maxResults (18 ms)
2025-04-15T08:33:05.0460861Z 
2025-04-15T08:33:05.2185263Z PASS src/workflows/__tests__/workflows.controller.test.ts
2025-04-15T08:33:05.2185912Z   WorkflowsController
2025-04-15T08:33:05.2186258Z     getFromUrl
2025-04-15T08:33:05.2186617Z       should return workflow data
2025-04-15T08:33:05.2187445Z         âœ“ when the URL points to a valid JSON file (7 ms)
2025-04-15T08:33:05.2188029Z       should throw a BadRequestError
2025-04-15T08:33:05.2188714Z         âœ“ when the URL does not point to a valid JSON file (37 ms)
2025-04-15T08:33:05.2189476Z         âœ“ when the data is not a valid n8n workflow JSON (1 ms)
2025-04-15T08:33:05.2190183Z         âœ“ when the data is missing required fields (8 ms)
2025-04-15T08:33:05.2191015Z 
2025-04-15T08:33:07.6558122Z PASS src/task-runners/task-broker/__tests__/task-broker-ws-server.test.ts
2025-04-15T08:33:07.6561817Z   TaskBrokerWsServer
2025-04-15T08:33:07.6563566Z     removeConnection
2025-04-15T08:33:07.6565949Z       âœ“ should close with 1000 status code by default (6 ms)
2025-04-15T08:33:07.6573103Z     heartbeat timer
2025-04-15T08:33:07.6573666Z       âœ“ should set up heartbeat timer on server start (1 ms)
2025-04-15T08:33:07.6574333Z       âœ“ should clear heartbeat timer on server stop (1 ms)
2025-04-15T08:33:07.6574766Z     sendMessage
2025-04-15T08:33:07.6575347Z       âœ“ should work with a message containing circular references (1 ms)
2025-04-15T08:33:07.6575800Z 
2025-04-15T08:33:10.3846039Z PASS src/metrics/__tests__/license-metrics.service.test.ts
2025-04-15T08:33:10.3846694Z   LicenseMetricsService
2025-04-15T08:33:10.3847054Z     collectPassthroughData
2025-04-15T08:33:10.3847882Z       âœ“ should return an object with active workflow IDs (7 ms)
2025-04-15T08:33:10.3848446Z     collectUsageMetrics
2025-04-15T08:33:10.3849058Z       âœ“ should return an array of expected usage metrics (1 ms)
2025-04-15T08:33:10.3849427Z 
2025-04-15T08:33:29.1515849Z PASS test/integration/workflow-tag-mapping.repository.integration.test.ts (29.664 s)
2025-04-15T08:33:29.1516751Z   WorkflowTagMappingRepository
2025-04-15T08:33:29.1517169Z     overwriteTaggings
2025-04-15T08:33:29.1517924Z       âœ“ should overwrite taggings in a workflow (44 ms)
2025-04-15T08:33:29.1518647Z       âœ“ should delete taggings if no tags are provided (14 ms)
2025-04-15T08:33:29.1519027Z 
2025-04-15T08:33:31.5050495Z PASS src/evaluation.ee/test-runner/__tests__/format-test-case-execution-input-data.ee.test.ts
2025-04-15T08:33:31.5051600Z   formatTestCaseExecutionInputData
2025-04-15T08:33:31.5052640Z     âœ“ should format the test case execution input data correctly (12 ms)
2025-04-15T08:33:31.5053323Z 
2025-04-15T08:33:34.4367167Z PASS src/posthog/__tests__/posthog.test.ts
2025-04-15T08:33:34.4377014Z   PostHog
2025-04-15T08:33:34.4377735Z     âœ“ inits PostHog correctly (9 ms)
2025-04-15T08:33:34.4378534Z     âœ“ does not initialize or track if diagnostics are not enabled (1 ms)
2025-04-15T08:33:34.4379264Z     âœ“ captures PostHog events (2 ms)
2025-04-15T08:33:34.4379809Z     âœ“ gets feature flags (8 ms)
2025-04-15T08:33:34.4380083Z 
2025-04-15T08:33:36.8277981Z PASS test/integration/debug.controller.test.ts (31.324 s)
2025-04-15T08:33:36.8283757Z   DebugController
2025-04-15T08:33:36.8284184Z     GET /debug/multi-main-setup
2025-04-15T08:33:36.8285053Z       âœ“ should return multi-main setup details (33 ms)
2025-04-15T08:33:36.8285456Z 
2025-04-15T08:33:39.2443301Z PASS src/task-runners/__tests__/task-runner-process-restart-loop-detector.test.ts
2025-04-15T08:33:39.2444862Z   TaskRunnerProcessRestartLoopDetector
2025-04-15T08:33:39.2450230Z     âœ“ should detect a restart loop if process exits 5 times within 5s (7 ms)
2025-04-15T08:33:39.2451372Z     âœ“ should not detect a restart loop if process exits less than 5 times within 5s (3 ms)
2025-04-15T08:33:39.2454414Z 
2025-04-15T08:33:42.7483613Z PASS test/integration/eventbus.test.ts (32.092 s)
2025-04-15T08:33:42.7485886Z   GET /eventbus/destination
2025-04-15T08:33:42.7489588Z     âœ“ should fail due to missing authentication (28 ms)
2025-04-15T08:33:42.7491995Z     âœ“ should fail due to missing license when authenticated (16 ms)
2025-04-15T08:33:42.7492561Z   POST /eventbus/destination
2025-04-15T08:33:42.7493326Z     âœ“ should fail due to missing authentication (4 ms)
2025-04-15T08:33:42.7494080Z     âœ“ should fail due to missing license when authenticated (9 ms)
2025-04-15T08:33:42.7494641Z   DELETE /eventbus/destination
2025-04-15T08:33:42.7495254Z     âœ“ should fail due to missing authentication (4 ms)
2025-04-15T08:33:42.7495977Z     âœ“ should fail due to missing license when authenticated (11 ms)
2025-04-15T08:33:42.7496368Z 
2025-04-15T08:33:45.8529504Z PASS src/sso.ee/saml/routes/__tests__/saml.controller.ee.test.ts
2025-04-15T08:33:45.8531205Z   Test views
2025-04-15T08:33:45.8533517Z     âœ“ Should render success with template (6 ms)
2025-04-15T08:33:45.8534837Z     âœ“ Should render failure with template (1 ms)
2025-04-15T08:33:45.8535434Z     âœ“ Should render error with template
2025-04-15T08:33:45.8535756Z 
2025-04-15T08:33:48.3790884Z PASS src/environments.ee/source-control/__tests__/source-control-git.service.test.ts
2025-04-15T08:33:48.3793656Z   SourceControlGitService
2025-04-15T08:33:48.3794046Z     getBranches
2025-04-15T08:33:48.3794767Z       âœ“ should support branch names containing slashes (5 ms)
2025-04-15T08:33:48.3795263Z     initRepository
2025-04-15T08:33:48.3795675Z       when local repo is set up after remote is ready
2025-04-15T08:33:48.3796297Z         âœ“ should track remote (2 ms)
2025-04-15T08:33:48.3796572Z 
2025-04-15T08:33:50.5866302Z PASS src/task-runners/__tests__/sliding-window-signal.test.ts
2025-04-15T08:33:50.5868190Z   SlidingWindowSignal
2025-04-15T08:33:50.5869275Z     âœ“ should return the last signal if within window size (7 ms)
2025-04-15T08:33:50.5870255Z     âœ“ should return null if there is no signal within the window (3 ms)
2025-04-15T08:33:50.5871204Z     âœ“ should return null if "exit" event is not emitted before timeout (1 ms)
2025-04-15T08:33:50.5872190Z     âœ“ should return the signal emitted on "exit" event before timeout (1 ms)
2025-04-15T08:33:50.5872657Z 
2025-04-15T08:33:52.9610225Z PASS src/services/cache/__tests__/cache-mock.service.test.ts
2025-04-15T08:33:52.9611791Z   CacheService (Mock)
2025-04-15T08:33:52.9612653Z     should prevent use of empty keys
2025-04-15T08:33:52.9659745Z       âœ“ get (8 ms)
2025-04-15T08:33:52.9660198Z       âœ“ getMany (1 ms)
2025-04-15T08:33:52.9660580Z       âœ“ set (2 ms)
2025-04-15T08:33:52.9660998Z       âœ“ setMany (2 ms)
2025-04-15T08:33:52.9661389Z       âœ“ delete
2025-04-15T08:33:52.9661720Z       âœ“ deleteMany
2025-04-15T08:33:52.9661908Z 
2025-04-15T08:34:04.4823451Z PASS src/modules/insights/database/entities/__tests__/insights-raw.test.ts (29.817 s)
2025-04-15T08:34:04.4824349Z   Insights Raw Entity
2025-04-15T08:34:04.4825245Z     âœ“ `success` can be serialized and deserialized correctly (9 ms)
2025-04-15T08:34:04.4826126Z     âœ“ `failure` can be serialized and deserialized correctly (1 ms)
2025-04-15T08:34:04.4827005Z     âœ“ `runtime_ms` can be serialized and deserialized correctly (1 ms)
2025-04-15T08:34:04.4827934Z     âœ“ `time_saved_min` can be serialized and deserialized correctly (1 ms)
2025-04-15T08:34:04.4828862Z     âœ“ `timestamp` can be serialized and deserialized correctly (2 ms)
2025-04-15T08:34:04.4829656Z     âœ“ timestamp uses the correct default value (67 ms)
2025-04-15T08:34:04.4830018Z 
2025-04-15T08:34:06.9567415Z PASS src/services/__tests__/jwt.service.test.ts
2025-04-15T08:34:06.9570455Z   JwtService
2025-04-15T08:34:06.9572523Z     secret initialization
2025-04-15T08:34:06.9577416Z       âœ“ should read the secret from config, when set (7 ms)
2025-04-15T08:34:06.9578400Z       âœ“ should derive the secret from encryption key when not set in config (1 ms)
2025-04-15T08:34:06.9579045Z     with a secret set
2025-04-15T08:34:06.9579439Z       âœ“ should sign (3 ms)
2025-04-15T08:34:06.9579968Z       âœ“ should decode and verify payload (2 ms)
2025-04-15T08:34:06.9580667Z       âœ“ should throw an error on verify if the token is expired (9 ms)
2025-04-15T08:34:06.9581022Z 
2025-04-15T08:34:08.9080514Z PASS test/integration/security-audit/filesystem-risk-reporter.test.ts (29.437 s)
2025-04-15T08:34:08.9090590Z   âœ“ should report filesystem interaction nodes (90 ms)
2025-04-15T08:34:08.9091551Z   âœ“ should not report non-filesystem-interaction node (12 ms)
2025-04-15T08:34:08.9091991Z 
2025-04-15T08:34:09.1862643Z PASS src/external-secrets.ee/providers/__tests__/azure-key-vault.test.ts
2025-04-15T08:34:09.1864281Z   AzureKeyVault
2025-04-15T08:34:09.1865413Z     âœ“ should update cached secrets (121 ms)
2025-04-15T08:34:09.1865994Z 
2025-04-15T08:34:11.7134630Z PASS src/executions/__tests__/execution-data.service.test.ts
2025-04-15T08:34:11.7136047Z   ExecutionDataService
2025-04-15T08:34:11.7138670Z     generateFailedExecutionFromError
2025-04-15T08:34:11.7144319Z       âœ“ should generate a failed execution with error details (17 ms)
2025-04-15T08:34:11.7149707Z       âœ“ should generate a failed execution without node details if node is undefined (1 ms)
2025-04-15T08:34:11.7151770Z 
2025-04-15T08:34:11.9880472Z PASS src/task-runners/task-broker/__tests__/task-broker-server.test.ts
2025-04-15T08:34:11.9898354Z   TaskBrokerServer
2025-04-15T08:34:11.9898751Z     handleUpgradeRequest
2025-04-15T08:34:11.9899722Z       âœ“ should close WebSocket when response status code is > 200 (11 ms)
2025-04-15T08:34:11.9900703Z       âœ“ should not close WebSocket when response status code is 200 (2 ms)
2025-04-15T08:34:11.9905379Z 
2025-04-15T08:34:14.3401162Z PASS src/task-runners/errors/__tests__/task-runner-disconnected-error.test.ts
2025-04-15T08:34:14.3402360Z   TaskRunnerDisconnectedError
2025-04-15T08:34:14.3403657Z     âœ“ should have the correct default error message (6 ms)
2025-04-15T08:34:14.3404687Z     âœ“ should have the error level set to "error"
2025-04-15T08:34:14.3433962Z     âœ“ should set the correct description for non-cloud deployments (1 ms)
2025-04-15T08:34:14.3435160Z     âœ“ should set the correct description for cloud deployments (1 ms)
2025-04-15T08:34:14.3435816Z 
2025-04-15T08:34:15.0331332Z PASS src/databases/repositories/__tests__/workflow-statistics.test.ts
2025-04-15T08:34:15.0332112Z   insertWorkflowStatistics
2025-04-15T08:34:15.0333204Z     âœ“ Successfully inserts data when it is not yet present (8 ms)
2025-04-15T08:34:15.0333997Z     âœ“ Does not insert when data is present (1 ms)
2025-04-15T08:34:15.0334660Z     âœ“ throws an error when insertion fails (1 ms)
2025-04-15T08:34:15.0335054Z 
2025-04-15T08:34:16.8545898Z PASS src/modules/__tests__/modules.config.test.ts
2025-04-15T08:34:16.8546863Z   ModulesConfig
2025-04-15T08:34:16.8548112Z     âœ“ should initialize with insights modules if no environment variable is set (8 ms)
2025-04-15T08:34:16.8549456Z     âœ“ should parse valid module names from environment variable (1 ms)
2025-04-15T08:34:16.8550624Z     âœ“ should disable valid module names from environment variable (1 ms)
2025-04-15T08:34:16.8551717Z     âœ“ should throw UnexpectedError for invalid module names (29 ms)
2025-04-15T08:34:16.8553244Z     âœ“ should throw UnexpectedError if any module is both enabled and disabled (1 ms)
2025-04-15T08:34:16.8554553Z     âœ“ should throw UnexpectedError if any enabled module name is invalid (1 ms)
2025-04-15T08:34:16.8555921Z     âœ“ should throw UnexpectedError if any disabled module name is invalid (1 ms)
2025-04-15T08:34:16.8556654Z 
2025-04-15T08:34:17.6079050Z PASS src/__tests__/utils.test.ts
2025-04-15T08:34:17.6080935Z   shouldAssignExecuteMethod
2025-04-15T08:34:17.6086209Z     âœ“ should return true when node has no execute, poll, trigger, webhook (unless declarative), or methods (6 ms)
2025-04-15T08:34:17.6087140Z     âœ“ should return false when node has execute (1 ms)
2025-04-15T08:34:17.6087749Z     âœ“ should return false when node has poll
2025-04-15T08:34:17.6088428Z     âœ“ should return false when node has trigger
2025-04-15T08:34:17.6089155Z     âœ“ should return false when node has webhook and is not declarative
2025-04-15T08:34:17.6090005Z     âœ“ should return true when node has webhook but is declarative (1 ms)
2025-04-15T08:34:17.6090709Z     âœ“ should return false when node has methods
2025-04-15T08:34:17.6091016Z 
2025-04-15T08:34:19.9749284Z PASS src/sso.ee/saml/__tests__/saml-helpers.test.ts
2025-04-15T08:34:19.9750248Z   sso/saml/samlHelpers
2025-04-15T08:34:19.9764994Z     updateUserFromSamlAttributes
2025-04-15T08:34:19.9766954Z       âœ“ does not user `Repository.update`, but `Repository.save` instead (6 ms)
2025-04-15T08:34:19.9768288Z 
2025-04-15T08:34:23.2520106Z PASS test/integration/task-runners/task-runner-module.external.test.ts
2025-04-15T08:34:23.2530162Z   TaskRunnerModule in external mode
2025-04-15T08:34:23.2530654Z     start
2025-04-15T08:34:23.2531439Z       âœ“ should throw if the task runner is disabled (18 ms)
2025-04-15T08:34:23.2533064Z       âœ“ should throw if auth token is missing (11 ms)
2025-04-15T08:34:23.2533782Z       âœ“ should start the task runner (398 ms)
2025-04-15T08:34:23.2534536Z       âœ“ should use DefaultTaskRunnerDisconnectAnalyzer (1 ms)
2025-04-15T08:34:23.2534979Z 
2025-04-15T08:34:23.5453947Z PASS test/integration/services/workflow-static-data.service.test.ts (30.358 s)
2025-04-15T08:34:23.5454959Z   WorkflowStaticDataService
2025-04-15T08:34:23.5456083Z     âœ“ should not change workflow updatedAt when calling saveStaticData (26 ms)
2025-04-15T08:34:23.5457115Z     âœ“ should not change workflow updatedAt when calling saveStaticDataById (5 ms)
2025-04-15T08:34:23.5457589Z 
2025-04-15T08:34:25.7840809Z PASS src/modules/insights/__tests__/insights.pre-init.test.ts
2025-04-15T08:34:25.7853068Z   InsightsModulePreInit
2025-04-15T08:34:25.7866435Z     âœ“ should return false if instance type is not "main" (5 ms)
2025-04-15T08:34:25.7867343Z     âœ“ should return false if database type is "sqlite" and poolSize is < 1 (1 ms)
2025-04-15T08:34:25.7868273Z     âœ“ should return true if instance type is "main" and database is not sqlite
2025-04-15T08:34:25.7869142Z     âœ“ should return true if instance type is "main" and database is not sqlite
2025-04-15T08:34:25.7870060Z     âœ“ should return true if instance type is "main" and database is not sqlite (1 ms)
2025-04-15T08:34:25.7870975Z     âœ“ should return true if instance type is "main" and sqlite poolSize is >= 1
2025-04-15T08:34:25.7871403Z 
2025-04-15T08:34:26.8041887Z PASS src/controllers/__tests__/translation.controller.test.ts
2025-04-15T08:34:26.8045133Z   TranslationController
2025-04-15T08:34:26.8045566Z     getCredentialTranslation
2025-04-15T08:34:26.8046468Z       âœ“ should throw 400 on invalid credential types (20 ms)
2025-04-15T08:34:26.8047458Z       âœ“ should return translation json on valid credential types (2 ms)
2025-04-15T08:34:26.8047960Z 
2025-04-15T08:34:29.3812957Z PASS src/errors/response-errors/__tests__/webhook-not-found.error.test.ts
2025-04-15T08:34:29.3817011Z   utils test webhookNotFoundErrorMessage 
2025-04-15T08:34:29.3820925Z     âœ“ should return a message with path and method (7 ms)
2025-04-15T08:34:29.3825210Z     âœ“ should return a message with path
2025-04-15T08:34:29.3827546Z     âœ“ should return a message with method with tip (1 ms)
2025-04-15T08:34:29.3845331Z     âœ“ should return a message with method with tip (1 ms)
2025-04-15T08:34:29.3846250Z     âœ“ should return a message with method with tip (1 ms)
2025-04-15T08:34:29.3846808Z 
2025-04-15T08:34:51.4721163Z PASS test/integration/auth.mw.test.ts (33.678 s)
2025-04-15T08:34:51.4723657Z   Auth Middleware
2025-04-15T08:34:51.4725587Z     Routes requiring Authentication
2025-04-15T08:34:51.4728564Z       âœ“ patch /me should return 401 Unauthorized if no cookie (26 ms)
2025-04-15T08:34:51.4731024Z       âœ“ patch /me/password should return 401 Unauthorized if no cookie (4 ms)
2025-04-15T08:34:51.4735400Z       âœ“ post /me/survey should return 401 Unauthorized if no cookie (3 ms)
2025-04-15T08:34:51.4739874Z       âœ“ post /invitations should return 401 Unauthorized if no cookie (4 ms)
2025-04-15T08:34:51.4740879Z       âœ“ delete /users/123 should return 401 Unauthorized if no cookie (4 ms)
2025-04-15T08:34:51.4741533Z     Routes requiring Authorization
2025-04-15T08:34:51.4742308Z       âœ“ post /invitations should return 403 Forbidden for member (14 ms)
2025-04-15T08:34:51.4743464Z       âœ“ delete /users/123 should return 403 Forbidden for member (8 ms)
2025-04-15T08:34:51.4743902Z 
2025-04-15T08:34:54.1049917Z PASS src/scaling/__tests__/subscriber.service.test.ts
2025-04-15T08:34:54.1051400Z   Subscriber
2025-04-15T08:34:54.1052256Z     constructor
2025-04-15T08:34:54.1058510Z       âœ“ should init Redis client in scaling mode (9 ms)
2025-04-15T08:34:54.1059319Z       âœ“ should not init Redis client in regular mode
2025-04-15T08:34:54.1059776Z     shutdown
2025-04-15T08:34:54.1060260Z       âœ“ should disconnect Redis client (2 ms)
2025-04-15T08:34:54.1060719Z     subscribe
2025-04-15T08:34:54.1061200Z       âœ“ should subscribe to pubsub channel (1 ms)
2025-04-15T08:34:54.1062072Z 
2025-04-15T08:34:56.9978635Z PASS src/databases/repositories/__tests__/credentials.repository.test.ts
2025-04-15T08:34:57.0039249Z   findMany
2025-04-15T08:34:57.0040352Z     âœ“ return `data` property if `includeData:true` and select is using the record syntax (5 ms)
2025-04-15T08:34:57.0041481Z     âœ“ return `data` property if `includeData:true` and select is using the record syntax
2025-04-15T08:34:57.0042014Z 
2025-04-15T08:34:57.6519410Z PASS test/integration/user.repository.test.ts (31.63 s)
2025-04-15T08:34:57.6520162Z   UserRepository
2025-04-15T08:34:57.6520529Z     countUsersByRole()
2025-04-15T08:34:57.6521406Z       âœ“ should return the number of users in each role (68 ms)
2025-04-15T08:34:57.6522054Z     createUserWithProject()
2025-04-15T08:34:57.6522933Z       âœ“ should create personal project for a user (16 ms)
2025-04-15T08:34:57.6523352Z 
2025-04-15T08:34:59.1636948Z PASS src/services/__tests__/url.service.test.ts
2025-04-15T08:34:59.1659266Z   UrlService
2025-04-15T08:34:59.1659780Z     getInstanceBaseUrl
2025-04-15T08:34:59.1660538Z       âœ“ should set URL from N8N_EDITOR_BASE_URL (8 ms)
2025-04-15T08:34:59.1661161Z       âœ“ should set URL from WEBHOOK_URL (2 ms)
2025-04-15T08:34:59.1661895Z       âœ“ should trim quotes when setting URL from N8N_EDITOR_BASE_URL (1 ms)
2025-04-15T08:34:59.1662916Z       âœ“ should trim quotes when setting URL from WEBHOOK_URL (1 ms)
2025-04-15T08:34:59.1663328Z 
2025-04-15T08:35:01.1007110Z PASS test/integration/task-runners/task-runner-server.test.ts
2025-04-15T08:35:01.1011888Z   TaskBrokerServer
2025-04-15T08:35:01.1016398Z     /healthz
2025-04-15T08:35:01.1020747Z       âœ“ should return 200 (32 ms)
2025-04-15T08:35:01.1025212Z     /runners/_ws
2025-04-15T08:35:01.1029743Z       âœ“ should return 429 when too many requests are made (29 ms)
2025-04-15T08:35:01.1035118Z     /runners/auth
2025-04-15T08:35:01.1039542Z       âœ“ should return 429 when too many requests are made (36 ms)
2025-04-15T08:35:01.1043934Z 
2025-04-15T08:35:02.0914408Z PASS test/integration/task-runners/task-broker-server.test.ts
2025-04-15T08:35:02.0915294Z   TaskBrokerServer
2025-04-15T08:35:02.0915622Z     /healthz
2025-04-15T08:35:02.0916283Z       âœ“ should return 200 (24 ms)
2025-04-15T08:35:02.0916667Z     /runners/_ws
2025-04-15T08:35:02.0917245Z       âœ“ should return 429 when too many requests are made (26 ms)
2025-04-15T08:35:02.0917752Z     /runners/auth
2025-04-15T08:35:02.0918314Z       âœ“ should return 429 when too many requests are made (23 ms)
2025-04-15T08:35:02.0918700Z 
2025-04-15T08:35:02.9841338Z PASS test/integration/services/execution-metadata.service.test.ts (33.408 s)
2025-04-15T08:35:02.9842281Z   ProjectService
2025-04-15T08:35:02.9843553Z     save
2025-04-15T08:35:02.9844589Z       âœ“ should deduplicate entries by exeuctionId and key, keeping the latest one (44 ms)
2025-04-15T08:35:02.9845182Z 
2025-04-15T08:35:06.3452513Z PASS src/workflows/workflow-history.ee/__tests__/workflow-history-helper.ee.test.ts
2025-04-15T08:35:06.3455737Z   getWorkflowHistoryPruneTime
2025-04-15T08:35:06.3458414Z     âœ“ should return -1 (infinite) if config and license are -1 (6 ms)
2025-04-15T08:35:06.3459554Z     âœ“ should return config time if license is infinite and config is not (1 ms)
2025-04-15T08:35:06.3467945Z     âœ“ should return license time if config is infinite and license is not (1 ms)
2025-04-15T08:35:06.3468905Z     âœ“ should return lowest of config and license time if both are not -1
2025-04-15T08:35:06.3469377Z 
2025-04-15T08:35:06.7606059Z PASS src/controllers/__tests__/users.controller.test.ts
2025-04-15T08:35:06.7608612Z   UsersController
2025-04-15T08:35:06.7609409Z     changeGlobalRole
2025-04-15T08:35:06.7610365Z       âœ“ should emit event user-changed-role (6 ms)
2025-04-15T08:35:06.7611333Z 
2025-04-15T08:35:09.7496121Z PASS src/services/__tests__/password.utility.test.ts
2025-04-15T08:35:09.7498641Z   PasswordUtility
2025-04-15T08:35:09.7499005Z     hash()
2025-04-15T08:35:09.7499710Z       âœ“ should hash a plaintext password (134 ms)
2025-04-15T08:35:09.7500642Z     compare()
2025-04-15T08:35:09.7502967Z       âœ“ should return true on match (204 ms)
2025-04-15T08:35:09.7503596Z       âœ“ should return false on mismatch (200 ms)
2025-04-15T08:35:09.7504130Z 
2025-04-15T08:35:14.0416937Z PASS src/services/__tests__/orchestration.service.test.ts
2025-04-15T08:35:14.0417799Z   Orchestration Service
2025-04-15T08:35:14.0418657Z     âœ“ should initialize (5 ms)
2025-04-15T08:35:14.0419087Z 
2025-04-15T08:35:17.2541860Z PASS src/ldap.ee/__tests__/helpers.test.ts
2025-04-15T08:35:17.2555399Z   Ldap/helpers
2025-04-15T08:35:17.2555803Z     updateLdapUserOnLocalDb
2025-04-15T08:35:17.2557189Z       âœ“ does not use `Repository.update`, but `Repository.save` instead (7 ms)
2025-04-15T08:35:17.2559321Z 
2025-04-15T08:35:19.5082475Z PASS src/evaluation.ee/test-runner/__tests__/get-test-run-final-result.ee.test.ts
2025-04-15T08:35:19.5087564Z   getTestRunFinalResult
2025-04-15T08:35:19.5089577Z     âœ“ should return success if all test cases are successful (7 ms)
2025-04-15T08:35:19.5092046Z     âœ“ should return error if at least one test case is errored (1 ms)
2025-04-15T08:35:19.5094909Z     âœ“ should return warning if at least one test case is warned (1 ms)
2025-04-15T08:35:19.5095713Z     âœ“ should return error if there are errors and warnings
2025-04-15T08:35:19.5096086Z 
2025-04-15T08:35:21.8552315Z PASS src/evaluation.ee/test-runner/__tests__/get-start-node.ee.test.ts
2025-04-15T08:35:21.8557273Z   getPastExecutionStartNode
2025-04-15T08:35:21.8562034Z     âœ“ should return the start node of the past execution (12 ms)
2025-04-15T08:35:21.8564962Z     âœ“ should return the start node of the past execution with multiple triggers
2025-04-15T08:35:21.8566287Z     âœ“ should return the start node of the past execution with multiple triggers - chat trigger (1 ms)
2025-04-15T08:35:21.8566883Z 
2025-04-15T08:35:33.3310949Z PASS test/integration/cta.service.test.ts (31.973 s)
2025-04-15T08:35:33.3316482Z   CtaService
2025-04-15T08:35:33.3317095Z     getBecomeCreatorCta()
2025-04-15T08:35:33.3318348Z       âœ“ should return false if user has 0 active workflows with 0 successful production executions (21 ms)
2025-04-15T08:35:33.3319728Z       âœ“ should return false if user has 2 active workflows with 5 successful production executions (31 ms)
2025-04-15T08:35:33.3321083Z       âœ“ should return false if user has 3 active workflows with 4 successful production executions (25 ms)
2025-04-15T08:35:33.3322426Z       âœ“ should return true if user has 3 active workflows with 5 successful production executions (23 ms)
2025-04-15T08:35:33.3323238Z 
2025-04-15T08:35:36.0603966Z PASS test/integration/middlewares/body-parser.test.ts
2025-04-15T08:35:36.0606436Z   bodyParser
2025-04-15T08:35:36.0609249Z     âœ“ should handle uncompressed data (38 ms)
2025-04-15T08:35:36.0611321Z     âœ“ should handle gzip data (8 ms)
2025-04-15T08:35:36.0613585Z     âœ“ should handle deflate data (6 ms)
2025-04-15T08:35:36.0615279Z 
2025-04-15T08:35:38.5371557Z PASS src/databases/entities/__tests__/user.entity.test.ts
2025-04-15T08:35:38.5376188Z   User Entity
2025-04-15T08:35:38.5376857Z     JSON.stringify
2025-04-15T08:35:38.5379039Z       âœ“ should not serialize sensitive data (6 ms)
2025-04-15T08:35:38.5380055Z     createPersonalProjectName
2025-04-15T08:35:38.5383713Z       âœ“ given fistName: Nathan, lastName: Nathaniel and email: nathan@nathaniel.n8n this gives the projectName: "Nathan Nathaniel <nathan@nathaniel.n8n>" (1 ms)
2025-04-15T08:35:38.5385663Z       âœ“ given fistName: undefined, lastName: Nathaniel and email: nathan@nathaniel.n8n this gives the projectName: "<nathan@nathaniel.n8n>"
2025-04-15T08:35:38.5387433Z       âœ“ given fistName: Nathan, lastName: undefined and email: nathan@nathaniel.n8n this gives the projectName: "<nathan@nathaniel.n8n>"
2025-04-15T08:35:38.5389196Z       âœ“ given fistName: undefined, lastName: undefined and email: nathan@nathaniel.n8n this gives the projectName: "<nathan@nathaniel.n8n>"
2025-04-15T08:35:38.5390902Z       âœ“ given fistName: undefined, lastName: undefined and email: undefined this gives the projectName: "Unnamed Project" (1 ms)
2025-04-15T08:35:38.5393110Z       âœ“ given fistName: Nathan, lastName: Nathaniel and email: undefined this gives the projectName: "Unnamed Project"
2025-04-15T08:35:38.5393834Z 
2025-04-15T08:35:39.7794170Z PASS test/integration/workflows/workflows.controller-with-active-workflow-manager.ee.test.ts (33.236 s)
2025-04-15T08:35:39.7795351Z   PUT /:workflowId/transfer
2025-04-15T08:35:39.7796558Z     âœ“ can transfer an active workflow (118 ms)
2025-04-15T08:35:39.7800899Z 
2025-04-15T08:35:41.4145887Z PASS test/integration/task-runners/task-runner-module.internal.test.ts
2025-04-15T08:35:41.4151491Z   TaskRunnerModule in internal mode
2025-04-15T08:35:41.4152371Z     start
2025-04-15T08:35:41.4153485Z       âœ“ should throw if the task runner is disabled (15 ms)
2025-04-15T08:35:41.4154439Z       âœ“ should start the task runner (463 ms)
2025-04-15T08:35:41.4155373Z       âœ“ should use InternalTaskRunnerDisconnectAnalyzer (1 ms)
2025-04-15T08:35:41.4155994Z 
2025-04-15T08:35:42.3554730Z PASS src/utils/__tests__/object-to-error.test.ts
2025-04-15T08:35:42.3555380Z   objectToError
2025-04-15T08:35:42.3555712Z     node error handling
2025-04-15T08:35:42.3556630Z       âœ“ should create `NodeOperationError` when node is found (11 ms)
2025-04-15T08:35:42.3557503Z       âœ“ should create `Error` when node is not found (2 ms)
2025-04-15T08:35:42.3557894Z 
2025-04-15T08:35:45.9174061Z PASS src/services/__tests__/credentials-tester.service.test.ts
2025-04-15T08:35:45.9175171Z   CredentialsTester
2025-04-15T08:35:45.9176836Z     âœ“ should find the OAuth2 credential test for a generic OAuth2 API credential (4 ms)
2025-04-15T08:35:45.9177614Z 
2025-04-15T08:35:50.0675016Z PASS src/task-runners/__tests__/node-process-oom-detector.test.ts
2025-04-15T08:35:50.0678148Z   NodeProcessOomDetector
2025-04-15T08:35:50.0679414Z     âœ“ should detect an out-of-memory error in a monitored process (1404 ms)
2025-04-15T08:35:50.0680841Z     âœ“ should not detect an out-of-memory error in a process that exits normally (45 ms)
2025-04-15T08:35:50.0681651Z 
2025-04-15T08:35:53.2632909Z PASS src/execution-lifecycle/shared/__tests__/shared-hook-functions.test.ts
2025-04-15T08:35:53.2637189Z   determineFinalExecutionStatus
2025-04-15T08:35:53.2642441Z     âœ“ should return "error" when resultData.error exists (2 ms)
2025-04-15T08:35:53.2645394Z     âœ“ should return "waiting" when waitTill is defined (1 ms)
2025-04-15T08:35:53.2645973Z     When waitTill is not set
2025-04-15T08:35:53.2646526Z       âœ“ should return "canceled" (6 ms)
2025-04-15T08:35:53.2647085Z       âœ“ should return "crashed"
2025-04-15T08:35:53.2647560Z       âœ“ should return "error" (1 ms)
2025-04-15T08:35:53.2648072Z       âœ“ should return "success"
2025-04-15T08:35:53.2648899Z 
2025-04-15T08:35:54.9356006Z   console.log
2025-04-15T08:35:54.9361954Z     Migration "RenameAnalyticsToInsights1741167584277" failed, error: Can't add new command when connection is in closed state
2025-04-15T08:35:54.9367395Z 
2025-04-15T08:35:54.9368668Z       at Function.log (../../node_modules/.pnpm/@n8n+typeorm@0.3.20-12_@sentry+node@8.52.1_ioredis@5.3.2_mssql@10.0.2_mysql2@3.11.0_pg@_d8e1d9c1918afe722aa00ab5be03d957/node_modules/src/platform/PlatformTools.ts:230:17)
2025-04-15T08:35:54.9369913Z 
2025-04-15T08:35:54.9676186Z FAIL src/modules/insights/database/entities/__tests__/insights-by-period.test.ts (32.879 s)
2025-04-15T08:35:54.9677117Z   Insights By Period
2025-04-15T08:35:54.9682169Z     âœ• `time_saved_min` can be serialized and deserialized correctly (5 ms)
2025-04-15T08:35:54.9690639Z     âœ• `runtime_ms` can be serialized and deserialized correctly (1 ms)
2025-04-15T08:35:54.9691556Z     âœ• `failure` can be serialized and deserialized correctly
2025-04-15T08:35:54.9693168Z     âœ• `success` can be serialized and deserialized correctly (1 ms)
2025-04-15T08:35:54.9694109Z     âœ• `hour` can be serialized and deserialized correctly
2025-04-15T08:35:54.9695732Z     âœ• `day` can be serialized and deserialized correctly
2025-04-15T08:35:54.9696738Z     âœ• `week` can be serialized and deserialized correctly
2025-04-15T08:35:54.9697896Z 
2025-04-15T08:35:54.9698781Z   â— Insights By Period â€º `time_saved_min` can be serialized and deserialized correctly
2025-04-15T08:35:54.9700892Z 
2025-04-15T08:35:54.9701208Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:35:54.9702404Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:35:54.9703445Z 
2025-04-15T08:35:54.9704264Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:35:54.9705106Z      [90m 10 |[39m
2025-04-15T08:35:54.9705836Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:35:54.9706563Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:35:54.9707288Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:35:54.9716242Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:35:54.9717455Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:35:54.9717776Z 
2025-04-15T08:35:54.9718467Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:35:54.9719211Z 
2025-04-15T08:35:54.9719859Z   â— Insights By Period â€º `runtime_ms` can be serialized and deserialized correctly
2025-04-15T08:35:54.9720420Z 
2025-04-15T08:35:54.9720706Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:35:54.9721917Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:35:54.9723024Z 
2025-04-15T08:35:54.9723852Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:35:54.9724739Z      [90m 10 |[39m
2025-04-15T08:35:54.9725473Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:35:54.9726174Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:35:54.9726905Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:35:54.9728302Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:35:54.9729388Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:35:54.9729678Z 
2025-04-15T08:35:54.9730351Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:35:54.9731470Z 
2025-04-15T08:35:54.9732110Z   â— Insights By Period â€º `failure` can be serialized and deserialized correctly
2025-04-15T08:35:54.9732646Z 
2025-04-15T08:35:54.9733134Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:35:54.9734312Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:35:54.9735201Z 
2025-04-15T08:35:54.9736428Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:35:54.9737285Z      [90m 10 |[39m
2025-04-15T08:35:54.9737994Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:35:54.9738808Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:35:54.9739577Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:35:54.9740920Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:35:54.9742016Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:35:54.9742326Z 
2025-04-15T08:35:54.9743208Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:35:54.9744258Z 
2025-04-15T08:35:54.9744866Z   â— Insights By Period â€º `success` can be serialized and deserialized correctly
2025-04-15T08:35:54.9745409Z 
2025-04-15T08:35:54.9745683Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:35:54.9746870Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:35:54.9747712Z 
2025-04-15T08:35:54.9748484Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:35:54.9749329Z      [90m 10 |[39m
2025-04-15T08:35:54.9750042Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:35:54.9750818Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:35:54.9751524Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:35:54.9753077Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:35:54.9754199Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:35:54.9754500Z 
2025-04-15T08:35:54.9755163Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:35:54.9755880Z 
2025-04-15T08:35:54.9756466Z   â— Insights By Period â€º `hour` can be serialized and deserialized correctly
2025-04-15T08:35:54.9756970Z 
2025-04-15T08:35:54.9757252Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:35:54.9758434Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:35:54.9759275Z 
2025-04-15T08:35:54.9760088Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:35:54.9760936Z      [90m 10 |[39m
2025-04-15T08:35:54.9761628Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:35:54.9762339Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:35:54.9763265Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:35:54.9764634Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:35:54.9765678Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:35:54.9765944Z 
2025-04-15T08:35:54.9766618Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:35:54.9767351Z 
2025-04-15T08:35:54.9767906Z   â— Insights By Period â€º `day` can be serialized and deserialized correctly
2025-04-15T08:35:54.9768693Z 
2025-04-15T08:35:54.9768969Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:35:54.9770173Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:35:54.9771067Z 
2025-04-15T08:35:54.9771879Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:35:54.9772928Z      [90m 10 |[39m
2025-04-15T08:35:54.9773678Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:35:54.9774442Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:35:54.9775166Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:35:54.9776511Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:35:54.9777651Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:35:54.9777965Z 
2025-04-15T08:35:54.9778632Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:35:54.9779368Z 
2025-04-15T08:35:54.9780267Z   â— Insights By Period â€º `week` can be serialized and deserialized correctly
2025-04-15T08:35:54.9780786Z 
2025-04-15T08:35:54.9781078Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:35:54.9782276Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:35:54.9783337Z 
2025-04-15T08:35:54.9784147Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:35:54.9784999Z      [90m 10 |[39m
2025-04-15T08:35:54.9785720Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:35:54.9786479Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:35:54.9787210Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:35:54.9788546Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:35:54.9789683Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:35:54.9789986Z 
2025-04-15T08:35:54.9790673Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:35:54.9791393Z 
2025-04-15T08:35:57.5391195Z PASS src/utils/__tests__/path-util.test.ts
2025-04-15T08:35:57.5393219Z   isContainedWithin
2025-04-15T08:35:57.5395124Z     âœ“ should return true when parent and child paths are the same (4 ms)
2025-04-15T08:35:57.5400146Z     âœ“ should return true for parent /some/parent/folder and child /some/parent/folder/subfolder/file.txt
2025-04-15T08:35:57.5402869Z     âœ“ should return true for parent /some/parent/folder and child /some/parent/folder/../folder/subfolder/file.txt
2025-04-15T08:35:57.5404330Z     âœ“ should return true for parent /some/parent/folder/ and child /some/parent/folder/subfolder/file.txt (1 ms)
2025-04-15T08:35:57.5405584Z     âœ“ should return true for parent /some/parent/folder and child /some/parent/folder/subfolder/
2025-04-15T08:35:57.5406746Z     âœ“ should return false for parent /some/parent/folder and child /some/other/folder/file.txt
2025-04-15T08:35:57.5407979Z     âœ“ should return false for parent /some/parent/folder and child /some/parent/folder_but_not_really (1 ms)
2025-04-15T08:35:57.5409030Z     âœ“ should return false for parent /one/path and child /another/path
2025-04-15T08:35:57.5409465Z 
2025-04-15T08:36:00.5526742Z PASS src/services/__tests__/execution-metadata.service.test.ts
2025-04-15T08:36:00.5527495Z   ExecutionMetadataService
2025-04-15T08:36:00.5528299Z     âœ“ Execution metadata is saved in a batch (9 ms)
2025-04-15T08:36:00.5534859Z 
2025-04-15T08:36:02.9401209Z PASS src/decorators/__tests__/module.test.ts
2025-04-15T08:36:02.9402313Z   registerLifecycleHooks
2025-04-15T08:36:02.9405802Z     âœ“ is called when ModuleRegistry.registerLifecycleHooks is called (7 ms)
2025-04-15T08:36:02.9406352Z 
2025-04-15T08:36:06.1844647Z PASS src/environments.ee/source-control/__tests__/source-control-preferences.service.ee.test.ts
2025-04-15T08:36:06.1853950Z   SourceControlPreferencesService
2025-04-15T08:36:06.1854966Z     âœ“ should class validate correct preferences (9 ms)
2025-04-15T08:36:06.1855392Z 
2025-04-15T08:36:17.0266358Z PASS test/integration/commands/license.cmd.test.ts (34.472 s)
2025-04-15T08:36:17.0269315Z   âœ“ license:clear invokes clear() to release any floating entitlements and deletes the license cert from the DB (29 ms)
2025-04-15T08:36:17.0270100Z 
2025-04-15T08:36:19.5017226Z PASS src/validators/__tests__/no-url.validator.test.ts
2025-04-15T08:36:19.5023961Z   NoUrl
2025-04-15T08:36:19.5025445Z     URLs
2025-04-15T08:36:19.5026132Z       âœ“ should block http://google.com (7 ms)
2025-04-15T08:36:19.5027788Z       âœ“ should block www.domain.tld (1 ms)
2025-04-15T08:36:19.5028385Z       âœ“ should block n8n.io (1 ms)
2025-04-15T08:36:19.5028642Z 
2025-04-15T08:36:21.6564648Z PASS src/config/__tests__/index.test.ts
2025-04-15T08:36:21.6567159Z   userManagement.jwtRefreshTimeoutHours
2025-04-15T08:36:21.6569003Z     âœ“ resets jwtRefreshTimeoutHours to 0 if it's greater than or equal to jwtSessionDurationHours (7 ms)
2025-04-15T08:36:21.6569793Z 
2025-04-15T08:36:25.4301186Z PASS test/integration/saml/saml-helpers.test.ts (31.948 s)
2025-04-15T08:36:25.4303458Z   sso/saml/samlHelpers
2025-04-15T08:36:25.4303869Z     createUserFromSamlAttributes
2025-04-15T08:36:25.4304621Z       âœ“ Creates personal project for user (127 ms)
2025-04-15T08:36:25.4304919Z 
2025-04-15T08:36:36.0814200Z PASS test/integration/healthcheck.controller.test.ts (29.66 s)
2025-04-15T08:36:36.0815455Z   HealthcheckController
2025-04-15T08:36:36.0816349Z     âœ“ should return ok when DB is connected and migrated (17 ms)
2025-04-15T08:36:36.0817179Z     âœ“ should return error when DB is not connected (4 ms)
2025-04-15T08:36:36.0817548Z 
2025-04-15T08:36:36.2173692Z Summary of all failing tests
2025-04-15T08:36:36.2175346Z FAIL src/modules/insights/__tests__/insights.service.test.ts
2025-04-15T08:36:36.2176528Z   â— Test suite failed to run
2025-04-15T08:36:36.2176932Z 
2025-04-15T08:36:36.2177504Z     Jest worker encountered 4 child process exceptions, exceeding retry limit
2025-04-15T08:36:36.2178131Z 
2025-04-15T08:36:36.2179178Z       at ChildProcessWorker.initialize (../../node_modules/.pnpm/jest-worker@29.6.2/node_modules/jest-worker/build/workers/ChildProcessWorker.js:181:21)
2025-04-15T08:36:36.2180236Z 
2025-04-15T08:36:36.2263958Z FAIL src/modules/insights/database/entities/__tests__/insights-by-period.test.ts (32.879 s)
2025-04-15T08:36:36.2265314Z   â— Insights By Period â€º `time_saved_min` can be serialized and deserialized correctly
2025-04-15T08:36:36.2265832Z 
2025-04-15T08:36:36.2266081Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:36:36.2267217Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:36:36.2267996Z 
2025-04-15T08:36:36.2268760Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:36:36.2269575Z      [90m 10 |[39m
2025-04-15T08:36:36.2270250Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:36:36.2270936Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:36:36.2271645Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:36:36.2273124Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:36:36.2274255Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:36:36.2274541Z 
2025-04-15T08:36:36.2275668Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:36:36.2276376Z 
2025-04-15T08:36:36.2276972Z   â— Insights By Period â€º `runtime_ms` can be serialized and deserialized correctly
2025-04-15T08:36:36.2277487Z 
2025-04-15T08:36:36.2277763Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:36:36.2278907Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:36:36.2279722Z 
2025-04-15T08:36:36.2280452Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:36:36.2281239Z      [90m 10 |[39m
2025-04-15T08:36:36.2281925Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:36:36.2282573Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:36:36.2283393Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:36:36.2284635Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:36:36.2285592Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:36:36.2285860Z 
2025-04-15T08:36:36.2286745Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:36:36.2287411Z 
2025-04-15T08:36:36.2287937Z   â— Insights By Period â€º `failure` can be serialized and deserialized correctly
2025-04-15T08:36:36.2288412Z 
2025-04-15T08:36:36.2288652Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:36:36.2289788Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:36:36.2290611Z 
2025-04-15T08:36:36.2314026Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:36:36.2315186Z      [90m 10 |[39m
2025-04-15T08:36:36.2316102Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:36:36.2316994Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:36:36.2317888Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:36:36.2319413Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:36:36.2320611Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:36:36.2321095Z 
2025-04-15T08:36:36.2321954Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:36:36.2323098Z 
2025-04-15T08:36:36.2323866Z   â— Insights By Period â€º `success` can be serialized and deserialized correctly
2025-04-15T08:36:36.2324569Z 
2025-04-15T08:36:36.2325052Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:36:36.2343484Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:36:36.2353326Z 
2025-04-15T08:36:36.2357656Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:36:36.2361189Z      [90m 10 |[39m
2025-04-15T08:36:36.2362128Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:36:36.2383545Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:36:36.2384659Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:36:36.2386228Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:36:36.2387459Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:36:36.2390313Z 
2025-04-15T08:36:36.2391031Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:36:36.2392213Z 
2025-04-15T08:36:36.2392973Z   â— Insights By Period â€º `hour` can be serialized and deserialized correctly
2025-04-15T08:36:36.2393479Z 
2025-04-15T08:36:36.2393732Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:36:36.2394861Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:36:36.2396086Z 
2025-04-15T08:36:36.2396847Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:36:36.2397625Z      [90m 10 |[39m
2025-04-15T08:36:36.2398270Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:36:36.2398919Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:36:36.2399583Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:36:36.2400846Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:36:36.2401786Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:36:36.2402060Z 
2025-04-15T08:36:36.2402890Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:36:36.2403847Z 
2025-04-15T08:36:36.2404360Z   â— Insights By Period â€º `day` can be serialized and deserialized correctly
2025-04-15T08:36:36.2404806Z 
2025-04-15T08:36:36.2405065Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:36:36.2406429Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:36:36.2407202Z 
2025-04-15T08:36:36.2408648Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:36:36.2409415Z      [90m 10 |[39m
2025-04-15T08:36:36.2410207Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:36:36.2410848Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:36:36.2412143Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:36:36.2421103Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:36:36.2422097Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:36:36.2422381Z 
2025-04-15T08:36:36.2423235Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:36:36.2423942Z 
2025-04-15T08:36:36.2424496Z   â— Insights By Period â€º `week` can be serialized and deserialized correctly
2025-04-15T08:36:36.2424979Z 
2025-04-15T08:36:36.2425237Z     thrown: "Exceeded timeout of 30000 ms for a hook.
2025-04-15T08:36:36.2426370Z     Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
2025-04-15T08:36:36.2427176Z 
2025-04-15T08:36:36.2427870Z     [0m [90m  9 |[39m [36mlet[39m insightsRawRepository[33m:[39m [33mInsightsRawRepository[39m[33m;[39m
2025-04-15T08:36:36.2430323Z      [90m 10 |[39m
2025-04-15T08:36:36.2431030Z     [31m[1m>[22m[39m[90m 11 |[39m beforeAll([36masync[39m () [33m=>[39m {
2025-04-15T08:36:36.2431689Z      [90m    |[39m [31m[1m^[22m[39m
2025-04-15T08:36:36.2432406Z      [90m 12 |[39m 	[36mawait[39m testDb[33m.[39minit()[33m;[39m
2025-04-15T08:36:36.2433996Z      [90m 13 |[39m 	insightsRawRepository [33m=[39m [33mContainer[39m[33m.[39m[36mget[39m([33mInsightsRawRepository[39m)[33m;[39m
2025-04-15T08:36:36.2434984Z      [90m 14 |[39m })[33m;[39m[0m
2025-04-15T08:36:36.2435254Z 
2025-04-15T08:36:36.2435892Z       at Object.<anonymous> (src/modules/insights/database/entities/__tests__/insights-by-period.test.ts:11:1)
2025-04-15T08:36:36.2436843Z 
2025-04-15T08:36:36.2436865Z 
2025-04-15T08:36:36.2437154Z Test Suites: 2 failed, 248 passed, 250 total
2025-04-15T08:36:36.2437763Z Tests:       7 failed, 2751 passed, 2758 total
2025-04-15T08:36:36.2438293Z Snapshots:   3 passed, 3 total
2025-04-15T08:36:36.2438701Z Time:        789.678 s
2025-04-15T08:36:36.2439070Z Ran all test suites.
2025-04-15T08:36:37.4188490Z â€‰ELIFECYCLEâ€‰ Command failed with exit code 1.
2025-04-15T08:36:37.4639517Z ##[error]Process completed with exit code 1.

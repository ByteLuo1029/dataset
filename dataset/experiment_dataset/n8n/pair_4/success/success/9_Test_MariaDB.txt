2025-04-15T01:02:03.8576633Z ##[group]Run pnpm test:mariadb --testTimeout 30000
2025-04-15T01:02:03.8577036Z [36;1mpnpm test:mariadb --testTimeout 30000[0m
2025-04-15T01:02:03.8624383Z shell: /usr/bin/bash -e {0}
2025-04-15T01:02:03.8624631Z env:
2025-04-15T01:02:03.8624832Z   DB_MYSQLDB_PASSWORD: password
2025-04-15T01:02:03.8625077Z   TURBOGHA_PORT: 41230
2025-04-15T01:02:03.8625316Z   TURBO_API: http://localhost:41230
2025-04-15T01:02:03.8625573Z   TURBO_TOKEN: turbogha
2025-04-15T01:02:03.8625799Z   TURBO_TEAM: turbogha
2025-04-15T01:02:03.8625999Z ##[endgroup]
2025-04-15T01:02:04.2111865Z 
2025-04-15T01:02:04.2112834Z > n8n@1.89.0 test:mariadb /home/runner/work/n8n/n8n/packages/cli
2025-04-15T01:02:04.2114203Z > N8N_LOG_LEVEL=silent DB_TYPE=mariadb DB_TABLE_PREFIX=test_ jest --no-coverage --testTimeout 30000
2025-04-15T01:02:04.2114758Z 
2025-04-15T01:02:16.8221314Z PASS src/modules/insights/__tests__/insights.service.test.ts (11.327 s)
2025-04-15T01:02:16.8232914Z   workflowExecuteAfterHandler
2025-04-15T01:02:16.8233971Z     âœ“ stores events for executions with the status `success` (56 ms)
2025-04-15T01:02:16.8235042Z     âœ“ stores events for executions with the status `error` (23 ms)
2025-04-15T01:02:16.8235969Z     âœ“ stores events for executions with the status `crashed` (23 ms)
2025-04-15T01:02:16.8236922Z     âœ“ does not store events for executions with the status `waiting` (17 ms)
2025-04-15T01:02:16.8238158Z     âœ“ does not store events for executions with the status `canceled` (15 ms)
2025-04-15T01:02:16.8239513Z     âœ“ does not store events for executions with the status `unknown` (15 ms)
2025-04-15T01:02:16.8240478Z     âœ“ does not store events for executions with the status `new` (16 ms)
2025-04-15T01:02:16.8242656Z     âœ“ does not store events for executions with the status `running` (14 ms)
2025-04-15T01:02:16.8243695Z     âœ“ does not store events for executions with the mode `internal` (14 ms)
2025-04-15T01:02:16.8244684Z     âœ“ does not store events for executions with the mode `manual` (14 ms)
2025-04-15T01:02:16.8245672Z     âœ“ does not store events for executions with the mode `integrated` (13 ms)
2025-04-15T01:02:16.8246656Z     âœ“ stores events for executions with the mode `evaluation` (20 ms)
2025-04-15T01:02:16.8247545Z     âœ“ stores events for executions with the mode `error` (24 ms)
2025-04-15T01:02:16.8248376Z     âœ“ stores events for executions with the mode `cli` (18 ms)
2025-04-15T01:02:16.8249229Z     âœ“ stores events for executions with the mode `retry` (22 ms)
2025-04-15T01:02:16.8250100Z     âœ“ stores events for executions with the mode `trigger` (17 ms)
2025-04-15T01:02:16.8250948Z     âœ“ stores events for executions with the mode `webhook` (18 ms)
2025-04-15T01:02:16.8252265Z   workflowExecuteAfterHandler - cacheMetadata
2025-04-15T01:02:16.8253048Z     âœ“ reuses cached metadata for subsequent executions of the same workflow (15 ms)
2025-04-15T01:02:16.8253868Z     âœ“ updates cached metadata if workflow details change (12 ms)
2025-04-15T01:02:16.8254503Z   workflowExecuteAfterHandler - flushEvents
2025-04-15T01:02:16.8255254Z     âœ“ flushes events to the database once buffer is full (120 ms)
2025-04-15T01:02:16.8256027Z     âœ“ flushes events to the database after a timeout (39 ms)
2025-04-15T01:02:16.8256673Z     âœ“ reschedule flush on flushing end (22 ms)
2025-04-15T01:02:16.8257318Z     âœ“ flushes events to the database on shutdown (16 ms)
2025-04-15T01:02:16.8258015Z     âœ“ flushes events synchronously while shutting down (14 ms)
2025-04-15T01:02:16.8258709Z     âœ“ restore buffer events on flushing error (12 ms)
2025-04-15T01:02:16.8259385Z     âœ“ waits for ongoing flush during shutdown (19 ms)
2025-04-15T01:02:16.8259844Z   compaction
2025-04-15T01:02:16.8260151Z     compactRawToHour
2025-04-15T01:02:16.8260601Z       âœ“ compact into 2 rows (27 ms)
2025-04-15T01:02:16.8261113Z       âœ“ compact into 3 rows (29 ms)
2025-04-15T01:02:16.8261986Z       âœ“ batch compaction split events in hourly insight periods (266 ms)
2025-04-15T01:02:16.8263035Z       âœ“ batch compaction split events in hourly insight periods by type and workflow (271 ms)
2025-04-15T01:02:16.8264354Z       âœ“ should return the number of compacted events (258 ms)
2025-04-15T01:02:16.8265075Z       âœ“ works with data in the compacted table (66 ms)
2025-04-15T01:02:16.8265756Z       âœ“ works with data bigger than the batch size (198 ms)
2025-04-15T01:02:16.8266254Z     compactionSchedule
2025-04-15T01:02:16.8266766Z       âœ“ compaction is running on schedule (6 ms)
2025-04-15T01:02:16.8267221Z     compactHourToDay
2025-04-15T01:02:16.8267667Z       âœ“ compact into 2 rows (28 ms)
2025-04-15T01:02:16.8268168Z       âœ“ compact into 3 rows (32 ms)
2025-04-15T01:02:16.8268787Z       âœ“ recent insight periods should not be compacted (19 ms)
2025-04-15T01:02:16.8269301Z     compactDayToWeek
2025-04-15T01:02:16.8269746Z       âœ“ compact into 2 rows (25 ms)
2025-04-15T01:02:16.8270254Z       âœ“ compact into 3 rows (33 ms)
2025-04-15T01:02:16.8270895Z       âœ“ recent insight periods should not be compacted (20 ms)
2025-04-15T01:02:16.8271501Z     compaction threshold configuration
2025-04-15T01:02:16.8272601Z       âœ“ insights by period older than the hourly to daily threshold are not compacted (20 ms)
2025-04-15T01:02:16.8273732Z       âœ“ insights by period older than the daily to weekly threshold are not compacted (33 ms)
2025-04-15T01:02:16.8274392Z   getInsightsSummary
2025-04-15T01:02:16.8274939Z     âœ“ compacted data are summarized correctly (41 ms)
2025-04-15T01:02:16.8275732Z     âœ“ no data for previous period should return null deviation (25 ms)
2025-04-15T01:02:16.8276786Z     âœ“ mixed period data are summarized correctly (33 ms)
2025-04-15T01:02:16.8277286Z   getInsightsByWorkflow
2025-04-15T01:02:16.8277928Z     âœ“ compacted data are are grouped by workflow correctly (67 ms)
2025-04-15T01:02:16.8278804Z     âœ“ compacted data are grouped by workflow correctly with sorting (40 ms)
2025-04-15T01:02:16.8279759Z     âœ“ compacted data are grouped by workflow correctly with pagination (36 ms)
2025-04-15T01:02:16.8280893Z     âœ“ compacted data are grouped by workflow correctly even with 0 data (check division by 0) (18 ms)
2025-04-15T01:02:16.8281961Z   getInsightsByTime
2025-04-15T01:02:16.8282523Z     âœ“ returns empty array when no insights exist (16 ms)
2025-04-15T01:02:16.8283347Z     âœ“ returns empty array when no insights in the time range exists (23 ms)
2025-04-15T01:02:16.8284187Z     âœ“ compacted data are are grouped by time correctly (57 ms)
2025-04-15T01:02:16.8284660Z 
2025-04-15T01:02:21.2101951Z PASS test/integration/workflows/workflows.controller.ee.test.ts (15.679 s)
2025-04-15T01:02:21.2104431Z   router should switch based on flag
2025-04-15T01:02:21.2107112Z     âœ“ when sharing is disabled (105 ms)
2025-04-15T01:02:21.2111417Z     âœ“ when sharing is enabled (48 ms)
2025-04-15T01:02:21.2112143Z   PUT /workflows/:workflowId/share
2025-04-15T01:02:21.2112760Z     âœ“ should save sharing with new users (46 ms)
2025-04-15T01:02:21.2113499Z     âœ“ should succeed when sharing with invalid user-id (25 ms)
2025-04-15T01:02:21.2114232Z     âœ“ should allow sharing with pending users (31 ms)
2025-04-15T01:02:21.2114935Z     âœ“ should allow sharing with multiple users (29 ms)
2025-04-15T01:02:21.2115542Z     âœ“ should override sharing (50 ms)
2025-04-15T01:02:21.2116236Z     âœ“ should allow sharing by the owner of the workflow (29 ms)
2025-04-15T01:02:21.2116977Z     âœ“ should allow sharing by the instance owner (40 ms)
2025-04-15T01:02:21.2117717Z     âœ“ should not allow sharing by another shared member (32 ms)
2025-04-15T01:02:21.2118589Z     âœ“ should not allow sharing with self by another non-shared member (19 ms)
2025-04-15T01:02:21.2120440Z     âœ“ should not allow sharing by another non-shared member (31 ms)
2025-04-15T01:02:21.2121925Z     âœ“ should not call internal hooks listener for email sent if emailing is disabled (25 ms)
2025-04-15T01:02:21.2123029Z     âœ“ should ignore sharing with owner project (22 ms)
2025-04-15T01:02:21.2124122Z     âœ“ should ignore sharing with project that already has it shared (25 ms)
2025-04-15T01:02:21.2124764Z   GET /workflows/new
2025-04-15T01:02:21.2125601Z     âœ“ should return an auto-incremented name, even when sharing is enabled (27 ms)
2025-04-15T01:02:21.2127580Z     âœ“ should return an auto-incremented name, even when sharing is disabled (21 ms)
2025-04-15T01:02:21.2128417Z   GET /workflows/:workflowId
2025-04-15T01:02:21.2129266Z     âœ“ should fail with invalid id due to route rule (32 ms)
2025-04-15T01:02:21.2130115Z     âœ“ should return 404 for non existing workflow (13 ms)
2025-04-15T01:02:21.2130772Z     âœ“ project viewers can view workflows (35 ms)
2025-04-15T01:02:21.2131401Z     âœ“ should return a workflow with owner (30 ms)
2025-04-15T01:02:21.2132467Z     âœ“ should return tags (37 ms)
2025-04-15T01:02:21.2133310Z     âœ“ should return shared workflow with user data (40 ms)
2025-04-15T01:02:21.2134109Z     âœ“ should return all sharees (41 ms)
2025-04-15T01:02:21.2135222Z     âœ“ should return workflow with credentials owned by user (44 ms)
2025-04-15T01:02:21.2136588Z     âœ“ should return workflow with credentials saying owner does have access even when not shared (60 ms)
2025-04-15T01:02:21.2138294Z     âœ“ should return workflow with credentials saying admin does have access even when not shared (46 ms)
2025-04-15T01:02:21.2139815Z     âœ“ should return workflow with credentials for all users with or without access (67 ms)
2025-04-15T01:02:21.2141234Z     âœ“ should return workflow with credentials for all users with access (72 ms)
2025-04-15T01:02:21.2142866Z     âœ“ should return workflow credentials home project and shared with projects (63 ms)
2025-04-15T01:02:21.2144097Z   POST /workflows
2025-04-15T01:02:21.2144892Z     âœ“ project viewers cannot create workflows (42 ms)
2025-04-15T01:02:21.2167732Z     âœ“ Should create a workflow that uses no credential (23 ms)
2025-04-15T01:02:21.2168612Z     âœ“ Should save a new workflow with credentials (37 ms)
2025-04-15T01:02:21.2169593Z     âœ“ Should not allow saving a workflow using credential you have no access (20 ms)
2025-04-15T01:02:21.2170727Z     âœ“ Should allow owner to save a workflow using credential owned by others (33 ms)
2025-04-15T01:02:21.2172161Z     âœ“ Should allow saving a workflow using a credential owned by others and shared with you (41 ms)
2025-04-15T01:02:21.2173265Z     âœ“ Should create workflow history version when licensed (29 ms)
2025-04-15T01:02:21.2174241Z     âœ“ Should not create workflow history version when not licensed (24 ms)
2025-04-15T01:02:21.2174935Z   PATCH /workflows/:workflowId
2025-04-15T01:02:21.2175600Z     âœ“ project viewers cannot update workflows (22 ms)
2025-04-15T01:02:21.2176242Z     validate credential permissions to user
2025-04-15T01:02:21.2177037Z       âœ“ Should succeed when saving unchanged workflow nodes (63 ms)
2025-04-15T01:02:21.2178082Z       âœ“ Should allow owner to add node containing credential not shared with the owner (67 ms)
2025-04-15T01:02:21.2180038Z       âœ“ Tamper proofing kicks in if the workflow is owned by the owner and shared with the member, the credentials is owned by the owner, and the member tries to use the credential in the workflow (41 ms)
2025-04-15T01:02:21.2185136Z       âœ“ Tamper proofing kicks in if the workflow is owned by team 1, the credentials is owned by the member, and the member tries to use the credential in the workflow (39 ms)
2025-04-15T01:02:21.2187102Z       âœ“ Tamper proofing kicks in if the workflow is owned by team 1, the credentials is owned by team 2, and the member tries to use the credential in the workflow (32 ms)
2025-04-15T01:02:21.2189039Z       âœ“ Tamper proofing kicks in if the workflow is owned by the member, the credentials is owned by the owner, and the member tries to use the credential in the workflow (38 ms)
2025-04-15T01:02:21.2191182Z       âœ“ Tamper proofing kicks in if the workflow is owned by the member, the credentials is owned by team 2, and the member tries to use the credential in the workflow (41 ms)
2025-04-15T01:02:21.2193183Z       âœ“ Should succeed but prevent modifying node attributes other than position, name and disabled (93 ms)
2025-04-15T01:02:21.2194063Z     validate interim updates
2025-04-15T01:02:21.2194983Z       âœ“ should block owner updating workflow nodes on interim update by member (133 ms)
2025-04-15T01:02:21.2196438Z       âœ“ should block member updating workflow nodes on interim update by owner (151 ms)
2025-04-15T01:02:21.2197471Z       âœ“ should block owner activation on interim activation by member (179 ms)
2025-04-15T01:02:21.2198480Z       âœ“ should block member activation on interim activation by owner (173 ms)
2025-04-15T01:02:21.2199556Z       âœ“ should block member updating workflow settings on interim update by owner (113 ms)
2025-04-15T01:02:21.2200558Z       âœ“ should block member updating workflow name on interim update by owner (104 ms)
2025-04-15T01:02:21.2201106Z     workflow history
2025-04-15T01:02:21.2201890Z       âœ“ Should create workflow history version when licensed (37 ms)
2025-04-15T01:02:21.2202731Z       âœ“ Should not create workflow history version when not licensed (32 ms)
2025-04-15T01:02:21.2203330Z     activate workflow
2025-04-15T01:02:21.2203954Z       âœ“ should activate workflow without changing version ID (33 ms)
2025-04-15T01:02:21.2204864Z       âœ“ should deactivate workflow without changing version ID (30 ms)
2025-04-15T01:02:21.2205462Z   PUT /:workflowId/transfer
2025-04-15T01:02:21.2206052Z     âœ“ cannot transfer into the same project (27 ms)
2025-04-15T01:02:21.2206724Z     âœ“ cannot transfer somebody elses workflow (20 ms)
2025-04-15T01:02:21.2207581Z     âœ“ cannot transfer if you're not a member of the destination project (29 ms)
2025-04-15T01:02:21.2208432Z     âœ“ project:editors cannot transfer workflows (23 ms)
2025-04-15T01:02:21.2209434Z     âœ“ project:viewers cannot transfer workflows (22 ms)
2025-04-15T01:02:21.2210389Z     âœ“ global owners can transfer workflows from a team project to a team project (38 ms)
2025-04-15T01:02:21.2211482Z     âœ“ global owners can transfer workflows from a team project to a personal project (33 ms)
2025-04-15T01:02:21.2212888Z     âœ“ global owners can transfer workflows from a personal project to a team project (33 ms)
2025-04-15T01:02:21.2214037Z     âœ“ global admins can transfer workflows from a team project to a team project (37 ms)
2025-04-15T01:02:21.2215239Z     âœ“ global admins can transfer workflows from a team project to a personal project (36 ms)
2025-04-15T01:02:21.2216413Z     âœ“ global admins can transfer workflows from a personal project to a team project (34 ms)
2025-04-15T01:02:21.2217628Z     âœ“ removes and re-adds the workflow from the active workflow manager during the transfer (49 ms)
2025-04-15T01:02:21.2218711Z     âœ“ should detach workflow from parent folder in source project (70 ms)
2025-04-15T01:02:21.2220074Z     âœ“ deactivates the workflow if it cannot be added to the active workflow manager again and returns the WorkflowActivationError as data (44 ms)
2025-04-15T01:02:21.2221706Z     âœ“ owner transfers workflow from project they are not part of, e.g. test global cred sharing scope (62 ms)
2025-04-15T01:02:21.2223108Z     âœ“ admin transfers workflow from project they are not part of, e.g. test global cred sharing scope (60 ms)
2025-04-15T01:02:21.2224728Z     âœ“ member transfers workflow from personal project to team project and wf contains a credential that they can use but not share (48 ms)
2025-04-15T01:02:21.2226355Z     âœ“ member transfers workflow from their personal project to another team project in which they have editor role (44 ms)
2025-04-15T01:02:21.2227853Z     âœ“ member transfers workflow from a team project as project admin to another team project in which they have editor role (59 ms)
2025-04-15T01:02:21.2229992Z     âœ“ member transfers workflow from a team project as project admin to another team project in which they have editor role but cannot share the credential that is only shared into the source project (71 ms)
2025-04-15T01:02:21.2232418Z     âœ“ member transfers workflow from a team project as project admin to another team project in which they have editor role but cannot share all the credentials (56 ms)
2025-04-15T01:02:21.2233907Z     âœ“ returns a 500 if the workflow cannot be activated due to an unknown error (36 ms)
2025-04-15T01:02:21.2234913Z   POST /workflows/:workflowId/run
2025-04-15T01:02:21.2235527Z     âœ“ project viewers cannot run workflows (17 ms)
2025-04-15T01:02:21.2235881Z 
2025-04-15T01:02:22.2263969Z PASS test/integration/workflows/workflows.controller.test.ts (16.731 s)
2025-04-15T01:02:22.2264843Z   POST /workflows
2025-04-15T01:02:22.2265725Z     âœ“ should store pin data for node in workflow (114 ms)
2025-04-15T01:02:22.2266556Z     âœ“ should set pin data to null if no pin data (67 ms)
2025-04-15T01:02:22.2267453Z     âœ“ should return scopes on created workflow (65 ms)
2025-04-15T01:02:22.2268333Z     âœ“ should create workflow history version when licensed (57 ms)
2025-04-15T01:02:22.2269335Z     âœ“ should not create workflow history version when not licensed (51 ms)
2025-04-15T01:02:22.2270306Z     âœ“ create workflow in personal project by default (107 ms)
2025-04-15T01:02:22.2271315Z     âœ“ creates workflow in a specific project if the projectId is passed (71 ms)
2025-04-15T01:02:22.2272818Z     âœ“ does not create the workflow in a specific project if the user is not part of the project (76 ms)
2025-04-15T01:02:22.2274321Z     âœ“ does not create the workflow in a specific project if the user does not have the right role to do so (48 ms)
2025-04-15T01:02:22.2275478Z     âœ“ create link workflow with folder if one is provided (59 ms)
2025-04-15T01:02:22.2276448Z     âœ“ create workflow without parent folder if no folder is provided (74 ms)
2025-04-15T01:02:22.2277614Z     âœ“ create workflow without parent is provided folder does not exist in the project (55 ms)
2025-04-15T01:02:22.2279122Z   GET /workflows/:workflowId
2025-04-15T01:02:22.2279766Z     âœ“ should return pin data (78 ms)
2025-04-15T01:02:22.2280377Z     âœ“ should return tags (62 ms)
2025-04-15T01:02:22.2280803Z   GET /workflows
2025-04-15T01:02:22.2281392Z     âœ“ should return zero workflows if none exist (41 ms)
2025-04-15T01:02:22.2323094Z     âœ“ should return workflows (78 ms)
2025-04-15T01:02:22.2323947Z     âœ“ should return workflows with scopes when ?includeScopes=true (128 ms)
2025-04-15T01:02:22.2324631Z     filter
2025-04-15T01:02:22.2325235Z       âœ“ should filter workflows by field: name (64 ms)
2025-04-15T01:02:22.2325960Z       âœ“ should filter workflows by field: active (80 ms)
2025-04-15T01:02:22.2326807Z       âœ“ should filter workflows by field: tags (AND operator) (90 ms)
2025-04-15T01:02:22.2327624Z       âœ“ should filter workflows by projectId (60 ms)
2025-04-15T01:02:22.2328355Z       âœ“ should filter workflows by parentFolderId (64 ms)
2025-04-15T01:02:22.2329298Z       âœ“ should return homeProject when filtering workflows by projectId (48 ms)
2025-04-15T01:02:22.2329954Z     select
2025-04-15T01:02:22.2330510Z       âœ“ should select workflow field: name (50 ms)
2025-04-15T01:02:22.2331241Z       âœ“ should select workflow field: active (57 ms)
2025-04-15T01:02:22.2332355Z       âœ“ should select workflow field: tags (50 ms)
2025-04-15T01:02:22.2333259Z       âœ“ should select workflow fields: createdAt and updatedAt (58 ms)
2025-04-15T01:02:22.2334086Z       âœ“ should select workflow field: versionId (51 ms)
2025-04-15T01:02:22.2334832Z       âœ“ should select workflow field: ownedBy (56 ms)
2025-04-15T01:02:22.2335594Z       âœ“ should select workflow field: parentFolder (53 ms)
2025-04-15T01:02:22.2336119Z     sortBy
2025-04-15T01:02:22.2336759Z       âœ“ should fail when trying to sort by non sortable column (42 ms)
2025-04-15T01:02:22.2337525Z       âœ“ should sort by createdAt column (67 ms)
2025-04-15T01:02:22.2338164Z       âœ“ should sort by name column (72 ms)
2025-04-15T01:02:22.2338843Z       âœ“ should sort by updatedAt column (72 ms)
2025-04-15T01:02:22.2339330Z     pagination
2025-04-15T01:02:22.2340001Z       âœ“ should fail when skip is provided without take (87 ms)
2025-04-15T01:02:22.2340833Z       âœ“ should handle skip with take parameter (96 ms)
2025-04-15T01:02:22.2341809Z       âœ“ should handle pagination with sorting (78 ms)
2025-04-15T01:02:22.2342622Z       âœ“ should handle pagination with filtering (130 ms)
2025-04-15T01:02:22.2343512Z       âœ“ should return empty array when pagination exceeds total count (69 ms)
2025-04-15T01:02:22.2344879Z       âœ“ should return all results when no pagination parameters are provided (67 ms)
2025-04-15T01:02:22.2345605Z   GET /workflows?includeFolders=true
2025-04-15T01:02:22.2346396Z     âœ“ should return zero workflows and folders if none exist (36 ms)
2025-04-15T01:02:22.2347210Z     âœ“ should return workflows and folders (69 ms)
2025-04-15T01:02:22.2348164Z     âœ“ should return workflows with scopes and folders when ?includeScopes=true (101 ms)
2025-04-15T01:02:22.2348885Z     filter
2025-04-15T01:02:22.2349526Z       âœ“ should filter workflows and folders by field: name (65 ms)
2025-04-15T01:02:22.2350420Z       âœ“ should filter workflows and folders by field: active (41 ms)
2025-04-15T01:02:22.2351456Z       âœ“ should filter workflows and folders by field: tags (AND operator) (66 ms)
2025-04-15T01:02:22.2352583Z       âœ“ should filter workflows by projectId (58 ms)
2025-04-15T01:02:22.2353649Z       âœ“ should filter workflows by parentFolderId and its descendants when filtering by name (68 ms)
2025-04-15T01:02:22.2354948Z       âœ“ should return homeProject when filtering workflows and folders by projectId (107 ms)
2025-04-15T01:02:22.2355675Z     sortBy
2025-04-15T01:02:22.2356347Z       âœ“ should fail when trying to sort by non sortable column (40 ms)
2025-04-15T01:02:22.2357194Z       âœ“ should sort by createdAt column (99 ms)
2025-04-15T01:02:22.2357748Z       âœ“ should sort by name column (73 ms)
2025-04-15T01:02:22.2358680Z       âœ“ should sort by updatedAt column (68 ms)
2025-04-15T01:02:22.2359173Z     pagination
2025-04-15T01:02:22.2359809Z       âœ“ should fail when skip is provided without take (64 ms)
2025-04-15T01:02:22.2360578Z       âœ“ should handle skip with take parameter (72 ms)
2025-04-15T01:02:22.2361320Z       âœ“ should handle pagination with sorting (69 ms)
2025-04-15T01:02:22.2362254Z       âœ“ should handle pagination with filtering (99 ms)
2025-04-15T01:02:22.2363133Z       âœ“ should return empty array when pagination exceeds total count (58 ms)
2025-04-15T01:02:22.2364255Z       âœ“ should return all results when no pagination parameters are provided (70 ms)
2025-04-15T01:02:22.2365004Z   PATCH /workflows/:workflowId
2025-04-15T01:02:22.2365791Z     âœ“ should create workflow history version when licensed (73 ms)
2025-04-15T01:02:22.2366771Z     âœ“ should not create workflow history version when not licensed (48 ms)
2025-04-15T01:02:22.2367816Z     âœ“ should activate workflow without changing version ID (59 ms)
2025-04-15T01:02:22.2368759Z     âœ“ should deactivate workflow without changing version ID (51 ms)
2025-04-15T01:02:22.2369500Z     âœ“ should update workflow meta (72 ms)
2025-04-15T01:02:22.2370144Z     âœ“ should move workflow to folder (59 ms)
2025-04-15T01:02:22.2370828Z     âœ“ should move workflow to project root (51 ms)
2025-04-15T01:02:22.2372153Z     âœ“ should fail if trying update workflow parent folder with a folder that does not belong to project (67 ms)
2025-04-15T01:02:22.2373039Z   POST /workflows/:workflowId/run
2025-04-15T01:02:22.2373753Z     âœ“ should prevent tampering if sharing is enabled (32 ms)
2025-04-15T01:02:22.2374630Z     âœ“ should skip tampering prevention if sharing is disabled (101 ms)
2025-04-15T01:02:22.2375291Z   DELETE /workflows/:workflowId
2025-04-15T01:02:22.2375920Z     âœ“ deletes a workflow owned by the user (61 ms)
2025-04-15T01:02:22.2376843Z     âœ“ deletes a workflow owned by the user, even if the user is just a member (45 ms)
2025-04-15T01:02:22.2377873Z     âœ“ does not delete a workflow that is not owned by the user (34 ms)
2025-04-15T01:02:22.2378735Z     âœ“ allows the owner to delete workflows they don't own (46 ms)
2025-04-15T01:02:22.2379148Z 
2025-04-15T01:02:26.3632966Z   console.log
2025-04-15T01:02:26.3633751Z     { message: 'Forbidden' }
2025-04-15T01:02:26.3634165Z 
2025-04-15T01:02:26.3634935Z       at Object.<anonymous> (test/integration/public-api/endpoints-with-scopes-enabled.test.ts:336:14)
2025-04-15T01:02:26.3635763Z 
2025-04-15T01:02:28.4428003Z PASS test/integration/public-api/endpoints-with-scopes-enabled.test.ts (11.39 s)
2025-04-15T01:02:28.4436131Z   Public API endpoints with feat:apiKeyScopes enabled
2025-04-15T01:02:28.4436767Z     with "feat:apiKeyScopes" enabled
2025-04-15T01:02:28.4437210Z       users
2025-04-15T01:02:28.4438385Z         âœ“ should fail when "feat:apiKeyScopes" is disabled and API key does not have "user:list" scope (39 ms)
2025-04-15T01:02:28.4439618Z         GET /users
2025-04-15T01:02:28.4440648Z           âœ“ should return all users when API key has "user:list" scope (1210 ms)
2025-04-15T01:02:28.4441722Z         POST /users
2025-04-15T01:02:28.4442668Z           âœ“ should create user when API key has "user:create" scope (68 ms)
2025-04-15T01:02:28.4444357Z           âœ“ should fail to create user when API key doesn't have "user:create" scope (35 ms)
2025-04-15T01:02:28.4445094Z         PATCH /users/:id/role
2025-04-15T01:02:28.4446042Z           âœ“ should change role when API key has "user:changeRole" scope (53 ms)
2025-04-15T01:02:28.4447124Z           âœ“ should fail to change role when API key doesn't have "user:changeRole" scope (32 ms)
2025-04-15T01:02:28.4448089Z           âœ“ should remove all admin only scopes when user downgrading to member (41 ms)
2025-04-15T01:02:28.4448772Z         DELETE /users/:id
2025-04-15T01:02:28.4449752Z           âœ“ should delete user when API key has "user:delete" scope (82 ms)
2025-04-15T01:02:28.4451049Z           âœ“ should fail to create user when API key doesn't have "user:delete" scope (29 ms)
2025-04-15T01:02:28.4452615Z       credentials
2025-04-15T01:02:28.4453012Z         POST /credentials
2025-04-15T01:02:28.4454036Z           âœ“ should fail to create credential when API key doesn't have "credential:create" scope (96 ms)
2025-04-15T01:02:28.4455313Z           âœ“ should create credential when API key has "credential:create" scope (64 ms)
2025-04-15T01:02:28.4456053Z         DELETE /credentials/:id
2025-04-15T01:02:28.4456970Z           âœ“ should delete credential when API key has "credential:create" scope (51 ms)
2025-04-15T01:02:28.4458233Z           âœ“ should delete credential when API key doesn't have "credential:create" scope (38 ms)
2025-04-15T01:02:28.4459082Z         PUT /credentials/:id/transfer
2025-04-15T01:02:28.4460046Z           âœ“ should transfer credential when API key has "credential:move" scope (61 ms)
2025-04-15T01:02:28.4461349Z           âœ“ should fail to transfer credential when API key doesn't have "credential:move" scope (32 ms)
2025-04-15T01:02:28.4462304Z       executions
2025-04-15T01:02:28.4462669Z         GET /executions/:id
2025-04-15T01:02:28.4463540Z           âœ“ should retrieve execution when API key has "execution:read" scope (45 ms)
2025-04-15T01:02:28.4464771Z           âœ“ should fail to retrieve credential API key doesn't have "execution:read" scope (38 ms)
2025-04-15T01:02:28.4465571Z         DELETE /executions/:id
2025-04-15T01:02:28.4466453Z           âœ“ should delete execution when API key has "execution:delete" scope (62 ms)
2025-04-15T01:02:28.4467448Z           âœ“ should fail to delete execution when API key doesn't have "execution:delete" scope (35 ms)
2025-04-15T01:02:28.4467864Z         GET /executions
2025-04-15T01:02:28.4468326Z           âœ“ should retrieve all executions when API key has "execution:list" scope (52 ms)
2025-04-15T01:02:28.4469007Z           âœ“ should fail to retrieve all executions when API key doesn't have "execution:list" scope (28 ms)
2025-04-15T01:02:28.4469422Z       tags
2025-04-15T01:02:28.4469598Z         GET /tags
2025-04-15T01:02:28.4469996Z           âœ“ should retrieve all tags when API key has "tag:list" scope (43 ms)
2025-04-15T01:02:28.4470596Z           âœ“ should fail to retrieve all tags when API key doesn't have "tag:list" scope (32 ms)
2025-04-15T01:02:28.4470983Z         POST /tags
2025-04-15T01:02:28.4471371Z           âœ“ should create a tag when API key has "tag:create" scope (49 ms)
2025-04-15T01:02:28.4472487Z           âœ“ should fail to create a tag when API key doesn't have "tag:create" scope (25 ms)
2025-04-15T01:02:28.4473177Z         DELETE /tags/:id
2025-04-15T01:02:28.4474221Z           âœ“ should delete a tag when API key has "tag:delete" scope (36 ms)
2025-04-15T01:02:28.4475267Z           âœ“ should fail to delete a tag when API key doesn't have "tag:delete" scope (23 ms)
2025-04-15T01:02:28.4475957Z         PUT /tags/:id
2025-04-15T01:02:28.4476745Z           âœ“ should update a tag when API key has "tag:update" scope (66 ms)
2025-04-15T01:02:28.4477826Z           âœ“ should fail to update a tag when API key doesn't have "tag:update" scope (28 ms)
2025-04-15T01:02:28.4478522Z         GET /tags/:id
2025-04-15T01:02:28.4479308Z           âœ“ should retrieve a tag when API key has "tag:read" scope (40 ms)
2025-04-15T01:02:28.4480402Z           âœ“ should fail to retrieve a tag when API key doesn't have "tag:read" scope (23 ms)
2025-04-15T01:02:28.4481085Z       variables
2025-04-15T01:02:28.4481440Z         GET /variables
2025-04-15T01:02:28.4482169Z           âœ“ should retrieve all variables when API key has "variable:list" scope (47 ms)
2025-04-15T01:02:28.4482821Z           âœ“ should fail to retrieve all variables when API key doesn't have "variable:read" scope (40 ms)
2025-04-15T01:02:28.4483239Z         POST /variables
2025-04-15T01:02:28.4483810Z           âœ“ should create variable when API key has "variable:create" scope (94 ms)
2025-04-15T01:02:28.4485005Z           âœ“ should fail to create variable when API key doesn't have "variable:create" scope (37 ms)
2025-04-15T01:02:28.4485733Z       projects
2025-04-15T01:02:28.4486097Z         POST /projects
2025-04-15T01:02:28.4486918Z           âœ“ should create project when API key has "project:create" scope (46 ms)
2025-04-15T01:02:28.4487577Z           âœ“ should fail to create project when API key doesn't have "project:create" scope (24 ms)
2025-04-15T01:02:28.4487957Z         GET /projects
2025-04-15T01:02:28.4488379Z           âœ“ should return all projects when API key has "project:list" scope (42 ms)
2025-04-15T01:02:28.4488978Z           âœ“ should fail to create project when API key doesn't have "project:list" scope (32 ms)
2025-04-15T01:02:28.4489388Z         DELETE /projects/:id
2025-04-15T01:02:28.4489823Z           âœ“ should delete a project when API key has "project:delete" scope (43 ms)
2025-04-15T01:02:28.4490432Z           âœ“ should fail to delete a project when API key doesn't have "project:delete" scope (27 ms)
2025-04-15T01:02:28.4490821Z         PUT /projects/:id
2025-04-15T01:02:28.4491234Z           âœ“ should update a project when API key has "project:update" scope (32 ms)
2025-04-15T01:02:28.4492290Z           âœ“ should fail to update a project when API key doesn't have "project:update" scope (22 ms)
2025-04-15T01:02:28.4492987Z       workflows
2025-04-15T01:02:28.4493331Z         POST /workflows
2025-04-15T01:02:28.4494156Z           âœ“ should create workflow when API key has "workflow:create" scope (88 ms)
2025-04-15T01:02:28.4495398Z           âœ“ should fail to create a workflow when API key doesn't have "workflow:create" scope (27 ms)
2025-04-15T01:02:28.4496181Z         GET /workflows
2025-04-15T01:02:28.4497068Z           âœ“ should retrieve all workflows when API key has "workflow:list" scope (73 ms)
2025-04-15T01:02:28.4498394Z           âœ“ should fail to retrieve all workflows when API key doesn't have "workflow:create" scope (38 ms)
2025-04-15T01:02:28.4499209Z         GET /workflows/:id
2025-04-15T01:02:28.4500111Z           âœ“ should retrieve a workflow when API key has "workflow:read" scope (48 ms)
2025-04-15T01:02:28.4501335Z           âœ“ should fail to retrieve a workflow when API key doesn't have "workflow:read" scope (33 ms)
2025-04-15T01:02:28.4502348Z         DELETE /workflows/:id
2025-04-15T01:02:28.4503272Z           âœ“ should delete a workflow when API key has "workflow:delete" scope (55 ms)
2025-04-15T01:02:28.4504523Z           âœ“ should fail to delete a workflow when API key doesn't have "workflow:delete" scope (27 ms)
2025-04-15T01:02:28.4505307Z         PUT /workflows/:id
2025-04-15T01:02:28.4506168Z           âœ“ should update workflow when API key has "workflow:update" scope (77 ms)
2025-04-15T01:02:28.4507386Z           âœ“ should fail to update workflow when API key doesn't have "workflow:update" scope (30 ms)
2025-04-15T01:02:28.4508432Z         GET /workflows/:id/tags
2025-04-15T01:02:28.4509377Z           âœ“ should retrieve all workflow tags when API key has "workflowTags:list" scope (59 ms)
2025-04-15T01:02:28.4510731Z           âœ“ should fail to retrieve all workflow tags when API key doesn't have "workflowTags:list" scope (41 ms)
2025-04-15T01:02:28.4511789Z         PUT /workflows/:id/tags
2025-04-15T01:02:28.4512758Z           âœ“ should update workflow tags when API key has "workflowTags:update" scope (74 ms)
2025-04-15T01:02:28.4514063Z           âœ“ should fail to update workflow tags when API key doesn't have "workflowTags:update" scope (42 ms)
2025-04-15T01:02:28.4514716Z 
2025-04-15T01:02:31.6585822Z PASS test/integration/credentials/credentials.api.test.ts (10.156 s)
2025-04-15T01:02:31.6586599Z   GET /credentials
2025-04-15T01:02:31.6587314Z     âœ“ should return all creds for owner (100 ms)
2025-04-15T01:02:31.6588046Z     âœ“ should return only own creds for member (78 ms)
2025-04-15T01:02:31.6588824Z     âœ“ should return scopes when ?includeScopes=true (98 ms)
2025-04-15T01:02:31.6589659Z     âœ“ should return data when ?includeData=true (91 ms)
2025-04-15T01:02:31.6590553Z     âœ“ should return data when ?includeData=true for owners (56 ms)
2025-04-15T01:02:31.6591106Z     should return
2025-04-15T01:02:31.6591819Z       âœ“ all credentials for owner (91 ms)
2025-04-15T01:02:31.6592456Z       âœ“ only own credentials for member (63 ms)
2025-04-15T01:02:31.6593289Z     filter
2025-04-15T01:02:31.6593920Z       âœ“ should filter credentials by field: name - full match (64 ms)
2025-04-15T01:02:31.6594811Z       âœ“ should filter credentials by field: name - partial match (53 ms)
2025-04-15T01:02:31.6595633Z       âœ“ should filter credentials by field: type - full match (47 ms)
2025-04-15T01:02:31.6596367Z       âœ“ should filter credentials by field: type - partial match (46 ms)
2025-04-15T01:02:31.6597044Z       âœ“ should filter credentials by projectId (46 ms)
2025-04-15T01:02:31.6597923Z       âœ“ should return homeProject when filtering credentials by projectId (44 ms)
2025-04-15T01:02:31.6598987Z       âœ“ should return all credentials in a team project that member is part of (48 ms)
2025-04-15T01:02:31.6600047Z       âœ“ should return no credentials in a team project that member not is part of (39 ms)
2025-04-15T01:02:31.6601306Z       âœ“ should return only owned and explicitly shared credentials when filtering by any personal project id (52 ms)
2025-04-15T01:02:31.6603014Z       âœ“ should not ignore the project filter when the request is done by an owner and also includes the scopes (48 ms)
2025-04-15T01:02:31.6603786Z     select
2025-04-15T01:02:31.6604261Z       âœ“ should select credential field: id (44 ms)
2025-04-15T01:02:31.6604909Z       âœ“ should select credential field: name (41 ms)
2025-04-15T01:02:31.6605552Z       âœ“ should select credential field: type (36 ms)
2025-04-15T01:02:31.6606004Z     take
2025-04-15T01:02:31.6606558Z       âœ“ should return n credentials or less, without skip (55 ms)
2025-04-15T01:02:31.6607332Z       âœ“ should return n credentials or less, with skip (44 ms)
2025-04-15T01:02:31.6607845Z   POST /credentials
2025-04-15T01:02:31.6608291Z     âœ“ should create cred (45 ms)
2025-04-15T01:02:31.6608850Z     âœ“ should fail with invalid inputs (45 ms)
2025-04-15T01:02:31.6609424Z     âœ“ should ignore ID in payload (58 ms)
2025-04-15T01:02:31.6610105Z     âœ“ creates credential in personal project by default (48 ms)
2025-04-15T01:02:31.6610996Z     âœ“ creates credential in a specific project if the projectId is passed (56 ms)
2025-04-15T01:02:31.6612332Z     âœ“ does not create the credential in a specific project if the user is not part of the project (69 ms)
2025-04-15T01:02:31.6613048Z   DELETE /credentials/:id
2025-04-15T01:02:31.6613552Z     âœ“ should delete owned cred for owner (53 ms)
2025-04-15T01:02:31.6614159Z     âœ“ should delete non-owned cred for owner (49 ms)
2025-04-15T01:02:31.6614783Z     âœ“ should delete owned cred for member (44 ms)
2025-04-15T01:02:31.6615732Z     âœ“ should not delete non-owned cred for member (44 ms)
2025-04-15T01:02:31.6616493Z     âœ“ should not delete non-owned but shared cred for member (43 ms)
2025-04-15T01:02:31.6617159Z     âœ“ should fail if cred not found (36 ms)
2025-04-15T01:02:31.6617593Z   PATCH /credentials/:id
2025-04-15T01:02:31.6618099Z     âœ“ should update owned cred for owner (57 ms)
2025-04-15T01:02:31.6618716Z     âœ“ should update non-owned cred for owner (41 ms)
2025-04-15T01:02:31.6619345Z     âœ“ should update owned cred for member (52 ms)
2025-04-15T01:02:31.6619993Z     âœ“ should not update non-owned cred for member (40 ms)
2025-04-15T01:02:31.6620747Z     âœ“ should not update non-owned but shared cred for member (43 ms)
2025-04-15T01:02:31.6621711Z     âœ“ should update non-owned but shared cred for instance owner (54 ms)
2025-04-15T01:02:31.6622495Z     âœ“ should not allow to overwrite oauthTokenData (66 ms)
2025-04-15T01:02:31.6623144Z     âœ“ should fail with invalid inputs (76 ms)
2025-04-15T01:02:31.6624228Z     âœ“ should fail with a 404 if the credential does not exist and the actor has the global credential:update scope (31 ms)
2025-04-15T01:02:31.6625704Z     âœ“ should fail with a 403 if the credential does not exist and the actor does not have the global credential:update scope (35 ms)
2025-04-15T01:02:31.6626777Z     âœ“ should fail with a 400 is credential is managed (58 ms)
2025-04-15T01:02:31.6627294Z   GET /credentials/new
2025-04-15T01:02:31.6627965Z     âœ“ should return default name for new credential or its increment (75 ms)
2025-04-15T01:02:31.6629121Z     âœ“ should return name from query for new credential or its increment (84 ms)
2025-04-15T01:02:31.6629721Z   GET /credentials/:id
2025-04-15T01:02:31.6630243Z     âœ“ should retrieve owned cred for owner (55 ms)
2025-04-15T01:02:31.6631010Z     âœ“ should redact the data when `includeData:true` is passed (46 ms)
2025-04-15T01:02:31.6631994Z     âœ“ should omit oauth data when `includeData:true` is passed (37 ms)
2025-04-15T01:02:31.6632760Z     âœ“ should retrieve owned cred for member (44 ms)
2025-04-15T01:02:31.6633409Z     âœ“ should retrieve non-owned cred for owner (47 ms)
2025-04-15T01:02:31.6634106Z     âœ“ should not retrieve non-owned cred for member (32 ms)
2025-04-15T01:02:31.6634773Z     âœ“ should return 404 if cred not found (31 ms)
2025-04-15T01:02:31.6635220Z   POST /credentials/test
2025-04-15T01:02:31.6635810Z     âœ“ should test a credential with unredacted data (38 ms)
2025-04-15T01:02:31.6636512Z     âœ“ should test a credential with redacted data (38 ms)
2025-04-15T01:02:31.6636891Z 
2025-04-15T01:02:32.4634580Z PASS test/integration/public-api/workflows.test.ts (9.981 s)
2025-04-15T01:02:32.4646111Z   GET /workflows
2025-04-15T01:02:32.4647204Z     âœ“ should fail due to missing API Key (48 ms)
2025-04-15T01:02:32.4647910Z     âœ“ should fail due to invalid API Key (15 ms)
2025-04-15T01:02:32.4648543Z     âœ“ should return all owned workflows (215 ms)
2025-04-15T01:02:32.4649331Z     âœ“ should return all owned workflows with pagination (58 ms)
2025-04-15T01:02:32.4650182Z     âœ“ should return all owned workflows filtered by tag (42 ms)
2025-04-15T01:02:32.4652750Z     âœ“ should return all owned workflows filtered by tags (59 ms)
2025-04-15T01:02:32.4662747Z     âœ“ for owner, should return all workflows filtered by `projectId` (51 ms)
2025-04-15T01:02:32.4664336Z     âœ“ for member, should return all member-accessible workflows filtered by `projectId` (32 ms)
2025-04-15T01:02:32.4667154Z     âœ“ should return all owned workflows filtered by name (33 ms)
2025-04-15T01:02:32.4669093Z     âœ“ should return all workflows for owner (59 ms)
2025-04-15T01:02:32.4669975Z     âœ“ should return all owned workflows without pinned data (42 ms)
2025-04-15T01:02:32.4670689Z   GET /workflows/:id
2025-04-15T01:02:32.4672893Z     âœ“ should fail due to missing API Key (16 ms)
2025-04-15T01:02:32.4673539Z     âœ“ should fail due to invalid API Key (10 ms)
2025-04-15T01:02:32.4674217Z     âœ“ should fail due to non-existing workflow (42 ms)
2025-04-15T01:02:32.4674852Z     âœ“ should retrieve workflow (40 ms)
2025-04-15T01:02:32.4675886Z     âœ“ should retrieve non-owned workflow for owner (28 ms)
2025-04-15T01:02:32.4676567Z     âœ“ should retrieve workflow without pinned data (36 ms)
2025-04-15T01:02:32.4677051Z   DELETE /workflows/:id
2025-04-15T01:02:32.4677545Z     âœ“ should fail due to missing API Key (16 ms)
2025-04-15T01:02:32.4678129Z     âœ“ should fail due to invalid API Key (21 ms)
2025-04-15T01:02:32.4678741Z     âœ“ should fail due to non-existing workflow (36 ms)
2025-04-15T01:02:32.4679366Z     âœ“ should delete the workflow (53 ms)
2025-04-15T01:02:32.4680038Z     âœ“ should delete non-owned workflow when owner (25 ms)
2025-04-15T01:02:32.4680591Z   POST /workflows/:id/activate
2025-04-15T01:02:32.4681153Z     âœ“ should fail due to missing API Key (10 ms)
2025-04-15T01:02:32.4681957Z     âœ“ should fail due to invalid API Key (10 ms)
2025-04-15T01:02:32.4682635Z     âœ“ should fail due to non-existing workflow (44 ms)
2025-04-15T01:02:32.4683514Z     âœ“ should fail due to trying to activate a workflow without any nodes (42 ms)
2025-04-15T01:02:32.4684534Z     âœ“ should fail due to trying to activate a workflow without a trigger (30 ms)
2025-04-15T01:02:32.4685307Z     âœ“ should set workflow as active (85 ms)
2025-04-15T01:02:32.4686013Z     âœ“ should set non-owned workflow as active when owner (104 ms)
2025-04-15T01:02:32.4686618Z   POST /workflows/:id/deactivate
2025-04-15T01:02:32.4687208Z     âœ“ should fail due to missing API Key (8 ms)
2025-04-15T01:02:32.4688140Z     âœ“ should fail due to invalid API Key (14 ms)
2025-04-15T01:02:32.4688828Z     âœ“ should fail due to non-existing workflow (18 ms)
2025-04-15T01:02:32.4689429Z     âœ“ should deactivate workflow (57 ms)
2025-04-15T01:02:32.4690128Z     âœ“ should deactivate non-owned workflow when owner (56 ms)
2025-04-15T01:02:32.4690668Z   POST /workflows
2025-04-15T01:02:32.4691157Z     âœ“ should fail due to missing API Key (8 ms)
2025-04-15T01:02:32.4695357Z     âœ“ should fail due to invalid API Key (10 ms)
2025-04-15T01:02:32.4695991Z     âœ“ should fail due to invalid body (39 ms)
2025-04-15T01:02:32.4696550Z     âœ“ should create workflow (41 ms)
2025-04-15T01:02:32.4697220Z     âœ“ should create workflow history version when licensed (22 ms)
2025-04-15T01:02:32.4698099Z     âœ“ should not create workflow history version when not licensed (20 ms)
2025-04-15T01:02:32.4699088Z     âœ“ should not add a starting node if the payload has no starting nodes (20 ms)
2025-04-15T01:02:32.4699718Z   PUT /workflows/:id
2025-04-15T01:02:32.4700292Z     âœ“ should fail due to missing API Key (10 ms)
2025-04-15T01:02:32.4700942Z     âœ“ should fail due to invalid API Key (9 ms)
2025-04-15T01:02:32.4701913Z     âœ“ should fail due to non-existing workflow (32 ms)
2025-04-15T01:02:32.4702588Z     âœ“ should fail due to invalid body (12 ms)
2025-04-15T01:02:32.4703182Z     âœ“ should update workflow (26 ms)
2025-04-15T01:02:32.4703900Z     âœ“ should create workflow history version when licensed (24 ms)
2025-04-15T01:02:32.4704759Z     âœ“ should not create workflow history when not licensed (25 ms)
2025-04-15T01:02:32.4705563Z     âœ“ should update non-owned workflow if owner (35 ms)
2025-04-15T01:02:32.4706087Z   GET /workflows/:id/tags
2025-04-15T01:02:32.4706631Z     âœ“ should fail due to missing API Key (9 ms)
2025-04-15T01:02:32.4707239Z     âœ“ should fail due to invalid API Key (7 ms)
2025-04-15T01:02:32.4707918Z     âœ“ should fail if N8N_WORKFLOW_TAGS_DISABLED (20 ms)
2025-04-15T01:02:32.4708630Z     âœ“ should fail due to non-existing workflow (13 ms)
2025-04-15T01:02:32.4709353Z     âœ“ should return all tags of owned workflow (31 ms)
2025-04-15T01:02:32.4710165Z     âœ“ should return empty array if workflow does not have tags (25 ms)
2025-04-15T01:02:32.4710766Z   PUT /workflows/:id/tags
2025-04-15T01:02:32.4711320Z     âœ“ should fail due to missing API Key (10 ms)
2025-04-15T01:02:32.4712102Z     âœ“ should fail due to invalid API Key (11 ms)
2025-04-15T01:02:32.4712774Z     âœ“ should fail if N8N_WORKFLOW_TAGS_DISABLED (19 ms)
2025-04-15T01:02:32.4713469Z     âœ“ should fail due to non-existing workflow (12 ms)
2025-04-15T01:02:32.4714526Z     âœ“ should add the tags, workflow have not got tags previously (38 ms)
2025-04-15T01:02:32.4715417Z     âœ“ should add the tags, workflow have some tags previously (42 ms)
2025-04-15T01:02:32.4716400Z     âœ“ should fail to add the tags as one does not exist, workflow should maintain previous tags (41 ms)
2025-04-15T01:02:32.4717158Z   PUT /workflows/:id/transfer
2025-04-15T01:02:32.4717790Z     âœ“ should transfer workflow to project (77 ms)
2025-04-15T01:02:32.4718503Z     âœ“ if no destination project, should reject (17 ms)
2025-04-15T01:02:32.4718858Z 
2025-04-15T01:02:36.2863103Z PASS src/events/__tests__/telemetry-event-relay.test.ts
2025-04-15T01:02:36.2863835Z   TelemetryEventRelay
2025-04-15T01:02:36.2864216Z     init
2025-04-15T01:02:36.2865203Z       âœ“ with diagnostics enabled, should init telemetry and register listeners (17 ms)
2025-04-15T01:02:36.2866449Z       âœ“ with diagnostics disabled, should neither init telemetry nor register listeners (1 ms)
2025-04-15T01:02:36.2867276Z     project events
2025-04-15T01:02:36.2867931Z       âœ“ should track on `team-project-updated` event (2 ms)
2025-04-15T01:02:36.2868736Z       âœ“ should track on `team-project-deleted` event (1 ms)
2025-04-15T01:02:36.2869497Z       âœ“ should track on `team-project-created` event (1 ms)
2025-04-15T01:02:36.2870031Z     source control events
2025-04-15T01:02:36.2870785Z       âœ“ should track on `source-control-settings-updated` event (1 ms)
2025-04-15T01:02:36.2872523Z       âœ“ should track on `source-control-user-started-pull-ui` event
2025-04-15T01:02:36.2873532Z       âœ“ should track on `source-control-user-finished-pull-ui` event (1 ms)
2025-04-15T01:02:36.2874556Z       âœ“ should track on `source-control-user-pulled-api` event (1 ms)
2025-04-15T01:02:36.2875487Z       âœ“ should track on `source-control-user-started-push-ui` event
2025-04-15T01:02:36.2876452Z       âœ“ should track on `source-control-user-finished-push-ui` event (1 ms)
2025-04-15T01:02:36.2877074Z     license events
2025-04-15T01:02:36.2877788Z       âœ“ should track on `license-renewal-attempted` event (1 ms)
2025-04-15T01:02:36.2878357Z     variable events
2025-04-15T01:02:36.2878917Z       âœ“ should track on `variable-created` event
2025-04-15T01:02:36.2879422Z     external secrets events
2025-04-15T01:02:36.2880271Z       âœ“ should track on `external-secrets-provider-settings-saved` event (1 ms)
2025-04-15T01:02:36.2880971Z     public API events
2025-04-15T01:02:36.2881802Z       âœ“ should track on `public-api-invoked` event
2025-04-15T01:02:36.2882697Z       âœ“ should track on `public-api-key-created` event (1 ms)
2025-04-15T01:02:36.2883551Z       âœ“ should track on `public-api-key-deleted` event
2025-04-15T01:02:36.2884115Z     community package events
2025-04-15T01:02:36.2884839Z       âœ“ should track on `community-package-installed` event (1 ms)
2025-04-15T01:02:36.2885766Z       âœ“ should track on `community-package-updated` event (1 ms)
2025-04-15T01:02:36.2886660Z       âœ“ should track on `community-package-deleted` event
2025-04-15T01:02:36.2887254Z     credentials events
2025-04-15T01:02:36.2887895Z       âœ“ should track on `credentials-created` event (1 ms)
2025-04-15T01:02:36.2888594Z       âœ“ should track on `credentials-shared` event (1 ms)
2025-04-15T01:02:36.2889299Z       âœ“ should track on `credentials-updated` event (1 ms)
2025-04-15T01:02:36.2889982Z       âœ“ should track on `credentials-deleted` event
2025-04-15T01:02:36.2890446Z     LDAP events
2025-04-15T01:02:36.2891053Z       âœ“ should track on `ldap-general-sync-finished` event (1 ms)
2025-04-15T01:02:36.2923647Z       âœ“ should track on `ldap-settings-updated` event (1 ms)
2025-04-15T01:02:36.2924509Z       âœ“ should track on `ldap-login-sync-failed` event
2025-04-15T01:02:36.2925443Z       âœ“ should track on `login-failed-due-to-ldap-disabled` event (1 ms)
2025-04-15T01:02:36.2926088Z     workflow events
2025-04-15T01:02:36.2926691Z       âœ“ should track on `workflow-created` event (3 ms)
2025-04-15T01:02:36.2927457Z       âœ“ should track on `workflow-deleted` event (1 ms)
2025-04-15T01:02:36.2928714Z       âœ“ should track on `workflow-post-execute` event (3 ms)
2025-04-15T01:02:36.2929479Z       âœ“ should track on `workflow-saved` event (10 ms)
2025-04-15T01:02:36.2930230Z       âœ“ should track on `workflow-sharing-updated` event
2025-04-15T01:02:36.2930761Z     user events
2025-04-15T01:02:36.2931292Z       âœ“ should track on `user-updated` event
2025-04-15T01:02:36.2962304Z       âœ“ should track on `user-deleted` event (1 ms)
2025-04-15T01:02:36.2963001Z       âœ“ should track on `user-invited` event
2025-04-15T01:02:36.2963669Z       âœ“ should track on `user-signed-up` event (1 ms)
2025-04-15T01:02:36.2964556Z       âœ“ should track on `user-submitted-personalization-survey` event (1 ms)
2025-04-15T01:02:36.2965432Z       âœ“ should track on `user-changed-role` event (1 ms)
2025-04-15T01:02:36.2966134Z       âœ“ should track on `user-retrieved-user` event
2025-04-15T01:02:36.2966898Z       âœ“ should track on `user-retrieved-all-users` event (1 ms)
2025-04-15T01:02:36.2967436Z     lifecycle events
2025-04-15T01:02:36.2968026Z       âœ“ should track on `server-started` event (10 ms)
2025-04-15T01:02:36.2968716Z       âœ“ should track on `session-started` event (1 ms)
2025-04-15T01:02:36.2969418Z       âœ“ should track on `instance-stopped` event (1 ms)
2025-04-15T01:02:36.2970181Z       âœ“ should track on `instance-owner-setup` event (1 ms)
2025-04-15T01:02:36.2970715Z     workflow execution events
2025-04-15T01:02:36.2971421Z       âœ“ should track on `first-production-workflow-succeeded` event
2025-04-15T01:02:36.2972834Z       âœ“ should track on `first-workflow-data-loaded` event (1 ms)
2025-04-15T01:02:36.2973387Z     email events
2025-04-15T01:02:36.2973916Z       âœ“ should track on `email-failed` event (1 ms)
2025-04-15T01:02:36.2974421Z     Community+ registered
2025-04-15T01:02:36.2975071Z       âœ“ should track `license-community-plus-registered` event
2025-04-15T01:02:36.2975689Z     workflow post execute events
2025-04-15T01:02:36.2976307Z       âœ“ should not track when workflow has no id (1 ms)
2025-04-15T01:02:36.2977045Z       âœ“ should track successful workflow execution (19 ms)
2025-04-15T01:02:36.2977972Z       âœ“ should call telemetry.track when manual node execution finished (9 ms)
2025-04-15T01:02:36.2979240Z       âœ“ should call telemetry.track when manual node execution finished with canceled error message (6 ms)
2025-04-15T01:02:36.2980445Z       âœ“ should call telemetry.track when manual workflow execution finished (83 ms)
2025-04-15T01:02:36.2982047Z       âœ“ should call telemetry.track when manual node execution finished with is_managed and credential_type properties (4 ms)
2025-04-15T01:02:36.2983413Z       âœ“ should call telemetry.track when user ran out of free AI credits (7 ms)
2025-04-15T01:02:36.2983940Z 
2025-04-15T01:02:39.0557806Z PASS test/integration/credentials/credentials.api.ee.test.ts (10.328 s)
2025-04-15T01:02:39.0604161Z   POST /credentials
2025-04-15T01:02:39.0605699Z     âœ“ project viewers cannot create credentials (165 ms)
2025-04-15T01:02:39.0606451Z   GET /credentials
2025-04-15T01:02:39.0607209Z     âœ“ should return all creds for owner (109 ms)
2025-04-15T01:02:39.0608175Z     âœ“ should return only relevant creds for member (83 ms)
2025-04-15T01:02:39.0609474Z     âœ“ should show credentials that the user has access to through a team project they are part of (79 ms)
2025-04-15T01:02:39.0610595Z   GET /credentials/for-workflow
2025-04-15T01:02:39.0611163Z     for team projects
2025-04-15T01:02:39.0612809Z       âœ“ it will only return the credentials in that project if "workflowId" is used as the query parameter and the actor is a "member" (79 ms)
2025-04-15T01:02:39.0614690Z       âœ“ it will only return the credentials in that project if "projectId" is used as the query parameter and the actor is a "member" (64 ms)
2025-04-15T01:02:39.0616131Z       âœ“ it will only return the credentials in that project if "workflowId" is used as the query parameter and the actor is a "owner" (74 ms)
2025-04-15T01:02:39.0617738Z       âœ“ it will only return the credentials in that project if "projectId" is used as the query parameter and the actor is a "owner" (98 ms)
2025-04-15T01:02:39.0618927Z     for personal projects
2025-04-15T01:02:39.0619924Z       âœ“ it returns only personal credentials for a members, if "projectId" is used as the query parameter (102 ms)
2025-04-15T01:02:39.0621266Z       âœ“ it returns only personal credentials for a members, if "workflowId" is used as the query parameter (95 ms)
2025-04-15T01:02:39.0623202Z       âœ“ if the actor is a global owner and the workflow has not been shared with them, it returns all credentials of all projects the workflow is part of (76 ms)
2025-04-15T01:02:39.0625104Z       âœ“ if the actor is a global owner and the workflow has been shared with them, it returns all credentials of all projects the workflow is part of (66 ms)
2025-04-15T01:02:39.0626613Z       âœ“ if the projectId is passed by a global owner it will return all credentials in that project (61 ms)
2025-04-15T01:02:39.0628258Z       âœ“ if the global owner owns the workflow it will return all credentials of all personal projects, when using "workflowId" as the query parameter (69 ms)
2025-04-15T01:02:39.0630084Z       âœ“ if the global owner owns the workflow it will return all credentials of all personal projects, when using "projectId" as the query parameter (74 ms)
2025-04-15T01:02:39.0631051Z   GET /credentials/:id
2025-04-15T01:02:39.0631720Z     âœ“ project viewers can view credentials (62 ms)
2025-04-15T01:02:39.0632367Z     âœ“ should retrieve owned cred for owner (62 ms)
2025-04-15T01:02:39.0633326Z     âœ“ should redact the data when `includeData:true` is passed (57 ms)
2025-04-15T01:02:39.0634054Z     âœ“ should retrieve non-owned cred for owner (98 ms)
2025-04-15T01:02:39.0634674Z     âœ“ should retrieve owned cred for member (88 ms)
2025-04-15T01:02:39.0635363Z     âœ“ should not retrieve non-owned cred for member (45 ms)
2025-04-15T01:02:39.0636002Z     âœ“ should return 404 if cred not found (51 ms)
2025-04-15T01:02:39.0636477Z   PATCH /credentials/:id
2025-04-15T01:02:39.0637049Z     âœ“ project viewer cannot update credentials (56 ms)
2025-04-15T01:02:39.0637567Z   PUT /credentials/:id/share
2025-04-15T01:02:39.0638473Z     âœ“ should share the credential with the provided userIds and unshare it for missing ones (101 ms)
2025-04-15T01:02:39.0639486Z     âœ“ should share the credential with the provided userIds (74 ms)
2025-04-15T01:02:39.0640259Z     âœ“ should respond 403 for non-existing credentials (50 ms)
2025-04-15T01:02:39.0641141Z     âœ“ should respond 403 for non-owned credentials for shared members (58 ms)
2025-04-15T01:02:39.0642401Z     âœ“ should respond 403 for non-owned credentials for non-shared members sharing with self (57 ms)
2025-04-15T01:02:39.0643559Z     âœ“ should respond 403 for non-owned credentials for non-shared members sharing (59 ms)
2025-04-15T01:02:39.0644500Z     âœ“ should respond 200 for non-owned credentials for owners (53 ms)
2025-04-15T01:02:39.0645213Z     âœ“ should not ignore pending sharee (57 ms)
2025-04-15T01:02:39.0645807Z     âœ“ should ignore non-existing sharee (53 ms)
2025-04-15T01:02:39.0646481Z     âœ“ should ignore sharing with owner project (44 ms)
2025-04-15T01:02:39.0647322Z     âœ“ should ignore sharing with project that already has it shared (54 ms)
2025-04-15T01:02:39.0648187Z     âœ“ should respond 400 if invalid payload is provided (41 ms)
2025-04-15T01:02:39.0648859Z     âœ“ should unshare the credential (56 ms)
2025-04-15T01:02:39.0649751Z     âœ“ should not call internal hooks listener for email sent if emailing is disabled (55 ms)
2025-04-15T01:02:39.0651003Z     âœ“ member should be able to share from personal project to team project that member has access to (58 ms)
2025-04-15T01:02:39.0652276Z     âœ“ member should be able to share from team project to personal project (60 ms)
2025-04-15T01:02:39.0653389Z     âœ“ member should be able to share from team project to team project that member has access to (49 ms)
2025-04-15T01:02:39.0654472Z     âœ“ admins should be able to share from any team project to any team project  (67 ms)
2025-04-15T01:02:39.0655604Z     âœ“ admins should be able to share from any team project to any user's personal project  (54 ms)
2025-04-15T01:02:39.0656986Z     âœ“ admins should be able to share from any personal project to any team project  (59 ms)
2025-04-15T01:02:39.0657662Z   PUT /:credentialId/transfer
2025-04-15T01:02:39.0658230Z     âœ“ cannot transfer into the same project (57 ms)
2025-04-15T01:02:39.0658884Z     âœ“ cannot transfer somebody elses credential (55 ms)
2025-04-15T01:02:39.0659696Z     âœ“ cannot transfer if you're not a member of the destination project (55 ms)
2025-04-15T01:02:39.0660557Z     âœ“ project:editors cannot transfer credentials (60 ms)
2025-04-15T01:02:39.0661272Z     âœ“ project:viewers cannot transfer credentials (45 ms)
2025-04-15T01:02:39.0667342Z     âœ“ owners can always transfer from a team project to a team project (54 ms)
2025-04-15T01:02:39.0668379Z     âœ“ owners can always transfer from a team project to a personal project (45 ms)
2025-04-15T01:02:39.0669391Z     âœ“ owners can always transfer from a personal project to a team project (56 ms)
2025-04-15T01:02:39.0670372Z     âœ“ admins can always transfer from a team project to a team project (50 ms)
2025-04-15T01:02:39.0671331Z     âœ“ admins can always transfer from a team project to a personal project (66 ms)
2025-04-15T01:02:39.0672506Z     âœ“ admins can always transfer from a personal project to a team project (69 ms)
2025-04-15T01:02:39.0672968Z 
2025-04-15T01:02:40.6762933Z PASS src/ldap.ee/__tests__/ldap.service.test.ts
2025-04-15T01:02:40.6763592Z   LdapService
2025-04-15T01:02:40.6764368Z     init()
2025-04-15T01:02:40.6765092Z       âœ“ should load the LDAP configuration (8 ms)
2025-04-15T01:02:40.6766025Z       âœ“ should set expected configuration variables from LDAP config if LDAP is enabled (3 ms)
2025-04-15T01:02:40.6767168Z       âœ“ should set expected configuration variables from LDAP config if LDAP is disabled (1 ms)
2025-04-15T01:02:40.6768295Z       âœ“ should show logger warning if authentication method is not ldap or email (1 ms)
2025-04-15T01:02:40.6769255Z       âœ“ should schedule syncing if config has enabled synchronization (2 ms)
2025-04-15T01:02:40.6770512Z       âœ“ should throw an error if config has enabled synchronization but no synchronizationInterval is set (50 ms)
2025-04-15T01:02:40.6771293Z     loadConfig()
2025-04-15T01:02:40.6772137Z       âœ“ should retrieve the LDAP configuration from the settings repository (1 ms)
2025-04-15T01:02:40.6773168Z       âœ“ should throw an expected error if the LDAP configuration is not found (2 ms)
2025-04-15T01:02:40.6774177Z       âœ“ should decipher the LDAP configuration admin password (1 ms)
2025-04-15T01:02:40.6775241Z       âœ“ should return the expected LDAP configuration (1 ms)
2025-04-15T01:02:40.6775759Z     updateConfig()
2025-04-15T01:02:40.6776482Z       âœ“ should throw expected error if the LDAP configuration is invalid (6 ms)
2025-04-15T01:02:40.6777758Z       âœ“ should throw expected error if login is enabled and the current authentication method is "saml" (1 ms)
2025-04-15T01:02:40.6778741Z       âœ“ should encrypt the binding admin password (2 ms)
2025-04-15T01:02:40.6779725Z       âœ“ should delete all ldap identities if login is disabled and ldap users exist (2 ms)
2025-04-15T01:02:40.6780948Z       âœ“ should not delete ldap identities if login is disabled and there are no ldap identities (7 ms)
2025-04-15T01:02:40.6791166Z       âœ“ should update the LDAP configuration in the settings repository (1 ms)
2025-04-15T01:02:40.6792325Z       âœ“ should update the LDAP login label in the config (1 ms)
2025-04-15T01:02:40.6792915Z     setConfig()
2025-04-15T01:02:40.6793814Z       âœ“ should stop synchronization if the timer is running and the config is disabled (1 ms)
2025-04-15T01:02:40.6795103Z       âœ“ should schedule synchronization if the timer is not running and the config is enabled (1 ms)
2025-04-15T01:02:40.6796678Z       âœ“ should throw an error if the timer is not running and the config is enabled but the synchronizationInterval is not set (1 ms)
2025-04-15T01:02:40.6798176Z       âœ“ should restart synchronization if the timer is running and the config is enabled (1 ms)
2025-04-15T01:02:40.6799260Z     searchWithAdminBinding()
2025-04-15T01:02:40.6799832Z       âœ“ should bind admin client (1 ms)
2025-04-15T01:02:40.6800517Z       âœ“ should call client search with expected parameters
2025-04-15T01:02:40.6801506Z       âœ“ should call client search with expected parameters when searchPageSize is 0 (1 ms)
2025-04-15T01:02:40.6802568Z       âœ“ should unbind client after search (1 ms)
2025-04-15T01:02:40.6803212Z       âœ“ should return expected search entries
2025-04-15T01:02:40.6803918Z     validUser()
2025-04-15T01:02:40.6804645Z       âœ“ should throw expected error if no configuration has been set (1 ms)
2025-04-15T01:02:40.6805724Z       âœ“ should bind the ldap client with the expected distinguished name and password (1 ms)
2025-04-15T01:02:40.6806607Z       âœ“ should throw expected error if binding fails
2025-04-15T01:02:40.6807265Z       âœ“ should unbind the client binding (1 ms)
2025-04-15T01:02:40.6807812Z     findAndAuthenticateLdapUser()
2025-04-15T01:02:40.6808574Z       âœ“ should search for expected admin login ID (2 ms)
2025-04-15T01:02:40.6809392Z       âœ“ should emit expected error if admin search fails (1 ms)
2025-04-15T01:02:40.6810201Z       âœ“ should return undefined if no user is found (1 ms)
2025-04-15T01:02:40.6810848Z       âœ“ should validate found user (1 ms)
2025-04-15T01:02:40.6811776Z       âœ“ should validate last user if more than one is found (1 ms)
2025-04-15T01:02:40.6812632Z       âœ“ should return undefined if invalid user is found
2025-04-15T01:02:40.6813429Z       âœ“ should resolve binary attributes for found user
2025-04-15T01:02:40.6814071Z       âœ“ should return found user (1 ms)
2025-04-15T01:02:40.6814510Z     testConnection()
2025-04-15T01:02:40.6815192Z       âœ“ should throw expected error if init() is not called first (1 ms)
2025-04-15T01:02:40.6816210Z       âœ“ should create a new client without TLS if connectionSecurity is set to "none"
2025-04-15T01:02:40.6817682Z       âœ“ should create a new client with TLS enabled if connectionSecurity is set to "tls" and allowing unauthorized certificates (2 ms)
2025-04-15T01:02:40.6819447Z       âœ“ should create a new client with TLS enabled if connectionSecurity is set to "tls" and not allowing unauthorized certificates
2025-04-15T01:02:40.6820916Z       âœ“ should create a new client and start TLS if connectionSecurity is set to "startTls" (1 ms)
2025-04-15T01:02:40.6822304Z       âœ“ should not create a new client if one has already been created (1 ms)
2025-04-15T01:02:40.6822937Z     runSync()
2025-04-15T01:02:40.6823522Z       âœ“ should search for users with expected parameters (1 ms)
2025-04-15T01:02:40.6824256Z       âœ“ should resolve binary attributes for users (2 ms)
2025-04-15T01:02:40.6824942Z       âœ“ should throw expected error if search fails (1 ms)
2025-04-15T01:02:40.6825660Z       âœ“ should process expected users if mode is "live" (1 ms)
2025-04-15T01:02:40.6826448Z       âœ“ should sync expected LDAP data when no errors (2 ms)
2025-04-15T01:02:40.6827355Z       âœ“ should sync expected LDAP data when users fail to process (2 ms)
2025-04-15T01:02:40.6828643Z       âœ“ should emit expected event if synchronization is enabled (1 ms)
2025-04-15T01:02:40.6829616Z       âœ“ should emit expected event if synchronization is disabled (1 ms)
2025-04-15T01:02:40.6830623Z       âœ“ should emit expected event with error message if processUsers fails (1 ms)
2025-04-15T01:02:40.6831289Z     stopSync()
2025-04-15T01:02:40.6844091Z       âœ“ should clear the scheduled timer
2025-04-15T01:02:40.6844493Z 
2025-04-15T01:02:42.6448884Z PASS test/integration/folder/folder.controller.test.ts (9.957 s)
2025-04-15T01:02:42.6449713Z   POST /projects/:projectId/folders
2025-04-15T01:02:42.6450745Z     âœ“ should not create folder when project does not exist (135 ms)
2025-04-15T01:02:42.6451990Z     âœ“ should not create folder when name is empty (59 ms)
2025-04-15T01:02:42.6453072Z     âœ“ should not create folder if user has project:viewer role in team project (44 ms)
2025-04-15T01:02:42.6454246Z     âœ“ should not allow creating folder in another user's personal project (33 ms)
2025-04-15T01:02:42.6455510Z     âœ“ should create folder if user has project:editor role in team project (33 ms)
2025-04-15T01:02:42.6456683Z     âœ“ should create folder if user has project:admin role in team project (28 ms)
2025-04-15T01:02:42.6458053Z     âœ“ should not allow creating folder with parent that exists in another project (58 ms)
2025-04-15T01:02:42.6459115Z     âœ“ should create folder in root of specified project (42 ms)
2025-04-15T01:02:42.6460526Z     âœ“ should create folder in specified project within another folder (46 ms)
2025-04-15T01:02:42.6461417Z     âœ“ should create folder in personal project (35 ms)
2025-04-15T01:02:42.6462453Z   GET /projects/:projectId/folders/:folderId/tree
2025-04-15T01:02:42.6463642Z     âœ“ should not get folder tree when project does not exist (28 ms)
2025-04-15T01:02:42.6464582Z     âœ“ should not get folder tree when folder does not exist (41 ms)
2025-04-15T01:02:42.6465582Z     âœ“ should not get folder tree if user has no access to project (36 ms)
2025-04-15T01:02:42.6466760Z     âœ“ should not allow getting folder tree from another user's personal project (34 ms)
2025-04-15T01:02:42.6467709Z     âœ“ should get nested folder structure (59 ms)
2025-04-15T01:02:42.6468332Z   PATCH /projects/:projectId/folders/:folderId
2025-04-15T01:02:42.6469152Z     âœ“ should not update folder when project does not exist (59 ms)
2025-04-15T01:02:42.6470030Z     âœ“ should not update folder when folder does not exist (34 ms)
2025-04-15T01:02:42.6470924Z     âœ“ should not update folder when name is empty (33 ms)
2025-04-15T01:02:42.6472130Z     âœ“ should not update folder if user has project:viewer role in team project (36 ms)
2025-04-15T01:02:42.6473253Z     âœ“ should not allow updating folder in another user's personal project (28 ms)
2025-04-15T01:02:42.6474426Z     âœ“ should update folder if user has project:editor role in team project (31 ms)
2025-04-15T01:02:42.6475600Z     âœ“ should update folder if user has project:admin role in team project (35 ms)
2025-04-15T01:02:42.6476586Z     âœ“ should update folder in personal project (34 ms)
2025-04-15T01:02:42.6477326Z     âœ“ should update folder tags (46 ms)
2025-04-15T01:02:42.6478112Z     âœ“ should replace existing folder tags with new ones (50 ms)
2025-04-15T01:02:42.6478880Z     âœ“ should update folder parent folder ID (50 ms)
2025-04-15T01:02:42.6479846Z     âœ“ should not update folder parent when target folder does not exist (37 ms)
2025-04-15T01:02:42.6481058Z     âœ“ should not update folder parent when target folder is in another project (39 ms)
2025-04-15T01:02:42.6482540Z     âœ“ should allow moving a folder to root level by setting parentFolderId to "0" (41 ms)
2025-04-15T01:02:42.6483777Z     âœ“ should not update folder parent if user has project:viewer role in team project (46 ms)
2025-04-15T01:02:42.6485062Z     âœ“ should update folder parent folder if user has project:editor role in team project (43 ms)
2025-04-15T01:02:42.6486108Z     âœ“ should not allow setting a folder as its own parent (34 ms)
2025-04-15T01:02:42.6487119Z   DELETE /projects/:projectId/folders/:folderId
2025-04-15T01:02:42.6487955Z     âœ“ should not delete folder when project does not exist (24 ms)
2025-04-15T01:02:42.6488846Z     âœ“ should not delete folder when folder does not exist (31 ms)
2025-04-15T01:02:42.6489940Z     âœ“ should not delete folder if user has project:viewer role in team project (30 ms)
2025-04-15T01:02:42.6491122Z     âœ“ should not allow deleting folder in another user's personal project (31 ms)
2025-04-15T01:02:42.6492493Z     âœ“ should delete folder if user has project:editor role in team project (37 ms)
2025-04-15T01:02:42.6493561Z     âœ“ should delete folder if user has project:admin role in team project (31 ms)
2025-04-15T01:02:42.6494473Z     âœ“ should delete folder in personal project (29 ms)
2025-04-15T01:02:42.6495715Z     âœ“ should delete folder, all child folders, and contained workflows when no transfer folder is specified (48 ms)
2025-04-15T01:02:42.6497031Z     âœ“ should transfer folder contents when transferToFolderId is specified (50 ms)
2025-04-15T01:02:42.6498248Z     âœ“ should not transfer folder contents when transfer folder does not exist (36 ms)
2025-04-15T01:02:42.6499452Z     âœ“ should not transfer folder contents when transfer folder is in another project (40 ms)
2025-04-15T01:02:42.6500723Z     âœ“ should not allow transferring contents to the same folder being deleted (34 ms)
2025-04-15T01:02:42.6502180Z     âœ“ should transfer folder contents to project root when transferToFolderId is "0" (58 ms)
2025-04-15T01:02:42.6503281Z   GET /projects/:projectId/folders
2025-04-15T01:02:42.6504050Z     âœ“ should not list folders when project does not exist (24 ms)
2025-04-15T01:02:42.6504945Z     âœ“ should not list folders if user has no access to project (26 ms)
2025-04-15T01:02:42.6505931Z     âœ“ should not allow listing folders from another user's personal project (22 ms)
2025-04-15T01:02:42.6507065Z     âœ“ should list folders if user has project:viewer role in team project (59 ms)
2025-04-15T01:02:42.6508004Z     âœ“ should list folders from personal project (35 ms)
2025-04-15T01:02:42.6508772Z     âœ“ should filter folders by name (37 ms)
2025-04-15T01:02:42.6509516Z     âœ“ should filter folders by parent folder ID (44 ms)
2025-04-15T01:02:42.6510428Z     âœ“ should filter root-level folders when parentFolderId=0 (38 ms)
2025-04-15T01:02:42.6511203Z     âœ“ should filter folders by tag (65 ms)
2025-04-15T01:02:42.6512252Z     âœ“ should filter folders by multiple tags (AND operator) (55 ms)
2025-04-15T01:02:42.6513267Z     âœ“ should filter folders by excludeFolderIdAndDescendants (43 ms)
2025-04-15T01:02:42.6514199Z     âœ“ should apply pagination with take parameter (61 ms)
2025-04-15T01:02:42.6515068Z     âœ“ should apply pagination with skip parameter (46 ms)
2025-04-15T01:02:42.6515921Z     âœ“ should apply combined skip and take parameters (48 ms)
2025-04-15T01:02:42.6516689Z     âœ“ should sort folders by name ascending (39 ms)
2025-04-15T01:02:42.6517421Z     âœ“ should sort folders by name descending (33 ms)
2025-04-15T01:02:42.6518206Z     âœ“ should sort folders by updatedAt (32 ms)
2025-04-15T01:02:42.6518980Z     âœ“ should select specific fields when requested (31 ms)
2025-04-15T01:02:42.6519867Z     âœ“ should combine multiple query parameters correctly (40 ms)
2025-04-15T01:02:42.6520812Z     âœ“ should filter by projectId automatically based on URL (33 ms)
2025-04-15T01:02:42.6521734Z   GET /projects/:projectId/folders/content
2025-04-15T01:02:42.6522559Z     âœ“ should not list folders when project does not exist (29 ms)
2025-04-15T01:02:42.6523572Z     âœ“ should not return folder content if user has no access to project (32 ms)
2025-04-15T01:02:42.6524721Z     âœ“ should not return folder content if folder does not belong to project (28 ms)
2025-04-15T01:02:42.6525935Z     âœ“ should return folder content if user has project:viewer role in team project (41 ms)
2025-04-15T01:02:42.6526895Z     âœ“ should return folder content (49 ms)
2025-04-15T01:02:42.6527255Z 
2025-04-15T01:02:46.1309124Z PASS src/evaluation.ee/test-runner/__tests__/test-runner.service.ee.test.ts (5.163 s)
2025-04-15T01:02:46.1314022Z   TestRunnerService
2025-04-15T01:02:46.1317654Z     âœ“ should create an instance of TestRunnerService (6 ms)
2025-04-15T01:02:46.1332020Z     âœ“ should create and run test cases from past executions (11 ms)
2025-04-15T01:02:46.1333031Z     âœ“ should run both workflow under test and evaluation workflow (14 ms)
2025-04-15T01:02:46.1334010Z     âœ“ should properly count passed and failed executions (20 ms)
2025-04-15T01:02:46.1334914Z     âœ“ should properly count failed test executions (8 ms)
2025-04-15T01:02:46.1337572Z     âœ“ should properly count failed evaluations (6 ms)
2025-04-15T01:02:46.1339253Z     âœ“ should specify correct start nodes when running workflow under test (14 ms)
2025-04-15T01:02:46.1340173Z     âœ“ should properly choose trigger and start nodes (1 ms)
2025-04-15T01:02:46.1341247Z     âœ“ should properly choose trigger and start nodes 2 (2 ms)
2025-04-15T01:02:46.1342510Z     âœ“ should properly run test when nodes were renamed (5 ms)
2025-04-15T01:02:46.1343537Z     âœ“ should properly choose trigger when it was renamed (1 ms)
2025-04-15T01:02:46.1344741Z     âœ“ should create proper execution data for queue mode in runTestCase (3 ms)
2025-04-15T01:02:46.1346094Z     âœ“ should create proper execution data for regular mode in runTestCase (2 ms)
2025-04-15T01:02:46.1372864Z     âœ“ should run workflow with metrics defined in the middle of the workflow (16 ms)
2025-04-15T01:02:46.1374091Z     âœ“ should properly override metrics from earlier nodes with later ones (6 ms)
2025-04-15T01:02:46.1375243Z     Test Run cancellation
2025-04-15T01:02:46.1375849Z       âœ“ should cancel test run (4 ms)
2025-04-15T01:02:46.1376166Z 
2025-04-15T01:02:47.9557536Z PASS test/integration/project.api.test.ts (8.619 s)
2025-04-15T01:02:47.9572160Z   GET /projects/
2025-04-15T01:02:47.9573262Z     âœ“ member should get all personal projects and team projects they are apart of (93 ms)
2025-04-15T01:02:47.9574142Z     âœ“ owner should get all projects (48 ms)
2025-04-15T01:02:47.9574633Z   GET /projects/count
2025-04-15T01:02:47.9575194Z     âœ“ should return correct number of projects (35 ms)
2025-04-15T01:02:47.9575691Z   GET /projects/my-projects
2025-04-15T01:02:47.9576356Z     âœ“ member should get all projects they are apart of (76 ms)
2025-04-15T01:02:47.9577164Z     âœ“ owner should get all projects they are apart of (58 ms)
2025-04-15T01:02:47.9577711Z   GET /projects/personal
2025-04-15T01:02:47.9578275Z     âœ“ should return the user's personal project (20 ms)
2025-04-15T01:02:47.9579132Z     âœ“ should return 404 if user doesn't have a personal project (44 ms)
2025-04-15T01:02:47.9579700Z   POST /projects/
2025-04-15T01:02:47.9580211Z     âœ“ should create a team project (31 ms)
2025-04-15T01:02:47.9581067Z     âœ“ should allow to create a team projects if below the quota (30 ms)
2025-04-15T01:02:47.9582336Z     âœ“ should fail to create a team project if at quota (18 ms)
2025-04-15T01:02:47.9583289Z     âœ“ should fail to create a team project if above the quota (17 ms)
2025-04-15T01:02:47.9583949Z   PATCH /projects/:projectId
2025-04-15T01:02:47.9584621Z     âœ“ should update a team project name (28 ms)
2025-04-15T01:02:47.9585498Z     âœ“ should not allow viewers to edit team project name (21 ms)
2025-04-15T01:02:47.9586471Z     âœ“ should not allow owners to edit personal project name (29 ms)
2025-04-15T01:02:47.9587076Z     member management
2025-04-15T01:02:47.9587745Z       âœ“ should add or remove users from a project (83 ms)
2025-04-15T01:02:47.9588873Z       âœ“ `project:viewer`s should not be able to add, update or remove users from a project (42 ms)
2025-04-15T01:02:47.9590244Z       âœ“ `project:editor`s should not be able to add, update or remove users from a project (37 ms)
2025-04-15T01:02:47.9591738Z       âœ“ should not be able to add a user with the role project:viewer if it's not licensed (35 ms)
2025-04-15T01:02:47.9593093Z       âœ“ should not be able to add a user with the role project:editor if it's not licensed (31 ms)
2025-04-15T01:02:47.9594447Z       âœ“ should not edit a relation of a project when changing a user's role to an unlicensed role (37 ms)
2025-04-15T01:02:47.9596550Z       âœ“ should  edit a relation of a project when changing a user's role to an licensed role but unlicensed roles are present (40 ms)
2025-04-15T01:02:47.9597862Z       âœ“ should not add or remove users from a personal project (22 ms)
2025-04-15T01:02:47.9598494Z   GET /project/:projectId
2025-04-15T01:02:47.9599186Z     âœ“ should get project details and relations (44 ms)
2025-04-15T01:02:47.9599776Z   DELETE /project/:projectId
2025-04-15T01:02:47.9600517Z     âœ“ allows the project:owner to delete a project (84 ms)
2025-04-15T01:02:47.9601828Z     âœ“ allows the instance owner to delete a team project their are not related to (36 ms)
2025-04-15T01:02:47.9603047Z     âœ“ does not allow instance members to delete their personal project (22 ms)
2025-04-15T01:02:47.9604171Z     âœ“ does not allow instance owners to delete their personal projects (16 ms)
2025-04-15T01:02:47.9605321Z     âœ“ does not allow users with the role project:editor to delete a project (17 ms)
2025-04-15T01:02:47.9606502Z     âœ“ does not allow users with the role project:viewer to delete a project (24 ms)
2025-04-15T01:02:47.9607822Z     âœ“ deletes all workflows and credentials it owns as well as the sharings into other projects (104 ms)
2025-04-15T01:02:47.9609175Z     âœ“ unshares all workflows and credentials that were shared with the project (93 ms)
2025-04-15T01:02:47.9610136Z     âœ“ deletes the project relations (36 ms)
2025-04-15T01:02:47.9611333Z     âœ“ should fail if the project to delete does not exist (15 ms)
2025-04-15T01:02:47.9612676Z     âœ“ should fail to delete if project to migrate to and the project to delete are the same (19 ms)
2025-04-15T01:02:47.9614472Z     âœ“ does not migrate credentials and projects if the user does not have the permissions to create workflows or credentials in the target project (24 ms)
2025-04-15T01:02:47.9616299Z     âœ“ migrates folders, workflows and credentials to another project if `migrateToProject` is passed (70 ms)
2025-04-15T01:02:47.9617800Z     âœ“ should upgrade a projects role if the workflow/credential is already shared with it (44 ms)
2025-04-15T01:02:47.9618462Z 
2025-04-15T01:02:50.8086911Z PASS test/integration/users.api.test.ts (7.928 s)
2025-04-15T01:02:50.8087615Z   GET /users
2025-04-15T01:02:50.8088354Z     âœ“ should return all users (79 ms)
2025-04-15T01:02:50.8088825Z     list query options
2025-04-15T01:02:50.8089192Z       filter
2025-04-15T01:02:50.8089731Z         âœ“ should filter users by field: email (25 ms)
2025-04-15T01:02:50.8090503Z         âœ“ should filter users by field: firstName (18 ms)
2025-04-15T01:02:50.8091222Z         âœ“ should filter users by field: lastName (18 ms)
2025-04-15T01:02:50.8092385Z         âœ“ should filter users by computed field: isOwner (15 ms)
2025-04-15T01:02:50.8092898Z       select
2025-04-15T01:02:50.8093362Z         âœ“ should select user field: id (9 ms)
2025-04-15T01:02:50.8094002Z         âœ“ should select user field: email (5 ms)
2025-04-15T01:02:50.8094698Z         âœ“ should select user field: firstName (5 ms)
2025-04-15T01:02:50.8095379Z         âœ“ should select user field: lastName (5 ms)
2025-04-15T01:02:50.8095842Z       take
2025-04-15T01:02:50.8096434Z         âœ“ should return n users or less, without skip (20 ms)
2025-04-15T01:02:50.8097225Z         âœ“ should return n users or less, with skip (9 ms)
2025-04-15T01:02:50.8097750Z       auxiliary fields
2025-04-15T01:02:50.8098451Z         âœ“ should support options that require auxiliary fields (7 ms)
2025-04-15T01:02:50.8099140Z   GET /users/:id/password-reset-link
2025-04-15T01:02:50.8100125Z     âœ“ should allow owners to generate password reset links for admins and members (27 ms)
2025-04-15T01:02:50.8101772Z     âœ“ should allow admins to generate password reset links for admins and members, but not owners (50 ms)
2025-04-15T01:02:50.8103005Z     âœ“ should not allow members to generate password reset links for anyone (15 ms)
2025-04-15T01:02:50.8103651Z   DELETE /users/:id
2025-04-15T01:02:50.8104218Z     âœ“ should delete user and their resources (90 ms)
2025-04-15T01:02:50.8105684Z     âœ“ should delete user and team relations and transfer their personal resources to user (129 ms)
2025-04-15T01:02:50.8106767Z     âœ“ should delete user and transfer their personal resources to team project (55 ms)
2025-04-15T01:02:50.8107492Z     âœ“ should fail to delete self (11 ms)
2025-04-15T01:02:50.8108084Z     âœ“ should fail to delete the instance owner (19 ms)
2025-04-15T01:02:50.8108769Z     âœ“ should fail to delete a user that does not exist (5 ms)
2025-04-15T01:02:50.8109550Z     âœ“ should fail to transfer to a project that does not exist (15 ms)
2025-04-15T01:02:50.8110339Z     âœ“ should fail to delete if user to delete is transferee (17 ms)
2025-04-15T01:02:50.8110842Z   PATCH /users/:id/role
2025-04-15T01:02:50.8114075Z     âœ“ should clear credential external secrets usability cache when changing a user's role (52 ms)
2025-04-15T01:02:50.8114829Z     unauthenticated user
2025-04-15T01:02:50.8115343Z       âœ“ should receive 401 (4 ms)
2025-04-15T01:02:50.8115859Z     Invalid payload should return 400 when newRoleName
2025-04-15T01:02:50.8116376Z       âœ“ is missing (7 ms)
2025-04-15T01:02:50.8116749Z       âœ“ is `owner` (5 ms)
2025-04-15T01:02:50.8117130Z       âœ“ is an array (5 ms)
2025-04-15T01:02:50.8117447Z     member
2025-04-15T01:02:50.8117912Z       âœ“ should fail to demote owner to member (7 ms)
2025-04-15T01:02:50.8118525Z       âœ“ should fail to demote owner to admin (8 ms)
2025-04-15T01:02:50.8119146Z       âœ“ should fail to demote admin to member (10 ms)
2025-04-15T01:02:50.8120126Z       âœ“ should fail to promote other member to owner (5 ms)
2025-04-15T01:02:50.8120780Z       âœ“ should fail to promote other member to admin (6 ms)
2025-04-15T01:02:50.8121390Z       âœ“ should fail to promote self to admin (5 ms)
2025-04-15T01:02:50.8122245Z       âœ“ should fail to promote self to owner (6 ms)
2025-04-15T01:02:50.8122655Z     admin
2025-04-15T01:02:50.8123090Z       âœ“ should receive 404 on unknown target user (7 ms)
2025-04-15T01:02:50.8123667Z       âœ“ should fail to demote owner to admin (8 ms)
2025-04-15T01:02:50.8124261Z       âœ“ should fail to demote owner to member (9 ms)
2025-04-15T01:02:50.8124963Z       âœ“ should fail to promote member to admin if not licensed (5 ms)
2025-04-15T01:02:50.8125675Z       âœ“ should be able to demote admin to member (32 ms)
2025-04-15T01:02:50.8126333Z       âœ“ should be able to demote self to member (19 ms)
2025-04-15T01:02:50.8127088Z       âœ“ should be able to promote member to admin if licensed (18 ms)
2025-04-15T01:02:50.8127629Z     owner
2025-04-15T01:02:50.8128105Z       âœ“ should fail to demote self to admin (7 ms)
2025-04-15T01:02:50.8128738Z       âœ“ should fail to demote self to member (7 ms)
2025-04-15T01:02:50.8129478Z       âœ“ should fail to promote member to admin if not licensed (5 ms)
2025-04-15T01:02:50.8130283Z       âœ“ should be able to promote member to admin if licensed (19 ms)
2025-04-15T01:02:50.8131025Z       âœ“ should be able to demote admin to member (21 ms)
2025-04-15T01:02:50.8131394Z 
2025-04-15T01:02:51.1215836Z PASS src/task-runners/task-broker/__tests__/task-broker.service.test.ts
2025-04-15T01:02:51.1223713Z   TaskBroker
2025-04-15T01:02:51.1224054Z     expireTasks
2025-04-15T01:02:51.1224951Z       âœ“ should remove expired task offers and keep valid task offers (5 ms)
2025-04-15T01:02:51.1225782Z       âœ“ should not expire non-expiring task offers (1 ms)
2025-04-15T01:02:51.1226264Z     registerRunner
2025-04-15T01:02:51.1226780Z       âœ“ should add a runner to known runners (1 ms)
2025-04-15T01:02:51.1227409Z       âœ“ should send node types to runner
2025-04-15T01:02:51.1227832Z     registerRequester
2025-04-15T01:02:51.1228348Z       âœ“ should add a requester to known requesters
2025-04-15T01:02:51.1228828Z     deregisterRunner
2025-04-15T01:02:51.1229383Z       âœ“ should remove a runner from known runners (1 ms)
2025-04-15T01:02:51.1230066Z       âœ“ should remove any pending offers for that runner
2025-04-15T01:02:51.1230682Z       âœ“ should fail any running tasks for that runner (2 ms)
2025-04-15T01:02:51.1231809Z     deregisterRequester
2025-04-15T01:02:51.1232391Z       âœ“ should remove a requester from known requesters
2025-04-15T01:02:51.1232856Z     taskRequested
2025-04-15T01:02:51.1233448Z       âœ“ should match a pending offer to an incoming request (1 ms)
2025-04-15T01:02:51.1233957Z     taskOffered
2025-04-15T01:02:51.1234484Z       âœ“ should match a pending request to an incoming offer
2025-04-15T01:02:51.1234954Z     settleTasks
2025-04-15T01:02:51.1235553Z       âœ“ should match task offers with task requests by task type (2 ms)
2025-04-15T01:02:51.1236436Z       âœ“ should not match a request whose acceptance is in progress (1 ms)
2025-04-15T01:02:51.1237170Z       âœ“ should expire tasks before settling (1 ms)
2025-04-15T01:02:51.1237626Z     onRunnerMessage
2025-04-15T01:02:51.1238178Z       âœ“ should handle `runner:taskaccepted` message (1 ms)
2025-04-15T01:02:51.1238882Z       âœ“ should handle `runner:taskrejected` message (1 ms)
2025-04-15T01:02:51.1239565Z       âœ“ should handle `runner:taskdone` message (1 ms)
2025-04-15T01:02:51.1240195Z       âœ“ should handle `runner:taskerror` message
2025-04-15T01:02:51.1240887Z       âœ“ should handle `runner:taskdatarequest` message (1 ms)
2025-04-15T01:02:51.1241702Z       âœ“ should handle `runner:rpc` message
2025-04-15T01:02:51.1242372Z       âœ“ should handle `runner:nodetypesrequest` message
2025-04-15T01:02:51.1243152Z       âœ“ should handle `runner:taskoffer` message with expiring offer (1 ms)
2025-04-15T01:02:51.1244032Z       âœ“ should handle `runner:taskoffer` message with non-expiring offer (1 ms)
2025-04-15T01:02:51.1244865Z     onRequesterMessage
2025-04-15T01:02:51.1245410Z       âœ“ should handle `requester:nodetypesresponse` message
2025-04-15T01:02:51.1245872Z     task timeouts
2025-04-15T01:02:51.1246397Z       âœ“ on sending task, we should set up task timeout (1 ms)
2025-04-15T01:02:51.1247057Z       âœ“ on task completion, we should clear timeout (1 ms)
2025-04-15T01:02:51.1247632Z       âœ“ on task error, we should clear timeout
2025-04-15T01:02:51.1248650Z       âœ“ [internal mode] on timeout, we should emit `runner:timed-out-during-task` event and send error to requester (2 ms)
2025-04-15T01:02:51.1249923Z       âœ“ [external mode] on timeout, we should instruct the runner to cancel and send error to requester (1 ms)
2025-04-15T01:02:51.1250521Z 
2025-04-15T01:02:51.8979005Z PASS src/events/__tests__/log-streaming-event-relay.test.ts (5.546 s)
2025-04-15T01:02:51.8984321Z   LogStreamingEventRelay
2025-04-15T01:02:51.8988453Z     workflow events
2025-04-15T01:02:51.8993495Z       âœ“ should log on `workflow-created` event (5 ms)
2025-04-15T01:02:51.8998161Z       âœ“ should log on `workflow-deleted` event (1 ms)
2025-04-15T01:02:51.9003209Z       âœ“ should log on `workflow-saved` event
2025-04-15T01:02:51.9006931Z       âœ“ should log on `workflow-pre-execute` event (1 ms)
2025-04-15T01:02:51.9009949Z       âœ“ should log on `workflow-post-execute` for successful execution (8 ms)
2025-04-15T01:02:51.9021204Z       âœ“ should log on `workflow-post-execute` event for failed execution (1 ms)
2025-04-15T01:02:51.9022117Z     user events
2025-04-15T01:02:51.9022659Z       âœ“ should log on `user-updated` event
2025-04-15T01:02:51.9023371Z       âœ“ should log on `user-deleted` event (1 ms)
2025-04-15T01:02:51.9024070Z       âœ“ should log on `user-invited` event (1 ms)
2025-04-15T01:02:51.9024795Z       âœ“ should log on `user-reinvited` event (1 ms)
2025-04-15T01:02:51.9025523Z       âœ“ should log on `user-signed-up` event
2025-04-15T01:02:51.9026171Z       âœ“ should log on `user-logged-in` event
2025-04-15T01:02:51.9026686Z     click events
2025-04-15T01:02:51.9027417Z       âœ“ should log on `user-password-reset-request-click` event (1 ms)
2025-04-15T01:02:51.9028335Z       âœ“ should log on `user-invite-email-click` event (1 ms)
2025-04-15T01:02:51.9029177Z       âœ“ should log on `user-password-reset-email-click` event
2025-04-15T01:02:51.9029712Z     node events
2025-04-15T01:02:51.9030306Z       âœ“ should log on `node-pre-execute` event (1 ms)
2025-04-15T01:02:51.9031072Z       âœ“ should log on `node-post-execute` event (1 ms)
2025-04-15T01:02:51.9032722Z     credentials events
2025-04-15T01:02:51.9033402Z       âœ“ should log on `credentials-shared` event (1 ms)
2025-04-15T01:02:51.9034195Z       âœ“ should log on `credentials-created` event (1 ms)
2025-04-15T01:02:51.9034959Z       âœ“ should log on `credentials-deleted` event
2025-04-15T01:02:51.9035747Z       âœ“ should log on `credentials-updated` event (1 ms)
2025-04-15T01:02:51.9036279Z     auth events
2025-04-15T01:02:51.9036879Z       âœ“ should log on `user-login-failed` event
2025-04-15T01:02:51.9037394Z     community package events
2025-04-15T01:02:51.9038092Z       âœ“ should log on `community-package-updated` event
2025-04-15T01:02:51.9039034Z       âœ“ should log on `community-package-installed` event (1 ms)
2025-04-15T01:02:51.9039922Z       âœ“ should log on `community-package-deleted` event (1 ms)
2025-04-15T01:02:51.9040487Z     email events
2025-04-15T01:02:51.9041039Z       âœ“ should log on `email-failed` event
2025-04-15T01:02:51.9041714Z     public API events
2025-04-15T01:02:51.9042418Z       âœ“ should log on `public-api-key-created` event (1 ms)
2025-04-15T01:02:51.9043244Z       âœ“ should log on `public-api-key-deleted` event (1 ms)
2025-04-15T01:02:51.9043788Z     execution events
2025-04-15T01:02:51.9044464Z       âœ“ should log on `execution-started-during-bootup` event
2025-04-15T01:02:51.9045287Z       âœ“ should log on `execution-throttled` event (1 ms)
2025-04-15T01:02:51.9045816Z     AI events
2025-04-15T01:02:51.9046829Z       âœ“ should log on `ai-messages-retrieved-from-memory` event
2025-04-15T01:02:51.9047669Z       âœ“ should log on `ai-message-added-to-memory` event
2025-04-15T01:02:51.9048417Z       âœ“ should log on `ai-output-parsed` event
2025-04-15T01:02:51.9049190Z       âœ“ should log on `ai-documents-retrieved` event (1 ms)
2025-04-15T01:02:51.9049943Z       âœ“ should log on `ai-document-embedded` event
2025-04-15T01:02:51.9050698Z       âœ“ should log on `ai-query-embedded` event (1 ms)
2025-04-15T01:02:51.9051424Z       âœ“ should log on `ai-document-processed` event
2025-04-15T01:02:51.9052406Z       âœ“ should log on `ai-text-split` event (1 ms)
2025-04-15T01:02:51.9053096Z       âœ“ should log on `ai-tool-called` event
2025-04-15T01:02:51.9053859Z       âœ“ should log on `ai-vector-store-searched` event (1 ms)
2025-04-15T01:02:51.9054675Z       âœ“ should log on `ai-llm-generated-output` event
2025-04-15T01:02:51.9055430Z       âœ“ should log on `ai-llm-errored` event (1 ms)
2025-04-15T01:02:51.9056220Z       âœ“ should log on `ai-vector-store-populated` event
2025-04-15T01:02:51.9057058Z       âœ“ should log on `ai-vector-store-updated` event (1 ms)
2025-04-15T01:02:51.9057481Z 
2025-04-15T01:02:56.0303419Z PASS src/execution-lifecycle/__tests__/execution-lifecycle-hooks.test.ts
2025-04-15T01:02:56.0308132Z   Execution Lifecycle Hooks
2025-04-15T01:02:56.0312133Z     getLifecycleHooksForRegularMain
2025-04-15T01:02:56.0315015Z       âœ“ should setup the correct set of hooks (2 ms)
2025-04-15T01:02:56.0316480Z       workflowExecuteBefore
2025-04-15T01:02:56.0318219Z         âœ“ should emit workflow-pre-execute events (7 ms)
2025-04-15T01:02:56.0320356Z         âœ“ should run workflow.preExecute hook (1 ms)
2025-04-15T01:02:56.0322601Z         âœ“ should send executionStarted push event (1 ms)
2025-04-15T01:02:56.0326636Z         âœ“ should run workflow.preExecute external hook (1 ms)
2025-04-15T01:02:56.0327266Z       workflowExecuteAfter
2025-04-15T01:02:56.0328124Z         âœ“ should emit workflow-post-execute events (3 ms)
2025-04-15T01:02:56.0329214Z         âœ“ should not emit workflow-post-execute events for waiting executions (1 ms)
2025-04-15T01:02:56.0330104Z         âœ“ should run workflow.postExecute hook (1 ms)
2025-04-15T01:02:56.0330841Z         âœ“ should send executionFinished push event (2 ms)
2025-04-15T01:02:56.0331759Z         âœ“ should send executionWaiting push event (2 ms)
2025-04-15T01:02:56.0332703Z         âœ“ should restore binary data IDs after workflow execution for webhooks (1 ms)
2025-04-15T01:02:56.0333319Z         saving static data
2025-04-15T01:02:56.0334305Z           âœ“ should skip saving static data for manual executions
2025-04-15T01:02:56.0334996Z           âœ“ should save static data for prod executions (1 ms)
2025-04-15T01:02:56.0335653Z           âœ“ should handle static data saving errors (1 ms)
2025-04-15T01:02:56.0335947Z         saving execution data
2025-04-15T01:02:56.0336290Z           âœ“ should update execution with proper data (2 ms)
2025-04-15T01:02:56.0336690Z           âœ“ should not delete unfinished executions (1 ms)
2025-04-15T01:02:56.0337093Z           âœ“ should not delete waiting executions (1 ms)
2025-04-15T01:02:56.0337590Z           âœ“ should soft delete manual executions when manual saving is disabled (1 ms)
2025-04-15T01:02:56.0338292Z           âœ“ should not soft delete manual executions with waitTill (1 ms)
2025-04-15T01:02:56.0338863Z         error workflow
2025-04-15T01:02:56.0339551Z           âœ“ should not execute error workflow for manual executions (1 ms)
2025-04-15T01:02:56.0340419Z           âœ“ should execute error workflow for failed non-manual executions (2 ms)
2025-04-15T01:02:56.0341019Z       nodeExecuteBefore
2025-04-15T01:02:56.0341706Z         âœ“ should emit node-pre-execute event (1 ms)
2025-04-15T01:02:56.0342328Z         âœ“ should send nodeExecuteBefore push event
2025-04-15T01:02:56.0342764Z       nodeExecuteAfter
2025-04-15T01:02:56.0343299Z         âœ“ should emit node-post-execute event (1 ms)
2025-04-15T01:02:56.0343931Z         âœ“ should send nodeExecuteAfter push event (1 ms)
2025-04-15T01:02:56.0344844Z         âœ“ should save execution progress when enabled (1 ms)
2025-04-15T01:02:56.0345654Z         âœ“ should not save execution progress when disabled (1 ms)
2025-04-15T01:02:56.0346222Z       statistics events
2025-04-15T01:02:56.0347161Z         âœ“ workflowExecuteAfter should emit workflowExecutionCompleted statistics event (1 ms)
2025-04-15T01:02:56.0348409Z         âœ“ nodeFetchedData should handle nodeFetchedData statistics event (1 ms)
2025-04-15T01:02:56.0349106Z       when pushRef isn't set
2025-04-15T01:02:56.0349778Z         âœ“ should not setup any push hooks (2 ms)
2025-04-15T01:02:56.0350333Z     getLifecycleHooksForScalingMain
2025-04-15T01:02:56.0351040Z       âœ“ should setup the correct set of hooks (1 ms)
2025-04-15T01:02:56.0351771Z       workflowExecuteBefore
2025-04-15T01:02:56.0352445Z         âœ“ should emit workflow-pre-execute events
2025-04-15T01:02:56.0353168Z         âœ“ should run workflow.preExecute hook (1 ms)
2025-04-15T01:02:56.0353995Z         âœ“ should run the workflow.preExecute external hook (1 ms)
2025-04-15T01:02:56.0354623Z       workflowExecuteAfter
2025-04-15T01:02:56.0355317Z         âœ“ should emit workflow-post-execute events (1 ms)
2025-04-15T01:02:56.0356301Z         âœ“ should not emit workflow-post-execute events for waiting executions (5 ms)
2025-04-15T01:02:56.0357206Z         âœ“ should run workflow.postExecute hook
2025-04-15T01:02:56.0358172Z         âœ“ should delete successful executions when success saving is disabled (1 ms)
2025-04-15T01:02:56.0359227Z         âœ“ should delete failed executions when error saving is disabled
2025-04-15T01:02:56.0359947Z     getLifecycleHooksForScalingWorker
2025-04-15T01:02:56.0360657Z       âœ“ should setup the correct set of hooks (1 ms)
2025-04-15T01:02:56.0361172Z       nodeExecuteBefore
2025-04-15T01:02:56.0361976Z         âœ“ should emit node-pre-execute event (1 ms)
2025-04-15T01:02:56.0362488Z       nodeExecuteAfter
2025-04-15T01:02:56.0363115Z         âœ“ should emit node-post-execute event (1 ms)
2025-04-15T01:02:56.0363701Z       workflowExecuteBefore
2025-04-15T01:02:56.0364337Z         âœ“ should run workflow.preExecute hook
2025-04-15T01:02:56.0364840Z       workflowExecuteAfter
2025-04-15T01:02:56.0365482Z         âœ“ should run workflow.postExecute hook (1 ms)
2025-04-15T01:02:56.0366003Z       statistics events
2025-04-15T01:02:56.0367045Z         âœ“ workflowExecuteAfter should emit workflowExecutionCompleted statistics event (1 ms)
2025-04-15T01:02:56.0368288Z         âœ“ nodeFetchedData should handle nodeFetchedData statistics event (1 ms)
2025-04-15T01:02:56.0369351Z       saving static data
2025-04-15T01:02:56.0370125Z         âœ“ should skip saving static data for manual executions (1 ms)
2025-04-15T01:02:56.0371013Z         âœ“ should save static data for prod executions (1 ms)
2025-04-15T01:02:56.0372042Z         âœ“ should handle static data saving errors (1 ms)
2025-04-15T01:02:56.0372577Z       error workflow
2025-04-15T01:02:56.0373302Z         âœ“ should not execute error workflow for manual executions (1 ms)
2025-04-15T01:02:56.0374350Z         âœ“ should execute error workflow for failed non-manual executions (1 ms)
2025-04-15T01:02:56.0375088Z     getLifecycleHooksForSubExecutions
2025-04-15T01:02:56.0375790Z       âœ“ should setup the correct set of hooks (1 ms)
2025-04-15T01:02:56.0376332Z       workflowExecuteBefore
2025-04-15T01:02:56.0376985Z         âœ“ should emit workflow-pre-execute events (1 ms)
2025-04-15T01:02:56.0377731Z         âœ“ should run workflow.preExecute hook (1 ms)
2025-04-15T01:02:56.0378253Z       workflowExecuteAfter
2025-04-15T01:02:56.0378956Z         âœ“ should emit workflow-post-execute events (1 ms)
2025-04-15T01:02:56.0379946Z         âœ“ should not emit workflow-post-execute events for waiting executions (1 ms)
2025-04-15T01:02:56.0380917Z         âœ“ should run workflow.postExecute hook (2 ms)
2025-04-15T01:02:56.0381442Z       nodeExecuteBefore
2025-04-15T01:02:56.0382259Z         âœ“ should emit node-pre-execute event (1 ms)
2025-04-15T01:02:56.0382768Z       nodeExecuteAfter
2025-04-15T01:02:56.0383656Z         âœ“ should emit node-post-execute event (1 ms)
2025-04-15T01:02:56.0384173Z       statistics events
2025-04-15T01:02:56.0385120Z         âœ“ workflowExecuteAfter should emit workflowExecutionCompleted statistics event (1 ms)
2025-04-15T01:02:56.0386351Z         âœ“ nodeFetchedData should handle nodeFetchedData statistics event (1 ms)
2025-04-15T01:02:56.0386912Z 
2025-04-15T01:02:57.6331007Z PASS src/scaling/__tests__/pubsub-handler.test.ts (5.487 s)
2025-04-15T01:02:57.6331911Z   PubSubHandler
2025-04-15T01:02:57.6332268Z     in webhook process
2025-04-15T01:02:57.6333149Z       âœ“ should set up handlers in webhook process (7 ms)
2025-04-15T01:02:57.6339727Z       âœ“ should reload license on `reload-license` event (2 ms)
2025-04-15T01:02:57.6340657Z       âœ“ should restart event bus on `restart-event-bus` event (1 ms)
2025-04-15T01:02:57.6341868Z       âœ“ should reload providers on `reload-external-secrets-providers` event (1 ms)
2025-04-15T01:02:57.6343019Z       âœ“ should install community package on `community-package-install` event (1 ms)
2025-04-15T01:02:57.6344149Z       âœ“ should update community package on `community-package-update` event (1 ms)
2025-04-15T01:02:57.6345276Z       âœ“ should uninstall community package on `community-package-uninstall` event (2 ms)
2025-04-15T01:02:57.6345981Z     in worker process
2025-04-15T01:02:57.6346556Z       âœ“ should set up handlers in worker process (1 ms)
2025-04-15T01:02:57.6347262Z       âœ“ should reload license on `reload-license` event
2025-04-15T01:02:57.6348057Z       âœ“ should restart event bus on `restart-event-bus` event (1 ms)
2025-04-15T01:02:57.6349050Z       âœ“ should reload providers on `reload-external-secrets-providers` event
2025-04-15T01:02:57.6350073Z       âœ“ should install community package on `community-package-install` event
2025-04-15T01:02:57.6351225Z       âœ“ should update community package on `community-package-update` event (1 ms)
2025-04-15T01:02:57.6352508Z       âœ“ should uninstall community package on `community-package-uninstall` event
2025-04-15T01:02:57.6353553Z       âœ“ should generate status on `get-worker-status` event
2025-04-15T01:02:57.6354108Z     in main process
2025-04-15T01:02:57.6354930Z       âœ“ should set up command and worker response handlers in main process (2 ms)
2025-04-15T01:02:57.6355906Z       âœ“ should reload license on `reload-license` event (1 ms)
2025-04-15T01:02:57.6356745Z       âœ“ should restart event bus on `restart-event-bus` event
2025-04-15T01:02:57.6357705Z       âœ“ should reload providers on `reload-external-secrets-providers` event
2025-04-15T01:02:57.6359394Z       âœ“ should install community package on `community-package-install` event (1 ms)
2025-04-15T01:02:57.6360534Z       âœ“ should update community package on `community-package-update` event
2025-04-15T01:02:57.6361935Z       âœ“ should uninstall community package on `community-package-uninstall` event (1 ms)
2025-04-15T01:02:57.6362690Z       multi-main setup
2025-04-15T01:02:57.6363542Z         âœ“ if leader, should handle `add-webhooks-triggers-and-pollers` event (7 ms)
2025-04-15T01:02:57.6364701Z         âœ“ if follower, should skip `add-webhooks-triggers-and-pollers` event (11 ms)
2025-04-15T01:02:57.6365829Z         âœ“ if leader, should handle `remove-triggers-and-pollers` event (17 ms)
2025-04-15T01:02:57.6366884Z         âœ“ if follower, should skip `remove-triggers-and-pollers` event (16 ms)
2025-04-15T01:02:57.6367869Z         âœ“ should handle `display-workflow-activation` event (1 ms)
2025-04-15T01:02:57.6368799Z         âœ“ should handle `display-workflow-deactivation` event (1 ms)
2025-04-15T01:02:57.6369840Z         âœ“ should handle `display-workflow-activation-error` event (13 ms)
2025-04-15T01:02:57.6373888Z         âœ“ should handle `relay-execution-lifecycle-event` event (1 ms)
2025-04-15T01:02:57.6376762Z         âœ“ should handle `clear-test-webhooks` event (1 ms)
2025-04-15T01:02:57.6377669Z         âœ“ should handle `response-to-get-worker-status event (11 ms)
2025-04-15T01:02:57.6378108Z 
2025-04-15T01:02:58.1661489Z PASS test/integration/execution.service.integration.test.ts (7.065 s)
2025-04-15T01:02:58.1663324Z   ExecutionService
2025-04-15T01:02:58.1694054Z     findRangeWithCount
2025-04-15T01:02:58.1695089Z       âœ“ should return execution summaries (69 ms)
2025-04-15T01:02:58.1696110Z       âœ“ should limit executions (25 ms)
2025-04-15T01:02:58.1697177Z       âœ“ should retrieve executions before `lastId`, excluding it (43 ms)
2025-04-15T01:02:58.1698473Z       âœ“ should retrieve executions after `firstId`, excluding it (18 ms)
2025-04-15T01:02:58.1699542Z       âœ“ should filter executions by `status` (25 ms)
2025-04-15T01:02:58.1700512Z       âœ“ should filter executions by `workflowId` (27 ms)
2025-04-15T01:02:58.1701504Z       âœ“ should filter executions by `startedBefore` (14 ms)
2025-04-15T01:02:58.1702706Z       âœ“ should filter executions by `startedAfter` (17 ms)
2025-04-15T01:02:58.1703703Z       âœ“ should filter executions by `metadata` (18 ms)
2025-04-15T01:02:58.1704675Z       âœ“ should filter executions by `projectId` (32 ms)
2025-04-15T01:02:58.1705844Z       âœ“ should filter executions by `projectId` and expected `status` (28 ms)
2025-04-15T01:02:58.1707089Z       âœ“ should filter executions by `projectId` and expected `waitTill` (37 ms)
2025-04-15T01:02:58.1708446Z       âœ“ should filter executions by `projectId` and expected `metadata` (35 ms)
2025-04-15T01:02:58.1709820Z       âœ“ should filter executions by `projectId` and expected `startedAfter` (35 ms)
2025-04-15T01:02:58.1711186Z       âœ“ should filter executions by `projectId` and expected `startedBefore` (36 ms)
2025-04-15T01:02:58.1712720Z       âœ“ should exclude executions by inaccessible `workflowId` (19 ms)
2025-04-15T01:02:58.1713776Z       âœ“ should support advanced filters (21 ms)
2025-04-15T01:02:58.1714483Z     findLatestCurrentAndCompleted
2025-04-15T01:02:58.1715466Z       âœ“ should return latest current and completed executions (86 ms)
2025-04-15T01:02:58.1716574Z       âœ“ should handle zero current executions (26 ms)
2025-04-15T01:02:58.1717570Z       âœ“ should handle zero completed executions (17 ms)
2025-04-15T01:02:58.1718487Z       âœ“ should handle zero executions (8 ms)
2025-04-15T01:02:58.1719417Z       âœ“ should prioritize `running` over `new` executions (26 ms)
2025-04-15T01:02:58.1720195Z     annotation
2025-04-15T01:02:58.1720815Z       âœ“ should add and retrieve annotation (31 ms)
2025-04-15T01:02:58.1752564Z       âœ“ should update annotation (24 ms)
2025-04-15T01:02:58.1753521Z       âœ“ should filter by annotation tags (22 ms)
2025-04-15T01:02:58.1754355Z       âœ“ should filter by annotation vote (26 ms)
2025-04-15T01:02:58.1755513Z 
2025-04-15T01:03:00.2356008Z PASS src/sso.ee/saml/__tests__/saml-validator.test.ts
2025-04-15T01:03:00.2360287Z   saml-validator
2025-04-15T01:03:00.2361940Z     validateMetadata
2025-04-15T01:03:00.2364444Z       âœ“ successfully validates metadata containing ws federation tags (171 ms)
2025-04-15T01:03:00.2365435Z       âœ“ rejects invalid metadata (207 ms)
2025-04-15T01:03:00.2366651Z       âœ“ rejects malformed XML metadata (146 ms)
2025-04-15T01:03:00.2367695Z       âœ“ rejects metadata missing SingleSignOnService (221 ms)
2025-04-15T01:03:00.2368769Z       âœ“ rejects metadata with invalid X.509 certificate (153 ms)
2025-04-15T01:03:00.2369795Z     validateResponse
2025-04-15T01:03:00.2370644Z       âœ“ successfully validates response (176 ms)
2025-04-15T01:03:00.2371314Z       âœ“ rejects invalid response (174 ms)
2025-04-15T01:03:00.2372112Z       âœ“ rejects expired SAML response (121 ms)
2025-04-15T01:03:00.2372459Z 
2025-04-15T01:03:03.9770071Z PASS src/concurrency/__tests__/concurrency-control.service.test.ts
2025-04-15T01:03:03.9771304Z   ConcurrencyControlService
2025-04-15T01:03:03.9772517Z     constructor
2025-04-15T01:03:03.9773430Z       âœ“ should be enabled if production cap is positive (7 ms)
2025-04-15T01:03:03.9774294Z       âœ“ should be enabled if evaluation cap is positive (1 ms)
2025-04-15T01:03:03.9775051Z       âœ“ should throw if production cap is 0 (1 ms)
2025-04-15T01:03:03.9775748Z       âœ“ should throw if evaluation cap is 0 (1 ms)
2025-04-15T01:03:03.9776956Z       âœ“ should be disabled if both production and evaluation caps are -1
2025-04-15T01:03:03.9777901Z       âœ“ should be disabled if production cap is lower than -1 (1 ms)
2025-04-15T01:03:03.9778808Z       âœ“ should be disabled if evaluation cap is lower than -1 (1 ms)
2025-04-15T01:03:03.9779481Z       âœ“ should be disabled on queue mode
2025-04-15T01:03:03.9779916Z     if enabled
2025-04-15T01:03:03.9780220Z       throttle
2025-04-15T01:03:03.9780684Z         âœ“ should do nothing on cli mode (2 ms)
2025-04-15T01:03:03.9781259Z         âœ“ should do nothing on error mode
2025-04-15T01:03:03.9782164Z         âœ“ should do nothing on integrated mode
2025-04-15T01:03:03.9782800Z         âœ“ should do nothing on internal mode (1 ms)
2025-04-15T01:03:03.9783412Z         âœ“ should do nothing on manual mode
2025-04-15T01:03:03.9783980Z         âœ“ should do nothing on retry mode
2025-04-15T01:03:03.9784570Z         âœ“ should enqueue on webhook mode (1 ms)
2025-04-15T01:03:03.9785142Z         âœ“ should enqueue on trigger mode
2025-04-15T01:03:03.9785754Z         âœ“ should enqueue on evaluation mode (1 ms)
2025-04-15T01:03:03.9786205Z       release
2025-04-15T01:03:03.9786641Z         âœ“ should do nothing on cli mode
2025-04-15T01:03:03.9787218Z         âœ“ should do nothing on error mode (1 ms)
2025-04-15T01:03:03.9787838Z         âœ“ should do nothing on integrated mode (1 ms)
2025-04-15T01:03:03.9788454Z         âœ“ should do nothing on internal mode
2025-04-15T01:03:03.9789043Z         âœ“ should do nothing on manual mode (1 ms)
2025-04-15T01:03:03.9789617Z         âœ“ should do nothing on retry mode
2025-04-15T01:03:03.9790199Z         âœ“ should dequeue on webhook mode (1 ms)
2025-04-15T01:03:03.9790766Z         âœ“ should dequeue on trigger mode
2025-04-15T01:03:03.9791326Z         âœ“ should dequeue on evaluation mode
2025-04-15T01:03:03.9791892Z       remove
2025-04-15T01:03:03.9792374Z         âœ“ should do nothing on cli mode (1 ms)
2025-04-15T01:03:03.9792938Z         âœ“ should do nothing on error mode
2025-04-15T01:03:03.9793529Z         âœ“ should do nothing on integrated mode (1 ms)
2025-04-15T01:03:03.9794149Z         âœ“ should do nothing on internal mode
2025-04-15T01:03:03.9794734Z         âœ“ should do nothing on manual mode (2 ms)
2025-04-15T01:03:03.9795338Z         âœ“ should do nothing on retry mode (1 ms)
2025-04-15T01:03:03.9795941Z         âœ“ should remove an execution on webhook mode
2025-04-15T01:03:03.9796642Z         âœ“ should remove an execution on trigger mode (1 ms)
2025-04-15T01:03:03.9797307Z         âœ“ should remove an execution on evaluation mode
2025-04-15T01:03:03.9798050Z       removeAll
2025-04-15T01:03:03.9798679Z         âœ“ should remove all executions from the production queue (2 ms)
2025-04-15T01:03:03.9799525Z         âœ“ should remove all executions from the evaluation queue (1 ms)
2025-04-15T01:03:03.9800063Z       get queue
2025-04-15T01:03:03.9800529Z         âœ“ should choose the production queue
2025-04-15T01:03:03.9801121Z         âœ“ should choose the evaluation queue
2025-04-15T01:03:03.9801701Z     if disabled
2025-04-15T01:03:03.9802159Z       throttle
2025-04-15T01:03:03.9802544Z         âœ“ should do nothing
2025-04-15T01:03:03.9803101Z         âœ“ should do nothing for evaluation executions
2025-04-15T01:03:03.9803558Z       release
2025-04-15T01:03:03.9803900Z         âœ“ should do nothing
2025-04-15T01:03:03.9804495Z         âœ“ should do nothing for evaluation executions (1 ms)
2025-04-15T01:03:03.9804975Z       remove
2025-04-15T01:03:03.9805328Z         âœ“ should do nothing
2025-04-15T01:03:03.9805855Z         âœ“ should do nothing for evaluation executions
2025-04-15T01:03:03.9806320Z     telemetry
2025-04-15T01:03:03.9806610Z       on cloud
2025-04-15T01:03:03.9807320Z         âœ“ for capacity 5, should report temp cloud threshold if reached (1 ms)
2025-04-15T01:03:03.9808245Z         âœ“ for capacity 10, should report temp cloud threshold if reached (1 ms)
2025-04-15T01:03:03.9809123Z         âœ“ for capacity 20, should report temp cloud threshold if reached
2025-04-15T01:03:03.9810009Z         âœ“ for capacity 50, should report temp cloud threshold if reached (1 ms)
2025-04-15T01:03:03.9811149Z         âœ“ for capacity 100, should report temp cloud threshold if reached
2025-04-15T01:03:03.9812848Z         âœ“ for capacity 200, should report temp cloud threshold if reached (1 ms)
2025-04-15T01:03:03.9813794Z         âœ“ for capacity 4, should not report temp cloud threshold if not reached
2025-04-15T01:03:03.9814691Z         âœ“ for capacity 9, should not report temp cloud threshold if not reached
2025-04-15T01:03:03.9815577Z         âœ“ for capacity 19, should not report temp cloud threshold if not reached
2025-04-15T01:03:03.9816518Z         âœ“ for capacity 49, should not report temp cloud threshold if not reached
2025-04-15T01:03:03.9817475Z         âœ“ for capacity 99, should not report temp cloud threshold if not reached (1 ms)
2025-04-15T01:03:03.9818424Z         âœ“ for capacity 199, should not report temp cloud threshold if not reached
2025-04-15T01:03:03.9819361Z         âœ“ for capacity 6, should not report temp cloud threshold if exceeded (1 ms)
2025-04-15T01:03:03.9820309Z         âœ“ for capacity 11, should not report temp cloud threshold if exceeded
2025-04-15T01:03:03.9821241Z         âœ“ for capacity 21, should not report temp cloud threshold if exceeded (1 ms)
2025-04-15T01:03:03.9822340Z         âœ“ for capacity 51, should not report temp cloud threshold if exceeded
2025-04-15T01:03:03.9823287Z         âœ“ for capacity 101, should not report temp cloud threshold if exceeded (6 ms)
2025-04-15T01:03:03.9824213Z         âœ“ for capacity 201, should not report temp cloud threshold if exceeded
2025-04-15T01:03:03.9824666Z 
2025-04-15T01:03:04.4883449Z PASS src/databases/repositories/__tests__/folder.repository.test.ts (6.103 s)
2025-04-15T01:03:04.4884210Z   FolderRepository
2025-04-15T01:03:04.4885661Z     getMany
2025-04-15T01:03:04.4886294Z       filters
2025-04-15T01:03:04.4888077Z         âœ“ should return all folders if not filter is provided (28 ms)
2025-04-15T01:03:04.4889497Z         âœ“ should filter folders by IDs (21 ms)
2025-04-15T01:03:04.4890648Z         âœ“ should filter folders by project ID (21 ms)
2025-04-15T01:03:04.4892262Z         âœ“ should filter folders by name case-insensitively (13 ms)
2025-04-15T01:03:04.4894840Z         âœ“ should filter folders by parent folder ID (20 ms)
2025-04-15T01:03:04.4897987Z         âœ“ should filter folders by a single tag (22 ms)
2025-04-15T01:03:04.4899258Z         âœ“ should filter folders by multiple tags (AND operator) (27 ms)
2025-04-15T01:03:04.4900725Z         âœ“ should apply multiple filters together (20 ms)
2025-04-15T01:03:04.4902115Z       select
2025-04-15T01:03:04.4902938Z         âœ“ should select only id and name when specified (13 ms)
2025-04-15T01:03:04.4904351Z         âœ“ should return id, name and tags when specified (18 ms)
2025-04-15T01:03:04.4905678Z         âœ“ should return id, name and project when specified (15 ms)
2025-04-15T01:03:04.4906957Z         âœ“ should return id, name and parentFolder when specified (13 ms)
2025-04-15T01:03:04.4908596Z         âœ“ should return id, name and workflowCount when specified (17 ms)
2025-04-15T01:03:04.4910869Z         âœ“ should return id, name and subFolderCount when specified (15 ms)
2025-04-15T01:03:04.4911983Z         âœ“ should return timestamps when specified (12 ms)
2025-04-15T01:03:04.4912918Z         âœ“ should return all properties when no select is specified (19 ms)
2025-04-15T01:03:04.4913537Z       pagination
2025-04-15T01:03:04.4914150Z         âœ“ should limit results when take is specified (30 ms)
2025-04-15T01:03:04.4914886Z         âœ“ should skip results when skip is specified (22 ms)
2025-04-15T01:03:04.4915661Z         âœ“ should handle skip and take together (13 ms)
2025-04-15T01:03:04.4916467Z         âœ“ should handle take larger than remaining items (15 ms)
2025-04-15T01:03:04.4917326Z         âœ“ should handle zero take by returning all results (15 ms)
2025-04-15T01:03:04.4917889Z       sorting
2025-04-15T01:03:04.4918502Z         âœ“ should sort by default (updatedAt:desc) (16 ms)
2025-04-15T01:03:04.4919193Z         âœ“ should sort by name:asc (14 ms)
2025-04-15T01:03:04.4920210Z         âœ“ should sort by name:desc (13 ms)
2025-04-15T01:03:04.4921061Z         âœ“ should sort by name:desc when select does not include the name (17 ms)
2025-04-15T01:03:04.4922114Z         âœ“ should sort by createdAt:asc (14 ms)
2025-04-15T01:03:04.4922789Z         âœ“ should sort by createdAt:desc (12 ms)
2025-04-15T01:03:04.4923455Z         âœ“ should sort by updatedAt:asc (16 ms)
2025-04-15T01:03:04.4924097Z         âœ“ should sort by updatedAt:desc (13 ms)
2025-04-15T01:03:04.4924872Z         âœ“ should default to asc if order not specified (12 ms)
2025-04-15T01:03:04.4925328Z 
2025-04-15T01:03:06.1973590Z PASS test/integration/ldap/ldap.api.test.ts (8.324 s)
2025-04-15T01:03:06.1975167Z   âœ“ Member role should not be able to access ldap routes (104 ms)
2025-04-15T01:03:06.1976623Z   âœ“ GET /ldap/config route should retrieve current configuration (25 ms)
2025-04-15T01:03:06.1978062Z   âœ“ GET /ldap/sync should return paginated synchronizations (29 ms)
2025-04-15T01:03:06.1979223Z   PUT /ldap/config
2025-04-15T01:03:06.1980243Z     âœ“ route should validate payload (40 ms)
2025-04-15T01:03:06.1981049Z     âœ“ route should update model (17 ms)
2025-04-15T01:03:06.1983203Z     âœ“ route should fail due to trying to enable LDAP login with SSO as current authentication method (17 ms)
2025-04-15T01:03:06.1984955Z     âœ“ should apply "Convert all LDAP users to email users" strategy when LDAP login disabled (37 ms)
2025-04-15T01:03:06.1986005Z   POST /ldap/test-connection
2025-04-15T01:03:06.1986775Z     âœ“ route should success (11 ms)
2025-04-15T01:03:06.1987596Z     âœ“ route should fail (10 ms)
2025-04-15T01:03:06.1988284Z   POST /ldap/sync
2025-04-15T01:03:06.1988883Z     dry mode
2025-04-15T01:03:06.1989883Z       âœ“ should detect new user but not persist change in model (44 ms)
2025-04-15T01:03:06.1991341Z       âœ“ should detect updated user but not persist change in model (34 ms)
2025-04-15T01:03:06.1992936Z       âœ“ should detect disabled user but not persist change in model (30 ms)
2025-04-15T01:03:06.2010252Z     live mode
2025-04-15T01:03:06.2011289Z       âœ“ should detect new user and persist change in model (36 ms)
2025-04-15T01:03:06.2012722Z       âœ“ should detect updated user and persist change in model (67 ms)
2025-04-15T01:03:06.2014001Z       âœ“ should detect disabled user and persist change in model (40 ms)
2025-04-15T01:03:06.2015397Z       âœ“ should remove user instance access once the user is disabled during synchronization (39 ms)
2025-04-15T01:03:06.2016403Z   POST /login
2025-04-15T01:03:06.2017339Z     âœ“ should allow new LDAP user to login and synchronize data (31 ms)
2025-04-15T01:03:06.2019165Z     âœ“ should allow existing LDAP user to login and synchronize data (180 ms)
2025-04-15T01:03:06.2020725Z     âœ“ should allow instance owner to sign in with email/password when LDAP is enabled (133 ms)
2025-04-15T01:03:06.2022426Z     âœ“ should transform email user into LDAP user when match found (145 ms)
2025-04-15T01:03:06.2023529Z   Instance owner should able to delete LDAP users
2025-04-15T01:03:06.2024915Z     âœ“ don't transfer workflows (21 ms)
2025-04-15T01:03:06.2025889Z     âœ“ transfer workflows and credentials (16 ms)
2025-04-15T01:03:06.2026476Z 
2025-04-15T01:03:12.6586051Z PASS test/integration/evaluation/test-definitions.api.test.ts (8.456 s)
2025-04-15T01:03:12.6587596Z   GET /evaluation/test-definitions
2025-04-15T01:03:12.6588571Z     âœ“ should retrieve empty test definitions list (87 ms)
2025-04-15T01:03:12.6589337Z     âœ“ should retrieve test definitions list (46 ms)
2025-04-15T01:03:12.6590162Z     âœ“ should retrieve test definitions list with pagination (67 ms)
2025-04-15T01:03:12.6591143Z     âœ“ should retrieve test definitions list for a workflow (54 ms)
2025-04-15T01:03:12.6592789Z     âœ“ should return error if user has no access to the workflowId specified in filter (91 ms)
2025-04-15T01:03:12.6593838Z   GET /evaluation/test-definitions/:id
2025-04-15T01:03:12.6594728Z     âœ“ should retrieve test definition (45 ms)
2025-04-15T01:03:12.6595775Z     âœ“ should return 404 for non-existent test definition (31 ms)
2025-04-15T01:03:12.6597360Z     âœ“ should retrieve test definition with evaluation workflow (42 ms)
2025-04-15T01:03:12.6599099Z     âœ“ should not retrieve test definition if user does not have access to workflow under test (40 ms)
2025-04-15T01:03:12.6600001Z   POST /evaluation/test-definitions
2025-04-15T01:03:12.6600654Z     âœ“ should create test definition (43 ms)
2025-04-15T01:03:12.6604200Z     âœ“ should create test definition with evaluation workflow (37 ms)
2025-04-15T01:03:12.6604780Z     âœ“ should create test definition with all fields (36 ms)
2025-04-15T01:03:12.6605341Z     âœ“ should return error if name is empty (39 ms)
2025-04-15T01:03:12.6605875Z     âœ“ should return error if user has no access to the workflow (33 ms)
2025-04-15T01:03:12.6606453Z     âœ“ should return error if user has no access to the evaluation workflow (33 ms)
2025-04-15T01:03:12.6606964Z   PATCH /evaluation/test-definitions/:id
2025-04-15T01:03:12.6607328Z     âœ“ should update test definition (46 ms)
2025-04-15T01:03:12.6607886Z     âœ“ should return 404 if user has no access to the workflow (35 ms)
2025-04-15T01:03:12.6608471Z     âœ“ should update test definition with evaluation workflow (48 ms)
2025-04-15T01:03:12.6609044Z     âœ“ should return error if user has no access to the evaluation workflow (39 ms)
2025-04-15T01:03:12.6609805Z     âœ“ should disallow workflowId (32 ms)
2025-04-15T01:03:12.6610355Z     âœ“ should update annotationTagId (49 ms)
2025-04-15T01:03:12.6611029Z     âœ“ should return error if annotationTagId is invalid (46 ms)
2025-04-15T01:03:12.6612191Z     âœ“ should update pinned nodes (53 ms)
2025-04-15T01:03:12.6612888Z     âœ“ should return error if pinned nodes are invalid (34 ms)
2025-04-15T01:03:12.6613789Z     âœ“ should return error if pinned nodes are not in the workflow (33 ms)
2025-04-15T01:03:12.6614485Z   DELETE /evaluation/test-definitions/:id
2025-04-15T01:03:12.6615097Z     âœ“ should delete test definition (32 ms)
2025-04-15T01:03:12.6615839Z     âœ“ should return 404 if test definition does not exist (30 ms)
2025-04-15T01:03:12.6616759Z     âœ“ should return 404 if user has no access to the workflow (30 ms)
2025-04-15T01:03:12.6617441Z   POST /evaluation/test-definitions/:id/run
2025-04-15T01:03:12.6618122Z     âœ“ should trigger the test run (34 ms)
2025-04-15T01:03:12.6618452Z 
2025-04-15T01:03:13.2152399Z PASS test/integration/public-api/executions.test.ts (8.491 s)
2025-04-15T01:03:13.2154043Z   GET /executions/:id
2025-04-15T01:03:13.2156390Z     âœ“ should fail due to missing API Key (39 ms)
2025-04-15T01:03:13.2157811Z     âœ“ should fail due to invalid API Key (14 ms)
2025-04-15T01:03:13.2158790Z     âœ“ owner should be able to get an execution owned by him (199 ms)
2025-04-15T01:03:13.2159666Z     âœ“ owner should be able to read executions of other users (26 ms)
2025-04-15T01:03:13.2162464Z     âœ“ member should be able to fetch his own executions (34 ms)
2025-04-15T01:03:13.2166464Z     âœ“ member should not be able to fetch custom data when includeData is not set (39 ms)
2025-04-15T01:03:13.2167314Z     âœ“ member should be able to fetch custom data when includeData=true (74 ms)
2025-04-15T01:03:13.2168311Z     âœ“ member should not get an execution of another user without the workflow being shared (23 ms)
2025-04-15T01:03:13.2168938Z     âœ“ member should be able to fetch executions of workflows shared with him (31 ms)
2025-04-15T01:03:13.2169310Z   DELETE /executions/:id
2025-04-15T01:03:13.2169636Z     âœ“ should fail due to missing API Key (11 ms)
2025-04-15T01:03:13.2170274Z     âœ“ should fail due to invalid API Key (11 ms)
2025-04-15T01:03:13.2170969Z     âœ“ should delete an execution (47 ms)
2025-04-15T01:03:13.2171440Z   GET /executions
2025-04-15T01:03:13.2172294Z     âœ“ should fail due to missing API Key (9 ms)
2025-04-15T01:03:13.2172950Z     âœ“ should fail due to invalid API Key (9 ms)
2025-04-15T01:03:13.2173485Z     âœ“ should retrieve all successful executions (44 ms)
2025-04-15T01:03:13.2173863Z     âœ“ should paginate two executions (49 ms)
2025-04-15T01:03:13.2174224Z     âœ“ should retrieve all error executions (41 ms)
2025-04-15T01:03:13.2174620Z     âœ“ should return all waiting executions (38 ms)
2025-04-15T01:03:13.2175044Z     âœ“ should retrieve all executions of specific workflow (53 ms)
2025-04-15T01:03:13.2175504Z     âœ“ should return executions filtered by project ID (41 ms)
2025-04-15T01:03:13.2176012Z     âœ“ owner should retrieve all executions regardless of ownership (115 ms)
2025-04-15T01:03:13.2176561Z     âœ“ member should not see executions of workflows not shared with him (78 ms)
2025-04-15T01:03:13.2177092Z     âœ“ member should also see executions of workflows shared with him (65 ms)
2025-04-15T01:03:13.2177370Z 
2025-04-15T01:03:13.6324898Z PASS test/integration/api-keys.api.test.ts (7.176 s)
2025-04-15T01:03:13.6325870Z   When public API is disabled
2025-04-15T01:03:13.6326815Z     âœ“ POST /api-keys should 404 (89 ms)
2025-04-15T01:03:13.6327611Z     âœ“ GET /api-keys should 404 (26 ms)
2025-04-15T01:03:13.6328457Z     âœ“ DELETE /api-key/:id should 404 (25 ms)
2025-04-15T01:03:13.6328907Z   Owner shell
2025-04-15T01:03:13.6329599Z     âœ“ POST /api-keys should create an api key with no expiration (28 ms)
2025-04-15T01:03:13.6330537Z     âœ“ POST /api-keys should fail to create api key with invalid scope (17 ms)
2025-04-15T01:03:13.6331460Z     âœ“ POST /api-keys should create an api key with expiration (18 ms)
2025-04-15T01:03:13.6332695Z     âœ“ POST /api-keys should create an api key with scopes allow in the user's role (18 ms)
2025-04-15T01:03:13.6333570Z     âœ“ PATCH /api-keys should update API key label (27 ms)
2025-04-15T01:03:13.6334368Z     âœ“ PATCH /api-keys should not modify API key expiration (37 ms)
2025-04-15T01:03:13.6335553Z     âœ“ GET /api-keys should fetch the api key redacted (31 ms)
2025-04-15T01:03:13.6336299Z     âœ“ DELETE /api-keys/:id should delete the api key (31 ms)
2025-04-15T01:03:13.6337090Z     âœ“ GET /api-keys/scopes should return scopes for the role (18 ms)
2025-04-15T01:03:13.6337415Z   Member
2025-04-15T01:03:13.6337797Z     âœ“ POST /api-keys should create an api key with no expiration (39 ms)
2025-04-15T01:03:13.6338315Z     âœ“ POST /api-keys should create an api key with expiration (20 ms)
2025-04-15T01:03:13.6338881Z     âœ“ POST /api-keys should create an api key with scopes allowed in the user's role (20 ms)
2025-04-15T01:03:13.6339563Z     âœ“ POST /api-keys should fail to create api key with scopes not allowed in the user's role (37 ms)
2025-04-15T01:03:13.6340101Z     âœ“ GET /api-keys should fetch the api key redacted (35 ms)
2025-04-15T01:03:13.6340542Z     âœ“ DELETE /api-keys/:id should delete the api key (30 ms)
2025-04-15T01:03:13.6341006Z     âœ“ GET /api-keys/scopes should return scopes for the role (15 ms)
2025-04-15T01:03:17.2717725Z 
2025-04-15T01:03:17.2718462Z PASS src/auth/__tests__/auth.service.test.ts
2025-04-15T01:03:17.2732227Z   AuthService
2025-04-15T01:03:17.2732648Z     createJWTHash
2025-04-15T01:03:17.2733423Z       âœ“ should generate unique hashes (21 ms)
2025-04-15T01:03:17.2733924Z     authMiddleware
2025-04-15T01:03:17.2734468Z       âœ“ should 401 if no cookie is set (2 ms)
2025-04-15T01:03:17.2735753Z       âœ“ should 401 and clear the cookie if the JWT is expired (32 ms)
2025-04-15T01:03:17.2736728Z       âœ“ should 401 and clear the cookie if the JWT has been invalidated (6 ms)
2025-04-15T01:03:17.2737665Z       âœ“ should refresh the cookie before it expires (10 ms)
2025-04-15T01:03:17.2738240Z     issueCookie
2025-04-15T01:03:17.2738924Z       âœ“ should issue a cookie with the correct options (5 ms)
2025-04-15T01:03:17.2739734Z       âœ“ should allow changing cookie options (2 ms)
2025-04-15T01:03:17.2740266Z     issueJWT
2025-04-15T01:03:17.2740775Z       when not setting userManagement.jwtSessionDuration
2025-04-15T01:03:17.2741748Z         âœ“ should default to expire in 7 days (5 ms)
2025-04-15T01:03:17.2742413Z       when setting userManagement.jwtSessionDuration
2025-04-15T01:03:17.2743128Z         âœ“ should apply it to tokens (8 ms)
2025-04-15T01:03:17.2743587Z     resolveJwt
2025-04-15T01:03:17.2744109Z       âœ“ should throw on invalid tokens (39 ms)
2025-04-15T01:03:17.2744833Z       âœ“ should throw on expired tokens (3 ms)
2025-04-15T01:03:17.2745559Z       âœ“ should throw on tampered tokens (2 ms)
2025-04-15T01:03:17.2746265Z       âœ“ should throw on hijacked tokens (3 ms)
2025-04-15T01:03:17.2746962Z       âœ“ should throw if no user is found (2 ms)
2025-04-15T01:03:17.2747676Z       âœ“ should throw if the user is disabled (2 ms)
2025-04-15T01:03:17.2748596Z       âœ“ should throw if user password does not match the one on the token (1 ms)
2025-04-15T01:03:17.2749627Z       âœ“ should throw if user email does not match the one on the token (1 ms)
2025-04-15T01:03:17.2750563Z       âœ“ should refresh the cookie before it expires (7 ms)
2025-04-15T01:03:17.2751727Z       âœ“ should refresh the cookie only if less than 1/4th of time is left (4 ms)
2025-04-15T01:03:17.2752837Z       âœ“ should not refresh the cookie if jwtRefreshTimeoutHours is set to -1 (2 ms)
2025-04-15T01:03:17.2753579Z     generatePasswordResetUrl
2025-04-15T01:03:17.2754238Z       âœ“ should generate a valid url (2 ms)
2025-04-15T01:03:17.2754836Z     generatePasswordResetToken
2025-04-15T01:03:17.2755594Z       âœ“ should generate valid password-reset tokens (1 ms)
2025-04-15T01:03:17.2756183Z     resolvePasswordResetToken
2025-04-15T01:03:17.2756954Z       âœ“ should not return a user if the token in invalid (1 ms)
2025-04-15T01:03:17.2757808Z       âœ“ should not return a user if the token in expired (2 ms)
2025-04-15T01:03:17.2758739Z       âœ“ should not return a user if the user does not exist in the DB (1 ms)
2025-04-15T01:03:17.2759705Z       âœ“ should not return a user if the password sha does not match (2 ms)
2025-04-15T01:03:17.2760908Z       âœ“ should not return the user if all checks pass (2 ms)
2025-04-15T01:03:17.2761447Z     invalidateToken
2025-04-15T01:03:17.2775502Z       âœ“ should invalidate the token (1 ms)
2025-04-15T01:03:17.2775882Z 
2025-04-15T01:03:17.8063676Z PASS src/services/__tests__/community-packages.service.test.ts
2025-04-15T01:03:17.8068248Z   CommunityPackagesService
2025-04-15T01:03:17.8070109Z     parseNpmPackageName()
2025-04-15T01:03:17.8072415Z       âœ“ should fail with empty package name (39 ms)
2025-04-15T01:03:17.8074375Z       âœ“ should fail with invalid package prefix name (1 ms)
2025-04-15T01:03:17.8089022Z       âœ“ should parse valid package name (1 ms)
2025-04-15T01:03:17.8089750Z       âœ“ should parse valid package name and version (1 ms)
2025-04-15T01:03:17.8090501Z       âœ“ should parse valid package name, scope and version (1 ms)
2025-04-15T01:03:17.8091042Z     executeCommand()
2025-04-15T01:03:17.8091875Z       âœ“ should call command with valid options (2 ms)
2025-04-15T01:03:17.8092578Z       âœ“ should make sure folder exists (1 ms)
2025-04-15T01:03:17.8093256Z       âœ“ should try to create folder if it does not exist (8 ms)
2025-04-15T01:03:17.8094042Z       âœ“ should throw especial error when package is not found (3 ms)
2025-04-15T01:03:17.8094611Z     crossInformationPackage()
2025-04-15T01:03:17.8095323Z       âœ“ should return same list if availableUpdates is undefined (2 ms)
2025-04-15T01:03:17.8096525Z       âœ“ should correctly match update versions for packages (1 ms)
2025-04-15T01:03:17.8097380Z       âœ“ should correctly match update versions for single package (1 ms)
2025-04-15T01:03:17.8097967Z     matchMissingPackages()
2025-04-15T01:03:17.8098592Z       âœ“ should not match failed packages that do not exist (2 ms)
2025-04-15T01:03:17.8099376Z       âœ“ should match failed packages that should be present (1 ms)
2025-04-15T01:03:17.8100198Z       âœ“ should match failed packages even if version is wrong
2025-04-15T01:03:17.8100771Z     checkNpmPackageStatus()
2025-04-15T01:03:17.8101262Z       âœ“ should call axios.post
2025-04-15T01:03:17.8102000Z       âœ“ should not fail if request fails (1 ms)
2025-04-15T01:03:17.8126731Z       âœ“ should warn if package is banned
2025-04-15T01:03:17.8127317Z     hasPackageLoadedSuccessfully()
2025-04-15T01:03:17.8128123Z       âœ“ should return true when failed package list does not exist (1 ms)
2025-04-15T01:03:17.8129081Z       âœ“ should return true when package is not in the list of missing packages
2025-04-15T01:03:17.8130079Z       âœ“ should return false when package is in the list of missing packages
2025-04-15T01:03:17.8130743Z     removePackageFromMissingList()
2025-04-15T01:03:17.8131399Z       âœ“ should do nothing if key does not exist (1 ms)
2025-04-15T01:03:17.8132319Z       âœ“ should remove only correct package from list
2025-04-15T01:03:17.8133042Z       âœ“ should not remove if package is not in the list (1 ms)
2025-04-15T01:03:17.8133569Z     updateNpmModule
2025-04-15T01:03:17.8134225Z       âœ“ should call `exec` with the correct command and registry (2 ms)
2025-04-15T01:03:17.8134953Z       âœ“ should throw when not licensed (2 ms)
2025-04-15T01:03:17.8135279Z 
2025-04-15T01:03:18.7204267Z PASS test/integration/deduplication/deduplication-helper.test.ts (5.253 s)
2025-04-15T01:03:18.7205150Z   Deduplication.DeduplicationHelper
2025-04-15T01:03:18.7206407Z     âœ“ Deduplication (mode: entries): DeduplicationHelper should record and check data correctly (24 ms)
2025-04-15T01:03:18.7208040Z     âœ“ Deduplication (mode: entries): DeduplicationHelper different contexts should not interfere with each other (13 ms)
2025-04-15T01:03:18.7209528Z     âœ“ Deduplication (mode: entries): DeduplicationHelper check maxEntries (9 ms)
2025-04-15T01:03:18.7210585Z     âœ“ removeProcessed should throw error for latest modes (48 ms)
2025-04-15T01:03:18.7211931Z     âœ“ clearAllProcessedItems should delete all processed items for workflow scope (7 ms)
2025-04-15T01:03:18.7216162Z     âœ“ clearAllProcessedItems should delete all processed items for node scope (6 ms)
2025-04-15T01:03:18.7218081Z     âœ“ clearAllProcessedItems should not clear workflow processed items when clearing node scope (8 ms)
2025-04-15T01:03:18.7219551Z     âœ“ clearAllProcessedItems should not clear node processed items when clearing workflow scope (11 ms)
2025-04-15T01:03:18.7230751Z     âœ“ getProcessedDataCount should return correct count for different modes (6 ms)
2025-04-15T01:03:18.7232258Z     Deduplication (mode: latestIncrementalKey): DeduplicationHelper should record and check data correctly
2025-04-15T01:03:18.7233272Z       âœ“ dates (33 ms)
2025-04-15T01:03:18.7233694Z       âœ“ numbers (5 ms)
2025-04-15T01:03:18.7233922Z 
2025-04-15T01:03:23.6373648Z PASS src/controllers/oauth/__tests__/oauth2-credential.controller.test.ts (5.581 s)
2025-04-15T01:03:23.6402283Z   OAuth2CredentialController
2025-04-15T01:03:23.6405086Z     getAuthUri
2025-04-15T01:03:23.6408026Z       âœ“ should throw a BadRequestError when credentialId is missing in the query (35 ms)
2025-04-15T01:03:23.6411102Z       âœ“ should throw a NotFoundError when no matching credential is found for the user (2 ms)
2025-04-15T01:03:23.6412503Z       âœ“ should return a valid auth URI (7 ms)
2025-04-15T01:03:23.6412989Z     handleCallback
2025-04-15T01:03:23.6413807Z       âœ“ should render the error page when required query params are missing (1 ms)
2025-04-15T01:03:23.6414895Z       âœ“ should render the error page when `state` query param is invalid (1 ms)
2025-04-15T01:03:23.6416230Z       âœ“ should render the error page when credential is not found in DB (2 ms)
2025-04-15T01:03:23.6417102Z       âœ“ should render the error page when csrfSecret on the saved credential does not match the state (1 ms)
2025-04-15T01:03:23.6417873Z       âœ“ should render the error page when state is older than 5 minutes (7 ms)
2025-04-15T01:03:23.6418509Z       âœ“ should render the error page when code exchange fails (61 ms)
2025-04-15T01:03:23.6419484Z       âœ“ should exchange the code for a valid token, and save it to DB (22 ms)
2025-04-15T01:03:23.6420443Z       âœ“ merges oauthTokenData if it already exists (60 ms)
2025-04-15T01:03:23.6421284Z       âœ“ overwrites oauthTokenData if it is a string (56 ms)
2025-04-15T01:03:23.6421737Z 
2025-04-15T01:03:24.8516835Z PASS test/integration/controllers/invitation/invitation.controller.integration.test.ts (7.373 s)
2025-04-15T01:03:24.8525520Z   InvitationController
2025-04-15T01:03:24.8526010Z     POST /invitations/:id/accept
2025-04-15T01:03:24.8526798Z       âœ“ should fill out a member shell (189 ms)
2025-04-15T01:03:24.8527462Z       âœ“ should fill out an admin shell (128 ms)
2025-04-15T01:03:24.8528075Z       âœ“ should fail with invalid payloads (34 ms)
2025-04-15T01:03:24.8528758Z       âœ“ should fail with already accepted invite (127 ms)
2025-04-15T01:03:24.8529260Z     POST /invitations
2025-04-15T01:03:24.8529788Z       âœ“ should fail with invalid payloads (40 ms)
2025-04-15T01:03:24.8530413Z       âœ“ should return 200 on empty payload (7 ms)
2025-04-15T01:03:24.8531077Z       âœ“ should return 200 if emailing is not set up (14 ms)
2025-04-15T01:03:24.8532428Z       âœ“ should create member shell (14 ms)
2025-04-15T01:03:24.8533178Z       âœ“ should create personal project for shell account (25 ms)
2025-04-15T01:03:24.8534125Z       âœ“ should create admin shell when advanced permissions is licensed (14 ms)
2025-04-15T01:03:24.8535024Z       âœ“ should reinvite member when sharing is licensed (29 ms)
2025-04-15T01:03:24.8535923Z       âœ“ should reinvite admin when advanced permissions is licensed (25 ms)
2025-04-15T01:03:24.8537054Z       âœ“ should return 403 on creating admin shell when advanced permissions is unlicensed (8 ms)
2025-04-15T01:03:24.8538242Z       âœ“ should email invites and create user shells, without inviting existing users (32 ms)
2025-04-15T01:03:24.8539335Z       âœ“ should return 200 and surface error when invite method throws error (13 ms)
2025-04-15T01:03:24.8539845Z 
2025-04-15T01:03:26.2900140Z PASS src/__tests__/load-nodes-and-credentials.test.ts
2025-04-15T01:03:26.2914045Z   LoadNodesAndCredentials
2025-04-15T01:03:26.2914925Z     resolveIcon
2025-04-15T01:03:26.2915892Z       âœ“ should return undefined if the loader for the package is not found (6 ms)
2025-04-15T01:03:26.2917072Z       âœ“ should return undefined if the resolved file path is outside the loader directory (1 ms)
2025-04-15T01:03:26.2918213Z       âœ“ should return the file path if the file is within the loader directory (1 ms)
2025-04-15T01:03:26.2919303Z       âœ“ should return undefined if the URL is outside the package directory
2025-04-15T01:03:26.2919998Z     convertNodeToAiTool
2025-04-15T01:03:26.2920721Z       âœ“ should modify the name and displayName correctly (1 ms)
2025-04-15T01:03:26.2921500Z       âœ“ should update inputs and outputs (2 ms)
2025-04-15T01:03:26.2922404Z       âœ“ should remove the usableAsTool property
2025-04-15T01:03:26.2923214Z       âœ“ should add toolDescription property if it doesn't exist
2025-04-15T01:03:26.2923986Z       âœ“ should set codex categories correctly
2025-04-15T01:03:26.2924672Z       âœ“ should preserve existing properties (1 ms)
2025-04-15T01:03:26.2925434Z       âœ“ should handle nodes with resource property
2025-04-15T01:03:26.2926198Z       âœ“ should handle nodes with operation property (1 ms)
2025-04-15T01:03:26.2927123Z       âœ“ should handle nodes with both resource and operation properties (1 ms)
2025-04-15T01:03:26.2928037Z       âœ“ should handle nodes with empty properties (1 ms)
2025-04-15T01:03:26.2928842Z       âœ“ should handle nodes with existing codex property (1 ms)
2025-04-15T01:03:26.2930210Z       âœ“ should handle nodes with existing codex with tool subcategory overwrite
2025-04-15T01:03:26.2931156Z       âœ“ should handle nodes with very long names (1 ms)
2025-04-15T01:03:26.2932651Z       âœ“ should handle nodes with special characters in name and displayName
2025-04-15T01:03:26.2933541Z     resolveSchema
2025-04-15T01:03:26.2936051Z       âœ“ should return undefined if the node is not known (1 ms)
2025-04-15T01:03:26.2936872Z       âœ“ should return the correct path if the node is known
2025-04-15T01:03:26.2937845Z       âœ“ should return the correct path if there is no resource or operation (1 ms)
2025-04-15T01:03:26.2938505Z     createAiTools
2025-04-15T01:03:26.2942043Z       âœ“ should create AI tools for nodes marked as usableAsTool (1 ms)
2025-04-15T01:03:26.2942947Z       âœ“ should duplicate supportedNodes for AI tools
2025-04-15T01:03:26.2943834Z       âœ“ should not modify nodes without usableAsTool property (1 ms)
2025-04-15T01:03:26.2944870Z       âœ“ should handle nodes with usableAsTool as an object with replacements (1 ms)
2025-04-15T01:03:26.2945440Z 
2025-04-15T01:03:26.3686902Z PASS test/integration/variables.test.ts (7.423 s)
2025-04-15T01:03:26.3688097Z   GET /variables
2025-04-15T01:03:26.3689351Z     âœ“ should return an empty array if there is nothing in the cache (55 ms)
2025-04-15T01:03:26.3690488Z     âœ“ should return all variables for an owner (19 ms)
2025-04-15T01:03:26.3691450Z     âœ“ should return all variables for a member (17 ms)
2025-04-15T01:03:26.3693519Z     state:empty
2025-04-15T01:03:26.3694158Z       âœ“ only return empty variables (16 ms)
2025-04-15T01:03:26.3694655Z   GET /variables/:id
2025-04-15T01:03:26.3695287Z     âœ“ should return a single variable for an owner (25 ms)
2025-04-15T01:03:26.3696104Z     âœ“ should return a single variable for a member (21 ms)
2025-04-15T01:03:26.3696631Z   POST /variables
2025-04-15T01:03:26.3697309Z     âœ“ should create a new variable and return it for an owner (18 ms)
2025-04-15T01:03:26.3698224Z     âœ“ should not create a new variable and return it for a member (9 ms)
2025-04-15T01:03:26.3699400Z     âœ“ should not create a new variable and return it if the instance doesn't have a license (8 ms)
2025-04-15T01:03:26.3700624Z     âœ“ should fail to create a new variable and if one with the same key exists (68 ms)
2025-04-15T01:03:26.3701817Z     âœ“ should not fail if variable limit not reached (17 ms)
2025-04-15T01:03:26.3702575Z     âœ“ should fail if variable limit reached (57 ms)
2025-04-15T01:03:26.3703270Z     âœ“ should fail if key too long (10 ms)
2025-04-15T01:03:26.3704332Z     âœ“ should fail if value too long (8 ms)
2025-04-15T01:03:26.3705110Z     âœ“ should fail if key contain's prohibited characters (7 ms)
2025-04-15T01:03:26.3705697Z   PATCH /variables/:id
2025-04-15T01:03:26.3710614Z     âœ“ should modify existing variable if use is an owner (17 ms)
2025-04-15T01:03:26.3711769Z     âœ“ should modify existing variable if use is an owner (11 ms)
2025-04-15T01:03:26.3712712Z     âœ“ should not modify existing variable if use is a member (9 ms)
2025-04-15T01:03:26.3713737Z     âœ“ should not modify existing variable if one with the same key exists (13 ms)
2025-04-15T01:03:26.3714435Z   DELETE /variables/:id
2025-04-15T01:03:26.3715112Z     âœ“ should delete a single variable for an owner (14 ms)
2025-04-15T01:03:26.3715945Z     âœ“ should not delete a single variable for a member (15 ms)
2025-04-15T01:03:26.3716315Z 
2025-04-15T01:03:30.7460223Z PASS src/workflows/__tests__/workflow-execution.service.test.ts
2025-04-15T01:03:30.7462389Z   WorkflowExecutionService
2025-04-15T01:03:30.7462887Z     runWorkflow()
2025-04-15T01:03:30.7463839Z       âœ“ should call `WorkflowRunner.run()` (12 ms)
2025-04-15T01:03:30.7464631Z     executeManually()
2025-04-15T01:03:30.7465692Z       âœ“ should call `WorkflowRunner.run()` with correct parameters with default partial execution logic (2 ms)
2025-04-15T01:03:30.7466891Z       âœ“ removes runData if the destination node is a trigger (2 ms)
2025-04-15T01:03:30.7467947Z       âœ“ should call WorkflowRunner.run() with pinned trigger with type trigger (1 ms)
2025-04-15T01:03:30.7470074Z       âœ“ should call WorkflowRunner.run() with pinned trigger with type webhook (2 ms)
2025-04-15T01:03:30.7471444Z       âœ“ should start from pinned trigger (1 ms)
2025-04-15T01:03:30.7472546Z       âœ“ should ignore pinned trigger and start from unexecuted trigger (1 ms)
2025-04-15T01:03:30.7476113Z     selectPinnedActivatorStarter()
2025-04-15T01:03:30.7476876Z       âœ“ should return `null` if no pindata (1 ms)
2025-04-15T01:03:30.7477580Z       âœ“ should return `null` if no starter nodes
2025-04-15T01:03:30.7478331Z       âœ“ should select webhook node if only choice (1 ms)
2025-04-15T01:03:30.7478959Z       âœ“ should return `null` if no choice
2025-04-15T01:03:30.7479545Z       âœ“ should return ignore Respond to Webhook
2025-04-15T01:03:30.7480231Z       âœ“ should select execute workflow trigger if only choice
2025-04-15T01:03:30.7480998Z       âœ“ should favor webhook node over execute workflow trigger
2025-04-15T01:03:30.7482108Z       âœ“ should favor first webhook node over second webhook node
2025-04-15T01:03:30.7486102Z       offloading manual executions to workers
2025-04-15T01:03:30.7500365Z         âœ“ when receiving no `runData`, should set `runData` to undefined in `executionData` (1 ms)
2025-04-15T01:03:30.7506161Z 
2025-04-15T01:03:31.8853996Z PASS src/services/__tests__/public-api-key.service.test.ts (5.277 s)
2025-04-15T01:03:31.8854473Z   PublicApiKeyService
2025-04-15T01:03:31.8854701Z     getAuthMiddleware
2025-04-15T01:03:31.8855248Z       âœ“ should return false if api key is invalid (10 ms)
2025-04-15T01:03:31.8855755Z       âœ“ should return false if valid api key is not in database (4 ms)
2025-04-15T01:03:31.8856248Z       âœ“ should return true if valid api key exist in the database (28 ms)
2025-04-15T01:03:31.8856699Z       âœ“ should return false if expired JWT is used (43 ms)
2025-04-15T01:03:31.8857097Z       âœ“ should work with non JWT (legacy) api keys (15 ms)
2025-04-15T01:03:31.8857375Z     redactApiKey
2025-04-15T01:03:31.8857662Z       âœ“ should redact api key (1 ms)
2025-04-15T01:03:31.8857953Z     removeOwnerOnlyScopesFromApiKeys
2025-04-15T01:03:31.8858390Z       âœ“ it should remove all owner only scopes from user's API keys (18 ms)
2025-04-15T01:03:31.8858747Z     getApiKeyScopedMiddleware
2025-04-15T01:03:31.8859145Z       âœ“ should allow access when API key has required scope (22 ms)
2025-04-15T01:03:31.8859647Z       âœ“ should deny access when API key does not have required scope (13 ms)
2025-04-15T01:03:31.8860103Z       âœ“ should deny access when API key is invalid (9 ms)
2025-04-15T01:03:31.8860896Z       âœ“ should deny access when header x-n8n-api-key is not present (11 ms)
2025-04-15T01:03:31.8861245Z     apiKeyHasValidScopes
2025-04-15T01:03:31.8863058Z       âœ“ should return true if API key has the required scope (19 ms)
2025-04-15T01:03:31.8864149Z       âœ“ should return false if API key does not have the required scope (11 ms)
2025-04-15T01:03:31.8864886Z     apiKeyHasValidScopesForRole
2025-04-15T01:03:31.8865760Z       âœ“ should return true if API key has the required scope for the role (2 ms)
2025-04-15T01:03:31.8866885Z       âœ“ should return false if API key does not have the required scope for the role (1 ms)
2025-04-15T01:03:31.8867462Z 
2025-04-15T01:03:33.2112235Z PASS test/integration/mfa/mfa.api.test.ts (8.112 s)
2025-04-15T01:03:33.2116088Z   Enable MFA setup
2025-04-15T01:03:33.2116479Z     Step one
2025-04-15T01:03:33.2117378Z       âœ“ GET /qr should fail due to unauthenticated user (74 ms)
2025-04-15T01:03:33.2118394Z       âœ“ GET /qr should reuse secret and recovery codes until setup is complete (100 ms)
2025-04-15T01:03:33.2119412Z       âœ“ GET /qr should return qr, secret and recovery codes (24 ms)
2025-04-15T01:03:33.2119971Z     Step two
2025-04-15T01:03:33.2120675Z       âœ“ POST /verify should fail due to unauthenticated user (13 ms)
2025-04-15T01:03:33.2121815Z       âœ“ POST /verify should fail due to invalid MFA code (32 ms)
2025-04-15T01:03:33.2122782Z       âœ“ POST /verify should fail due to missing mfaCode parameter (32 ms)
2025-04-15T01:03:33.2124079Z       âœ“ POST /verify should validate MFA code (32 ms)
2025-04-15T01:03:33.2124597Z     Step three
2025-04-15T01:03:33.2125262Z       âœ“ POST /enable should fail due to unauthenticated user (12 ms)
2025-04-15T01:03:33.2126190Z       âœ“ POST /verify should fail due to missing mfaCode parameter (23 ms)
2025-04-15T01:03:33.2127045Z       âœ“ POST /enable should fail due to invalid MFA code (47 ms)
2025-04-15T01:03:33.2128000Z       âœ“ POST /enable should fail due to empty secret and recovery codes (16 ms)
2025-04-15T01:03:33.2128925Z       âœ“ POST /enable should enable MFA in account (47 ms)
2025-04-15T01:03:33.2129814Z       âœ“ POST /enable should not enable MFA if pre check fails (34 ms)
2025-04-15T01:03:33.2130423Z   Disable MFA setup
2025-04-15T01:03:33.2131061Z     âœ“ POST /disable should disable login with MFA (40 ms)
2025-04-15T01:03:33.2132327Z     âœ“ POST /disable should fail if invalid MFA recovery code is given (25 ms)
2025-04-15T01:03:33.2133319Z     âœ“ POST /disable should fail if invalid MFA code is given (31 ms)
2025-04-15T01:03:33.2134303Z     âœ“ POST /disable should fail if neither MFA code nor recovery code is sent (24 ms)
2025-04-15T01:03:33.2134921Z   Change password with MFA enabled
2025-04-15T01:03:33.2135588Z     âœ“ POST /change-password should fail due to missing MFA code (22 ms)
2025-04-15T01:03:33.2136485Z     âœ“ POST /change-password should fail due to invalid MFA code (18 ms)
2025-04-15T01:03:33.2137376Z     âœ“ POST /change-password should update password (240 ms)
2025-04-15T01:03:33.2137961Z   MFA before enable checks
2025-04-15T01:03:33.2149927Z     âœ“ POST /can-enable should throw error if mfa.beforeSetup returns error (16 ms)
2025-04-15T01:03:33.2151311Z     âœ“ POST /can-enable should not throw error if mfa.beforeSetup does not exist (18 ms)
2025-04-15T01:03:33.2152292Z   Login
2025-04-15T01:03:33.2153061Z     âœ“ POST /login with email/password should succeed when mfa is disabled (27 ms)
2025-04-15T01:03:33.2154605Z     âœ“ GET /login should not include mfaSecret and mfaRecoveryCodes property in response (16 ms)
2025-04-15T01:03:33.2156041Z     âœ“ POST /login with email/password should fail when mfa is enabled (23 ms)
2025-04-15T01:03:33.2156956Z     Login with MFA token
2025-04-15T01:03:33.2158018Z       âœ“ POST /login should fail due to invalid MFA token (24 ms)
2025-04-15T01:03:33.2159076Z       âœ“ POST /login should fail due two MFA step needed (26 ms)
2025-04-15T01:03:33.2159839Z       âœ“ POST /login should succeed with MFA token (22 ms)
2025-04-15T01:03:33.2160580Z     Login with recovery code
2025-04-15T01:03:33.2161909Z       âœ“ POST /login should fail due to invalid MFA recovery code (25 ms)
2025-04-15T01:03:33.2213221Z       âœ“ POST /login should succeed with MFA recovery code (36 ms)
2025-04-15T01:03:33.2213653Z 
2025-04-15T01:03:34.8294121Z PASS src/__tests__/manual-execution.service.test.ts
2025-04-15T01:03:34.8294825Z   ManualExecutionService
2025-04-15T01:03:34.8295259Z     getExecutionStartNode
2025-04-15T01:03:34.8296056Z       âœ“ Should return undefined (6 ms)
2025-04-15T01:03:34.8296718Z       âœ“ Should return startNode (1 ms)
2025-04-15T01:03:34.8297470Z       âœ“ Should return triggerToStartFrom trigger node (1 ms)
2025-04-15T01:03:34.8298901Z     runManually
2025-04-15T01:03:34.8299876Z       âœ“ should correctly process triggerToStartFrom data when data.triggerToStartFrom.data is present (8 ms)
2025-04-15T01:03:34.8301126Z       âœ“ should correctly include destinationNode in executionData when provided (2 ms)
2025-04-15T01:03:34.8302495Z       âœ“ should call workflowExecute.run for full execution when no runData or startNodes (2 ms)
2025-04-15T01:03:34.8303564Z       âœ“ should use execution start node when available for full execution (3 ms)
2025-04-15T01:03:34.8304690Z       âœ“ should handle partial execution with provided runData, startNodes and no destinationNode (2 ms)
2025-04-15T01:03:34.8305811Z       âœ“ should handle partial execution with partialExecutionVersion=2 (2 ms)
2025-04-15T01:03:34.8306641Z       âœ“ should validate nodes exist before execution (2 ms)
2025-04-15T01:03:34.8307790Z       âœ“ should handle pinData correctly when provided (2 ms)
2025-04-15T01:03:34.8308179Z 
2025-04-15T01:03:35.4516665Z PASS src/controllers/__tests__/me.controller.test.ts
2025-04-15T01:03:35.4517272Z   MeController
2025-04-15T01:03:35.4517607Z     updateCurrentUser
2025-04-15T01:03:35.4540722Z       âœ“ should update the user in the DB, and issue a new cookie (16 ms)
2025-04-15T01:03:35.4542113Z       âœ“ should throw BadRequestError if beforeUpdate hook throws BadRequestError (28 ms)
2025-04-15T01:03:35.4542905Z       when mfa is enabled
2025-04-15T01:03:35.4543628Z         âœ“ should throw BadRequestError if mfa code is missing (1 ms)
2025-04-15T01:03:35.4544556Z         âœ“ should throw InvalidMfaCodeError if mfa code is invalid (1 ms)
2025-04-15T01:03:35.4545458Z         âœ“ should update the user's email if mfa code is valid (2 ms)
2025-04-15T01:03:35.4546035Z     updatePassword
2025-04-15T01:03:35.4546723Z       âœ“ should throw if the user does not have a password set (2 ms)
2025-04-15T01:03:35.4547764Z       âœ“ should throw if currentPassword does not match the user's password (149 ms)
2025-04-15T01:03:35.4548827Z       âœ“ should update the password in the DB, and issue a new cookie (208 ms)
2025-04-15T01:03:35.4549566Z       should throw if newPassword is not valid
2025-04-15T01:03:35.4550119Z         âœ“ pass (112 ms)
2025-04-15T01:03:35.4550563Z         âœ“ password (99 ms)
2025-04-15T01:03:35.4551035Z         âœ“ password1 (90 ms)
2025-04-15T01:03:35.4551429Z       mfa enabled
2025-04-15T01:03:35.4552286Z         âœ“ should throw BadRequestError if mfa code is missing (101 ms)
2025-04-15T01:03:35.4553279Z         âœ“ should throw InvalidMfaCodeError if invalid mfa code is given (92 ms)
2025-04-15T01:03:35.4554159Z         âœ“ should succeed when mfa code is correct (195 ms)
2025-04-15T01:03:35.4554689Z     storeSurveyAnswers
2025-04-15T01:03:35.4555483Z       âœ“ should throw BadRequestError if answers are missing in the payload (1 ms)
2025-04-15T01:03:35.4556486Z       âœ“ should not flag XSS attempt for `<` sign in company size (8 ms)
2025-04-15T01:03:35.4557645Z       âœ“ should throw BadRequestError on XSS attempt for an array field automationGoalDevops (3 ms)
2025-04-15T01:03:35.4579968Z       âœ“ should throw BadRequestError on XSS attempt for an array field companyIndustryExtended (1 ms)
2025-04-15T01:03:35.4622949Z       âœ“ should throw BadRequestError on XSS attempt for an array field otherCompanyIndustryExtended (1 ms)
2025-04-15T01:03:35.4624281Z       âœ“ should throw BadRequestError on XSS attempt for an array field automationGoalSm (1 ms)
2025-04-15T01:03:35.4625768Z       âœ“ should throw BadRequestError on XSS attempt for an array field usageModes (1 ms)
2025-04-15T01:03:35.4626930Z       âœ“ should throw BadRequestError on XSS attempt for a string field automationGoalDevopsOther (1 ms)
2025-04-15T01:03:35.4628060Z       âœ“ should throw BadRequestError on XSS attempt for a string field companySize (1 ms)
2025-04-15T01:03:35.4629128Z       âœ“ should throw BadRequestError on XSS attempt for a string field companyType (1 ms)
2025-04-15T01:03:35.4630274Z       âœ“ should throw BadRequestError on XSS attempt for a string field automationGoalSmOther (1 ms)
2025-04-15T01:03:35.4631373Z       âœ“ should throw BadRequestError on XSS attempt for a string field roleOther (1 ms)
2025-04-15T01:03:35.4632605Z       âœ“ should throw BadRequestError on XSS attempt for a string field reportedSource (1 ms)
2025-04-15T01:03:35.4633724Z       âœ“ should throw BadRequestError on XSS attempt for a string field reportedSourceOther (1 ms)
2025-04-15T01:03:35.4634282Z 
2025-04-15T01:03:39.3654543Z PASS src/webhooks/__tests__/webhook-helpers.test.ts
2025-04-15T01:03:39.3656930Z   autoDetectResponseMode
2025-04-15T01:03:39.3657933Z     âœ“ should return undefined if start node is WAIT_NODE_TYPE with resume not equal to form (6 ms)
2025-04-15T01:03:39.3658972Z     âœ“ should return responseNode when start node is FORM_NODE_TYPE and method is POST (1 ms)
2025-04-15T01:03:39.3660126Z     âœ“ should return undefined when start node is FORM_NODE_TYPE with no other form child nodes
2025-04-15T01:03:39.3661738Z     âœ“ should return undefined for non-matching node type and method (1 ms)
2025-04-15T01:03:39.3662377Z   handleFormRedirectionCase
2025-04-15T01:03:39.3663297Z     âœ“ should return data unchanged if start node is WAIT_NODE_TYPE with resume not equal to form (1 ms)
2025-04-15T01:03:39.3664407Z     âœ“ should modify data if start node type matches and responseCode is a redirect
2025-04-15T01:03:39.3712147Z     âœ“ should not modify data if location header is missing
2025-04-15T01:03:39.3712717Z   getResponseOnReceived
2025-04-15T01:03:39.3713495Z     âœ“ should return response with no data when responseData is "noData" (1 ms)
2025-04-15T01:03:39.3714419Z     âœ“ should return response with responseData when it is defined (1 ms)
2025-04-15T01:03:39.3715584Z     âœ“ should return response with webhookResponse when responseData is falsy but webhookResponse exists (1 ms)
2025-04-15T01:03:39.3716843Z     âœ“ should return default response message when responseData and webhookResponse are falsy
2025-04-15T01:03:39.3717565Z   setupResponseNodePromise
2025-04-15T01:03:39.3718096Z     âœ“ should handle regular response object (3 ms)
2025-04-15T01:03:39.3718657Z     âœ“ should handle binary data with ID (1 ms)
2025-04-15T01:03:39.3719190Z     âœ“ should handle buffer response (2 ms)
2025-04-15T01:03:39.3719715Z     âœ“ should handle errors properly (1 ms)
2025-04-15T01:03:39.3720131Z   prepareExecutionData
2025-04-15T01:03:39.3720709Z     âœ“ should create new execution data when not provided (1 ms)
2025-04-15T01:03:39.3721754Z     âœ“ should update existing runExecutionData when executionId is defined (1 ms)
2025-04-15T01:03:39.3722535Z     âœ“ should set destination node when provided
2025-04-15T01:03:39.3723212Z     âœ“ should update execution data with execution data merge
2025-04-15T01:03:39.3723954Z     âœ“ should set pinData when execution mode is manual (1 ms)
2025-04-15T01:03:39.3724768Z     âœ“ should not set pinData when execution mode is not manual or evaluation
2025-04-15T01:03:39.3725212Z 
2025-04-15T01:03:40.9263824Z PASS test/integration/me.api.test.ts (7.423 s)
2025-04-15T01:03:40.9266644Z   Owner shell
2025-04-15T01:03:40.9269568Z     âœ“ PATCH /me should succeed with valid inputs (82 ms)
2025-04-15T01:03:40.9272916Z     âœ“ PATCH /me should fail with invalid inputs (95 ms)
2025-04-15T01:03:40.9276223Z     âœ“ PATCH /me/password should fail for shell (106 ms)
2025-04-15T01:03:40.9282715Z     âœ“ POST /me/survey should succeed with valid inputs (36 ms)
2025-04-15T01:03:40.9283360Z   Member
2025-04-15T01:03:40.9284398Z     âœ“ PATCH /me should succeed with valid inputs (83 ms)
2025-04-15T01:03:40.9285116Z     âœ“ PATCH /me should fail with invalid inputs (85 ms)
2025-04-15T01:03:40.9285928Z     âœ“ PATCH /me/password should succeed with valid inputs (167 ms)
2025-04-15T01:03:40.9288127Z     âœ“ PATCH /me/password should fail with invalid inputs (117 ms)
2025-04-15T01:03:40.9290293Z     âœ“ POST /me/survey should succeed with valid inputs (35 ms)
2025-04-15T01:03:40.9291961Z   Owner
2025-04-15T01:03:40.9292703Z     âœ“ PATCH /me should succeed with valid inputs (32 ms)
2025-04-15T01:03:40.9293671Z 
2025-04-15T01:03:43.8049885Z (node:2863) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 uncaughtException listeners added to [process]. MaxListeners is 10. Use emitter.setMaxListeners() to increase limit
2025-04-15T01:03:43.8061948Z (Use `node --trace-warnings ...` to show where the warning was created)
2025-04-15T01:03:44.0094565Z PASS test/integration/commands/ldap/reset.test.ts (8.311 s)
2025-04-15T01:03:44.0102254Z   âœ“ fails if neither `--userId` nor `--projectId` nor `--deleteWorkflowsAndCredentials` is passed (39 ms)
2025-04-15T01:03:44.0104653Z   âœ“ fails if more than one of `--userId`, `--projectId`, `--deleteWorkflowsAndCredentials` are passed (5 ms)
2025-04-15T01:03:44.0107464Z   âœ“ fails if more than one of `--userId`, `--projectId`, `--deleteWorkflowsAndCredentials` are passed (3 ms)
2025-04-15T01:03:44.0108941Z   âœ“ fails if more than one of `--userId`, `--projectId`, `--deleteWorkflowsAndCredentials` are passed (4 ms)
2025-04-15T01:03:44.0110963Z   âœ“ fails if more than one of `--userId`, `--projectId`, `--deleteWorkflowsAndCredentials` are passed (4 ms)
2025-04-15T01:03:44.0112126Z   --deleteWorkflowsAndCredentials
2025-04-15T01:03:44.0113224Z     âœ“ deletes personal projects, workflows and credentials owned by LDAP managed users (144 ms)
2025-04-15T01:03:44.0114212Z     âœ“ deletes the LDAP sync history (18 ms)
2025-04-15T01:03:44.0114826Z     âœ“ resets LDAP settings (24 ms)
2025-04-15T01:03:44.0115298Z   --userId
2025-04-15T01:03:44.0115826Z     âœ“ fails if the user does not exist (11 ms)
2025-04-15T01:03:44.0116633Z     âœ“ fails if the user to migrate to is also an LDAP user (14 ms)
2025-04-15T01:03:44.0117730Z     âœ“ transfers all workflows and credentials to the user's personal project (68 ms)
2025-04-15T01:03:44.0118438Z   --projectId
2025-04-15T01:03:44.0119010Z     âœ“ fails if the project does not exist (7 ms)
2025-04-15T01:03:44.0119839Z     âœ“ fails if the user to migrate to is also an LDAP user (14 ms)
2025-04-15T01:03:44.0120850Z     âœ“ transfers all workflows and credentials to a personal project (76 ms)
2025-04-15T01:03:44.0122070Z     âœ“ transfers all workflows and credentials to a team project (74 ms)
2025-04-15T01:03:44.0122561Z 
2025-04-15T01:03:46.8485293Z PASS src/webhooks/__tests__/webhook.service.test.ts
2025-04-15T01:03:46.8493117Z   WebhookService
2025-04-15T01:03:46.8493676Z     findWebhook() - static case [cache enabled]
2025-04-15T01:03:46.8494570Z       âœ“ should return the webhook if found (5 ms)
2025-04-15T01:03:46.8495283Z       âœ“ should return null if not found (1 ms)
2025-04-15T01:03:46.8495885Z     findWebhook() - dynamic case [cache enabled]
2025-04-15T01:03:46.8496556Z       âœ“ should return the webhook if found (1 ms)
2025-04-15T01:03:46.8497254Z       âœ“ should handle subset dynamic path case (1 ms)
2025-04-15T01:03:46.8498030Z       âœ“ should handle single-segment dynamic path case
2025-04-15T01:03:46.8498897Z       âœ“ should return null if not found (1 ms)
2025-04-15T01:03:46.8499504Z     findWebhook() - static case [cache disabled]
2025-04-15T01:03:46.8500319Z       âœ“ should return the webhook if found
2025-04-15T01:03:46.8501040Z       âœ“ should return null if not found (1 ms)
2025-04-15T01:03:46.8501831Z     findWebhook() - dynamic case [cache disabled]
2025-04-15T01:03:46.8502573Z       âœ“ should return the webhook if found (1 ms)
2025-04-15T01:03:46.8503297Z       âœ“ should handle subset dynamic path case (1 ms)
2025-04-15T01:03:46.8504139Z       âœ“ should handle single-segment dynamic path case (1 ms)
2025-04-15T01:03:46.8505320Z       âœ“ should return null if not found (1 ms)
2025-04-15T01:03:46.8505820Z     getWebhookMethods()
2025-04-15T01:03:46.8506384Z       âœ“ should return all methods for webhook (2 ms)
2025-04-15T01:03:46.8507156Z       âœ“ should return empty array if no webhooks found (1 ms)
2025-04-15T01:03:46.8507721Z     deleteWorkflowWebhooks()
2025-04-15T01:03:46.8508393Z       âœ“ should delete all webhooks of the workflow (2 ms)
2025-04-15T01:03:46.8509670Z       âœ“ should not delete any webhooks if none found
2025-04-15T01:03:46.8510184Z     createWebhook()
2025-04-15T01:03:46.8510658Z       âœ“ should store webhook in DB
2025-04-15T01:03:46.8511086Z     getNodeWebhooks()
2025-04-15T01:03:46.8511892Z       âœ“ should return empty array if node is disabled (1 ms)
2025-04-15T01:03:46.8512823Z       âœ“ should return webhooks for node with webhook definitions (2 ms)
2025-04-15T01:03:46.8513517Z     createWebhookIfNotExists()
2025-04-15T01:03:46.8514233Z       âœ“ should create webhook if it does not exist (2 ms)
2025-04-15T01:03:46.8514968Z       âœ“ should not create webhook if it already exists (1 ms)
2025-04-15T01:03:46.8515884Z       âœ“ should handle case when webhook methods are not defined (1 ms)
2025-04-15T01:03:46.8516554Z     deleteWebhook()
2025-04-15T01:03:46.8517166Z       âœ“ should call runWebhookMethod with delete (2 ms)
2025-04-15T01:03:46.8517696Z     runWebhook()
2025-04-15T01:03:46.8518393Z       âœ“ should throw error if node does not have webhooks (26 ms)
2025-04-15T01:03:46.8519634Z       âœ“ should execute webhook and return response data (1 ms)
2025-04-15T01:03:46.8520056Z 
2025-04-15T01:03:47.2358942Z PASS test/integration/auth.api.test.ts (7.523 s)
2025-04-15T01:03:47.2364076Z   POST /login
2025-04-15T01:03:47.2369224Z     âœ“ should log user in (86 ms)
2025-04-15T01:03:47.2370217Z     âœ“ should log user with MFA enabled (43 ms)
2025-04-15T01:03:47.2372989Z     âœ“ should throw AuthError for non-owner if not within users limit quota (63 ms)
2025-04-15T01:03:47.2392764Z     âœ“ should not throw AuthError for owner if not within users limit quota (39 ms)
2025-04-15T01:03:47.2394956Z     âœ“ should fail with invalid email in the payload is the current authentication method is "email" (20 ms)
2025-04-15T01:03:47.2396026Z   GET /login
2025-04-15T01:03:47.2396863Z     âœ“ should return 401 Unauthorized if no cookie (6 ms)
2025-04-15T01:03:47.2397914Z     âœ“ should return 401 Unauthorized if invalid cookie (6 ms)
2025-04-15T01:03:47.2398896Z     âœ“ should return logged-in owner shell (15 ms)
2025-04-15T01:03:47.2399847Z     âœ“ should return logged-in member shell (18 ms)
2025-04-15T01:03:47.2400683Z     âœ“ should return logged-in owner (15 ms)
2025-04-15T01:03:47.2401796Z     âœ“ should return logged-in member (19 ms)
2025-04-15T01:03:47.2402533Z   GET /resolve-signup-token
2025-04-15T01:03:47.2403326Z     âœ“ should validate invite token (23 ms)
2025-04-15T01:03:47.2404314Z     âœ“ should return 403 if user quota reached (22 ms)
2025-04-15T01:03:47.2405310Z     âœ“ should fail with invalid inputs (47 ms)
2025-04-15T01:03:47.2406017Z   POST /logout
2025-04-15T01:03:47.2406722Z     âœ“ should log user out (19 ms)
2025-04-15T01:03:47.2407515Z 
2025-04-15T01:03:47.9235230Z PASS test/integration/environments/source-control-import.service.test.ts (6.744 s)
2025-04-15T01:03:47.9246607Z   SourceControlImportService
2025-04-15T01:03:47.9249769Z     importCredentialsFromWorkFolder()
2025-04-15T01:03:47.9253255Z       if user email specified by `ownedBy` exists at target instance
2025-04-15T01:03:47.9258728Z         âœ“ should assign credential ownership to original user (53 ms)
2025-04-15T01:03:47.9259459Z       if user email specified by `ownedBy` is `null`
2025-04-15T01:03:47.9267701Z         âœ“ should assign credential ownership to importing user (15 ms)
2025-04-15T01:03:47.9268603Z       if user email specified by `ownedBy` does not exist at target instance
2025-04-15T01:03:47.9269576Z         âœ“ should assign credential ownership to importing user (13 ms)
2025-04-15T01:03:47.9270381Z     if owner specified by `ownedBy` does not exist at target instance
2025-04-15T01:03:47.9272574Z       âœ“ should assign the credential ownership to the importing user if it was owned by a personal project in the source instance (15 ms)
2025-04-15T01:03:47.9274235Z       âœ“ should create a new team project if the credential was owned by a team project in the source instance (17 ms)
2025-04-15T01:03:47.9275300Z     if owner specified by `ownedBy` does exist at target instance
2025-04-15T01:03:47.9276385Z       âœ“ should use the existing team project if credential owning project is found (12 ms)
2025-04-15T01:03:47.9277706Z       âœ“ should not change the owner if the credential is owned by somebody else on the target instance (18 ms)
2025-04-15T01:03:47.9278365Z 
2025-04-15T01:03:50.1785596Z PASS src/executions/pre-execution-checks/__tests__/subworkflow-policy-checker.test.ts
2025-04-15T01:03:50.1786557Z   SubworkflowPolicyChecker
2025-04-15T01:03:50.1786995Z     no caller policy
2025-04-15T01:03:50.1788017Z       âœ“ should fall back to `N8N_WORKFLOW_CALLER_POLICY_DEFAULT_OPTION` (19 ms)
2025-04-15T01:03:50.1788810Z     `workflows-from-list` caller policy
2025-04-15T01:03:50.1789678Z       âœ“ should allow if caller list contains parent workflow ID (1 ms)
2025-04-15T01:03:50.1790651Z       âœ“ should deny if caller list does not contain parent workflow ID (2 ms)
2025-04-15T01:03:50.1791395Z     `any` caller policy
2025-04-15T01:03:50.1792471Z       âœ“ should not throw on a regular subworkflow call
2025-04-15T01:03:50.1793994Z     `workflows-from-same-owner` caller policy
2025-04-15T01:03:50.1795352Z       âœ“ should deny if the two workflows are owned by different projects (2 ms)
2025-04-15T01:03:50.1796853Z       âœ“ should allow if both workflows are owned by the same project (1 ms)
2025-04-15T01:03:50.1798657Z     error details
2025-04-15T01:03:50.1799645Z       âœ“ should contain description for accessible case (2 ms)
2025-04-15T01:03:50.1800955Z       âœ“ should contain description for inaccessible personal project case (1 ms)
2025-04-15T01:03:50.1802595Z       âœ“ should contain description for inaccessible team project case (1 ms)
2025-04-15T01:03:50.1803935Z       âœ“ should contain description for default (e.g. error workflow) case (2 ms)
2025-04-15T01:03:50.1804684Z 
2025-04-15T01:03:51.8804732Z PASS src/__tests__/active-executions.test.ts
2025-04-15T01:03:51.8808921Z   ActiveExecutions
2025-04-15T01:03:51.8813496Z     âœ“ Should initialize activeExecutions with empty list (11 ms)
2025-04-15T01:03:51.8818112Z     âœ“ Should add execution to active execution list (2 ms)
2025-04-15T01:03:51.8821002Z     âœ“ Should update execution if add is called with execution ID (19 ms)
2025-04-15T01:03:51.8823911Z     âœ“ Should attach and resolve response promise to existing execution (2 ms)
2025-04-15T01:03:51.8826611Z     âœ“ Should copy over startedAt and responsePromise when resuming a waiting execution (4 ms)
2025-04-15T01:03:51.8828762Z     attachWorkflowExecution
2025-04-15T01:03:51.8830871Z       âœ“ Should fail attaching execution to invalid executionId (40 ms)
2025-04-15T01:03:51.8833922Z       âœ“ Should successfully attach execution to valid executionId (4 ms)
2025-04-15T01:03:51.8843495Z     finalizeExecution
2025-04-15T01:03:51.8845652Z       âœ“ Should not remove a waiting execution (4 ms)
2025-04-15T01:03:51.8848024Z       âœ“ Should remove an existing execution (9 ms)
2025-04-15T01:03:51.8850664Z       âœ“ Should not try to resolve a post-execute promise for an inactive execution (1 ms)
2025-04-15T01:03:51.8864862Z       âœ“ Should resolve post execute promise on removal (12 ms)
2025-04-15T01:03:51.8865494Z     getPostExecutePromise
2025-04-15T01:03:51.8866402Z       âœ“ Should throw error when trying to create a promise with invalid execution (1 ms)
2025-04-15T01:03:51.8867108Z     stopExecution
2025-04-15T01:03:51.8867712Z       âœ“ Should cancel ongoing executions (3 ms)
2025-04-15T01:03:51.8868386Z       âœ“ Should cancel waiting executions (1 ms)
2025-04-15T01:03:51.8868854Z     shutdown
2025-04-15T01:03:51.8869595Z       âœ“ Should cancel only executions with response-promises by default (23 ms)
2025-04-15T01:03:51.8871069Z       âœ“ Should cancel all executions when cancelAll is true (21 ms)
2025-04-15T01:03:51.8871717Z 
2025-04-15T01:03:55.5401327Z PASS test/integration/public-api/credentials.test.ts (8.06 s)
2025-04-15T01:03:55.5408280Z   POST /credentials
2025-04-15T01:03:55.5409068Z     âœ“ should create credentials (180 ms)
2025-04-15T01:03:55.5409705Z     âœ“ should fail with invalid inputs (30 ms)
2025-04-15T01:03:55.5410191Z   DELETE /credentials/:id
2025-04-15T01:03:55.5410794Z     âœ“ should delete owned cred for owner (27 ms)
2025-04-15T01:03:55.5411480Z     âœ“ should delete non-owned cred for owner (20 ms)
2025-04-15T01:03:55.5412319Z     âœ“ should delete owned cred for member (21 ms)
2025-04-15T01:03:55.5413168Z     âœ“ should delete owned cred for member but leave others untouched (66 ms)
2025-04-15T01:03:55.5414021Z     âœ“ should not delete non-owned cred for member (30 ms)
2025-04-15T01:03:55.5414664Z     âœ“ should fail if cred not found (7 ms)
2025-04-15T01:03:55.5417618Z   GET /credentials/schema/:credentialType
2025-04-15T01:03:55.5418601Z     âœ“ should fail due to not found type (16 ms)
2025-04-15T01:03:55.5419977Z     âœ“ should retrieve credential type (8 ms)
2025-04-15T01:03:55.5420428Z   PUT /credentials/:id/transfer
2025-04-15T01:03:55.5422570Z     âœ“ should transfer credential to project (45 ms)
2025-04-15T01:03:55.5423752Z     âœ“ should transfer the right credential, not the first one it finds (37 ms)
2025-04-15T01:03:55.5424622Z     âœ“ if no destination project, should reject (19 ms)
2025-04-15T01:03:55.5425496Z 
2025-04-15T01:03:57.6674970Z PASS test/integration/eventbus.ee.test.ts (7.264 s)
2025-04-15T01:03:57.6677166Z   âœ“ should have a running logwriter process (5 ms)
2025-04-15T01:03:57.6679637Z   âœ“ should have logwriter log messages (52 ms)
2025-04-15T01:03:57.6681805Z   âœ“ should anonymize audit message to syslog  (10 ms)
2025-04-15T01:03:57.6683757Z   âœ“ should send message to webhook  (5 ms)
2025-04-15T01:03:57.6685572Z   âœ“ should send message to sentry  (6 ms)
2025-04-15T01:03:57.6686648Z   âœ“ DELETE /eventbus/destination delete all destinations by id (22 ms)
2025-04-15T01:03:57.6687292Z   GET /eventbus/destination
2025-04-15T01:03:57.6687896Z     âœ“ should fail due to missing authentication (20 ms)
2025-04-15T01:03:57.6688710Z     âœ“ all returned destinations should exist in eventbus (14 ms)
2025-04-15T01:03:57.6689320Z   POST /eventbus/destination
2025-04-15T01:03:57.6689939Z     âœ“ create syslog destination (12 ms)
2025-04-15T01:03:57.6690489Z     âœ“ create sentry destination (9 ms)
2025-04-15T01:03:57.6691116Z     âœ“ create webhook destination (7 ms)
2025-04-15T01:03:57.6691438Z 
2025-04-15T01:03:59.1358111Z PASS src/telemetry/__tests__/telemetry.test.ts
2025-04-15T01:03:59.1359039Z   Telemetry
2025-04-15T01:03:59.1359672Z     trackWorkflowExecution
2025-04-15T01:03:59.1360754Z       âœ“ should count executions correctly (9 ms)
2025-04-15T01:03:59.1362022Z       âœ“ should fire "Workflow execution errored" event for failed executions (3 ms)
2025-04-15T01:03:59.1362998Z       âœ“ should track production executions count correctly (14 ms)
2025-04-15T01:03:59.1363644Z     Rudderstack
2025-04-15T01:03:59.1364794Z       âœ“ should call rudderStack.identify() with a fake IP address to instruct Rudderstack to not use the user's IP address (1 ms)
2025-04-15T01:03:59.1366459Z       âœ“ should call rudderStack.track() with a fake IP address to instruct Rudderstack to not use the user's IP address (1 ms)
2025-04-15T01:03:59.1367216Z 
2025-04-15T01:03:59.5069676Z PASS test/integration/external-secrets/external-secrets.api.test.ts (7.433 s)
2025-04-15T01:03:59.5075580Z   GET /external-secrets/providers
2025-04-15T01:03:59.5076442Z     âœ“ can retrieve providers as owner (40 ms)
2025-04-15T01:03:59.5077151Z     âœ“ can not retrieve providers as non-owner (9 ms)
2025-04-15T01:03:59.5077802Z     âœ“ does obscure passwords (11 ms)
2025-04-15T01:03:59.5078338Z   GET /external-secrets/providers/:provider
2025-04-15T01:03:59.5078964Z     âœ“ can retrieve provider as owner (10 ms)
2025-04-15T01:03:59.5079616Z     âœ“ can not retrieve provider as non-owner (8 ms)
2025-04-15T01:03:59.5080625Z     âœ“ does obscure passwords (11 ms)
2025-04-15T01:03:59.5081186Z   POST /external-secrets/providers/:provider
2025-04-15T01:03:59.5084903Z     âœ“ can update provider settings (14 ms)
2025-04-15T01:03:59.5085725Z     âœ“ can update provider settings with blanking value (16 ms)
2025-04-15T01:03:59.5086440Z   POST /external-secrets/providers/:provider/connect
2025-04-15T01:03:59.5087190Z     âœ“ can change provider connected state (11 ms)
2025-04-15T01:03:59.5087837Z   POST /external-secrets/providers/:provider/test
2025-04-15T01:03:59.5088465Z     âœ“ can test provider (7 ms)
2025-04-15T01:03:59.5089004Z     âœ“ can test provider fail (7 ms)
2025-04-15T01:03:59.5089577Z   POST /external-secrets/providers/:provider/update
2025-04-15T01:03:59.5090198Z     âœ“ can update provider (6 ms)
2025-04-15T01:03:59.5090795Z     âœ“ can not update errored provider (10 ms)
2025-04-15T01:03:59.5091710Z     âœ“ can not update provider without a valid license (8 ms)
2025-04-15T01:03:59.5092331Z   GET /external-secrets/secrets
2025-04-15T01:03:59.5092891Z     âœ“ can get secret names as owner (5 ms)
2025-04-15T01:03:59.5093531Z     âœ“ can not get secret names as non-owner (6 ms)
2025-04-15T01:03:59.5093880Z 
2025-04-15T01:04:05.2998245Z PASS test/integration/active-workflow-manager.test.ts (7.38 s)
2025-04-15T01:04:05.2999677Z   init()
2025-04-15T01:04:05.3000730Z     âœ“ should load workflows into memory (57 ms)
2025-04-15T01:04:05.3001378Z     âœ“ should call external hook (7 ms)
2025-04-15T01:04:05.3002586Z     âœ“ should check that workflow can be activated (35 ms)
2025-04-15T01:04:05.3003082Z   isActive()
2025-04-15T01:04:05.3003672Z     âœ“ should return `true` for active workflow in storage (21 ms)
2025-04-15T01:04:05.3004572Z     âœ“ should return `false` for inactive workflow in storage (12 ms)
2025-04-15T01:04:05.3005180Z   add()
2025-04-15T01:04:05.3005993Z     âœ“ should count workflow triggers correctly when node has multiple webhooks (11 ms)
2025-04-15T01:04:05.3006762Z     in single-main mode
2025-04-15T01:04:05.3007827Z       âœ“ should add webhooks, triggers and pollers for workflow in 'activate' activation mode (21 ms)
2025-04-15T01:04:05.3031092Z       âœ“ should add webhooks, triggers and pollers for workflow in 'update' activation mode (17 ms)
2025-04-15T01:04:05.3032028Z   removeAll()
2025-04-15T01:04:05.3032681Z     âœ“ should remove all active workflows from memory (29 ms)
2025-04-15T01:04:05.3033194Z   remove()
2025-04-15T01:04:05.3033499Z     in single-main mode
2025-04-15T01:04:05.3034191Z       âœ“ should remove all webhooks of a workflow from database (16 ms)
2025-04-15T01:04:05.3035205Z       âœ“ should remove all webhooks of a workflow from external service (16 ms)
2025-04-15T01:04:05.3036119Z       âœ“ should stop running triggers and pollers (18 ms)
2025-04-15T01:04:05.3036689Z   executeErrorWorkflow()
2025-04-15T01:04:05.3037401Z     âœ“ should be called on failure to activate due to 401 (22 ms)
2025-04-15T01:04:05.3037972Z   addWebhooks()
2025-04-15T01:04:05.3038743Z     âœ“ should call `WebhookService.storeWebhook()` (18 ms)
2025-04-15T01:04:05.3039195Z 
2025-04-15T01:04:06.8288642Z PASS test/integration/prometheus-metrics.test.ts (7.071 s)
2025-04-15T01:04:06.8289334Z   PrometheusMetricsService
2025-04-15T01:04:06.8290074Z     âœ“ should return n8n version (36 ms)
2025-04-15T01:04:06.8290707Z     âœ“ should return default metrics if enabled (16 ms)
2025-04-15T01:04:06.8291417Z     âœ“ should not return default metrics if disabled (6 ms)
2025-04-15T01:04:06.8297115Z     âœ“ should return cache metrics if enabled (4 ms)
2025-04-15T01:04:06.8297881Z     âœ“ should not return cache metrics if disabled (3 ms)
2025-04-15T01:04:06.8298601Z     âœ“ should return route metrics if enabled (11 ms)
2025-04-15T01:04:06.8299367Z     âœ“ should include last activity metric with route metrics (15 ms)
2025-04-15T01:04:06.8300153Z     âœ“ should return labels in route metrics if enabled (8 ms)
2025-04-15T01:04:06.8300834Z     âœ“ should return queue metrics if enabled (4 ms)
2025-04-15T01:04:06.8301830Z     âœ“ should set queue metrics in response to `job-counts-updated` event (4 ms)
2025-04-15T01:04:06.8303016Z     âœ“ should return active workflow count (22 ms)
2025-04-15T01:04:06.8303342Z 
2025-04-15T01:04:07.1922412Z PASS test/integration/evaluation/test-runs.api.test.ts (7.78 s)
2025-04-15T01:04:07.1923675Z   GET /evaluation/test-definitions/:testDefinitionId/runs
2025-04-15T01:04:07.1925009Z     âœ“ should retrieve empty list of runs for a test definition (86 ms)
2025-04-15T01:04:07.1926239Z     âœ“ should return 404 if test definition does not exist (45 ms)
2025-04-15T01:04:07.1927413Z     âœ“ should return 404 if user does not have access to test definition (27 ms)
2025-04-15T01:04:07.1928631Z     âœ“ should retrieve list of runs for a test definition (28 ms)
2025-04-15T01:04:07.1929818Z     âœ“ should retrieve list of runs for a test definition with pagination (47 ms)
2025-04-15T01:04:07.1930852Z   GET /evaluation/test-definitions/:testDefinitionId/runs/:id
2025-04-15T01:04:07.1932096Z     âœ“ should retrieve test run for a test definition (34 ms)
2025-04-15T01:04:07.1933196Z     âœ“ should return 404 if test run does not exist (29 ms)
2025-04-15T01:04:07.1934352Z     âœ“ should return 404 if user does not have access to test definition (27 ms)
2025-04-15T01:04:07.1969588Z     âœ“ should retrieve test run for a test definition of a shared workflow (65 ms)
2025-04-15T01:04:07.1970548Z   DELETE /evaluation/test-definitions/:testDefinitionId/runs/:id
2025-04-15T01:04:07.1971477Z     âœ“ should delete test run for a test definition (33 ms)
2025-04-15T01:04:07.1972950Z     âœ“ should return 404 if test run does not exist (28 ms)
2025-04-15T01:04:07.1973876Z     âœ“ should return 404 if user does not have access to test definition (24 ms)
2025-04-15T01:04:07.1974775Z   POST /evaluation/test-definitions/:testDefinitionId/runs/:id/cancel
2025-04-15T01:04:07.1975596Z     âœ“ should cancel test run (30 ms)
2025-04-15T01:04:07.1976283Z     âœ“ should return 404 if test run does not exist (28 ms)
2025-04-15T01:04:07.1977105Z     âœ“ should return 404 if test definition does not exist (22 ms)
2025-04-15T01:04:07.1978086Z     âœ“ should return 404 if user does not have access to test definition (23 ms)
2025-04-15T01:04:07.1978580Z 
2025-04-15T01:04:12.5427357Z PASS src/commands/__tests__/community-node.test.ts (5.468 s)
2025-04-15T01:04:12.5428085Z   uninstallCredential
2025-04-15T01:04:12.5428846Z     âœ“ should delete a credential (10 ms)
2025-04-15T01:04:12.5429518Z     âœ“ should return if the user is not found (1 ms)
2025-04-15T01:04:12.5430276Z     âœ“ should return if the credential is not found (2 ms)
2025-04-15T01:04:12.5430955Z     âœ“ should delete multiple credentials (2 ms)
2025-04-15T01:04:12.5431421Z   uninstallPackage
2025-04-15T01:04:12.5432088Z     âœ“ should uninstall the package (3 ms)
2025-04-15T01:04:12.5432742Z     âœ“ should uninstall all nodes from a package (2 ms)
2025-04-15T01:04:12.5433187Z     âœ“ should return if a package is not found (1 ms)
2025-04-15T01:04:12.5433560Z     âœ“ should return if nodes are not found (1 ms)
2025-04-15T01:04:12.5433754Z 
2025-04-15T01:04:13.5575019Z PASS test/integration/public-api/projects.test.ts (8.023 s)
2025-04-15T01:04:13.5575981Z   Projects in Public API
2025-04-15T01:04:13.5576517Z     GET /projects
2025-04-15T01:04:13.5577602Z       âœ“ if licensed, should return all projects with pagination (223 ms)
2025-04-15T01:04:13.5578554Z       âœ“ if not authenticated, should reject (8 ms)
2025-04-15T01:04:13.5579301Z       âœ“ if not licensed, should reject (20 ms)
2025-04-15T01:04:13.5580299Z       âœ“ if missing scope, should reject (18 ms)
2025-04-15T01:04:13.5583135Z     POST /projects
2025-04-15T01:04:13.5583965Z       âœ“ if licensed, should create a new project (35 ms)
2025-04-15T01:04:13.5587490Z       âœ“ if not authenticated, should reject (6 ms)
2025-04-15T01:04:13.5588614Z       âœ“ if not licensed, should reject (20 ms)
2025-04-15T01:04:13.5589698Z       âœ“ if missing scope, should reject (16 ms)
2025-04-15T01:04:13.5590679Z     DELETE /projects/:id
2025-04-15T01:04:13.5591509Z       âœ“ if licensed, should delete a project (71 ms)
2025-04-15T01:04:13.5598545Z       âœ“ if not authenticated, should reject (8 ms)
2025-04-15T01:04:13.5599504Z       âœ“ if not licensed, should reject (21 ms)
2025-04-15T01:04:13.5600328Z       âœ“ if missing scope, should reject (17 ms)
2025-04-15T01:04:13.5600961Z     PUT /projects/:id
2025-04-15T01:04:13.5601849Z       âœ“ if licensed, should update a project (27 ms)
2025-04-15T01:04:13.5607761Z       âœ“ if not authenticated, should reject (7 ms)
2025-04-15T01:04:13.5608854Z       âœ“ if not licensed, should reject (20 ms)
2025-04-15T01:04:13.5612192Z       âœ“ if missing scope, should reject (18 ms)
2025-04-15T01:04:13.5612548Z 
2025-04-15T01:04:14.5375850Z PASS src/executions/__tests__/execution-recovery.service.test.ts (7.104 s)
2025-04-15T01:04:14.5380444Z   ExecutionRecoveryService
2025-04-15T01:04:14.5384840Z     recoverFromLogs
2025-04-15T01:04:14.5386914Z       if follower
2025-04-15T01:04:14.5388278Z         âœ“ should do nothing (36 ms)
2025-04-15T01:04:14.5388961Z       if leader, with 0 messages
2025-04-15T01:04:14.5390300Z         âœ“ should return `null` if no execution found (13 ms)
2025-04-15T01:04:14.5392991Z         âœ“ should update `status` and `stoppedAt` (51 ms)
2025-04-15T01:04:14.5393789Z       if leader, with 1+ messages
2025-04-15T01:04:14.5394732Z         âœ“ for successful dataful execution, should return `null` (15 ms)
2025-04-15T01:04:14.5395696Z         âœ“ should return `null` if no execution found (5 ms)
2025-04-15T01:04:14.5396738Z         âœ“ for successful dataless execution, should update `status`, `stoppedAt` and `data` (67 ms)
2025-04-15T01:04:14.5398468Z         âœ“ for running execution, should update `status`, `stoppedAt` and `data` if last node did not finish (19 ms)
2025-04-15T01:04:14.5400221Z         âœ“ should update `status`, `stoppedAt` and `data` if last node finished (17 ms)
2025-04-15T01:04:14.5400861Z 
2025-04-15T01:04:17.9203530Z PASS src/controllers/oauth/__tests__/oauth1-credential.controller.test.ts (5.124 s)
2025-04-15T01:04:17.9208700Z   OAuth1CredentialController
2025-04-15T01:04:17.9213432Z     getAuthUri
2025-04-15T01:04:17.9218543Z       âœ“ should throw a BadRequestError when credentialId is missing in the query (37 ms)
2025-04-15T01:04:17.9232827Z       âœ“ should throw a NotFoundError when no matching credential is found for the user (2 ms)
2025-04-15T01:04:17.9237875Z       âœ“ should return a valid auth URI (97 ms)
2025-04-15T01:04:17.9242835Z     handleCallback
2025-04-15T01:04:17.9244123Z       âœ“ should render the error page when required query params are missing (2 ms)
2025-04-15T01:04:17.9245682Z       âœ“ should render the error page when `state` query param is invalid (5 ms)
2025-04-15T01:04:17.9247181Z       âœ“ should render the error page when credential is not found in DB (2 ms)
2025-04-15T01:04:17.9248808Z       âœ“ should render the error page when state differs from the stored state in the credential (8 ms)
2025-04-15T01:04:17.9250461Z       âœ“ should render the error page when state is older than 5 minutes (2 ms)
2025-04-15T01:04:17.9252182Z       âœ“ should exchange the code for a valid token, and save it to DB (37 ms)
2025-04-15T01:04:17.9253463Z 
2025-04-15T01:04:18.4726993Z PASS src/scaling/__tests__/scaling.service.test.ts
2025-04-15T01:04:18.4728985Z   ScalingService
2025-04-15T01:04:18.4733304Z     setupQueue
2025-04-15T01:04:18.4734753Z       if leader main
2025-04-15T01:04:18.4739171Z         âœ“ should set up queue + listeners + queue recovery (8 ms)
2025-04-15T01:04:18.4741051Z       if follower main
2025-04-15T01:04:18.4743219Z         âœ“ should set up queue + listeners (1 ms)
2025-04-15T01:04:18.4745161Z       if worker
2025-04-15T01:04:18.4745864Z         âœ“ should set up queue + listeners (1 ms)
2025-04-15T01:04:18.4746628Z       webhook
2025-04-15T01:04:18.4748403Z         âœ“ should set up a queue + listeners (1 ms)
2025-04-15T01:04:18.4749187Z     setupWorker
2025-04-15T01:04:18.4750285Z       âœ“ should set up a worker with concurrency (1 ms)
2025-04-15T01:04:18.4751253Z       âœ“ should throw if called on a non-worker instance (24 ms)
2025-04-15T01:04:18.4752495Z       âœ“ should throw if called before queue is ready (2 ms)
2025-04-15T01:04:18.4753280Z     stop
2025-04-15T01:04:18.4755396Z       if main
2025-04-15T01:04:18.4756177Z         âœ“ should pause queue, stop queue recovery and queue metrics (2 ms)
2025-04-15T01:04:18.4756985Z       if worker
2025-04-15T01:04:18.4758751Z         âœ“ should pause queue and wait for running jobs to finish (1 ms)
2025-04-15T01:04:18.4759493Z     pingQueue
2025-04-15T01:04:18.4760103Z       âœ“ should ping the queue (1 ms)
2025-04-15T01:04:18.4761159Z     addJob
2025-04-15T01:04:18.4763145Z       âœ“ should add a job (1 ms)
2025-04-15T01:04:18.4763696Z     getJob
2025-04-15T01:04:18.4764387Z       âœ“ should get a job (8 ms)
2025-04-15T01:04:18.4764966Z     findJobsByStatus
2025-04-15T01:04:18.4765623Z       âœ“ should find jobs by status (2 ms)
2025-04-15T01:04:18.4766569Z       âœ“ should filter out `null` in Redis response (1 ms)
2025-04-15T01:04:18.4767238Z     stopJob
2025-04-15T01:04:18.4767991Z       âœ“ should stop an active job (2 ms)
2025-04-15T01:04:18.4769027Z       âœ“ should stop an inactive job (2 ms)
2025-04-15T01:04:18.4769938Z       âœ“ should report failure to stop a job (1 ms)
2025-04-15T01:04:18.4770643Z 
2025-04-15T01:04:20.6352213Z PASS src/task-runners/task-managers/__tests__/data-request-response-stripper.test.ts
2025-04-15T01:04:20.6359728Z   DataRequestResponseStripper
2025-04-15T01:04:20.6362675Z     all data
2025-04-15T01:04:20.6365486Z       âœ“ should build the runExecutionData as is when everything is requested (6 ms)
2025-04-15T01:04:20.6376379Z     envProviderState
2025-04-15T01:04:20.6377175Z       âœ“ should filter out envProviderState when it's not requested (1 ms)
2025-04-15T01:04:20.6377756Z     input data
2025-04-15T01:04:20.6378220Z       âœ“ drops input data from result
2025-04-15T01:04:20.6378745Z       âœ“ returns only chunked data
2025-04-15T01:04:20.6379122Z     nodes
2025-04-15T01:04:20.6379752Z       âœ“ should return empty run data when only Code node is requested (1 ms)
2025-04-15T01:04:20.6380660Z       âœ“ should return empty run data when only Code node is requested (1 ms)
2025-04-15T01:04:20.6381885Z       âœ“ should return only DebugHelper's data when only DebugHelper node is requested (1 ms)
2025-04-15T01:04:20.6382997Z       âœ“ should return DebugHelper's data when only prevNode node is requested (2 ms)
2025-04-15T01:04:20.6383641Z     passthrough properties
2025-04-15T01:04:20.6384129Z       âœ“ it doesn't change workflow
2025-04-15T01:04:20.6384716Z       âœ“ it doesn't change connectionInputSource (1 ms)
2025-04-15T01:04:20.6385330Z       âœ“ it doesn't change node (1 ms)
2025-04-15T01:04:20.6385962Z       âœ“ it doesn't change runIndex
2025-04-15T01:04:20.6386510Z       âœ“ it doesn't change itemIndex (1 ms)
2025-04-15T01:04:20.6387067Z       âœ“ it doesn't change activeNodeName
2025-04-15T01:04:20.6387666Z       âœ“ it doesn't change siblingParameters (1 ms)
2025-04-15T01:04:20.6388212Z       âœ“ it doesn't change mode
2025-04-15T01:04:20.6388754Z       âœ“ it doesn't change defaultReturnRunIndex
2025-04-15T01:04:20.6389323Z       âœ“ it doesn't change selfData
2025-04-15T01:04:20.6390177Z       âœ“ it doesn't change contextNodeName
2025-04-15T01:04:20.6390744Z       âœ“ it doesn't change additionalData
2025-04-15T01:04:20.6391037Z 
2025-04-15T01:04:23.1354901Z PASS test/integration/public-api/tags.test.ts (8.39 s)
2025-04-15T01:04:23.1355543Z   GET /tags
2025-04-15T01:04:23.1356279Z     âœ“ should fail due to missing API Key (34 ms)
2025-04-15T01:04:23.1356954Z     âœ“ should fail due to invalid API Key (8 ms)
2025-04-15T01:04:23.1357636Z     âœ“ should return all tags (189 ms)
2025-04-15T01:04:23.1358287Z     âœ“ should return all tags with pagination (28 ms)
2025-04-15T01:04:23.1358787Z   GET /tags/:id
2025-04-15T01:04:23.1359287Z     âœ“ should fail due to missing API Key (9 ms)
2025-04-15T01:04:23.1359927Z     âœ“ should fail due to invalid API Key (7 ms)
2025-04-15T01:04:23.1360571Z     âœ“ should fail due to non-existing tag (16 ms)
2025-04-15T01:04:23.1361171Z     âœ“ should retrieve tag (12 ms)
2025-04-15T01:04:23.1361818Z   DELETE /tags/:id
2025-04-15T01:04:23.1362405Z     âœ“ should fail due to missing API Key (5 ms)
2025-04-15T01:04:23.1363063Z     âœ“ should fail due to invalid API Key (6 ms)
2025-04-15T01:04:23.1363726Z     âœ“ should fail due to non-existing tag (23 ms)
2025-04-15T01:04:23.1364359Z     âœ“ owner should delete the tag (13 ms)
2025-04-15T01:04:23.1364971Z     âœ“ non-owner should not delete tag (9 ms)
2025-04-15T01:04:23.1365426Z   POST /tags
2025-04-15T01:04:23.1365927Z     âœ“ should fail due to missing API Key (4 ms)
2025-04-15T01:04:23.1367000Z     âœ“ should fail due to invalid API Key (5 ms)
2025-04-15T01:04:23.1367649Z     âœ“ should fail due to invalid body (13 ms)
2025-04-15T01:04:23.1368225Z     âœ“ should create tag (10 ms)
2025-04-15T01:04:23.1368905Z     âœ“ should not create tag if tag with same name exists (8 ms)
2025-04-15T01:04:23.1369456Z   PUT /tags/:id
2025-04-15T01:04:23.1369967Z     âœ“ should fail due to missing API Key (3 ms)
2025-04-15T01:04:23.1370607Z     âœ“ should fail due to invalid API Key (5 ms)
2025-04-15T01:04:23.1371252Z     âœ“ should fail due to non-existing tag (11 ms)
2025-04-15T01:04:23.1372106Z     âœ“ should fail due to invalid body (8 ms)
2025-04-15T01:04:23.1372697Z     âœ“ should update tag (16 ms)
2025-04-15T01:04:23.1373432Z     âœ“ should fail if there is already a tag with a the new name (18 ms)
2025-04-15T01:04:23.1373882Z 
2025-04-15T01:04:26.7059969Z PASS test/integration/password-reset.api.test.ts (8.038 s)
2025-04-15T01:04:26.7065212Z   POST /forgot-password
2025-04-15T01:04:26.7066498Z     âœ“ should send password reset email (83 ms)
2025-04-15T01:04:26.7067206Z     âœ“ should fail if emailing is not set up (55 ms)
2025-04-15T01:04:26.7067913Z     âœ“ should fail if SAML is authentication method (34 ms)
2025-04-15T01:04:26.7068800Z     âœ“ should succeed if SAML is authentication method and requestor is owner (30 ms)
2025-04-15T01:04:26.7069589Z     âœ“ should fail with invalid inputs (28 ms)
2025-04-15T01:04:26.7070185Z     âœ“ should fail if user is not found (19 ms)
2025-04-15T01:04:26.7070658Z   GET /resolve-password-token
2025-04-15T01:04:26.7071245Z     âœ“ should succeed with valid inputs (26 ms)
2025-04-15T01:04:26.7072048Z     âœ“ should fail with invalid inputs (18 ms)
2025-04-15T01:04:26.7072653Z     âœ“ should fail if user is not found (21 ms)
2025-04-15T01:04:26.7073237Z     âœ“ should fail if token is expired (20 ms)
2025-04-15T01:04:26.7073856Z     âœ“ should fail after password has changed (23 ms)
2025-04-15T01:04:26.7074351Z   POST /change-password
2025-04-15T01:04:26.7074869Z     âœ“ should succeed with valid inputs (238 ms)
2025-04-15T01:04:26.7075485Z     âœ“ should fail with invalid inputs (49 ms)
2025-04-15T01:04:26.7076073Z     âœ“ should fail when token has expired (18 ms)
2025-04-15T01:04:26.7076867Z     âœ“ owner should be able to reset its password when quota:users = 1 (223 ms)
2025-04-15T01:04:26.7077830Z     âœ“ member should not be able to reset its password when quota:users = 1 (118 ms)
2025-04-15T01:04:26.7078300Z 
2025-04-15T01:04:27.5199787Z PASS src/executions/__tests__/execution.service.test.ts
2025-04-15T01:04:27.5201177Z   ExecutionService
2025-04-15T01:04:27.5201903Z     retry
2025-04-15T01:04:27.5202922Z       âœ“ should error on retrying a execution that was aborted before starting (30 ms)
2025-04-15T01:04:27.5203593Z     stop
2025-04-15T01:04:27.5204165Z       âœ“ should throw when stopping a missing execution (1 ms)
2025-04-15T01:04:27.5205013Z       âœ“ should throw when stopping a not-in-progress execution (1 ms)
2025-04-15T01:04:27.5205973Z       regular mode
2025-04-15T01:04:27.5206680Z         âœ“ should stop a `running` execution in regular mode (4 ms)
2025-04-15T01:04:27.5207528Z         âœ“ should stop a `waiting` execution in regular mode (2 ms)
2025-04-15T01:04:27.5208523Z         âœ“ should stop a concurrency-controlled `new` execution in regular mode (2 ms)
2025-04-15T01:04:27.5209175Z       scaling mode
2025-04-15T01:04:27.5209511Z         manual execution
2025-04-15T01:04:27.5210183Z           âœ“ should stop a `running` execution in scaling mode (2 ms)
2025-04-15T01:04:27.5210734Z         production execution
2025-04-15T01:04:27.5211464Z           âœ“ should stop a `running` execution in scaling mode (2 ms)
2025-04-15T01:04:27.5212550Z           âœ“ should stop a `waiting` execution in scaling mode (2 ms)
2025-04-15T01:04:27.5212962Z 
2025-04-15T01:04:29.0840538Z PASS test/integration/saml/saml.api.test.ts (8.243 s)
2025-04-15T01:04:29.0842031Z   Instance owner
2025-04-15T01:04:29.0842370Z     PATCH /me
2025-04-15T01:04:29.0843115Z       âœ“ should succeed with valid inputs (86 ms)
2025-04-15T01:04:29.0845477Z       âœ“ should throw BadRequestError if email is changed when SAML is enabled (32 ms)
2025-04-15T01:04:29.0846054Z     PATCH /password
2025-04-15T01:04:29.0846793Z       âœ“ should throw BadRequestError if password is changed when SAML is enabled (11 ms)
2025-04-15T01:04:29.0847475Z     POST /sso/saml/config
2025-04-15T01:04:29.0847976Z       âœ“ should post saml config (311 ms)
2025-04-15T01:04:29.0848571Z       âœ“ should return 400 on invalid config (13 ms)
2025-04-15T01:04:29.0849065Z     POST /sso/saml/config/toggle
2025-04-15T01:04:29.0849752Z       âœ“ should toggle saml as default authentication method (42 ms)
2025-04-15T01:04:29.0850610Z       âœ“ should fail enable saml if default authentication is not email (32 ms)
2025-04-15T01:04:29.0851184Z   Check endpoint permissions
2025-04-15T01:04:29.0851736Z     Owner
2025-04-15T01:04:29.0852303Z       âœ“ should be able to access GET /sso/saml/metadata (14 ms)
2025-04-15T01:04:29.0853037Z       âœ“ should be able to access GET /sso/saml/config (19 ms)
2025-04-15T01:04:29.0853775Z       âœ“ should be able to access POST /sso/saml/config (24 ms)
2025-04-15T01:04:29.0854544Z       âœ“ should be able to access POST /sso/saml/config/toggle (12 ms)
2025-04-15T01:04:29.0855272Z       âœ“ should be able to access GET /sso/saml/acs (8 ms)
2025-04-15T01:04:29.0855961Z       âœ“ should be able to access POST /sso/saml/acs (7 ms)
2025-04-15T01:04:29.0856662Z       âœ“ should be able to access GET /sso/saml/initsso (17 ms)
2025-04-15T01:04:29.0857440Z       âœ“ should be able to access GET /sso/saml/config/test (14 ms)
2025-04-15T01:04:29.0858007Z     Authenticated Member
2025-04-15T01:04:29.0858603Z       âœ“ should be able to access GET /sso/saml/metadata (8 ms)
2025-04-15T01:04:29.0859294Z       âœ“ should be able to access GET /sso/saml/config (14 ms)
2025-04-15T01:04:29.0859983Z       âœ“ should NOT be able to access POST /sso/saml/config (8 ms)
2025-04-15T01:04:29.0860734Z       âœ“ should NOT be able to access POST /sso/saml/config/toggle (7 ms)
2025-04-15T01:04:29.0861441Z       âœ“ should be able to access GET /sso/saml/acs (9 ms)
2025-04-15T01:04:29.0866810Z       âœ“ should be able to access POST /sso/saml/acs (11 ms)
2025-04-15T01:04:29.0867509Z       âœ“ should be able to access GET /sso/saml/initsso (9 ms)
2025-04-15T01:04:29.0868262Z       âœ“ should NOT be able to access GET /sso/saml/config/test (9 ms)
2025-04-15T01:04:29.0868795Z     Non-Authenticated User
2025-04-15T01:04:29.0869346Z       âœ“ should be able to access /sso/saml/metadata (5 ms)
2025-04-15T01:04:29.0870040Z       âœ“ should NOT be able to access GET /sso/saml/config (4 ms)
2025-04-15T01:04:29.0871056Z       âœ“ should NOT be able to access POST /sso/saml/config (4 ms)
2025-04-15T01:04:29.0872035Z       âœ“ should NOT be able to access POST /sso/saml/config/toggle (5 ms)
2025-04-15T01:04:29.0872792Z       âœ“ should be able to access GET /sso/saml/acs (9 ms)
2025-04-15T01:04:29.0873444Z       âœ“ should be able to access POST /sso/saml/acs (5 ms)
2025-04-15T01:04:29.0874120Z       âœ“ should be able to access GET /sso/saml/initsso (5 ms)
2025-04-15T01:04:29.0874876Z       âœ“ should NOT be able to access GET /sso/saml/config/test (4 ms)
2025-04-15T01:04:29.0875252Z 
2025-04-15T01:04:31.8948687Z PASS src/__tests__/node-types.test.ts
2025-04-15T01:04:31.8949706Z   NodeTypes
2025-04-15T01:04:31.8953746Z     getByName
2025-04-15T01:04:31.8955561Z       âœ“ should return node type when it exists (13 ms)
2025-04-15T01:04:31.8956395Z     getByNameAndVersion
2025-04-15T01:04:31.8957676Z       âœ“ should throw an error if the package does not exist (24 ms)
2025-04-15T01:04:31.8958828Z       âœ“ should throw an error if the node-type does not exist (1 ms)
2025-04-15T01:04:31.8960007Z       âœ“ should return a regular node-type without version (1 ms)
2025-04-15T01:04:31.8961030Z       âœ“ should return a regular node-type with version
2025-04-15T01:04:31.8973469Z       âœ“ should throw when a node-type is requested as tool, but does not support being used as one (1 ms)
2025-04-15T01:04:31.8974827Z       âœ“ should throw when a node-type is requested as tool, but the original node is already a tool (1 ms)
2025-04-15T01:04:31.8976461Z       âœ“ should return the tool node-type when requested as tool (2 ms)
2025-04-15T01:04:31.8977532Z       âœ“ should return a tool node-type from a community node,  when requested as tool (1 ms)
2025-04-15T01:04:31.8978630Z       âœ“ should return a declarative node-type with an `.execute` method (2 ms)
2025-04-15T01:04:31.8979617Z       âœ“ should return a declarative node-type as a tool with an `.execute` method (2 ms)
2025-04-15T01:04:31.8980208Z     getWithSourcePath
2025-04-15T01:04:31.8980919Z       âœ“ should return description and source path for existing node (1 ms)
2025-04-15T01:04:31.8981919Z       âœ“ should throw error for non-existent node (1 ms)
2025-04-15T01:04:31.8982393Z     getKnownTypes
2025-04-15T01:04:31.8982866Z       âœ“ should return known node types (1 ms)
2025-04-15T01:04:31.8983304Z     getNodeTypeDescriptions
2025-04-15T01:04:31.8983920Z       âœ“ should return descriptions for valid node types (1 ms)
2025-04-15T01:04:31.8984613Z       âœ“ should throw error for invalid node type (1 ms)
2025-04-15T01:04:31.8984946Z 
2025-04-15T01:04:34.4025143Z PASS test/integration/pruning.service.test.ts (7.456 s)
2025-04-15T01:04:34.4036842Z   softDeleteOnPruningCycle()
2025-04-15T01:04:34.4045436Z     when EXECUTIONS_DATA_PRUNE_MAX_COUNT is set
2025-04-15T01:04:34.4046607Z       âœ“ should mark as deleted based on EXECUTIONS_DATA_PRUNE_MAX_COUNT (40 ms)
2025-04-15T01:04:34.4047597Z       âœ“ should not re-mark already marked executions (15 ms)
2025-04-15T01:04:34.4048401Z       âœ“ should prune unknown executions (16 ms)
2025-04-15T01:04:34.4049107Z       âœ“ should prune canceled executions (15 ms)
2025-04-15T01:04:34.4049803Z       âœ“ should prune crashed executions (13 ms)
2025-04-15T01:04:34.4050463Z       âœ“ should prune error executions (13 ms)
2025-04-15T01:04:34.4051111Z       âœ“ should prune success executions (12 ms)
2025-04-15T01:04:34.4051977Z       âœ“ should not prune new executions (13 ms)
2025-04-15T01:04:34.4052674Z       âœ“ should not prune running executions (12 ms)
2025-04-15T01:04:34.4053426Z       âœ“ should not prune waiting executions (11 ms)
2025-04-15T01:04:34.4054115Z       âœ“ should not prune annotated executions (25 ms)
2025-04-15T01:04:34.4054688Z     when EXECUTIONS_DATA_MAX_AGE is set
2025-04-15T01:04:34.4055498Z       âœ“ should mark as deleted based on EXECUTIONS_DATA_MAX_AGE (11 ms)
2025-04-15T01:04:34.4056378Z       âœ“ should not re-mark already marked executions (11 ms)
2025-04-15T01:04:34.4057105Z       âœ“ should prune unknown executions (9 ms)
2025-04-15T01:04:34.4058110Z       âœ“ should prune canceled executions (8 ms)
2025-04-15T01:04:34.4058818Z       âœ“ should prune crashed executions (8 ms)
2025-04-15T01:04:34.4059495Z       âœ“ should prune error executions (11 ms)
2025-04-15T01:04:34.4060140Z       âœ“ should prune success executions (8 ms)
2025-04-15T01:04:34.4060797Z       âœ“ should not prune new executions (11 ms)
2025-04-15T01:04:34.4061483Z       âœ“ should not prune running executions (10 ms)
2025-04-15T01:04:34.4062410Z       âœ“ should not prune waiting executions (15 ms)
2025-04-15T01:04:34.4063161Z       âœ“ should not prune annotated executions (17 ms)
2025-04-15T01:04:34.4063534Z 
2025-04-15T01:04:35.1422895Z PASS src/__tests__/license.test.ts
2025-04-15T01:04:35.1423737Z   License
2025-04-15T01:04:35.1424456Z     âœ“ initializes license manager (10 ms)
2025-04-15T01:04:35.1425287Z     âœ“ initializes license manager for worker (3 ms)
2025-04-15T01:04:35.1426187Z     âœ“ attempts to activate license with provided key (1 ms)
2025-04-15T01:04:35.1426934Z     âœ“ renews license (1 ms)
2025-04-15T01:04:35.1427651Z     âœ“ check if feature is enabled (1 ms)
2025-04-15T01:04:35.1428424Z     âœ“ check if sharing feature is enabled (1 ms)
2025-04-15T01:04:35.1429182Z     âœ“ check fetching entitlements (7 ms)
2025-04-15T01:04:35.1429886Z     âœ“ check fetching feature values (2 ms)
2025-04-15T01:04:35.1430557Z     âœ“ check management jwt (1 ms)
2025-04-15T01:04:35.1431353Z     âœ“ getMainPlan() returns the latest main entitlement (2 ms)
2025-04-15T01:04:35.1433014Z     âœ“ getMainPlan() returns undefined if there is no main plan (2 ms)
2025-04-15T01:04:35.1433734Z     init
2025-04-15T01:04:35.1434651Z       âœ“ when leader main with N8N_LICENSE_AUTO_RENEW_ENABLED=true, should enable renewal (2 ms)
2025-04-15T01:04:35.1436027Z       âœ“ when leader main with N8N_LICENSE_AUTO_RENEW_ENABLED=false, should disable renewal (2 ms)
2025-04-15T01:04:35.1437416Z       âœ“ when follower main with N8N_LICENSE_AUTO_RENEW_ENABLED=true, should disable renewal (1 ms)
2025-04-15T01:04:35.1438826Z       âœ“ when follower main with N8N_LICENSE_AUTO_RENEW_ENABLED=false, should disable renewal (2 ms)
2025-04-15T01:04:35.1440236Z       âœ“ when CLI command with N8N_LICENSE_AUTO_RENEW_ENABLED=true, should enable renewal (2 ms)
2025-04-15T01:04:35.1440953Z 
2025-04-15T01:04:36.0333180Z PASS test/integration/commands/import.cmd.test.ts (8.281 s)
2025-04-15T01:04:36.0338018Z   âœ“ import:workflow should import active workflow and deactivate it (100 ms)
2025-04-15T01:04:36.0351911Z   âœ“ import:workflow should import active workflow from combined file and deactivate it (31 ms)
2025-04-15T01:04:36.0353123Z   âœ“ import:workflow can import a single workflow object (27 ms)
2025-04-15T01:04:36.0354437Z   âœ“ `import:workflow --userId ...` should fail if the workflow exists already and is owned by somebody else (74 ms)
2025-04-15T01:04:36.0355890Z   âœ“ only update the workflow, don't create or update the owner if `--userId` is not passed (42 ms)
2025-04-15T01:04:36.0357430Z   âœ“ `import:workflow --projectId ...` should fail if the credential already exists and is owned by another project (58 ms)
2025-04-15T01:04:36.0360996Z   âœ“ `import:workflow --projectId ... --userId ...` fails explaining that only one of the options can be used at a time (10 ms)
2025-04-15T01:04:36.0362147Z 
2025-04-15T01:04:38.0494823Z PASS src/middlewares/list-query/__tests__/list-query.test.ts
2025-04-15T01:04:38.0495557Z   List query middleware
2025-04-15T01:04:38.0495940Z     Query filter
2025-04-15T01:04:38.0496776Z       âœ“ should not set filter on request if none sent (5 ms)
2025-04-15T01:04:38.0497557Z       âœ“ should parse valid filter (4 ms)
2025-04-15T01:04:38.0498195Z       âœ“ should ignore invalid filter (1 ms)
2025-04-15T01:04:38.0498878Z       âœ“ should throw on invalid JSON (30 ms)
2025-04-15T01:04:38.0499640Z       âœ“ should throw on valid filter with invalid type (3 ms)
2025-04-15T01:04:38.0500187Z     Query select
2025-04-15T01:04:38.0500841Z       âœ“ should not set select on request if none sent (1 ms)
2025-04-15T01:04:38.0501799Z       âœ“ should parse valid select (1 ms)
2025-04-15T01:04:38.0502907Z       âœ“ ignore invalid select (1 ms)
2025-04-15T01:04:38.0503514Z       âœ“ throw on invalid JSON (3 ms)
2025-04-15T01:04:38.0504205Z       âœ“ throw on non-string-array JSON for select (2 ms)
2025-04-15T01:04:38.0504735Z     Query pagination
2025-04-15T01:04:38.0505526Z       âœ“ should not set pagination options on request if none sent (1 ms)
2025-04-15T01:04:38.0506314Z       âœ“ should parse valid pagination (1 ms)
2025-04-15T01:04:38.0506991Z       âœ“ should throw on skip without take (1 ms)
2025-04-15T01:04:38.0507635Z       âœ“ should default skip to 0 (3 ms)
2025-04-15T01:04:38.0508198Z       âœ“ should cap take at 50
2025-04-15T01:04:38.0508840Z       âœ“ should throw on non-numeric-integer take (2 ms)
2025-04-15T01:04:38.0509588Z       âœ“ should throw on non-numeric-integer skip (1 ms)
2025-04-15T01:04:38.0510091Z     Query sort by
2025-04-15T01:04:38.0510750Z       âœ“ should succeed validation when sorting by name asc (1 ms)
2025-04-15T01:04:38.0511767Z       âœ“ should succeed validation when sorting by name desc
2025-04-15T01:04:38.0512672Z       âœ“ should succeed validation when sorting by createdAt asc
2025-04-15T01:04:38.0513528Z       âœ“ should succeed validation when sorting by createdAt desc
2025-04-15T01:04:38.0514437Z       âœ“ should succeed validation when sorting by updatedAt asc (1 ms)
2025-04-15T01:04:38.0515334Z       âœ“ should succeed validation when sorting by updatedAt desc
2025-04-15T01:04:38.0516216Z       âœ“ should fail validation when sorting by invalid column (1 ms)
2025-04-15T01:04:38.0517556Z       âœ“ should fail validation when sorting by valid column without order (1 ms)
2025-04-15T01:04:38.0518674Z       âœ“ should fail validation when sorting by valid column with invalid order (1 ms)
2025-04-15T01:04:38.0519665Z       âœ“ should not pass sortBy to listQueryOptions if not provided
2025-04-15T01:04:38.0520256Z     Combinations
2025-04-15T01:04:38.0520789Z       âœ“ should combine filter with select (1 ms)
2025-04-15T01:04:38.0521782Z       âœ“ should combine filter with pagination options (1 ms)
2025-04-15T01:04:38.0522635Z       âœ“ should combine select with pagination options
2025-04-15T01:04:38.0523019Z 
2025-04-15T01:04:39.0114508Z PASS src/environments.ee/source-control/__tests__/source-control.service.test.ts
2025-04-15T01:04:39.0115678Z   SourceControlService
2025-04-15T01:04:39.0116562Z     pushWorkfolder
2025-04-15T01:04:39.0118354Z       âœ“ should throw an error if a file is given that is not in the workfolder (33 ms)
2025-04-15T01:04:39.0119135Z     pullWorkfolder
2025-04-15T01:04:39.0124107Z       âœ“ does not filter locally created credentials (3 ms)
2025-04-15T01:04:39.0127139Z       âœ“ does not filter remotely deleted credentials (1 ms)
2025-04-15T01:04:39.0129903Z       âœ“ should throw an error if a file is given that is not in the workfolder (2 ms)
2025-04-15T01:04:39.0137753Z     getStatus
2025-04-15T01:04:39.0138462Z       âœ“ conflict depends on the value of `direction` (7 ms)
2025-04-15T01:04:39.0138879Z 
2025-04-15T01:04:39.5085060Z PASS src/environments.ee/source-control/__tests__/source-control-export.service.test.ts
2025-04-15T01:04:39.5086420Z   SourceControlExportService
2025-04-15T01:04:39.5095569Z     exportCredentialsToWorkFolder
2025-04-15T01:04:39.5096542Z       âœ“ should export credentials to work folder (23 ms)
2025-04-15T01:04:39.5097322Z       âœ“ should handle team project credentials (2 ms)
2025-04-15T01:04:39.5098057Z       âœ“ should handle missing credentials (7 ms)
2025-04-15T01:04:39.5098571Z     exportTagsToWorkFolder
2025-04-15T01:04:39.5099204Z       âœ“ should export tags to work folder (2 ms)
2025-04-15T01:04:39.5099822Z       âœ“ should not export empty tags (1 ms)
2025-04-15T01:04:39.5100306Z     exportFoldersToWorkFolder
2025-04-15T01:04:39.5100904Z       âœ“ should export folders to work folder (1 ms)
2025-04-15T01:04:39.5101742Z       âœ“ should not export empty folders (1 ms)
2025-04-15T01:04:39.5102281Z     exportVariablesToWorkFolder
2025-04-15T01:04:39.5104091Z       âœ“ should export variables to work folder (1 ms)
2025-04-15T01:04:39.5105158Z       âœ“ should not export empty variables (1 ms)
2025-04-15T01:04:39.5113294Z     exportWorkflowsToWorkFolder
2025-04-15T01:04:39.5113908Z       âœ“ should export workflows to work folder (2 ms)
2025-04-15T01:04:39.5114621Z       âœ“ should throw an error if workflow has no owner (30 ms)
2025-04-15T01:04:39.5115009Z 
2025-04-15T01:04:43.0471788Z PASS src/metrics/__tests__/prometheus-metrics.service.test.ts
2025-04-15T01:04:43.0473094Z   PrometheusMetricsService
2025-04-15T01:04:43.0473856Z     constructor
2025-04-15T01:04:43.0474751Z       âœ“ should enable metrics based on global config (8 ms)
2025-04-15T01:04:43.0475298Z     init
2025-04-15T01:04:43.0475847Z       âœ“ should set up `n8n_version_info` (1 ms)
2025-04-15T01:04:43.0476725Z       âœ“ should set up default metrics collection with `prom-client` (2 ms)
2025-04-15T01:04:43.0477608Z       âœ“ should set up `n8n_cache_hits_total` (1 ms)
2025-04-15T01:04:43.0478343Z       âœ“ should set up `n8n_cache_misses_total` (2 ms)
2025-04-15T01:04:43.0479096Z       âœ“ should set up `n8n_cache_updates_total` (2 ms)
2025-04-15T01:04:43.0480007Z       âœ“ should set up route metrics with `express-prom-bundle` (2 ms)
2025-04-15T01:04:43.0480812Z       âœ“ should set up event bus metrics (1 ms)
2025-04-15T01:04:43.0481732Z       âœ“ should set up queue metrics if enabled (3 ms)
2025-04-15T01:04:43.0482715Z       âœ“ should not set up queue metrics if enabled but not on scaling mode (1 ms)
2025-04-15T01:04:43.0483931Z       âœ“ should not set up queue metrics if enabled and on scaling mode but instance is not main (2 ms)
2025-04-15T01:04:43.0485422Z       âœ“ should setup active workflow count metric (4 ms)
2025-04-15T01:04:43.0485833Z 
2025-04-15T01:04:44.1762102Z PASS src/__tests__/workflow-execute-additional-data.test.ts
2025-04-15T01:04:44.1764037Z   WorkflowExecuteAdditionalData
2025-04-15T01:04:44.1765175Z     âœ“ logAiEvent should call MessageEventBus (6 ms)
2025-04-15T01:04:44.1765804Z     executeWorkflow
2025-04-15T01:04:44.1767236Z       âœ“ should execute workflow, return data and execution id (11 ms)
2025-04-15T01:04:44.1768209Z       âœ“ should execute workflow, skip waiting (3 ms)
2025-04-15T01:04:44.1769062Z       âœ“ should set sub workflow execution as running (2 ms)
2025-04-15T01:04:44.1770068Z       âœ“ should return waitTill property when workflow execution is waiting (3 ms)
2025-04-15T01:04:44.1770759Z     getRunData
2025-04-15T01:04:44.1771358Z       âœ“ should throw error to add trigger ndoe (29 ms)
2025-04-15T01:04:44.1772734Z       âœ“ should return default data (2 ms)
2025-04-15T01:04:44.1773585Z       âœ“ should return run data with input data and metadata (1 ms)
2025-04-15T01:04:44.1774056Z 
2025-04-15T01:04:46.5774461Z PASS test/integration/community-packages.api.test.ts (7.309 s)
2025-04-15T01:04:46.5778141Z   GET /community-packages
2025-04-15T01:04:46.5780162Z     âœ“ should respond 200 if no nodes are installed (45 ms)
2025-04-15T01:04:46.5783147Z     âœ“ should return list of one installed package and node (7 ms)
2025-04-15T01:04:46.5788850Z     âœ“ should return list of multiple installed packages and nodes (8 ms)
2025-04-15T01:04:46.5791878Z     âœ“ should not check for updates if no packages installed (21 ms)
2025-04-15T01:04:46.5795730Z     âœ“ should check for updates if packages installed (7 ms)
2025-04-15T01:04:46.5796604Z     âœ“ should report package updates if available (6 ms)
2025-04-15T01:04:46.5797176Z   POST /community-packages
2025-04-15T01:04:46.5797860Z     âœ“ should reject if package name is missing (7 ms)
2025-04-15T01:04:46.5798614Z     âœ“ should reject if package is duplicate (8 ms)
2025-04-15T01:04:46.5799552Z     âœ“ should allow installing packages that could not be loaded (7 ms)
2025-04-15T01:04:46.5800424Z     âœ“ should not install a banned package (8 ms)
2025-04-15T01:04:46.5800967Z   DELETE /community-packages
2025-04-15T01:04:46.5801876Z     âœ“ should not delete if package name is empty (7 ms)
2025-04-15T01:04:46.5802708Z     âœ“ should reject if package is not installed (7 ms)
2025-04-15T01:04:46.5803429Z     âœ“ should uninstall package (7 ms)
2025-04-15T01:04:46.5803947Z   PATCH /community-packages
2025-04-15T01:04:46.5805114Z     âœ“ should reject if package name is empty (6 ms)
2025-04-15T01:04:46.5805876Z     âœ“ should reject if package is not installed (6 ms)
2025-04-15T01:04:46.5806576Z     âœ“ should update a package (11 ms)
2025-04-15T01:04:46.5806895Z 
2025-04-15T01:04:50.0545985Z PASS src/services/__tests__/workflow-statistics.service.test.ts
2025-04-15T01:04:50.0550139Z   WorkflowStatisticsService
2025-04-15T01:04:50.0550633Z     workflowExecutionCompleted
2025-04-15T01:04:50.0551752Z       âœ“ should create metrics for production successes (9 ms)
2025-04-15T01:04:50.0552532Z       âœ“ should only create metrics for production successes
2025-04-15T01:04:50.0553269Z       âœ“ should not send metrics for updated entries (1 ms)
2025-04-15T01:04:50.0553771Z     nodeFetchedData
2025-04-15T01:04:50.0554325Z       âœ“ should create metrics when the db is updated (2 ms)
2025-04-15T01:04:50.0555206Z       âœ“ should emit event with no `userId` if workflow is owned by team project (1 ms)
2025-04-15T01:04:50.0556192Z       âœ“ should create metrics with credentials when the db is updated (1 ms)
2025-04-15T01:04:50.0557123Z       âœ“ should not send metrics for entries that already have the flag set (2 ms)
2025-04-15T01:04:50.0557546Z 
2025-04-15T01:04:51.1602961Z PASS test/integration/workflow-history.api.test.ts (7.868 s)
2025-04-15T01:04:51.1603733Z   GET /workflow-history/:workflowId
2025-04-15T01:04:51.1604650Z     âœ“ should not work when license is not available (27 ms)
2025-04-15T01:04:51.1605878Z     âœ“ should not return anything on an invalid workflow ID (42 ms)
2025-04-15T01:04:51.1606680Z     âœ“ should not return anything if not shared with user (24 ms)
2025-04-15T01:04:51.1607412Z     âœ“ should return any empty list if no versions (25 ms)
2025-04-15T01:04:51.1608057Z     âœ“ should return versions for workflow (60 ms)
2025-04-15T01:04:51.1608795Z     âœ“ should return versions only for workflow id provided (55 ms)
2025-04-15T01:04:51.1609475Z     âœ“ should work with take parameter (41 ms)
2025-04-15T01:04:51.1610082Z     âœ“ should work with skip parameter (39 ms)
2025-04-15T01:04:51.1610704Z   GET /workflow-history/workflow/:workflowId/version/:versionId
2025-04-15T01:04:51.1611479Z     âœ“ should not work when license is not available (11 ms)
2025-04-15T01:04:51.1612604Z     âœ“ should not return anything on an invalid workflow ID (16 ms)
2025-04-15T01:04:51.1613414Z     âœ“ should not return anything on an invalid version ID (21 ms)
2025-04-15T01:04:51.1614092Z     âœ“ should return version (28 ms)
2025-04-15T01:04:51.1614850Z     âœ“ should not return anything if not shared with user (23 ms)
2025-04-15T01:04:51.1615918Z     âœ“ should not return anything if not shared with user and using workflow owned by unshared user (31 ms)
2025-04-15T01:04:51.1616527Z 
2025-04-15T01:04:52.4642103Z PASS test/integration/commands/credentials.cmd.test.ts (7.956 s)
2025-04-15T01:04:52.4652764Z   âœ“ import:credentials should import a credential (67 ms)
2025-04-15T01:04:52.4653823Z   âœ“ import:credentials should import a credential from separated files (34 ms)
2025-04-15T01:04:52.4655356Z   âœ“ `import:credentials --userId ...` should fail if the credential exists already and is owned by somebody else (84 ms)
2025-04-15T01:04:52.4657074Z   âœ“ only update credential, don't create or update owner if neither `--userId` nor `--projectId` is passed (43 ms)
2025-04-15T01:04:52.4658782Z   âœ“ `import:credential --projectId ...` should fail if the credential already exists and is owned by another project (49 ms)
2025-04-15T01:04:52.4660608Z   âœ“ `import:credential --projectId ... --userId ...` fails explaining that only one of the options can be used at a time (5 ms)
2025-04-15T01:04:52.4661441Z 
2025-04-15T01:04:54.5794660Z PASS src/services/__tests__/ownership.service.test.ts
2025-04-15T01:04:54.5795402Z   OwnershipService
2025-04-15T01:04:54.5796697Z     getWorkflowProjectCached()
2025-04-15T01:04:54.5798106Z       âœ“ should retrieve a workflow owner project (13 ms)
2025-04-15T01:04:54.5798928Z       âœ“ should throw if no workflow owner project found (13 ms)
2025-04-15T01:04:54.5800060Z     getPersonalProjectOwnerCached()
2025-04-15T01:04:54.5801007Z       âœ“ should retrieve a project owner (1 ms)
2025-04-15T01:04:54.5802499Z       âœ“ should not throw if no project owner found, should return null instead (1 ms)
2025-04-15T01:04:54.5803756Z       âœ“ should not use the repository if the owner was found in the cache (3 ms)
2025-04-15T01:04:54.5806650Z     getProjectOwnerCached()
2025-04-15T01:04:54.5809440Z       âœ“ should retrieve a project owner
2025-04-15T01:04:54.5815213Z       âœ“ should not throw if no project owner found, should return null instead (1 ms)
2025-04-15T01:04:54.5815940Z     addOwnedByAndSharedWith()
2025-04-15T01:04:54.5816716Z       âœ“ should add `ownedBy` and `sharedWith` to credential (2 ms)
2025-04-15T01:04:54.5817646Z       âœ“ should add `ownedBy` and `sharedWith` to workflow (1 ms)
2025-04-15T01:04:54.5818831Z       âœ“ should produce an empty sharedWith if no sharee (1 ms)
2025-04-15T01:04:54.5819632Z     getInstanceOwner()
2025-04-15T01:04:54.5820520Z       âœ“ should find owner using global owner role ID (1 ms)
2025-04-15T01:04:54.5821104Z 
2025-04-15T01:04:54.6426629Z PASS src/__tests__/wait-tracker.test.ts
2025-04-15T01:04:54.6445560Z   WaitTracker
2025-04-15T01:04:54.6445944Z     init()
2025-04-15T01:04:54.6446796Z       âœ“ should query DB for waiting executions if leader (7 ms)
2025-04-15T01:04:54.6447572Z       âœ“ if follower, should do nothing (1 ms)
2025-04-15T01:04:54.6448322Z       âœ“ if no executions to start, should do nothing
2025-04-15T01:04:54.6449390Z       if execution to start
2025-04-15T01:04:54.6450180Z         âœ“ if not enough time passed, should not start execution (1 ms)
2025-04-15T01:04:54.6451093Z         âœ“ if enough time passed, should start execution (2 ms)
2025-04-15T01:04:54.6451887Z     startExecution()
2025-04-15T01:04:54.6452499Z       âœ“ should query for execution to start (2 ms)
2025-04-15T01:04:54.6453369Z       âœ“ should also resume parent execution once sub-workflow finishes (5 ms)
2025-04-15T01:04:54.6454024Z     single-main setup
2025-04-15T01:04:54.6454614Z       âœ“ should start tracking (1 ms)
2025-04-15T01:04:54.6455064Z     multi-main setup
2025-04-15T01:04:54.6455628Z       âœ“ should start tracking if leader (1 ms)
2025-04-15T01:04:54.6456305Z       âœ“ should not start tracking if follower (1 ms)
2025-04-15T01:04:54.6456659Z 
2025-04-15T01:04:55.7404978Z PASS src/services/cache/__tests__/cache.service.test.ts
2025-04-15T01:04:55.7409530Z   memory
2025-04-15T01:04:55.7413926Z     init
2025-04-15T01:04:55.7418677Z       âœ“ should select backend based on config (6 ms)
2025-04-15T01:04:55.7423608Z       âœ“ should honor max size when enough (2 ms)
2025-04-15T01:04:55.7428411Z       âœ“ should honor max size when not enough (1 ms)
2025-04-15T01:04:55.7433110Z     set
2025-04-15T01:04:55.7437373Z       âœ“ should set a string value
2025-04-15T01:04:55.7441345Z       âœ“ should set a number value
2025-04-15T01:04:55.7442478Z       âœ“ should set an object value (1 ms)
2025-04-15T01:04:55.7445556Z       âœ“ should not cache `null` or `undefined` values (1 ms)
2025-04-15T01:04:55.7446321Z       âœ“ should disregard zero-length keys
2025-04-15T01:04:55.7446919Z       âœ“ should honor ttl (201 ms)
2025-04-15T01:04:55.7447330Z     get
2025-04-15T01:04:55.7447834Z       âœ“ should fall back to fallback value (1 ms)
2025-04-15T01:04:55.7448470Z       âœ“ should refresh value (1 ms)
2025-04-15T01:04:55.7449067Z       âœ“ should handle non-ASCII key (1 ms)
2025-04-15T01:04:55.7449539Z     delete
2025-04-15T01:04:55.7450064Z       âœ“ should delete a key (1 ms)
2025-04-15T01:04:55.7450714Z       âœ“ should handle non-ASCII key (1 ms)
2025-04-15T01:04:55.7451202Z     setMany
2025-04-15T01:04:55.7452002Z       âœ“ should set multiple string values (1 ms)
2025-04-15T01:04:55.7452717Z       âœ“ should set multiple number values (1 ms)
2025-04-15T01:04:55.7453401Z       âœ“ should disregard zero-length keys (2 ms)
2025-04-15T01:04:55.7453880Z     getMany
2025-04-15T01:04:55.7454437Z       âœ“ should return undefined on missing result (1 ms)
2025-04-15T01:04:55.7454948Z     setHash
2025-04-15T01:04:55.7455882Z       âœ“ should set a hash if non-existing (1 ms)
2025-04-15T01:04:55.7456571Z       âœ“ should add to a hash value if existing (1 ms)
2025-04-15T01:04:55.7457071Z     deleteFromHash
2025-04-15T01:04:55.7457582Z       âœ“ should delete a hash field (1 ms)
2025-04-15T01:04:55.7458043Z     getHashValue
2025-04-15T01:04:55.7458566Z       âœ“ should return a hash field value (4 ms)
2025-04-15T01:04:55.7459032Z   redis
2025-04-15T01:04:55.7459324Z     init
2025-04-15T01:04:55.7459875Z       âœ“ should select backend based on config (2 ms)
2025-04-15T01:04:55.7460694Z       âœ“ with auto backend and queue mode, should select redis (1 ms)
2025-04-15T01:04:55.7461247Z     set
2025-04-15T01:04:55.7461898Z       âœ“ should set a string value (4 ms)
2025-04-15T01:04:55.7462497Z       âœ“ should set a number value (1 ms)
2025-04-15T01:04:55.7463051Z       âœ“ should set an object value
2025-04-15T01:04:55.7463733Z       âœ“ should not cache `null` or `undefined` values (4 ms)
2025-04-15T01:04:55.7464460Z       âœ“ should disregard zero-length keys
2025-04-15T01:04:55.7465086Z       âœ“ should honor ttl (202 ms)
2025-04-15T01:04:55.7465519Z     get
2025-04-15T01:04:55.7466072Z       âœ“ should fall back to fallback value (1 ms)
2025-04-15T01:04:55.7466667Z       âœ“ should refresh value
2025-04-15T01:04:55.7467190Z       âœ“ should handle non-ASCII key
2025-04-15T01:04:55.7467614Z     delete
2025-04-15T01:04:55.7468053Z       âœ“ should delete a key (1 ms)
2025-04-15T01:04:55.7468933Z       âœ“ should handle non-ASCII key
2025-04-15T01:04:55.7469358Z     setMany
2025-04-15T01:04:55.7469858Z       âœ“ should set multiple string values (1 ms)
2025-04-15T01:04:55.7470506Z       âœ“ should set multiple number values (1 ms)
2025-04-15T01:04:55.7471182Z       âœ“ should disregard zero-length keys (1 ms)
2025-04-15T01:04:55.7471857Z     getMany
2025-04-15T01:04:55.7472422Z       âœ“ should return undefined on missing result (1 ms)
2025-04-15T01:04:55.7472924Z     setHash
2025-04-15T01:04:55.7473421Z       âœ“ should set a hash if non-existing (1 ms)
2025-04-15T01:04:55.7474125Z       âœ“ should add to a hash value if existing (1 ms)
2025-04-15T01:04:55.7474609Z     deleteFromHash
2025-04-15T01:04:55.7475105Z       âœ“ should delete a hash field (1 ms)
2025-04-15T01:04:55.7475549Z     getHashValue
2025-04-15T01:04:55.7476031Z       âœ“ should return a hash field value
2025-04-15T01:04:55.7476360Z 
2025-04-15T01:05:00.4217578Z PASS test/integration/executions/pre-execution-checks/credentials-permission-checker.test.ts (5.625 s)
2025-04-15T01:05:00.4240150Z   check()
2025-04-15T01:05:00.4241157Z     âœ“ should allow if workflow has no creds (23 ms)
2025-04-15T01:05:00.4242200Z     âœ“ should allow if workflow creds are valid subset (34 ms)
2025-04-15T01:05:00.4243093Z     âœ“ should deny if workflow creds are not valid subset (33 ms)
2025-04-15T01:05:00.4244096Z     âœ“ should allow all credentials if current user is instance owner (22 ms)
2025-04-15T01:05:00.4244625Z 
2025-04-15T01:05:00.5179945Z PASS src/environments.ee/source-control/__tests__/source-control-helper.ee.test.ts
2025-04-15T01:05:00.5180909Z   Source Control
2025-04-15T01:05:00.5181883Z     âœ“ should generate an SSH key pair (122 ms)
2025-04-15T01:05:00.5182570Z     âœ“ should generate an RSA key pair (1438 ms)
2025-04-15T01:05:00.5183445Z     âœ“ should check for git and ssh folders and create them if required (2 ms)
2025-04-15T01:05:00.5184313Z     âœ“ should get repo type from url (1 ms)
2025-04-15T01:05:00.5185131Z     âœ“ should get tracking information from pre-push results (4 ms)
2025-04-15T01:05:00.5186026Z     âœ“ should get tracking information from post-push results
2025-04-15T01:05:00.5186875Z     âœ“ should get tracking information from pull results (1 ms)
2025-04-15T01:05:00.5187291Z 
2025-04-15T01:05:03.1260277Z PASS test/integration/public-api/users.ee.test.ts (8.236 s)
2025-04-15T01:05:03.1265332Z   With license unlimited quota:users
2025-04-15T01:05:03.1270187Z     GET /users
2025-04-15T01:05:03.1275022Z       âœ“ should fail due to missing API Key (494 ms)
2025-04-15T01:05:03.1279718Z       âœ“ should fail due to invalid API Key (16 ms)
2025-04-15T01:05:03.1283696Z       âœ“ should return all users (221 ms)
2025-04-15T01:05:03.1292405Z       âœ“ should return users filtered by project ID (57 ms)
2025-04-15T01:05:03.1292995Z     GET /users/:id
2025-04-15T01:05:03.1293594Z       âœ“ should fail due to missing API Key (26 ms)
2025-04-15T01:05:03.1294906Z       âœ“ should fail due to invalid API Key (16 ms)
2025-04-15T01:05:03.1297540Z       âœ“ should fail due to member trying to access owner only endpoint (20 ms)
2025-04-15T01:05:03.1299455Z       âœ“ should return 404 for non-existing id  (16 ms)
2025-04-15T01:05:03.1300148Z       âœ“ should return a pending user (38 ms)
2025-04-15T01:05:03.1300613Z     GET /users/:email
2025-04-15T01:05:03.1301221Z       âœ“ with non-existing email should return 404 (27 ms)
2025-04-15T01:05:03.1302103Z       âœ“ should return a user (19 ms)
2025-04-15T01:05:03.1302618Z   With license without quota:users
2025-04-15T01:05:03.1303336Z     âœ“ GET /users should fail due to invalid license (28 ms)
2025-04-15T01:05:03.1304190Z     âœ“ GET /users/:id should fail due to invalid license (21 ms)
2025-04-15T01:05:03.1304611Z 
2025-04-15T01:05:03.9150092Z PASS src/controllers/__tests__/binary-data.controller.test.ts
2025-04-15T01:05:03.9153166Z   BinaryDataController
2025-04-15T01:05:03.9155439Z     get
2025-04-15T01:05:03.9157777Z       âœ“ should return 400 if binary data mode is missing (9 ms)
2025-04-15T01:05:03.9163726Z       âœ“ should return 400 if binary data mode is invalid (1 ms)
2025-04-15T01:05:03.9164907Z       âœ“ should return 404 if file is not found (2 ms)
2025-04-15T01:05:03.9165761Z       âœ“ should set Content-Type and Content-Length from query if provided (2 ms)
2025-04-15T01:05:03.9166749Z       âœ“ should set Content-Type and Content-Length from metadata if not provided (1 ms)
2025-04-15T01:05:03.9167574Z       âœ“ should set Content-Disposition for download action
2025-04-15T01:05:03.9168348Z       âœ“ should set Content-Security-Policy for HTML in view mode (12 ms)
2025-04-15T01:05:03.9169250Z       âœ“ should not set Content-Security-Policy for HTML in download mode (1 ms)
2025-04-15T01:05:03.9170011Z       âœ“ should return the file stream on success (1 ms)
2025-04-15T01:05:03.9170446Z     getSigned
2025-04-15T01:05:03.9170985Z       âœ“ should return 400 if binary data mode is missing (1 ms)
2025-04-15T01:05:03.9171856Z       âœ“ should return 400 if binary data mode is invalid (2 ms)
2025-04-15T01:05:03.9172551Z       âœ“ should return 400 if token is invalid (1 ms)
2025-04-15T01:05:03.9173194Z       âœ“ should return 404 if file is not found (1 ms)
2025-04-15T01:05:03.9173901Z       âœ“ should return the file stream on a valid signed token (1 ms)
2025-04-15T01:05:03.9174286Z 
2025-04-15T01:05:07.7122187Z PASS src/environments.ee/source-control/__tests__/source-control-import.service.ee.test.ts
2025-04-15T01:05:07.7123495Z   SourceControlImportService
2025-04-15T01:05:07.7124162Z     getRemoteVersionIdsFromFiles
2025-04-15T01:05:07.7125199Z       âœ“ should parse workflow files correctly (5 ms)
2025-04-15T01:05:07.7126219Z       âœ“ should filter out files without valid workflow data
2025-04-15T01:05:07.7126981Z     getRemoteCredentialsFromFiles
2025-04-15T01:05:07.7127814Z       âœ“ should parse credential files correctly (1 ms)
2025-04-15T01:05:07.7128831Z       âœ“ should filter out files without valid credential data (1 ms)
2025-04-15T01:05:07.7129637Z     getRemoteVariablesFromFile
2025-04-15T01:05:07.7130415Z       âœ“ should parse variables file correctly
2025-04-15T01:05:07.7131396Z       âœ“ should return empty array if no variables file found (1 ms)
2025-04-15T01:05:07.7132582Z     getRemoteTagsAndMappingsFromFile
2025-04-15T01:05:07.7133523Z       âœ“ should parse tags and mappings file correctly (1 ms)
2025-04-15T01:05:07.7134514Z       âœ“ should return empty tags and mappings if no file found
2025-04-15T01:05:07.7135339Z     getRemoteFoldersAndMappingsFromFile
2025-04-15T01:05:07.7136282Z       âœ“ should parse folders and mappings file correctly (1 ms)
2025-04-15T01:05:07.7137824Z       âœ“ should return empty folders and mappings if no file found (1 ms)
2025-04-15T01:05:07.7139081Z     getLocalVersionIdsFromDb
2025-04-15T01:05:07.7139930Z       âœ“ should replace invalid updatedAt with current timestamp
2025-04-15T01:05:07.7144061Z     getLocalFoldersAndMappingsFromDb
2025-04-15T01:05:07.7144914Z       âœ“ should return data from DB (2 ms)
2025-04-15T01:05:07.7145355Z 
2025-04-15T01:05:07.8745095Z PASS test/integration/workflows/workflow.service.ee.test.ts (7.239 s)
2025-04-15T01:05:07.8750400Z   EnterpriseWorkflowService
2025-04-15T01:05:07.8755292Z     validateWorkflowCredentialUsage
2025-04-15T01:05:07.8760663Z       âœ“ Should throw error saving a workflow using credential without access (37 ms)
2025-04-15T01:05:07.8766959Z       âœ“ Should not throw error when saving a workflow using credential with access (1 ms)
2025-04-15T01:05:07.8770644Z       âœ“ Should not throw error when saving a workflow removing node without credential access (2 ms)
2025-04-15T01:05:07.8772157Z       âœ“ Should save fine when not making changes to workflow without access (2 ms)
2025-04-15T01:05:07.8773740Z       âœ“ Should throw error saving a workflow adding node without credential access (3 ms)
2025-04-15T01:05:07.8775818Z     getNodesWithInaccessibleCreds
2025-04-15T01:05:07.8776690Z       âœ“ Should return an empty list for a workflow without nodes (1 ms)
2025-04-15T01:05:07.8777814Z       âœ“ Should return an empty list for a workflow with nodes without credentials (2 ms)
2025-04-15T01:05:07.8778970Z       âœ“ Should return an element for a node with a credential without access (1 ms)
2025-04-15T01:05:07.8780578Z       âœ“ Should return an empty list for a node with a credential with access (2 ms)
2025-04-15T01:05:07.8783820Z       âœ“ Should return an element for a node with two credentials and mixed access (1 ms)
2025-04-15T01:05:07.8785047Z       âœ“ Should return one node for a workflow with two nodes and two credentials (1 ms)
2025-04-15T01:05:07.8786243Z       âœ“ Should return one element for a workflows with two nodes and one credential (2 ms)
2025-04-15T01:05:07.8787585Z       âœ“ Should return one element for a workflows with two nodes and partial credential access (1 ms)
2025-04-15T01:05:07.8788966Z       âœ“ Should return two elements for a workflows with two nodes and partial credential access (1 ms)
2025-04-15T01:05:07.8790336Z       âœ“ Should return two elements for a workflows with two nodes and no credential access (1 ms)
2025-04-15T01:05:07.8790967Z 
2025-04-15T01:05:08.6001037Z PASS src/controllers/__tests__/dynamic-node-parameters.controller.test.ts
2025-04-15T01:05:08.6005570Z   DynamicNodeParametersController
2025-04-15T01:05:08.6009260Z     getOptions
2025-04-15T01:05:08.6013625Z       âœ“ should call getOptionsViaMethodName when methodName is provided (8 ms)
2025-04-15T01:05:08.6017945Z       âœ“ should call getOptionsViaLoadOptions when loadOptions is provided (1 ms)
2025-04-15T01:05:08.6022177Z       âœ“ should return empty array when no method or load options are provided
2025-04-15T01:05:08.6025941Z     getResourceLocatorResults
2025-04-15T01:05:08.6029671Z       âœ“ should call getResourceLocatorResults with correct parameters (2 ms)
2025-04-15T01:05:08.6032368Z     getResourceMappingFields
2025-04-15T01:05:08.6034826Z       âœ“ should call getResourceMappingFields with correct parameters (1 ms)
2025-04-15T01:05:08.6035518Z     getLocalResourceMappingFields
2025-04-15T01:05:08.6036569Z       âœ“ should call getLocalResourceMappingFields with correct parameters (1 ms)
2025-04-15T01:05:08.6037827Z     getActionResult
2025-04-15T01:05:08.6040336Z       âœ“ should call getActionResult with correct parameters (1 ms)
2025-04-15T01:05:08.6041040Z 
2025-04-15T01:05:14.7670623Z PASS test/integration/security-audit/instance-risk-reporter.test.ts (6.617 s)
2025-04-15T01:05:14.7675665Z   âœ“ should report webhook lacking authentication (344 ms)
2025-04-15T01:05:14.7686139Z   âœ“ should not report webhooks having basic or header auth (22 ms)
2025-04-15T01:05:14.7687105Z   âœ“ should not report webhooks validated by direct children (27 ms)
2025-04-15T01:05:14.7687897Z   âœ“ should not report non-webhook node (13 ms)
2025-04-15T01:05:14.7689069Z   âœ“ should report outdated instance when outdated (9 ms)
2025-04-15T01:05:14.7689939Z   âœ“ should not report outdated instance when up to date (103 ms)
2025-04-15T01:05:14.7690936Z   âœ“ should report security settings (8 ms)
2025-04-15T01:05:14.7693391Z 
2025-04-15T01:05:17.1019994Z PASS src/webhooks/__tests__/webhook-request-handler.test.ts
2025-04-15T01:05:17.1023416Z   WebhookRequestHandler
2025-04-15T01:05:17.1027966Z     âœ“ should throw for unsupported methods (22 ms)
2025-04-15T01:05:17.1032325Z     preflight requests
2025-04-15T01:05:17.1036587Z       âœ“ should handle missing header for requested method (2 ms)
2025-04-15T01:05:17.1040913Z       âœ“ should handle default origin and max-age (1 ms)
2025-04-15T01:05:17.1045313Z       âœ“ should handle wildcard origin (1 ms)
2025-04-15T01:05:17.1049444Z       âœ“ should handle custom origin (1 ms)
2025-04-15T01:05:17.1053610Z     webhook requests
2025-04-15T01:05:17.1057912Z       âœ“ should delegate the request to the webhook manager and send the response (1 ms)
2025-04-15T01:05:17.1062971Z       âœ“ should send an error response if webhook execution throws (7 ms)
2025-04-15T01:05:17.1066266Z       âœ“ should handle 'DELETE' method (2 ms)
2025-04-15T01:05:17.1068952Z       âœ“ should handle 'GET' method (1 ms)
2025-04-15T01:05:17.1071770Z       âœ“ should handle 'HEAD' method (1 ms)
2025-04-15T01:05:17.1084325Z       âœ“ should handle 'PATCH' method (1 ms)
2025-04-15T01:05:17.1085469Z       âœ“ should handle 'POST' method (1 ms)
2025-04-15T01:05:17.1086084Z       âœ“ should handle 'PUT' method (1 ms)
2025-04-15T01:05:17.1086407Z 
2025-04-15T01:05:21.8695741Z PASS test/integration/public-api/users.test.ts (13.838 s)
2025-04-15T01:05:21.8697070Z   Users in Public API
2025-04-15T01:05:21.8697997Z     POST /users
2025-04-15T01:05:21.8701462Z       âœ“ if not authenticated, should reject (31 ms)
2025-04-15T01:05:21.8705649Z       âœ“ if missing scope, should reject (224 ms)
2025-04-15T01:05:21.8706336Z       âœ“ should create a user (79 ms)
2025-04-15T01:05:21.8706841Z     DELETE /users/:id
2025-04-15T01:05:21.8707452Z       âœ“ if not authenticated, should reject (19 ms)
2025-04-15T01:05:21.8708154Z       âœ“ if missing scope, should reject (33 ms)
2025-04-15T01:05:21.8708777Z       âœ“ should delete a user (69 ms)
2025-04-15T01:05:21.8709222Z     PATCH /users/:id/role
2025-04-15T01:05:21.8709788Z       âœ“ if not authenticated, should reject (15 ms)
2025-04-15T01:05:21.8710502Z       âœ“ if not licensed, should reject (31 ms)
2025-04-15T01:05:21.8712099Z       âœ“ if missing scope, should reject (27 ms)
2025-04-15T01:05:21.8712844Z       âœ“ should return a 400 on invalid payload (22 ms)
2025-04-15T01:05:21.8713544Z       âœ“ should change a user's role (33 ms)
2025-04-15T01:05:21.8713900Z 
2025-04-15T01:05:22.0728632Z PASS src/webhooks/__tests__/test-webhooks.test.ts
2025-04-15T01:05:22.0729334Z   TestWebhooks
2025-04-15T01:05:22.0729701Z     needsWebhook()
2025-04-15T01:05:22.0730758Z       âœ“ if webhook is needed, should register then create webhook and return true (7 ms)
2025-04-15T01:05:22.0732907Z       âœ“ if webhook activation fails, should deactivate workflow webhooks (16 ms)
2025-04-15T01:05:22.0733992Z       âœ“ if no webhook is found to start workflow, should return false (1 ms)
2025-04-15T01:05:22.0734985Z       âœ“ returns false if a triggerToStartFrom with triggerData is given
2025-04-15T01:05:22.0736311Z       âœ“ returns true, registers and then creates webhook if triggerToStartFrom is given with no triggerData (1 ms)
2025-04-15T01:05:22.0737199Z     executeWebhook()
2025-04-15T01:05:22.0737833Z       âœ“ if webhook is not registered, should throw (9 ms)
2025-04-15T01:05:22.0738796Z       âœ“ if webhook is registered but missing from workflow, should throw (1 ms)
2025-04-15T01:05:22.0739457Z     deactivateWebhooks()
2025-04-15T01:05:22.0740066Z       âœ“ should add additional data to workflow (2 ms)
2025-04-15T01:05:22.0740440Z 
2025-04-15T01:05:22.3315630Z PASS test/integration/webhooks.api.test.ts (13.507 s)
2025-04-15T01:05:22.3316303Z   Webhook API
2025-04-15T01:05:22.3317112Z     Content-Type support
2025-04-15T01:05:22.3317871Z       âœ“ should handle JSON (38 ms)
2025-04-15T01:05:22.3318427Z       âœ“ should handle XML (16 ms)
2025-04-15T01:05:22.3319020Z       âœ“ should handle form-urlencoded (11 ms)
2025-04-15T01:05:22.3319655Z       âœ“ should handle plain text (11 ms)
2025-04-15T01:05:22.3320301Z       âœ“ should handle multipart/form-data (26 ms)
2025-04-15T01:05:22.3320791Z     Params support
2025-04-15T01:05:22.3321743Z       âœ“ should handle params (46 ms)
2025-04-15T01:05:22.3322065Z 
2025-04-15T01:05:41.0221751Z PASS test/integration/import.service.test.ts (18.715 s)
2025-04-15T01:05:41.0238499Z   ImportService
2025-04-15T01:05:41.0241411Z     âœ“ should import credless and tagless workflow (56 ms)
2025-04-15T01:05:41.0318076Z     âœ“ should make user owner of imported workflow (19 ms)
2025-04-15T01:05:41.0319095Z     âœ“ should not change the owner if it already exists (71 ms)
2025-04-15T01:05:41.0319916Z     âœ“ should deactivate imported workflow if active (71 ms)
2025-04-15T01:05:41.0320746Z     âœ“ should leave intact new-format credentials (24 ms)
2025-04-15T01:05:41.0321452Z     âœ“ should set tag by identical match (60 ms)
2025-04-15T01:05:41.0322364Z     âœ“ should set tag by name match (31 ms)
2025-04-15T01:05:41.0326207Z     âœ“ should set tag by creating if no match (27 ms)
2025-04-15T01:05:41.0327108Z 
2025-04-15T01:05:41.0380733Z PASS test/integration/security-audit/credentials-risk-reporter.test.ts (18.456 s)
2025-04-15T01:05:41.0382168Z   âœ“ should report credentials not in any use (261 ms)
2025-04-15T01:05:41.0384711Z   âœ“ should report credentials not in active use (45 ms)
2025-04-15T01:05:41.0385628Z   âœ“ should report credential in not recently executed workflow (67 ms)
2025-04-15T01:05:41.0386602Z   âœ“ should not report credentials in recently executed workflow (27 ms)
2025-04-15T01:05:41.0387113Z 
2025-04-15T01:05:43.1904318Z PASS src/__tests__/workflow-runner.test.ts (21.121 s)
2025-04-15T01:05:43.1906244Z   processError
2025-04-15T01:05:43.1907303Z     âœ“ processError should return early in Bull stalled edge case (173 ms)
2025-04-15T01:05:43.1908403Z     âœ“ processError should return early if the error is `ExecutionNotFoundError` (27 ms)
2025-04-15T01:05:43.1909289Z     âœ“ processError should process error (40 ms)
2025-04-15T01:05:43.1909739Z   run
2025-04-15T01:05:43.1910760Z     âœ“ uses recreateNodeExecutionStack to create a partial execution if a triggerToStartFrom with data is sent (30 ms)
2025-04-15T01:05:43.1912813Z     âœ“ does not use recreateNodeExecutionStack to create a partial execution if a triggerToStartFrom without data is sent (5 ms)
2025-04-15T01:05:43.1913643Z 
2025-04-15T01:05:44.2652893Z PASS src/push/__tests__/index.test.ts
2025-04-15T01:05:44.2654647Z   Push
2025-04-15T01:05:44.2654995Z     setupPushServer
2025-04-15T01:05:44.2655356Z       sse backend
2025-04-15T01:05:44.2656133Z         âœ“ should not create a WebSocket server (7 ms)
2025-04-15T01:05:44.2656660Z       websocket backend
2025-04-15T01:05:44.2657253Z         âœ“ should not upgrade non-push urls (3 ms)
2025-04-15T01:05:44.2658555Z         âœ“ should upgrade push url, and route it to express (4 ms)
2025-04-15T01:05:44.2659151Z     handleRequest
2025-04-15T01:05:44.2659502Z       sse backend
2025-04-15T01:05:44.2660070Z         âœ“ should throw if pushRef is invalid (2 ms)
2025-04-15T01:05:44.2660879Z         âœ“ should add the connection if pushRef is valid (2 ms)
2025-04-15T01:05:44.2661505Z         should throw on invalid origin
2025-04-15T01:05:44.2662399Z           âœ“ https://subdomain.example.com (20 ms)
2025-04-15T01:05:44.2663075Z           âœ“ https://123example.com (1 ms)
2025-04-15T01:05:44.2663627Z           âœ“ undefined (1 ms)
2025-04-15T01:05:44.2664026Z       websocket backend
2025-04-15T01:05:44.2664565Z         âœ“ should throw if pushRef is invalid (1 ms)
2025-04-15T01:05:44.2665283Z         âœ“ should add the connection if pushRef is valid (1 ms)
2025-04-15T01:05:44.2666121Z         âœ“ should respond with 401 if request is not WebSocket (1 ms)
2025-04-15T01:05:44.2666730Z         should throw on invalid origin
2025-04-15T01:05:44.2667399Z           âœ“ https://subdomain.example.com (1 ms)
2025-04-15T01:05:44.2668051Z           âœ“ https://123example.com (1 ms)
2025-04-15T01:05:44.2668581Z           âœ“ undefined (10 ms)
2025-04-15T01:05:44.2668846Z 
2025-04-15T01:05:45.7270503Z PASS src/webhooks/__tests__/waiting-forms.test.ts
2025-04-15T01:05:45.7275291Z   WaitingForms
2025-04-15T01:05:45.7277666Z     findCompletionPage
2025-04-15T01:05:45.7280607Z       âœ“ should return lastNodeExecuted if it is a non-disabled form completion node (16 ms)
2025-04-15T01:05:45.7283425Z       âœ“ should return undefined if lastNodeExecuted is disabled (1 ms)
2025-04-15T01:05:45.7293899Z       âœ“ should return undefined if lastNodeExecuted is not a form node (5 ms)
2025-04-15T01:05:45.7295177Z       âœ“ should return undefined if lastNodeExecuted operation is not completion (1 ms)
2025-04-15T01:05:45.7297543Z       âœ“ should find first valid completion form in parent nodes if lastNodeExecuted is not valid (2 ms)
2025-04-15T01:05:45.7300377Z       âœ“ should return undefined if no valid completion form is found in parent nodes (1 ms)
2025-04-15T01:05:45.7301794Z       âœ“ should skip parent nodes without runData (21 ms)
2025-04-15T01:05:45.7302722Z       âœ“ should mark as test form webhook when execution mode is manual (1 ms)
2025-04-15T01:05:45.7303856Z       âœ“ should return status of execution if suffix is WAITING_FORMS_EXECUTION_STATUS (8 ms)
2025-04-15T01:05:45.7304423Z 
2025-04-15T01:05:47.5548315Z PASS src/services/pruning/__tests__/pruning.service.test.ts
2025-04-15T01:05:47.5553617Z   PruningService
2025-04-15T01:05:47.5556406Z     init
2025-04-15T01:05:47.5559694Z       âœ“ should start pruning on main instance that is the leader (8 ms)
2025-04-15T01:05:47.5563568Z       âœ“ should not start pruning on main instance that is a follower (1 ms)
2025-04-15T01:05:47.5566407Z       âœ“ should register leadership events if main on multi-main setup (2 ms)
2025-04-15T01:05:47.5571883Z     isEnabled
2025-04-15T01:05:47.5582725Z       âœ“ should return `true` based on config if leader main (1 ms)
2025-04-15T01:05:47.5583669Z       âœ“ should return `false` based on config if leader main (1 ms)
2025-04-15T01:05:47.5584624Z       âœ“ should return `false` if non-main even if config is enabled (1 ms)
2025-04-15T01:05:47.5585657Z       âœ“ should return `false` if follower main even if config is enabled (1 ms)
2025-04-15T01:05:47.5586299Z     startPruning
2025-04-15T01:05:47.5586896Z       âœ“ should not start pruning if service is disabled
2025-04-15T01:05:47.5587810Z       âœ“ should start pruning if service is enabled and DB is migrated (1 ms)
2025-04-15T01:05:47.5588299Z 
2025-04-15T01:05:49.5847752Z PASS test/integration/task-runners/js-task-runner-execution.integration.test.ts (6.173 s)
2025-04-15T01:05:49.5855658Z   JS TaskRunner execution on internal mode
2025-04-15T01:05:49.5857583Z     Basic code execution
2025-04-15T01:05:49.5859693Z       âœ“ should execute a simple JS task (1406 ms)
2025-04-15T01:05:49.5861471Z     Internal and external libs
2025-04-15T01:05:49.5883289Z       âœ“ should allow importing allowed internal module (1426 ms)
2025-04-15T01:05:49.5884169Z       âœ“ should not allow importing disallowed internal module (10 ms)
2025-04-15T01:05:49.5885011Z       âœ“ should allow importing allowed external module (10 ms)
2025-04-15T01:05:49.5885882Z       âœ“ should not allow importing disallowed external module (7 ms)
2025-04-15T01:05:49.5886317Z 
2025-04-15T01:05:50.7059441Z PASS src/__tests__/credentials-helper.test.ts
2025-04-15T01:05:50.7060142Z   CredentialsHelper
2025-04-15T01:05:50.7060508Z     authenticate
2025-04-15T01:05:50.7061272Z       âœ“ basicAuth, default property names (26 ms)
2025-04-15T01:05:50.7063352Z       âœ“ headerAuth (1 ms)
2025-04-15T01:05:50.7063981Z       âœ“ headerAuth, key and value expressions (2 ms)
2025-04-15T01:05:50.7064584Z       âœ“ queryAuth (1 ms)
2025-04-15T01:05:50.7065072Z       âœ“ custom authentication
2025-04-15T01:05:50.7065363Z 
2025-04-15T01:05:52.7799935Z PASS src/commands/db/__tests__/revert.test.ts
2025-04-15T01:05:52.7802731Z   âœ“ don't revert migrations if there is no migration (7 ms)
2025-04-15T01:05:52.7804968Z   âœ“ don't revert the last migration if it had no down migration (1 ms)
2025-04-15T01:05:52.7813117Z   âœ“ print migration name instead of class name in error message if the migration has a name (6 ms)
2025-04-15T01:05:52.7814375Z   âœ“ don't revert the last migration if we cannot find the migration in the code (1 ms)
2025-04-15T01:05:52.7815330Z   âœ“ revert the last migration if it has a down migration
2025-04-15T01:05:52.7816771Z   âœ“ don't use transaction if the last migration has transaction = false (1 ms)
2025-04-15T01:05:52.7817315Z 
2025-04-15T01:05:55.9232125Z PASS src/scaling/__tests__/worker-server.test.ts
2025-04-15T01:05:55.9240348Z   WorkerServer
2025-04-15T01:05:55.9240708Z     constructor
2025-04-15T01:05:55.9241476Z       âœ“ should throw if non-worker instance type (22 ms)
2025-04-15T01:05:55.9242332Z       âœ“ should exit if port taken (2 ms)
2025-04-15T01:05:55.9242758Z     init
2025-04-15T01:05:55.9243349Z       âœ“ should mount all endpoints when all are enabled (1 ms)
2025-04-15T01:05:55.9244309Z       âœ“ should mount only health and overwrites endpoints if only those are enabled (1 ms)
2025-04-15T01:05:55.9245108Z       âœ“ should throw if no endpoints are enabled (2 ms)
2025-04-15T01:05:55.9245658Z       âœ“ should call `worker.ready` external hook
2025-04-15T01:05:55.9245939Z 
2025-04-15T01:05:58.3544367Z PASS src/deprecation/__tests__/deprecation.service.test.ts
2025-04-15T01:05:58.3553194Z   DeprecationService
2025-04-15T01:05:58.3555400Z     âœ“ should detect when N8N_BINARY_DATA_TTL is `1` (5 ms)
2025-04-15T01:05:58.3557758Z     âœ“ should detect when N8N_PERSISTED_BINARY_DATA_TTL is `1`
2025-04-15T01:05:58.3568849Z     âœ“ should detect when EXECUTIONS_DATA_PRUNE_TIMEOUT is `1`
2025-04-15T01:05:58.3569605Z     âœ“ should detect when N8N_CONFIG_FILES is `1` (1 ms)
2025-04-15T01:05:58.3570502Z     âœ“ should detect when N8N_SKIP_WEBHOOK_DEREGISTRATION_SHUTDOWN is `1` (1 ms)
2025-04-15T01:05:58.3571506Z     âœ“ should detect when N8N_PARTIAL_EXECUTION_VERSION_DEFAULT is `1` (1 ms)
2025-04-15T01:05:58.3572818Z     âœ“ should detect when N8N_PARTIAL_EXECUTION_VERSION_DEFAULT is `2` (1 ms)
2025-04-15T01:05:58.3573811Z     âœ“ should detect when N8N_PARTIAL_EXECUTION_VERSION_DEFAULT is `undefined`
2025-04-15T01:05:58.3574667Z     âœ“ should handle N8N_BINARY_DATA_MODE as default (1 ms)
2025-04-15T01:05:58.3575436Z     âœ“ should handle N8N_BINARY_DATA_MODE as filesystem (1 ms)
2025-04-15T01:05:58.3576171Z     âœ“ should handle N8N_BINARY_DATA_MODE as s3
2025-04-15T01:05:58.3576802Z     âœ“ should handle DB_TYPE as sqlite (1 ms)
2025-04-15T01:05:58.3577395Z     âœ“ should handle DB_TYPE as postgresdb
2025-04-15T01:05:58.3578010Z     âœ“ should handle DB_TYPE as mysqldb (1 ms)
2025-04-15T01:05:58.3578593Z     âœ“ should handle DB_TYPE as mariadb
2025-04-15T01:05:58.3579089Z     N8N_PARTIAL_EXECUTION_VERSION_DEFAULT
2025-04-15T01:05:58.3579888Z       âœ“ supports multiple warnings for the same environment variable (9 ms)
2025-04-15T01:05:58.3581024Z     N8N_RUNNERS_ENABLED
2025-04-15T01:05:58.3581762Z       âœ“ should handle value: false (1 ms)
2025-04-15T01:05:58.3582319Z       âœ“ should handle value: 
2025-04-15T01:05:58.3582850Z       âœ“ should handle value: true (1 ms)
2025-04-15T01:05:58.3583458Z       âœ“ should handle value: undefined
2025-04-15T01:05:58.3583956Z     OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS
2025-04-15T01:05:58.3584438Z       when executions.mode is queue
2025-04-15T01:05:58.3585234Z         âœ“ should warn when OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS is false (1 ms)
2025-04-15T01:05:58.3586236Z         âœ“ should warn when OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS is empty (1 ms)
2025-04-15T01:05:58.3587203Z         âœ“ should not warn when OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS is true (1 ms)
2025-04-15T01:05:58.3588182Z         âœ“ should warn when OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS is undefined
2025-04-15T01:05:58.3588846Z       when executions.mode is not queue
2025-04-15T01:05:58.3589357Z         âœ“ should not warn
2025-04-15T01:05:58.3589618Z 
2025-04-15T01:06:02.6288798Z PASS src/__tests__/active-workflow-manager.test.ts
2025-04-15T01:06:02.6294442Z   ActiveWorkflowManager
2025-04-15T01:06:02.6294867Z     checkIfWorkflowCanBeActivated
2025-04-15T01:06:02.6295638Z       âœ“ should skip disabled nodes (6 ms)
2025-04-15T01:06:02.6296259Z       âœ“ should skip nodes marked as ignored (6 ms)
2025-04-15T01:06:02.6296864Z       âœ“ should skip unknown nodes (1 ms)
2025-04-15T01:06:02.6297507Z       âœ“ should skip nodes with no trigger method (1 ms)
2025-04-15T01:06:02.6298600Z       âœ“ should activate if poll method exists (1 ms)
2025-04-15T01:06:02.6299241Z       âœ“ should activate if trigger method exists (1 ms)
2025-04-15T01:06:02.6299895Z       âœ“ should activate if webhook method exists (1 ms)
2025-04-15T01:06:02.6300371Z     shouldAddWebhooks
2025-04-15T01:06:02.6300702Z       if leader
2025-04-15T01:06:02.6301149Z         âœ“ should return `true` for `init`
2025-04-15T01:06:02.6302040Z         âœ“ should return `false` for `leadershipChange` (1 ms)
2025-04-15T01:06:02.6302815Z         âœ“ should return `true` for `update` or `activate` (1 ms)
2025-04-15T01:06:02.6303309Z       if follower
2025-04-15T01:06:02.6303838Z         âœ“ should return `false` for `update` or `activate`
2025-04-15T01:06:02.6304293Z       add
2025-04-15T01:06:02.6304913Z         âœ“ should skip inactive workflow in `init` activation mode (2 ms)
2025-04-15T01:06:02.6305913Z         âœ“ should skip inactive workflow in `leadershipChange` activation mode (1 ms)
2025-04-15T01:06:02.6306452Z 
2025-04-15T01:06:06.9853356Z PASS test/integration/controllers/dynamic-node-parameters.controller.test.ts (20.97 s)
2025-04-15T01:06:06.9987553Z   DynamicNodeParametersController
2025-04-15T01:06:06.9988175Z     POST /dynamic-node-parameters/options
2025-04-15T01:06:06.9989023Z       âœ“ should take params via body (51 ms)
2025-04-15T01:06:06.9989676Z       âœ“ should take params with loadOptions (11 ms)
2025-04-15T01:06:06.9990540Z       âœ“ should return empty array when no method or loadOptions provided (8 ms)
2025-04-15T01:06:06.9991402Z     POST /dynamic-node-parameters/resource-locator-results
2025-04-15T01:06:06.9992347Z       âœ“ should return resource locator results (8 ms)
2025-04-15T01:06:06.9993175Z       âœ“ should handle resource locator results without pagination (8 ms)
2025-04-15T01:06:06.9994042Z       âœ“ should return a 400 if methodName is not defined (8 ms)
2025-04-15T01:06:06.9994741Z     POST /dynamic-node-parameters/resource-mapper-fields
2025-04-15T01:06:06.9995479Z       âœ“ should return resource mapper fields (8 ms)
2025-04-15T01:06:06.9996210Z       âœ“ should return a 400 if methodName is not defined (7 ms)
2025-04-15T01:06:06.9996935Z     POST /dynamic-node-parameters/local-resource-mapper-fields
2025-04-15T01:06:06.9997709Z       âœ“ should return local resource mapper fields (8 ms)
2025-04-15T01:06:06.9998471Z       âœ“ should return a 400 if methodName is not defined (7 ms)
2025-04-15T01:06:06.9999128Z     POST /dynamic-node-parameters/action-result
2025-04-15T01:06:06.9999855Z       âœ“ should return action result with handler (7 ms)
2025-04-15T01:06:07.0001011Z       âœ“ should return a 400 if handler is not defined (6 ms)
2025-04-15T01:06:07.0001401Z 
2025-04-15T01:06:07.0395231Z PASS src/executions/__tests__/executions.controller.test.ts
2025-04-15T01:06:07.0403144Z   ExecutionsController
2025-04-15T01:06:07.0404302Z     getOne
2025-04-15T01:06:07.0405393Z       âœ“ should 400 when execution is not a number (23 ms)
2025-04-15T01:06:07.0406007Z     getMany
2025-04-15T01:06:07.0406549Z       if either status or range provided
2025-04-15T01:06:07.0407318Z         âœ“ should fetch executions per query (3 ms)
2025-04-15T01:06:07.0408096Z         âœ“ should fetch executions per query (2 ms)
2025-04-15T01:06:07.0408859Z         âœ“ should fetch executions per query (5 ms)
2025-04-15T01:06:07.0409590Z         âœ“ should fetch executions per query (3 ms)
2025-04-15T01:06:07.0410241Z       if neither status nor range provided
2025-04-15T01:06:07.0410944Z         âœ“ should fetch executions per query (2 ms)
2025-04-15T01:06:07.0411875Z         âœ“ should fetch executions per query (1 ms)
2025-04-15T01:06:07.0412516Z       if both status and range provided
2025-04-15T01:06:07.0413241Z         âœ“ should fetch executions per query (3 ms)
2025-04-15T01:06:07.0413784Z     stop
2025-04-15T01:06:07.0414468Z       âœ“ should 404 when execution is inaccessible for user (2 ms)
2025-04-15T01:06:07.0415313Z       âœ“ should call ask for an execution to be stopped
2025-04-15T01:06:07.0415759Z 
2025-04-15T01:06:11.2240532Z PASS src/metrics/__tests__/prometheus-metrics.service.unmocked.test.ts
2025-04-15T01:06:11.2241369Z   workflow_success_total
2025-04-15T01:06:11.2242418Z     âœ“ support workflow id labels (24 ms)
2025-04-15T01:06:11.2243114Z     âœ“ support a custom prefix (1 ms)
2025-04-15T01:06:11.2243595Z   Active workflow count
2025-04-15T01:06:11.2244145Z     âœ“ should prioritize cached value (3 ms)
2025-04-15T01:06:11.2244785Z     âœ“ should query value from database if cache misses (1 ms)
2025-04-15T01:06:11.2249155Z 
2025-04-15T01:06:13.2843744Z PASS test/integration/collaboration/collaboration.service.test.ts (20.27 s)
2025-04-15T01:06:13.2848622Z   CollaborationService
2025-04-15T01:06:13.2853050Z     workflow opened message
2025-04-15T01:06:13.2857969Z       âœ“ should emit collaboratorsChanged after workflowOpened (36 ms)
2025-04-15T01:06:13.2863248Z       âœ“ should not emit collaboratorsChanged if user don't have access to the workflow (6 ms)
2025-04-15T01:06:13.2868067Z     workflow closed message
2025-04-15T01:06:13.2873453Z       âœ“ should not emit collaboratorsChanged after workflowClosed when there are no active users (16 ms)
2025-04-15T01:06:13.2879045Z       âœ“ should emit collaboratorsChanged after workflowClosed when there are active users (23 ms)
2025-04-15T01:06:13.2887603Z       âœ“ should not emit collaboratorsChanged if user don't have access to the workflow (10 ms)
2025-04-15T01:06:13.2890687Z 
2025-04-15T01:06:13.3865612Z PASS src/shutdown/__tests__/shutdown.service.test.ts
2025-04-15T01:06:13.3866701Z   ShutdownService
2025-04-15T01:06:13.3867186Z     shutdown
2025-04-15T01:06:13.3868851Z       âœ“ should signal shutdown (5 ms)
2025-04-15T01:06:13.3869493Z       âœ“ should signal shutdown in the priority order (6 ms)
2025-04-15T01:06:13.3870315Z       âœ“ should throw error if shutdown is already in progress (11 ms)
2025-04-15T01:06:13.3871143Z       âœ“ should report error if component shutdown fails (1 ms)
2025-04-15T01:06:13.3872042Z     waitForShutdown
2025-04-15T01:06:13.3872536Z       âœ“ should wait for shutdown (1 ms)
2025-04-15T01:06:13.3873222Z       âœ“ should throw error if app is not shutting down (1 ms)
2025-04-15T01:06:13.3873713Z     isShuttingDown
2025-04-15T01:06:13.3874198Z       âœ“ should return true if app is shutting down
2025-04-15T01:06:13.3874863Z       âœ“ should return false if app is not shutting down
2025-04-15T01:06:13.3875338Z     validate
2025-04-15T01:06:13.3876063Z       âœ“ should throw error if component is not registered with the DI container (1 ms)
2025-04-15T01:06:13.3877053Z       âœ“ should throw error if component is missing the shutdown method (1 ms)
2025-04-15T01:06:13.3877866Z 
2025-04-15T01:06:16.6818448Z PASS src/services/__tests__/hooks.service.test.ts
2025-04-15T01:06:16.6820084Z   HooksService
2025-04-15T01:06:16.6821857Z     âœ“ hooksService.inviteUsers should call userService.inviteUsers (6 ms)
2025-04-15T01:06:16.6823335Z     âœ“ hooksService.issueCookie should call authService.issueCookie (1 ms)
2025-04-15T01:06:16.6824806Z     âœ“ hooksService.findOneUser should call authUserRepository.findOne (1 ms)
2025-04-15T01:06:16.6826116Z     âœ“ hooksService.saveUser should call userRepository.save
2025-04-15T01:06:16.6828547Z     âœ“ hooksService.updateSettings should call settingRepository.update (1 ms)
2025-04-15T01:06:16.6829714Z     âœ“ hooksService.workflowsCount should call workflowRepository.count (1 ms)
2025-04-15T01:06:16.6830838Z     âœ“ hooksService.credentialsCount should call credentialRepository.count
2025-04-15T01:06:16.6834078Z     âœ“ hooksService.settingsCount should call settingsRepository.count (1 ms)
2025-04-15T01:06:16.6835249Z     âœ“ hooksService.authMiddleware should call authService.authMiddleware
2025-04-15T01:06:16.6836332Z     âœ“ hooksService.dbCollections should return valid repositories (1 ms)
2025-04-15T01:06:16.6837205Z     âœ“ hooksService.getRudderStackClient (5 ms)
2025-04-15T01:06:16.6837578Z 
2025-04-15T01:06:19.2244051Z PASS src/execution-lifecycle/__tests__/restore-binary-data-id.test.ts
2025-04-15T01:06:19.2246622Z   on filesystem-v2 mode
2025-04-15T01:06:19.2257073Z     âœ“ should restore if binary data ID is missing execution ID (7 ms)
2025-04-15T01:06:19.2258035Z     âœ“ should do nothing if binary data ID is not missing execution ID (1 ms)
2025-04-15T01:06:19.2258823Z     âœ“ should do nothing if no binary data ID (1 ms)
2025-04-15T01:06:19.2259471Z     âœ“ should do nothing on itemless case (1 ms)
2025-04-15T01:06:19.2260105Z     âœ“ should do nothing if data is undefined (1 ms)
2025-04-15T01:06:19.2260872Z     âœ“ should do nothing if workflow execution mode is not `webhook`
2025-04-15T01:06:19.2261794Z     âœ“ should ignore error thrown on renaming (7 ms)
2025-04-15T01:06:19.2262292Z   on s3 mode
2025-04-15T01:06:19.2262883Z     âœ“ should restore if binary data ID is missing execution ID (1 ms)
2025-04-15T01:06:19.2263687Z     âœ“ should do nothing if binary data ID is not missing execution ID
2025-04-15T01:06:19.2264361Z     âœ“ should do nothing if no binary data ID (1 ms)
2025-04-15T01:06:19.2264932Z     âœ“ should do nothing on itemless case (1 ms)
2025-04-15T01:06:19.2265510Z     âœ“ should do nothing if data is undefined (1 ms)
2025-04-15T01:06:19.2266211Z     âœ“ should do nothing if workflow execution mode is not `webhook`
2025-04-15T01:06:19.2266844Z     âœ“ should ignore error thrown on renaming
2025-04-15T01:06:19.2267246Z   on default mode
2025-04-15T01:06:19.2267640Z     âœ“ should do nothing (1 ms)
2025-04-15T01:06:19.2267885Z 
2025-04-15T01:06:23.3647011Z PASS src/executions/__tests__/parse-range-query.middleware.test.ts
2025-04-15T01:06:23.3647818Z   `parseRangeQuery` middleware
2025-04-15T01:06:23.3648236Z     errors
2025-04-15T01:06:23.3648986Z       âœ“ should fail on invalid JSON (26 ms)
2025-04-15T01:06:23.3649597Z       âœ“ should fail on invalid schema (6 ms)
2025-04-15T01:06:23.3650044Z     filter
2025-04-15T01:06:23.3650554Z       âœ“ should parse status and mode fields (3 ms)
2025-04-15T01:06:23.3651231Z       âœ“ should parse date-related fields (2 ms)
2025-04-15T01:06:23.3652150Z       âœ“ should parse ID-related fields (2 ms)
2025-04-15T01:06:23.3652793Z       âœ“ should parse `projectId` field (2 ms)
2025-04-15T01:06:23.3653402Z       âœ“ should delete invalid fields (1 ms)
2025-04-15T01:06:23.3653858Z     range
2025-04-15T01:06:23.3654280Z       âœ“ should parse first and last IDs
2025-04-15T01:06:23.3654781Z       âœ“ should parse limit
2025-04-15T01:06:23.3655349Z       âœ“ should default limit to 20 if absent (1 ms)
2025-04-15T01:06:23.3655697Z 
2025-04-15T01:06:27.4403986Z PASS test/integration/services/project.service.test.ts (20.169 s)
2025-04-15T01:06:27.4415610Z   ProjectService
2025-04-15T01:06:27.4416000Z     addUser
2025-04-15T01:06:27.4417610Z       âœ“ creates a relation between the user and the project using the role project:viewer (33 ms)
2025-04-15T01:06:27.4418909Z       âœ“ creates a relation between the user and the project using the role project:admin (13 ms)
2025-04-15T01:06:27.4420106Z       âœ“ creates a relation between the user and the project using the role project:editor (13 ms)
2025-04-15T01:06:27.4421351Z       âœ“ creates a relation between the user and the project using the role project:personalOwner (13 ms)
2025-04-15T01:06:27.4423124Z       âœ“ changes the role the user has in the project if the user is already part of the project, instead of creating a new relationship (23 ms)
2025-04-15T01:06:27.4424031Z     getProjectWithScope
2025-04-15T01:06:27.4425046Z       âœ“ should return the project if the user has the role project:admin and wants the scope workflow:list (16 ms)
2025-04-15T01:06:27.4426552Z       âœ“ should return the project if the user has the role project:admin and wants the scope workflow:create (13 ms)
2025-04-15T01:06:27.4428067Z       âœ“ should return the project if the user has the role project:viewer and wants the scope workflow:create (13 ms)
2025-04-15T01:06:27.4429583Z       âœ“ should return the project if the user has the role project:viewer and wants the scope credential:create (11 ms)
2025-04-15T01:06:27.4430759Z       âœ“ should not return the project if the user is not part of it (8 ms)
2025-04-15T01:06:27.4431217Z 
2025-04-15T01:06:29.8560938Z PASS src/__tests__/credentials-overwrites.test.ts
2025-04-15T01:06:29.8562244Z   CredentialsOverwrites
2025-04-15T01:06:29.8562664Z     constructor
2025-04-15T01:06:29.8563485Z       âœ“ should parse and set overwrite data from config (9 ms)
2025-04-15T01:06:29.8564026Z     setData
2025-04-15T01:06:29.8564640Z       âœ“ should reset resolvedTypes when setting new data (1 ms)
2025-04-15T01:06:29.8565197Z     applyOverwrite
2025-04-15T01:06:29.8565809Z       âœ“ should apply overwrites only for empty fields (1 ms)
2025-04-15T01:06:29.8566623Z       âœ“ should return original data if no overwrites exist (2 ms)
2025-04-15T01:06:29.8567204Z     getOverwrites
2025-04-15T01:06:29.8567878Z       âœ“ should return undefined for unrecognized credential type (2 ms)
2025-04-15T01:06:29.8568633Z       âœ“ should cache resolved types (1 ms)
2025-04-15T01:06:29.8569299Z       âœ“ should merge overwrites from parent types (5 ms)
2025-04-15T01:06:29.8569668Z 
2025-04-15T01:06:32.8129001Z PASS src/controllers/__tests__/owner.controller.test.ts
2025-04-15T01:06:32.8142895Z   OwnerController
2025-04-15T01:06:32.8143261Z     setupOwner
2025-04-15T01:06:32.8146174Z       âœ“ should throw a BadRequestError if the instance owner is already setup (22 ms)
2025-04-15T01:06:32.8151215Z       âœ“ should setup the instance owner successfully (5 ms)
2025-04-15T01:06:32.8153243Z     dismissBanner
2025-04-15T01:06:32.8153942Z       âœ“ should not call dismissBanner if no banner is provided
2025-04-15T01:06:32.8154765Z       âœ“ should call dismissBanner with the correct banner name
2025-04-15T01:06:32.8155199Z 
2025-04-15T01:06:33.4684238Z PASS test/integration/credentials-helper.test.ts (19.877 s)
2025-04-15T01:06:33.4690094Z   CredentialsHelper
2025-04-15T01:06:33.4690925Z     credentialOwnedBySuperUsers
2025-04-15T01:06:33.4693042Z       âœ“ owners are super users (30 ms)
2025-04-15T01:06:33.4693958Z       âœ“ admins are super users (12 ms)
2025-04-15T01:06:33.4694764Z       âœ“ owners need to own the credential (12 ms)
2025-04-15T01:06:33.4695619Z       âœ“ admins need to own the credential (10 ms)
2025-04-15T01:06:33.4701899Z       âœ“ members are no super users (10 ms)
2025-04-15T01:06:33.4702916Z       âœ“ credential in team project with instance owner as an admin can use external secrets (15 ms)
2025-04-15T01:06:33.4704202Z       âœ“ credential in team project with instance admin as an admin can use external secrets (14 ms)
2025-04-15T01:06:33.4705532Z       âœ“ credential in team project with instance owner as an editor cannot use external secrets (11 ms)
2025-04-15T01:06:33.4706877Z       âœ“ credential in team project with instance admin as an editor cannot use external secrets (13 ms)
2025-04-15T01:06:33.4708801Z       âœ“ credential in team project with no instance admin or owner as part of the project cannot use external secrets (10 ms)
2025-04-15T01:06:33.4709508Z 
2025-04-15T01:06:35.8739245Z PASS src/execution-lifecycle/__tests__/save-execution-progress.test.ts
2025-04-15T01:06:35.8743860Z   saveExecutionProgress
2025-04-15T01:06:35.8746453Z     âœ“ should not try to update non-existent executions (9 ms)
2025-04-15T01:06:35.8752681Z     âœ“ should handle DB errors on execution lookup (2 ms)
2025-04-15T01:06:35.8759605Z     âœ“ should handle DB errors when updating the execution (1 ms)
2025-04-15T01:06:35.8760463Z     âœ“ should not try to update finished executions (1 ms)
2025-04-15T01:06:35.8761250Z     âœ“ should populate `.data` when it is missing (1 ms)
2025-04-15T01:06:35.8762601Z     âœ“ should augment `.data` if it already exists (2 ms)
2025-04-15T01:06:35.8763635Z     âœ“ should set last executed node correctly
2025-04-15T01:06:35.8765795Z 
2025-04-15T01:06:43.8298986Z PASS test/integration/security-audit/database-risk-reporter.test.ts (20.235 s)
2025-04-15T01:06:43.8306362Z   âœ“ should report expressions in queries (102 ms)
2025-04-15T01:06:43.8307127Z   âœ“ should report expressions in query params (13 ms)
2025-04-15T01:06:43.8322210Z   âœ“ should report unused query params (12 ms)
2025-04-15T01:06:43.8323463Z   âœ“ should not report non-database node (5 ms)
2025-04-15T01:06:43.8323846Z 
2025-04-15T01:06:56.7624356Z PASS test/integration/binary-data.api.test.ts (23.055 s)
2025-04-15T01:06:56.7626808Z   GET /binary-data
2025-04-15T01:06:56.7631163Z     should reject on missing or invalid binary data ID
2025-04-15T01:06:56.7632752Z       âœ“ on request to view (55 ms)
2025-04-15T01:06:56.7633722Z       âœ“ on request to download (21 ms)
2025-04-15T01:06:56.7634436Z     should return binary data [filesystem]
2025-04-15T01:06:56.7635210Z       âœ“ on request to view (29 ms)
2025-04-15T01:06:56.7637845Z       âœ“ on request to download (15 ms)
2025-04-15T01:06:56.7638733Z     should handle non-ASCII filename [filesystem]
2025-04-15T01:06:56.7640024Z       âœ“ on request to download (12 ms)
2025-04-15T01:06:56.7641073Z     should return 404 on file not found [filesystem]
2025-04-15T01:06:56.7642270Z       âœ“ on request to view (6 ms)
2025-04-15T01:06:56.7643071Z       âœ“ on request to download (8 ms)
2025-04-15T01:06:56.7644224Z     should return binary data [s3]
2025-04-15T01:06:56.7645249Z       âœ“ on request to view (19 ms)
2025-04-15T01:06:56.7646498Z       âœ“ on request to download (7 ms)
2025-04-15T01:06:56.7647375Z     should return 404 on file not found [s3]
2025-04-15T01:06:56.7648204Z       âœ“ on request to view (7 ms)
2025-04-15T01:06:56.7649829Z       âœ“ on request to download (5 ms)
2025-04-15T01:06:56.7650144Z 
2025-04-15T01:06:57.2530510Z PASS test/integration/database/repositories/project.repository.test.ts (21.149 s)
2025-04-15T01:06:57.2533743Z   ProjectRepository
2025-04-15T01:06:57.2534153Z     getPersonalProjectForUser
2025-04-15T01:06:57.2535218Z       âœ“ returns the personal project (44 ms)
2025-04-15T01:06:57.2535813Z       âœ“ does not return non personal projects (16 ms)
2025-04-15T01:06:57.2536338Z     getPersonalProjectForUserOrFail
2025-04-15T01:06:57.2536938Z       âœ“ returns the personal project (15 ms)
2025-04-15T01:06:57.2537584Z       âœ“ does not return non personal projects (46 ms)
2025-04-15T01:06:57.2538110Z     update personal project name
2025-04-15T01:06:57.2539000Z       âœ“ do not pass a User instance with circular references into `UserRepository.create` (26 ms)
2025-04-15T01:06:57.2539580Z 
2025-04-15T01:06:59.6142827Z PASS src/push/__tests__/websocket.push.test.ts
2025-04-15T01:06:59.6150788Z   WebSocketPush
2025-04-15T01:06:59.6151783Z     âœ“ can add a connection (7 ms)
2025-04-15T01:06:59.6152411Z     âœ“ closes a connection (1 ms)
2025-04-15T01:06:59.6153021Z     âœ“ sends data to one connection (2 ms)
2025-04-15T01:06:59.6153664Z     âœ“ sends data to all connections (2 ms)
2025-04-15T01:06:59.6154324Z     âœ“ pings all connections (1 ms)
2025-04-15T01:06:59.6155560Z     âœ“ sends data to all users connections (1 ms)
2025-04-15T01:06:59.6156365Z     âœ“ emits message event when connection receives data (3 ms)
2025-04-15T01:06:59.6157141Z     âœ“ emits doesn' emit message for client heartbeat
2025-04-15T01:06:59.6157535Z 
2025-04-15T01:07:00.5893743Z PASS src/external-secrets.ee/__tests__/external-secrets-manager.ee.test.ts
2025-04-15T01:07:00.5933434Z   External Secrets Manager
2025-04-15T01:07:00.5937024Z     âœ“ should get secret (9 ms)
2025-04-15T01:07:00.5937735Z     âœ“ should not throw errors during init (3 ms)
2025-04-15T01:07:00.5938517Z     âœ“ should not throw errors during shutdown (1 ms)
2025-04-15T01:07:00.5939231Z     âœ“ should save provider settings (4 ms)
2025-04-15T01:07:00.5940038Z     âœ“ should call provider update functions on a timer (4 ms)
2025-04-15T01:07:00.5941012Z     âœ“ should not call provider update functions if the not licensed (7 ms)
2025-04-15T01:07:00.5942347Z     âœ“ should not call provider update functions if the provider has an error (1 ms)
2025-04-15T01:07:00.5943494Z     âœ“ should reinitialize a provider when save provider settings (1 ms)
2025-04-15T01:07:00.5944032Z 
2025-04-15T01:07:02.2023244Z PASS src/execution-lifecycle/__tests__/to-save-settings.test.ts
2025-04-15T01:07:02.2024071Z   failed production executions
2025-04-15T01:07:02.2024958Z     âœ“ should favor workflow settings over defaults (5 ms)
2025-04-15T01:07:02.2025799Z     âœ“ should fall back to default if no workflow setting (1 ms)
2025-04-15T01:07:02.2026850Z   successful production executions
2025-04-15T01:07:02.2027507Z     âœ“ should favor workflow settings over defaults
2025-04-15T01:07:02.2028238Z     âœ“ should fall back to default if no workflow setting
2025-04-15T01:07:02.2028747Z   manual executions
2025-04-15T01:07:02.2029328Z     âœ“ should favor workflow setting over default (1 ms)
2025-04-15T01:07:02.2030279Z     âœ“ should favor fall back to default if workflow setting is explicit default (1 ms)
2025-04-15T01:07:02.2031185Z     âœ“ should fall back to default if no workflow setting
2025-04-15T01:07:02.2031938Z   execution progress
2025-04-15T01:07:02.2032558Z     âœ“ should favor workflow setting over default (1 ms)
2025-04-15T01:07:02.2033488Z     âœ“ should favor fall back to default if workflow setting is explicit default (1 ms)
2025-04-15T01:07:02.2034405Z     âœ“ should fall back to default if no workflow setting
2025-04-15T01:07:02.2034793Z 
2025-04-15T01:07:05.3793466Z PASS src/webhooks/__tests__/webhook-form-data.test.ts
2025-04-15T01:07:05.3798590Z   webhook-form-data
2025-04-15T01:07:05.3802817Z     createMultiFormDataParser
2025-04-15T01:07:05.3807457Z       âœ“ should parse fields from the multipart form data (45 ms)
2025-04-15T01:07:05.3812311Z       âœ“ should parse text/plain file from the multipart form data (14 ms)
2025-04-15T01:07:05.3817088Z       âœ“ should parse multiple files and fields from the multipart form data (10 ms)
2025-04-15T01:07:05.3821866Z       âœ“ should ignore file that is too large (7 ms)
2025-04-15T01:07:05.3825894Z 
2025-04-15T01:07:07.0633636Z PASS test/integration/role.api.test.ts (23.017 s)
2025-04-15T01:07:07.0635748Z   GET /roles/
2025-04-15T01:07:07.0639339Z     âœ“ should return all role categories (29 ms)
2025-04-15T01:07:07.0640270Z     âœ“ should return fixed global roles (8 ms)
2025-04-15T01:07:07.0641143Z     âœ“ should return fixed project roles (7 ms)
2025-04-15T01:07:07.0643281Z     âœ“ should return fixed credential sharing roles (5 ms)
2025-04-15T01:07:07.0646104Z     âœ“ should return fixed workflow sharing roles (5 ms)
2025-04-15T01:07:07.0646555Z 
2025-04-15T01:07:25.1778391Z PASS test/integration/license.api.test.ts (24.353 s)
2025-04-15T01:07:25.1782662Z   GET /license
2025-04-15T01:07:25.1783856Z     âœ“ should return license information to the instance owner (41 ms)
2025-04-15T01:07:25.1787562Z     âœ“ should return license information to a regular user (10 ms)
2025-04-15T01:07:25.1788207Z   POST /license/enterprise/request_trial
2025-04-15T01:07:25.1788874Z     âœ“ should work for instance owner (28 ms)
2025-04-15T01:07:25.1789950Z     âœ“ does not work for regular users (7 ms)
2025-04-15T01:07:25.1790393Z   POST /license/activate
2025-04-15T01:07:25.1790931Z     âœ“ should work for instance owner (9 ms)
2025-04-15T01:07:25.1791726Z     âœ“ does not work for regular users (7 ms)
2025-04-15T01:07:25.1792320Z     âœ“ errors out properly (23 ms)
2025-04-15T01:07:25.1792750Z   POST /license/renew
2025-04-15T01:07:25.1793271Z     âœ“ should work for instance owner (11 ms)
2025-04-15T01:07:25.1793851Z     âœ“ does not work for regular users (8 ms)
2025-04-15T01:07:25.1794443Z     âœ“ errors out properly (8 ms)
2025-04-15T01:07:25.1794731Z 
2025-04-15T01:07:27.7512052Z PASS src/task-runners/__tests__/task-runner-process.test.ts
2025-04-15T01:07:27.7516026Z   TaskRunnerProcess
2025-04-15T01:07:27.7516381Z     constructor
2025-04-15T01:07:27.7517126Z       âœ“ should throw if runner mode is external (25 ms)
2025-04-15T01:07:27.7517991Z       âœ“ should register listener for `runner:failed-heartbeat-check` event (2 ms)
2025-04-15T01:07:27.7518972Z       âœ“ should register listener for `runner:timed-out-during-task` event (4 ms)
2025-04-15T01:07:27.7519614Z     start
2025-04-15T01:07:27.7520089Z       âœ“ should propagate PATH from env as is (6 ms)
2025-04-15T01:07:27.7520869Z       âœ“ should propagate NODE_FUNCTION_ALLOW_BUILTIN from env as is (1 ms)
2025-04-15T01:07:27.7521958Z       âœ“ should propagate NODE_FUNCTION_ALLOW_EXTERNAL from env as is (13 ms)
2025-04-15T01:07:27.7522781Z       âœ“ should propagate N8N_SENTRY_DSN from env as is (1 ms)
2025-04-15T01:07:27.7523906Z       âœ“ should propagate N8N_VERSION from env as is (1 ms)
2025-04-15T01:07:27.7524588Z       âœ“ should propagate ENVIRONMENT from env as is (4 ms)
2025-04-15T01:07:27.7525344Z       âœ“ should propagate DEPLOYMENT_NAME from env as is (1 ms)
2025-04-15T01:07:27.7526042Z       âœ“ should propagate NODE_PATH from env as is (1 ms)
2025-04-15T01:07:27.7526744Z       âœ“ should propagate GENERIC_TIMEZONE from env as is (1 ms)
2025-04-15T01:07:27.7527566Z       âœ“ should pass NODE_OPTIONS env if maxOldSpaceSize is configured (1 ms)
2025-04-15T01:07:27.7528510Z       âœ“ should not pass NODE_OPTIONS env if maxOldSpaceSize is not configured (2 ms)
2025-04-15T01:07:27.7529630Z       âœ“ should use --disallow-code-generation-from-strings and --disable-proto=delete flags (1 ms)
2025-04-15T01:07:27.7530216Z 
2025-04-15T01:07:29.8243242Z PASS test/integration/controllers/oauth/oauth2.api.test.ts (24.207 s)
2025-04-15T01:07:29.8246772Z   OAuth2 API
2025-04-15T01:07:29.8253991Z     âœ“ should return a valid auth URL when the auth flow is initiated (215 ms)
2025-04-15T01:07:29.8255170Z     âœ“ should fail on auth when callback is called as another user (41 ms)
2025-04-15T01:07:29.8256784Z     âœ“ should handle a valid callback without auth (63 ms)
2025-04-15T01:07:29.8273002Z 
2025-04-15T01:07:30.8402959Z PASS test/integration/credentials/credentials.service.test.ts (23.587 s)
2025-04-15T01:07:30.8408888Z   credentials service
2025-04-15T01:07:30.8409404Z     replaceCredentialContentsForSharee
2025-04-15T01:07:30.8410489Z       âœ“ should replace the contents of the credential for sharee (23 ms)
2025-04-15T01:07:30.8411760Z       âœ“ should replace the contents of the credential for project viewer (31 ms)
2025-04-15T01:07:30.8412885Z       âœ“ should not replace the contents of the credential for project editor (25 ms)
2025-04-15T01:07:30.8413416Z 
2025-04-15T01:07:30.9718809Z PASS src/sso.ee/saml/__tests__/saml.service.ee.test.ts
2025-04-15T01:07:30.9719474Z   SamlService
2025-04-15T01:07:30.9719992Z     getAttributesFromLoginResponse
2025-04-15T01:07:30.9720883Z       âœ“ throws when any attribute is missing (131 ms)
2025-04-15T01:07:30.9721352Z     init
2025-04-15T01:07:30.9722294Z       âœ“ calls `reset` if an InvalidSamlMetadataError is thrown (2 ms)
2025-04-15T01:07:30.9723069Z       âœ“ calls `reset` if a SyntaxError is thrown (1 ms)
2025-04-15T01:07:30.9723826Z       âœ“ does not call reset and rethrows if another error is thrown (2 ms)
2025-04-15T01:07:30.9724480Z       âœ“ does not call reset if no error is thrown (1 ms)
2025-04-15T01:07:30.9725339Z     reset
2025-04-15T01:07:30.9726047Z       âœ“ disables saml login and deletes the saml `features.saml` key in the db (2 ms)
2025-04-15T01:07:30.9726555Z 
2025-04-15T01:07:33.2287716Z PASS src/controllers/__tests__/api-keys.controller.test.ts
2025-04-15T01:07:33.2288876Z   ApiKeysController
2025-04-15T01:07:33.2289519Z     createAPIKey
2025-04-15T01:07:33.2296263Z       âœ“ should create and save an API key (6 ms)
2025-04-15T01:07:33.2298776Z       âœ“ should fail to create API key if user uses a scope not allow for its role (14 ms)
2025-04-15T01:07:33.2301902Z     updateApiKey
2025-04-15T01:07:33.2302819Z       âœ“ should fail to update API key if user uses a scope not allow for its role (2 ms)
2025-04-15T01:07:33.2303510Z     getAPIKeys
2025-04-15T01:07:33.2304115Z       âœ“ should return the users api keys redacted (4 ms)
2025-04-15T01:07:33.2304642Z     deleteAPIKey
2025-04-15T01:07:33.2305172Z       âœ“ should delete the API key (4 ms)
2025-04-15T01:07:33.2305520Z 
2025-04-15T01:07:34.1389649Z PASS src/__tests__/external-hooks.test.ts
2025-04-15T01:07:34.1390348Z   ExternalHooks
2025-04-15T01:07:34.1390715Z     init()
2025-04-15T01:07:34.1391818Z       âœ“ should not load hooks if no external hook files are configured (6 ms)
2025-04-15T01:07:34.1392696Z       âœ“ should throw an error if hook file cannot be loaded (13 ms)
2025-04-15T01:07:34.1393527Z       âœ“ should successfully load hooks from valid hook file (2 ms)
2025-04-15T01:07:34.1394064Z     run()
2025-04-15T01:07:34.1394981Z       âœ“ should not throw if no hooks are registered (1 ms)
2025-04-15T01:07:34.1395634Z       âœ“ should execute registered hooks (5 ms)
2025-04-15T01:07:34.1396300Z       âœ“ should report error if hook execution fails (2 ms)
2025-04-15T01:07:34.1396654Z 
2025-04-15T01:07:37.6102916Z PASS src/credentials/__tests__/credentials.service.test.ts
2025-04-15T01:07:37.6107129Z   CredentialsService
2025-04-15T01:07:37.6110571Z     redact
2025-04-15T01:07:37.6118948Z       âœ“ should redact sensitive values (5 ms)
2025-04-15T01:07:37.6132387Z     decrypt
2025-04-15T01:07:37.6133006Z       âœ“ should redact sensitive values by default (1 ms)
2025-04-15T01:07:37.6133800Z       âœ“ should return sensitive values if `includeRawData` is true (1 ms)
2025-04-15T01:07:37.6134668Z       âœ“ should return return an empty object if decryption fails (1 ms)
2025-04-15T01:07:37.6135088Z 
2025-04-15T01:07:54.1211175Z PASS test/integration/workflows/workflow-sharing.service.test.ts (22.909 s)
2025-04-15T01:07:54.1218285Z   WorkflowSharingService
2025-04-15T01:07:54.1219719Z     getSharedWorkflowIds
2025-04-15T01:07:54.1223063Z       âœ“ should show all workflows to owners (33 ms)
2025-04-15T01:07:54.1223828Z       âœ“ should show shared workflows to users (34 ms)
2025-04-15T01:07:54.1224884Z       âœ“ should show workflows that the user has access to through a team project they are part of (15 ms)
2025-04-15T01:07:54.1226022Z       âœ“ should show workflows that the user has update access to (27 ms)
2025-04-15T01:07:54.1226472Z 
2025-04-15T01:08:00.0344134Z PASS test/integration/public-api/variables.test.ts (25.664 s)
2025-04-15T01:08:00.0345332Z   Variables in Public API
2025-04-15T01:08:00.0345887Z     GET /variables
2025-04-15T01:08:00.0347152Z       âœ“ if licensed, should return all variables with pagination (408 ms)
2025-04-15T01:08:00.0348285Z       âœ“ if not licensed, should reject (21 ms)
2025-04-15T01:08:00.0351107Z     POST /variables
2025-04-15T01:08:00.0352098Z       âœ“ if licensed, should create a new variable (36 ms)
2025-04-15T01:08:00.0352976Z       âœ“ if not licensed, should reject (20 ms)
2025-04-15T01:08:00.0353473Z     DELETE /variables/:id
2025-04-15T01:08:00.0354044Z       âœ“ if licensed, should delete a variable (62 ms)
2025-04-15T01:08:00.0354650Z       âœ“ if not licensed, should reject (20 ms)
2025-04-15T01:08:00.0354918Z 
2025-04-15T01:08:03.0815354Z PASS test/integration/executions.controller.test.ts (25.279 s)
2025-04-15T01:08:03.0816629Z   GET /executions
2025-04-15T01:08:03.0817677Z     âœ“ only returns executions of shared workflows if sharing is enabled (122 ms)
2025-04-15T01:08:03.0819152Z     âœ“ should return a scopes array for each execution (55 ms)
2025-04-15T01:08:03.0819728Z   GET /executions/:id
2025-04-15T01:08:03.0827636Z     âœ“ project viewers can view executions for workflows in the project (90 ms)
2025-04-15T01:08:03.0828877Z     âœ“ only returns executions of shared workflows if sharing is enabled (64 ms)
2025-04-15T01:08:03.0829593Z   POST /executions/delete
2025-04-15T01:08:03.0830217Z     âœ“ should hard-delete an execution (54 ms)
2025-04-15T01:08:03.0830588Z 
2025-04-15T01:08:03.1452990Z PASS src/services/__tests__/ai.service.test.ts
2025-04-15T01:08:03.1455122Z   AiService
2025-04-15T01:08:03.1456998Z     init
2025-04-15T01:08:03.1478972Z       âœ“ should not initialize client if AI assistant is not enabled (6 ms)
2025-04-15T01:08:03.1479986Z       âœ“ should initialize client when AI assistant is enabled (1 ms)
2025-04-15T01:08:03.1480568Z     chat
2025-04-15T01:08:03.1481201Z       âœ“ should call client chat method after initialization (1 ms)
2025-04-15T01:08:03.1482313Z       âœ“ should throw error if client is not initialized (17 ms)
2025-04-15T01:08:03.1482885Z     applySuggestion
2025-04-15T01:08:03.1483458Z       âœ“ should call client applySuggestion (2 ms)
2025-04-15T01:08:03.1484226Z       âœ“ should throw error if client is not initialized (1 ms)
2025-04-15T01:08:03.1484754Z     askAi
2025-04-15T01:08:03.1485398Z       âœ“ should call client askAi method after initialization (1 ms)
2025-04-15T01:08:03.1486209Z       âœ“ should throw error if client is not initialized
2025-04-15T01:08:03.1487059Z 
2025-04-15T01:08:06.4270429Z PASS src/executions/pre-execution-checks/__tests__/credentials-permission-checker.test.ts
2025-04-15T01:08:06.4275551Z   CredentialsPermissionChecker
2025-04-15T01:08:06.4280253Z     âœ“ should throw if a node has a credential without an id (15 ms)
2025-04-15T01:08:06.4284998Z     âœ“ should throw if a credential is not accessible (1 ms)
2025-04-15T01:08:06.4289689Z     âœ“ should not throw an error if the workflow has no credentials (1 ms)
2025-04-15T01:08:06.4291028Z     âœ“ should not throw an error if all credentials are accessible (1 ms)
2025-04-15T01:08:06.4300090Z     âœ“ should skip credential checks if the home project owner has global scope (1 ms)
2025-04-15T01:08:06.4300684Z 
2025-04-15T01:08:06.6027849Z PASS src/decorators/__tests__/controller.registry.test.ts
2025-04-15T01:08:06.6033314Z   ControllerRegistry
2025-04-15T01:08:06.6037563Z     Rate limiting
2025-04-15T01:08:06.6038625Z       âœ“ should not rate-limit by default (79 ms)
2025-04-15T01:08:06.6039392Z       âœ“ should rate-limit when configured (26 ms)
2025-04-15T01:08:06.6039885Z     Authorization
2025-04-15T01:08:06.6040478Z       âœ“ should not require auth if configured to skip (8 ms)
2025-04-15T01:08:06.6041173Z       âœ“ should require auth by default (5 ms)
2025-04-15T01:08:06.6041827Z     License checks
2025-04-15T01:08:06.6042400Z       âœ“ should disallow when feature is missing (14 ms)
2025-04-15T01:08:06.6043100Z       âœ“ should allow when feature is available (6 ms)
2025-04-15T01:08:06.6043595Z     Args
2025-04-15T01:08:06.6044169Z       âœ“ should pass in correct args to the route handler (7 ms)
2025-04-15T01:08:06.6044570Z 
2025-04-15T01:08:09.0878610Z PASS src/__tests__/credential-types.test.ts
2025-04-15T01:08:09.0880141Z   CredentialTypes
2025-04-15T01:08:09.0883137Z     getByName
2025-04-15T01:08:09.0885417Z       âœ“ Should throw error when calling invalid credential name (18 ms)
2025-04-15T01:08:09.0888858Z       âœ“ Should return correct credential type for valid name (2 ms)
2025-04-15T01:08:09.0889888Z     recognizes
2025-04-15T01:08:09.0891108Z       âœ“ Should recognize credential type that exists in knownCredentials (1 ms)
2025-04-15T01:08:09.0892604Z       âœ“ Should recognize credential type that exists in loadedCredentials
2025-04-15T01:08:09.0899937Z       âœ“ Should not recognize unknown credential type (1 ms)
2025-04-15T01:08:09.0900471Z     getSupportedNodes
2025-04-15T01:08:09.0901152Z       âœ“ Should return supported nodes for known credential type (1 ms)
2025-04-15T01:08:09.0902651Z       âœ“ Should return empty array for unknown credential type supported nodes (1 ms)
2025-04-15T01:08:09.0903247Z     getParentTypes
2025-04-15T01:08:09.0903866Z       âœ“ Should return parent types for credential type with extends (1 ms)
2025-04-15T01:08:09.0904736Z       âœ“ Should return empty array for credential type without extends
2025-04-15T01:08:09.0905666Z       âœ“ Should return empty array for unknown credential type parent types (1 ms)
2025-04-15T01:08:09.0906168Z 
2025-04-15T01:08:11.3521269Z PASS test/integration/webhooks.test.ts
2025-04-15T01:08:11.3521806Z   WebhookServer
2025-04-15T01:08:11.3522015Z     CORS
2025-04-15T01:08:11.3522197Z       for webhook
2025-04-15T01:08:11.3522718Z         âœ“ should handle preflight requests (41 ms)
2025-04-15T01:08:11.3523095Z         âœ“ should handle regular requests (7 ms)
2025-04-15T01:08:11.3523357Z       for webhookTest
2025-04-15T01:08:11.3523664Z         âœ“ should handle preflight requests (4 ms)
2025-04-15T01:08:11.3524013Z         âœ“ should handle regular requests (5 ms)
2025-04-15T01:08:11.3524339Z     Routing for Waiting Webhooks
2025-04-15T01:08:11.3524666Z       âœ“ should handle URLs without suffix (4 ms)
2025-04-15T01:08:11.3525266Z       âœ“ should handle URLs with suffix (4 ms)
2025-04-15T01:08:11.3525578Z 
2025-04-15T01:08:12.5083094Z PASS src/controllers/__tests__/user-settings.controller.test.ts
2025-04-15T01:08:12.5090902Z   UserSettingsController
2025-04-15T01:08:12.5092845Z     NPS Survey
2025-04-15T01:08:12.5094171Z       âœ“ updates user settings, setting response state to done (5 ms)
2025-04-15T01:08:12.5095342Z       âœ“ updates user settings, setting response state to done, ignoring other keys like waitForResponse
2025-04-15T01:08:12.5096684Z       âœ“ updates user settings, setting response state to done, ignoring other keys like ignoredCount (1 ms)
2025-04-15T01:08:12.5097909Z       âœ“ updates user settings, setting response state to done, ignoring other unknown keys
2025-04-15T01:08:12.5098820Z       âœ“ updates user settings, updating ignore count (1 ms)
2025-04-15T01:08:12.5099619Z       âœ“ updates user settings, resetting to waiting state (1 ms)
2025-04-15T01:08:12.5100564Z       âœ“ updates user settings, updating ignore count, ignoring unknown keys (1 ms)
2025-04-15T01:08:12.5101455Z       âœ“ updates user settings, setting response state to done
2025-04-15T01:08:12.5102411Z       âœ“ updates user settings, updating ignore count (1 ms)
2025-04-15T01:08:12.5103142Z       âœ“ throws error when request payload is is missing (10 ms)
2025-04-15T01:08:12.5103875Z       âœ“ throws error when request payload is is undefined (1 ms)
2025-04-15T01:08:12.5104806Z       âœ“ throws error when request payload is is responded but missing lastShownAt (1 ms)
2025-04-15T01:08:12.5105939Z       âœ“ throws error when request payload is is waitingForResponse but missing lastShownAt (1 ms)
2025-04-15T01:08:12.5107133Z       âœ“ throws error when request payload is is waitingForResponse but missing ignoredCount (1 ms)
2025-04-15T01:08:12.5107699Z 
2025-04-15T01:08:15.2609263Z PASS src/scaling/__tests__/publisher.service.test.ts
2025-04-15T01:08:15.2609938Z   Publisher
2025-04-15T01:08:15.2610253Z     constructor
2025-04-15T01:08:15.2611051Z       âœ“ should init Redis client in scaling mode (7 ms)
2025-04-15T01:08:15.2611940Z       âœ“ should not init Redis client in regular mode
2025-04-15T01:08:15.2612425Z     shutdown
2025-04-15T01:08:15.2612920Z       âœ“ should disconnect Redis client (1 ms)
2025-04-15T01:08:15.2613398Z     publishCommand
2025-04-15T01:08:15.2613985Z       âœ“ should do nothing if not in scaling mode (1 ms)
2025-04-15T01:08:15.2614825Z       âœ“ should publish command into `n8n.commands` pubsub channel (1 ms)
2025-04-15T01:08:15.2615771Z       âœ“ should not debounce `add-webhooks-triggers-and-pollers` (1 ms)
2025-04-15T01:08:15.2616656Z       âœ“ should not debounce `remove-triggers-and-pollers` (1 ms)
2025-04-15T01:08:15.2617231Z     publishWorkerResponse
2025-04-15T01:08:15.2618077Z       âœ“ should publish worker response into `n8n.worker-response` pubsub channel (1 ms)
2025-04-15T01:08:15.2619038Z 
2025-04-15T01:08:18.5527786Z PASS src/license/__tests__/license.service.test.ts
2025-04-15T01:08:18.5531516Z   LicenseService
2025-04-15T01:08:18.5543664Z     getLicenseData
2025-04-15T01:08:18.5549031Z       âœ“ should return usage and license data (7 ms)
2025-04-15T01:08:18.5549563Z     activateLicense
2025-04-15T01:08:18.5550124Z       âœ“ should handle SCHEMA_VALIDATION error (12 ms)
2025-04-15T01:08:18.5550816Z       âœ“ should handle RESERVATION_EXHAUSTED error
2025-04-15T01:08:18.5551734Z       âœ“ should handle RESERVATION_EXPIRED error (1 ms)
2025-04-15T01:08:18.5552416Z       âœ“ should handle NOT_FOUND error (7 ms)
2025-04-15T01:08:18.5553070Z       âœ“ should handle RESERVATION_CONFLICT error (1 ms)
2025-04-15T01:08:18.5553799Z       âœ“ should handle RESERVATION_DUPLICATE error (1 ms)
2025-04-15T01:08:18.5554286Z     renewLicense
2025-04-15T01:08:18.5554695Z       âœ“ on success (1 ms)
2025-04-15T01:08:18.5555119Z       âœ“ on failure (2 ms)
2025-04-15T01:08:18.5555506Z     registerCommunityEdition
2025-04-15T01:08:18.5556018Z       âœ“ on success (1 ms)
2025-04-15T01:08:18.5556411Z       âœ“ on failure (2 ms)
2025-04-15T01:08:18.5556641Z 
2025-04-15T01:08:19.3718279Z PASS test/integration/owner.api.test.ts (25.039 s)
2025-04-15T01:08:19.3721165Z   POST /owner/setup
2025-04-15T01:08:19.3722733Z     âœ“ should create owner and enable isInstanceOwnerSetUp (229 ms)
2025-04-15T01:08:19.3724002Z     âœ“ should create owner with lowercased email (136 ms)
2025-04-15T01:08:19.3726091Z     âœ“ should fail with invalid inputs (36 ms)
2025-04-15T01:08:19.3726427Z 
2025-04-15T01:08:21.9698091Z PASS src/task-runners/task-managers/__tests__/task-manager.test.ts
2025-04-15T01:08:21.9698836Z   TaskRequester
2025-04-15T01:08:21.9699163Z     handleRpc
2025-04-15T01:08:21.9699887Z       âœ“ should handle logNodeOutput rpc call (5 ms)
2025-04-15T01:08:21.9700588Z       âœ“ should handle helpers.assertBinaryData rpc call
2025-04-15T01:08:21.9701458Z       âœ“ should handle helpers.getBinaryDataBuffer rpc call (1 ms)
2025-04-15T01:08:21.9702613Z       âœ“ should handle helpers.prepareBinaryData rpc call
2025-04-15T01:08:21.9703442Z       âœ“ should handle helpers.setBinaryDataBuffer rpc call
2025-04-15T01:08:21.9704234Z       âœ“ should handle helpers.binaryToString rpc call (5 ms)
2025-04-15T01:08:21.9704986Z       âœ“ should handle helpers.httpRequest rpc call (1 ms)
2025-04-15T01:08:21.9705767Z       âœ“ converts any serialized buffer arguments into buffers (1 ms)
2025-04-15T01:08:21.9706275Z       errors
2025-04-15T01:08:21.9706960Z         âœ“ sends method not allowed error if method is not in the allow list
2025-04-15T01:08:21.9707737Z         âœ“ sends error if method throws (1 ms)
2025-04-15T01:08:21.9708048Z 
2025-04-15T01:08:24.9534517Z PASS src/databases/repositories/__tests__/execution.repository.test.ts
2025-04-15T01:08:24.9544601Z   ExecutionRepository
2025-04-15T01:08:24.9545109Z     getWaitingExecutions()
2025-04-15T01:08:24.9546267Z       âœ“ on sqlite, should be called with expected args (6 ms)
2025-04-15T01:08:24.9547145Z       âœ“ on postgresdb, should be called with expected args (1 ms)
2025-04-15T01:08:24.9547805Z     deleteExecutionsByFilter
2025-04-15T01:08:24.9548403Z       âœ“ should delete binary data (1 ms)
2025-04-15T01:08:24.9548881Z     updateExistingExecution
2025-04-15T01:08:24.9549647Z       âœ“ should update execution and data in transaction on sqlite (2 ms)
2025-04-15T01:08:24.9550589Z       âœ“ should update execution and data in transaction on postgresdb
2025-04-15T01:08:24.9551488Z       âœ“ should update execution and data in transaction on mysqldb
2025-04-15T01:08:24.9552169Z 
2025-04-15T01:08:35.6333306Z PASS test/integration/workflow-history-manager.test.ts (24.099 s)
2025-04-15T01:08:35.6335071Z   Workflow History Manager
2025-04-15T01:08:35.6335901Z     âœ“ should prune on interval (15 ms)
2025-04-15T01:08:35.6336555Z     âœ“ should not prune when not licensed (85 ms)
2025-04-15T01:08:35.6337308Z     âœ“ should not prune when licensed but disabled (27 ms)
2025-04-15T01:08:35.6338139Z     âœ“ should not prune when both prune times are -1 (infinite) (24 ms)
2025-04-15T01:08:35.6339522Z     âœ“ should prune when config prune time is not -1 (infinite) (23 ms)
2025-04-15T01:08:35.6340426Z     âœ“ should prune when license prune time is not -1 (infinite) (21 ms)
2025-04-15T01:08:35.6341258Z     âœ“ should only prune versions older than prune time (40 ms)
2025-04-15T01:08:35.6341842Z 
2025-04-15T01:08:40.1128883Z PASS src/environments.ee/source-control/__tests__/source-control.controller.ee.test.ts
2025-04-15T01:08:40.1130281Z   SourceControlController
2025-04-15T01:08:40.1131037Z     pushWorkfolder
2025-04-15T01:08:40.1132453Z       âœ“ should push workfolder with expected parameters (9 ms)
2025-04-15T01:08:40.1133491Z     pullWorkfolder
2025-04-15T01:08:40.1134393Z       âœ“ should pull workfolder with expected parameters (2 ms)
2025-04-15T01:08:40.1141985Z     getStatus
2025-04-15T01:08:40.1142689Z       âœ“ should call getStatus with expected parameters (3 ms)
2025-04-15T01:08:40.1143247Z     status
2025-04-15T01:08:40.1143843Z       âœ“ should call getStatus with expected parameters (1 ms)
2025-04-15T01:08:40.1144248Z 
2025-04-15T01:08:42.3512534Z PASS src/modules/insights/__tests__/insights.controller.test.ts (23.571 s)
2025-04-15T01:08:42.3513847Z   InsightsController
2025-04-15T01:08:42.3514369Z     getInsightsSummary
2025-04-15T01:08:42.3515283Z       âœ“ should return default insights if no data (8 ms)
2025-04-15T01:08:42.3516485Z       âœ“ should return the insights summary with null deviation if insights exist only for current period (1 ms)
2025-04-15T01:08:42.3518218Z       âœ“ should return the insights summary if insights exist for both periods (1 ms)
2025-04-15T01:08:42.3520662Z 
2025-04-15T01:08:42.5763807Z PASS src/push/__tests__/sse.push.test.ts
2025-04-15T01:08:42.5767525Z   SSEPush
2025-04-15T01:08:42.5770134Z     âœ“ pings all connections (6 ms)
2025-04-15T01:08:42.5777892Z     âœ“ closes all connections (2 ms)
2025-04-15T01:08:42.5778379Z     add
2025-04-15T01:08:42.5778880Z       âœ“ adds a connection (13 ms)
2025-04-15T01:08:42.5779343Z     closes a connection
2025-04-15T01:08:42.5779877Z       âœ“ on "end" event (3 ms)
2025-04-15T01:08:42.5780423Z       âœ“ on "close" event (2 ms)
2025-04-15T01:08:42.5781334Z       âœ“ on "finish" event (2 ms)
2025-04-15T01:08:42.5783529Z     sends data
2025-04-15T01:08:42.5784080Z       âœ“ to one connection (3 ms)
2025-04-15T01:08:42.5784641Z       âœ“ to all connections (2 ms)
2025-04-15T01:08:42.5785202Z       âœ“ to a specific user (10 ms)
2025-04-15T01:08:42.5785519Z 
2025-04-15T01:08:45.5395353Z PASS src/services/__tests__/active-workflows.service.test.ts
2025-04-15T01:08:45.5396992Z   ActiveWorkflowsService
2025-04-15T01:08:45.5397822Z     getAllActiveIdsInStorage
2025-04-15T01:08:45.5400187Z       âœ“ should filter out any workflow ids that have activation errors (8 ms)
2025-04-15T01:08:45.5401371Z     getAllActiveIdsFor
2025-04-15T01:08:45.5405219Z       âœ“ should return all workflow ids when user has full access (2 ms)
2025-04-15T01:08:45.5406736Z       âœ“ should filter out workflow ids that the user does not have access to (1 ms)
2025-04-15T01:08:45.5408718Z     getActivationError
2025-04-15T01:08:45.5409700Z       âœ“ should throw a BadRequestError a user does not have access to the workflow id (19 ms)
2025-04-15T01:08:45.5410762Z       âœ“ should return the error when the user has access (1 ms)
2025-04-15T01:08:45.5411190Z 
2025-04-15T01:08:48.6805735Z PASS src/workflows/workflow-history.ee/__tests__/workflow-history.service.ee.test.ts
2025-04-15T01:08:48.6808411Z   WorkflowHistoryService
2025-04-15T01:08:48.6810339Z     saveVersion
2025-04-15T01:08:48.6819113Z       âœ“ should save a new version when workflow history is enabled and nodes and connections are present (5 ms)
2025-04-15T01:08:48.6828890Z       âœ“ should not save a new version when workflow history is disabled (1 ms)
2025-04-15T01:08:48.6829950Z       âœ“ should not save a new version when nodes or connections are missing (1 ms)
2025-04-15T01:08:48.6830984Z       âœ“ should log an error when failed to save workflow history version (7 ms)
2025-04-15T01:08:48.6832130Z 
2025-04-15T01:08:50.6757854Z PASS test/integration/commands/reset.cmd.test.ts (25.554 s)
2025-04-15T01:08:50.6764059Z   âœ“ user-management:reset should reset DB to default user state (118 ms)
2025-04-15T01:08:50.6764740Z 
2025-04-15T01:08:53.4465199Z PASS src/task-runners/task-broker/auth/__tests__/task-broker-auth.controller.test.ts
2025-04-15T01:08:53.4470387Z   TaskBrokerAuthController
2025-04-15T01:08:53.4473401Z     createGrantToken
2025-04-15T01:08:53.4476606Z       âœ“ should throw BadRequestError when auth token is missing (14 ms)
2025-04-15T01:08:53.4477940Z       âœ“ should throw ForbiddenError when auth token is invalid (1 ms)
2025-04-15T01:08:53.4485620Z       âœ“ should return rant token when auth token is valid (5 ms)
2025-04-15T01:08:53.4486220Z     authMiddleware
2025-04-15T01:08:53.4486919Z       âœ“ should respond with 401 when grant token is missing (2 ms)
2025-04-15T01:08:53.4487802Z       âœ“ should respond with 403 when grant token is invalid (2 ms)
2025-04-15T01:08:53.4488635Z       âœ“ should call next() when grant token is valid (8 ms)
2025-04-15T01:08:53.4489071Z 
2025-04-15T01:08:55.8837665Z PASS src/task-runners/task-managers/__tests__/data-request-response-builder.test.ts
2025-04-15T01:08:55.8843124Z   DataRequestResponseBuilder
2025-04-15T01:08:55.8853220Z     âœ“ picks only specific properties for additional data (8 ms)
2025-04-15T01:08:55.8855366Z     âœ“ picks only specific properties for workflow (3 ms)
2025-04-15T01:08:55.8856577Z     âœ“ clears nodeExecutionStack, waitingExecution and waitingExecutionSource from runExecutionData (3 ms)
2025-04-15T01:08:55.8857853Z 
2025-04-15T01:08:57.5951236Z PASS test/integration/task-runners/task-runner-process.test.ts (8.69 s)
2025-04-15T01:08:57.5956255Z   TaskRunnerProcess
2025-04-15T01:08:57.5960490Z     âœ“ should start and connect the task runner (1243 ms)
2025-04-15T01:08:57.5965224Z     âœ“ should stop an disconnect the task runner (1430 ms)
2025-04-15T01:08:57.5969512Z     âœ“ should restart the task runner if it exits (2485 ms)
2025-04-15T01:08:57.5973749Z     âœ“ should work together with restart loop detector (1031 ms)
2025-04-15T01:08:57.5975260Z 
2025-04-15T01:09:00.8469550Z PASS src/controllers/__tests__/ai.controller.test.ts
2025-04-15T01:09:00.8474277Z   AiController
2025-04-15T01:09:00.8476631Z     chat
2025-04-15T01:09:00.8479631Z       âœ“ should handle chat request successfully (12 ms)
2025-04-15T01:09:00.8482217Z       âœ“ should throw InternalServerError if chat fails (13 ms)
2025-04-15T01:09:00.8482804Z     applySuggestion
2025-04-15T01:09:00.8483420Z       âœ“ should apply suggestion successfully (2 ms)
2025-04-15T01:09:00.8484316Z       âœ“ should throw InternalServerError if applying suggestion fails (1 ms)
2025-04-15T01:09:00.8484955Z     askAi method
2025-04-15T01:09:00.8485473Z       âœ“ should ask AI successfully (2 ms)
2025-04-15T01:09:00.8486233Z       âœ“ should throw InternalServerError if asking AI fails (1 ms)
2025-04-15T01:09:00.8486668Z 
2025-04-15T01:09:03.8393712Z PASS src/databases/repositories/__tests__/shared-credentials.repository.test.ts
2025-04-15T01:09:03.8394639Z   SharedCredentialsRepository
2025-04-15T01:09:03.8395075Z     findCredentialForUser
2025-04-15T01:09:03.8395940Z       âœ“ should allow instance owner access to all credentials (6 ms)
2025-04-15T01:09:03.8396556Z       âœ“ should allow members (1 ms)
2025-04-15T01:09:03.8397255Z       âœ“ should return null when no shared credential is found (1 ms)
2025-04-15T01:09:03.8397682Z 
2025-04-15T01:09:06.3057005Z PASS src/task-runners/__tests__/forward-to-logger.test.ts
2025-04-15T01:09:06.3064408Z   forwardToLogger
2025-04-15T01:09:06.3065218Z     âœ“ should forward stdout data to logger.info (12 ms)
2025-04-15T01:09:06.3065912Z     âœ“ should forward stderr data to logger.error (1 ms)
2025-04-15T01:09:06.3066571Z     âœ“ should remove trailing newline from stdout (1 ms)
2025-04-15T01:09:06.3067235Z     âœ“ should remove trailing newline from stderr (1 ms)
2025-04-15T01:09:06.3067912Z     âœ“ should forward stderr data to logger.error (1 ms)
2025-04-15T01:09:06.3068571Z     âœ“ should include prefix if provided for stdout
2025-04-15T01:09:06.3069660Z     âœ“ should include prefix if provided for stderr (1 ms)
2025-04-15T01:09:06.3070502Z     âœ“ should make sure there is no duplicate space after prefix for stdout
2025-04-15T01:09:06.3071408Z     âœ“ should make sure there is no duplicate space after prefix for stderr
2025-04-15T01:09:06.3072023Z 
2025-04-15T01:09:07.5310048Z PASS test/integration/security-audit/nodes-risk-reporter.test.ts (24.738 s)
2025-04-15T01:09:07.5315072Z   âœ“ should report risky official nodes (133 ms)
2025-04-15T01:09:07.5315942Z   âœ“ should not report non-risky official nodes (24 ms)
2025-04-15T01:09:07.5316688Z   âœ“ should report community nodes (7 ms)
2025-04-15T01:09:07.5317018Z 
2025-04-15T01:09:09.3785662Z PASS src/services/__tests__/user.service.test.ts
2025-04-15T01:09:09.3791171Z   UserService
2025-04-15T01:09:09.3797823Z     toPublic
2025-04-15T01:09:09.3798887Z       âœ“ should remove sensitive properties (6 ms)
2025-04-15T01:09:09.3803263Z       âœ“ should add scopes if requested (1 ms)
2025-04-15T01:09:09.3804142Z       âœ“ should add invite URL if requested (1 ms)
2025-04-15T01:09:09.3804869Z     update
2025-04-15T01:09:09.3806375Z       âœ“ should use `save` instead of `update` (1 ms)
2025-04-15T01:09:09.3806726Z 
2025-04-15T01:09:11.8437334Z PASS src/validators/__tests__/no-xss.validator.test.ts
2025-04-15T01:09:11.8438365Z   NoXss
2025-04-15T01:09:11.8438689Z     Scripts
2025-04-15T01:09:11.8439401Z       âœ“ should block <script src/> (9 ms)
2025-04-15T01:09:11.8440552Z       âœ“ should block <script>alert('xss')</script> (1 ms)
2025-04-15T01:09:11.8441236Z       âœ“ should block <a href="#">Jack</a> (1 ms)
2025-04-15T01:09:11.8441906Z     Names
2025-04-15T01:09:11.8442378Z       âœ“ should allow Johann StrauÃŸ (1 ms)
2025-04-15T01:09:11.8442940Z       âœ“ should allow Ð’Ð°Ð³Ð¸Ñ„ Ð¡Ó™Ð¼Ó™Ð´Ð¾Ò“Ð»Ñƒ
2025-04-15T01:09:11.8443461Z       âœ“ should allow RenÃ© Magritte
2025-04-15T01:09:11.8443997Z       âœ“ should allow à¦¸à§à¦•à§à¦®à¦¾à¦° à¦°à¦¾à§Ÿ (1 ms)
2025-04-15T01:09:11.8444530Z       âœ“ should allow à½˜à½‚à½¼à½“à¼‹à½”à½¼à¼‹à½¢à¾¡à½¼à¼‹à½¢à¾—à½ºà¼
2025-04-15T01:09:11.8445096Z       âœ“ should allow Ø¹Ø¨Ø¯Ø§Ù„Ø­Ù„ÙŠÙ… Ø­Ø§ÙØ¸ (1 ms)
2025-04-15T01:09:11.8445519Z     ISO-8601 timestamps
2025-04-15T01:09:11.8446072Z       âœ“ should allow 2022-01-01T00:00:00.000Z (1 ms)
2025-04-15T01:09:11.8446756Z       âœ“ should allow 2022-01-01T00:00:00.000+02:00 (1 ms)
2025-04-15T01:09:11.8447221Z     Semver versions
2025-04-15T01:09:11.8447650Z       âœ“ should allow 1.0.0 (1 ms)
2025-04-15T01:09:11.8448155Z       âœ“ should allow 1.0.0-alpha.1
2025-04-15T01:09:11.8448590Z     Miscellaneous strings
2025-04-15T01:09:11.8449055Z       âœ“ should allow CI/CD (1 ms)
2025-04-15T01:09:11.8449445Z     Array of strings
2025-04-15T01:09:11.8450217Z       âœ“ should allow array: ["cloud-infrastructure-orchestration","ci-cd","reporting"]
2025-04-15T01:09:11.8451389Z       âœ“ should allow array: ["automationGoalDevops","cloudComputing","containerization"] (1 ms)
2025-04-15T01:09:11.8453052Z       âœ“ should reject array containing invalid string: ["valid-string","<script>alert(\"xss\")</script>","another-valid-string"] (1 ms)
2025-04-15T01:09:11.8454867Z       âœ“ should reject array containing invalid string: ["<img src=\"x\" onerror=\"alert('XSS')\">","valid-string"] (1 ms)
2025-04-15T01:09:11.8455546Z 
2025-04-15T01:09:23.3856064Z PASS test/integration/project.service.integration.test.ts (25.521 s)
2025-04-15T01:09:23.3857154Z   ProjectService
2025-04-15T01:09:23.3857647Z     findRolesInProjects
2025-04-15T01:09:23.3858211Z       when user has roles in projects where workflow is accessible
2025-04-15T01:09:23.3859114Z         âœ“ should return roles and project IDs (56 ms)
2025-04-15T01:09:23.3859798Z       when user has no roles in projects where workflow is accessible
2025-04-15T01:09:23.3860563Z         âœ“ should return project IDs but no roles (14 ms)
2025-04-15T01:09:23.3861240Z       when user has roles in projects where workflow is inaccessible
2025-04-15T01:09:23.3862211Z         âœ“ should return project IDs but no roles (28 ms)
2025-04-15T01:09:23.3862571Z 
2025-04-15T01:09:35.4606027Z PASS test/integration/ai/ai.api.test.ts (27.701 s)
2025-04-15T01:09:35.4607115Z   POST /ai/free-credits
2025-04-15T01:09:35.4608115Z     âœ“ should create OpenAI managed credential (108 ms)
2025-04-15T01:09:35.4609471Z 
2025-04-15T01:09:38.1557071Z PASS test/integration/activation-errors.service.test.ts
2025-04-15T01:09:38.1558722Z   ActivationErrorsService
2025-04-15T01:09:38.1559826Z     register
2025-04-15T01:09:38.1562600Z       âœ“ should register an activation error for a workflow (7 ms)
2025-04-15T01:09:38.1564973Z     deregister
2025-04-15T01:09:38.1565686Z       âœ“ should deregister an activation error for a workflow (1 ms)
2025-04-15T01:09:38.1566249Z     get
2025-04-15T01:09:38.1566799Z       âœ“ should retrieve an activation error for a workflow
2025-04-15T01:09:38.1567662Z       âœ“ should return `null` if no activation error found for a workflow (1 ms)
2025-04-15T01:09:38.1568249Z     getAll
2025-04-15T01:09:38.1568761Z       âœ“ should retrieve all activation errors (1 ms)
2025-04-15T01:09:38.1569504Z       âœ“ should return an empty object if no activation errors
2025-04-15T01:09:38.1570039Z     clearAll()
2025-04-15T01:09:38.1570528Z       âœ“ should clear activation errors (1 ms)
2025-04-15T01:09:38.1570841Z 
2025-04-15T01:09:39.3033255Z PASS test/integration/tags.api.test.ts (27.206 s)
2025-04-15T01:09:39.3035603Z   POST /tags
2025-04-15T01:09:39.3036570Z     âœ“ should create tag (44 ms)
2025-04-15T01:09:39.3037210Z     âœ“ should not create duplicate tag (80 ms)
2025-04-15T01:09:39.3037814Z     âœ“ should delete tag (14 ms)
2025-04-15T01:09:39.3038385Z     âœ“ should update tag name (25 ms)
2025-04-15T01:09:39.3038965Z     âœ“ should retrieve all tags (16 ms)
2025-04-15T01:09:39.3039679Z     âœ“ should retrieve all tags with with usage count (18 ms)
2025-04-15T01:09:39.3040095Z 
2025-04-15T01:09:40.6962965Z PASS src/webhooks/__tests__/test-webhook-registrations.service.test.ts
2025-04-15T01:09:40.6964525Z   TestWebhookRegistrationsService
2025-04-15T01:09:40.6965165Z     register()
2025-04-15T01:09:40.6966210Z       âœ“ should register a test webhook registration (9 ms)
2025-04-15T01:09:40.6967438Z       âœ“ should skip setting TTL in single-main setup
2025-04-15T01:09:40.6968170Z     deregister()
2025-04-15T01:09:40.6969005Z       âœ“ should deregister a test webhook registration (1 ms)
2025-04-15T01:09:40.6969743Z     get()
2025-04-15T01:09:40.6970520Z       âœ“ should retrieve a test webhook registration (1 ms)
2025-04-15T01:09:40.6971945Z       âœ“ should return undefined if no such test webhook registration was found (1 ms)
2025-04-15T01:09:40.6972897Z     getAllKeys()
2025-04-15T01:09:40.6973835Z       âœ“ should retrieve all test webhook registration keys (1 ms)
2025-04-15T01:09:40.6974839Z     getAllRegistrations()
2025-04-15T01:09:40.6975781Z       âœ“ should retrieve all test webhook registrations (2 ms)
2025-04-15T01:09:40.6976580Z     deregisterAll()
2025-04-15T01:09:40.6977440Z       âœ“ should deregister all test webhook registrations
2025-04-15T01:09:40.6978547Z     toKey()
2025-04-15T01:09:40.6979449Z       âœ“ should convert a test webhook registration to a key (1 ms)
2025-04-15T01:09:40.6980613Z 
2025-04-15T01:09:42.4421476Z PASS src/services/__tests__/naming.service.test.ts
2025-04-15T01:09:42.4426552Z   NamingService
2025-04-15T01:09:42.4430885Z     getUniqueWorkflowName()
2025-04-15T01:09:42.4438706Z       âœ“ should return requested name if already unique (7 ms)
2025-04-15T01:09:42.4443712Z       âœ“ should return requested name suffixed if already existing once (1 ms)
2025-04-15T01:09:42.4448750Z       âœ“ should return requested name with incremented suffix if already suffixed (1 ms)
2025-04-15T01:09:42.4449928Z     getUniqueCredentialName()
2025-04-15T01:09:42.4451323Z       âœ“ should return requested name if already unique (1 ms)
2025-04-15T01:09:42.4452864Z       âœ“ should return requested name suffixed if already existing once (1 ms)
2025-04-15T01:09:42.4457887Z       âœ“ should return requested name with incremented suffix if already suffixed (1 ms)
2025-04-15T01:09:42.4460051Z 
2025-04-15T01:09:45.3035703Z PASS src/user-management/email/__tests__/user-management-mailer.test.ts
2025-04-15T01:09:45.3037882Z   UserManagementMailer
2025-04-15T01:09:45.3038320Z     when SMTP is not configured
2025-04-15T01:09:45.3039069Z       âœ“ should not setup email transport (5 ms)
2025-04-15T01:09:45.3039608Z       âœ“ should not send emails
2025-04-15T01:09:45.3039993Z     when SMTP is configured
2025-04-15T01:09:45.3040487Z       âœ“ should setup email transport (2 ms)
2025-04-15T01:09:45.3041075Z       âœ“ should send invitation emails (13 ms)
2025-04-15T01:09:45.3042394Z       âœ“ should send password reset emails (4 ms)
2025-04-15T01:09:45.3042743Z 
2025-04-15T01:09:51.6034594Z PASS test/integration/commands/worker.cmd.test.ts (28.05 s)
2025-04-15T01:09:51.6036150Z   âœ“ worker initializes all its components (157 ms)
2025-04-15T01:09:51.6038819Z 
2025-04-15T01:10:07.6390034Z PASS test/integration/database/repositories/execution.repository.test.ts (26.7 s)
2025-04-15T01:10:07.6391905Z   ExecutionRepository
2025-04-15T01:10:07.6392766Z     createNewExecution
2025-04-15T01:10:07.6397992Z       âœ“ should save execution data (35 ms)
2025-04-15T01:10:07.6398895Z       âœ“ should not create execution if execution data insert fails (17 ms)
2025-04-15T01:10:07.6399361Z 
2025-04-15T01:10:11.3774711Z PASS src/webhooks/__tests__/waiting-webhooks.test.ts
2025-04-15T01:10:11.3775443Z   WaitingWebhooks
2025-04-15T01:10:11.3779077Z     âœ“ should throw NotFoundError if there is no execution to resume (26 ms)
2025-04-15T01:10:11.3781408Z     âœ“ should throw ConflictError if the execution to resume is already running (1 ms)
2025-04-15T01:10:11.3785818Z     âœ“ should throw ConflictError if the execution to resume already finished (2 ms)
2025-04-15T01:10:11.3786962Z     âœ“ should mark as test webhook when execution mode is manual (2 ms)
2025-04-15T01:10:11.3787942Z 
2025-04-15T01:10:12.1140607Z PASS test/integration/license-metrics.repository.test.ts (26.589 s)
2025-04-15T01:10:12.1146482Z   LicenseMetricsRepository
2025-04-15T01:10:12.1146956Z     getLicenseRenewalMetrics
2025-04-15T01:10:12.1147824Z       âœ“ should return license renewal metrics (81 ms)
2025-04-15T01:10:12.1148749Z       âœ“ should handle zero execution statistics correctly (15 ms)
2025-04-15T01:10:12.1149197Z 
2025-04-15T01:10:15.2169199Z PASS src/modules/insights/__tests__/insights.module.test.ts
2025-04-15T01:10:15.2169909Z   InsightsModule
2025-04-15T01:10:15.2170274Z     backgroundProcess
2025-04-15T01:10:15.2171254Z       âœ“ should start background process if instance is main and leader (9 ms)
2025-04-15T01:10:15.2172686Z       âœ“ should not start background process if instance is main but not leader (1 ms)
2025-04-15T01:10:15.2173695Z       âœ“ should start background process on leader takeover (1 ms)
2025-04-15T01:10:15.2174576Z       âœ“ should stop background process on leader stepdown (2 ms)
2025-04-15T01:10:15.2175010Z 
2025-04-15T01:10:17.9301252Z PASS src/evaluation.ee/test-runner/__tests__/create-pin-data.ee.test.ts
2025-04-15T01:10:17.9340436Z   createPinData
2025-04-15T01:10:17.9342371Z     âœ“ should create pin data from past execution data (7 ms)
2025-04-15T01:10:17.9347065Z     âœ“ should not create pin data for non-existing mocked nodes (1 ms)
2025-04-15T01:10:17.9349681Z     âœ“ should create pin data for all mocked nodes (1 ms)
2025-04-15T01:10:17.9350639Z     âœ“ should return empty object if no mocked nodes are provided
2025-04-15T01:10:17.9351338Z     âœ“ should create pin data for all mocked nodes with renamed nodes (1 ms)
2025-04-15T01:10:17.9351870Z 
2025-04-15T01:10:20.2783090Z PASS test/integration/workflows/workflow.service.test.ts (28.443 s)
2025-04-15T01:10:20.2786277Z   update()
2025-04-15T01:10:20.2789531Z     âœ“ should remove and re-add to active workflows on `active: true` payload (75 ms)
2025-04-15T01:10:20.2792854Z     âœ“ should remove from active workflows on `active: false` payload (33 ms)
2025-04-15T01:10:20.2797207Z 
2025-04-15T01:10:22.1255600Z PASS src/controllers/__tests__/auth.controller.test.ts
2025-04-15T01:10:22.1256348Z   AuthController
2025-04-15T01:10:22.1256691Z     login
2025-04-15T01:10:22.1257625Z       âœ“ should not validate email in "emailOrLdapLoginId" if LDAP is enabled (7 ms)
2025-04-15T01:10:22.1258108Z 
2025-04-15T01:10:22.7080533Z PASS src/concurrency/__tests__/concurrency-queue.test.ts
2025-04-15T01:10:22.7083944Z   ConcurrencyQueue
2025-04-15T01:10:22.7084854Z     âœ“ should limit concurrency (12 ms)
2025-04-15T01:10:22.7085645Z     âœ“ should debounce emitting of the `concurrency-check` event (1 ms)
2025-04-15T01:10:22.7086097Z 
2025-04-15T01:10:25.7282967Z PASS src/task-runners/task-broker/auth/__tests__/task-broker-auth.service.test.ts
2025-04-15T01:10:25.7288849Z   TaskBrokerAuthService
2025-04-15T01:10:25.7292396Z     isValidAuthToken
2025-04-15T01:10:25.7295444Z       âœ“ should be valid for the configured token (5 ms)
2025-04-15T01:10:25.7301470Z       âœ“ should be invalid for anything else
2025-04-15T01:10:25.7302180Z     createGrantToken
2025-04-15T01:10:25.7302796Z       âœ“ should generate a random token (3 ms)
2025-04-15T01:10:25.7303523Z       âœ“ should store the generated token in cache (2 ms)
2025-04-15T01:10:25.7304879Z     tryConsumeGrantToken
2025-04-15T01:10:25.7306494Z       âœ“ should return false for an invalid grant token
2025-04-15T01:10:25.7308961Z       âœ“ should return true for a valid grant token (1 ms)
2025-04-15T01:10:25.7312083Z       âœ“ should return false for a already used grant token
2025-04-15T01:10:25.7313490Z       âœ“ should return false for an expired grant token (302 ms)
2025-04-15T01:10:25.7314676Z 
2025-04-15T01:10:41.5247917Z PASS test/integration/commands/update/workflow.test.ts (29.214 s)
2025-04-15T01:10:41.5249708Z   âœ“ update:workflow can activate all workflows (43 ms)
2025-04-15T01:10:41.5251430Z   âœ“ update:workflow can deactivate all workflows (14 ms)
2025-04-15T01:10:41.5252795Z   âœ“ update:workflow can activate a specific workflow (20 ms)
2025-04-15T01:10:41.5253947Z   âœ“ update:workflow can deactivate a specific workflow (11 ms)
2025-04-15T01:10:41.5256973Z 
2025-04-15T01:10:44.5775905Z PASS src/external-secrets.ee/providers/__tests__/gcp-secrets-manager.test.ts
2025-04-15T01:10:44.5776777Z   GCP Secrets Manager
2025-04-15T01:10:44.5777549Z     âœ“ should update cached secrets (14 ms)
2025-04-15T01:10:44.5777903Z 
2025-04-15T01:10:49.3568202Z PASS src/credentials/__tests__/credentials.controller.test.ts
2025-04-15T01:10:49.3572656Z   CredentialsController
2025-04-15T01:10:49.3574643Z     createCredentials
2025-04-15T01:10:49.3576533Z       âœ“ should create new credentials and emit "credentials-created" (8 ms)
2025-04-15T01:10:49.3577248Z 
2025-04-15T01:10:52.7793327Z PASS test/integration/database/repositories/workflow.repository.test.ts (26.874 s)
2025-04-15T01:10:52.7797646Z   WorkflowRepository
2025-04-15T01:10:52.7799118Z     activateAll
2025-04-15T01:10:52.7801292Z       âœ“ should activate all workflows (34 ms)
2025-04-15T01:10:52.7803669Z     deactivateAll
2025-04-15T01:10:52.7804210Z       âœ“ should deactivate all workflows (10 ms)
2025-04-15T01:10:52.7804663Z     getActiveIds
2025-04-15T01:10:52.7805394Z       âœ“ should return all active workflow IDs when invoked without maxResults (10 ms)
2025-04-15T01:10:52.7806956Z       âœ“ should return a capped number of active workflow IDs when invoked with maxResults (10 ms)
2025-04-15T01:10:52.7807523Z 
2025-04-15T01:10:52.8604655Z PASS test/integration/environments/source-control.api.test.ts (30.502 s)
2025-04-15T01:10:52.8605567Z   GET /sourceControl/preferences
2025-04-15T01:10:52.8609729Z     âœ“ should return Source Control preferences (34 ms)
2025-04-15T01:10:52.8612698Z     âœ“ should return repo sync status (13 ms)
2025-04-15T01:10:52.8613563Z     âœ“ refreshing key pairsshould return new rsa key (1598 ms)
2025-04-15T01:10:52.8613990Z 
2025-04-15T01:10:53.8888365Z PASS src/scaling/__tests__/job-processor.service.test.ts
2025-04-15T01:10:53.8899822Z   JobProcessor
2025-04-15T01:10:53.8904002Z     âœ“ should refrain from processing a crashed execution (38 ms)
2025-04-15T01:10:53.8906566Z     âœ“ should use manualExecutionService to process a job in "manual" mode (13 ms)
2025-04-15T01:10:53.8914571Z     âœ“ should use manualExecutionService to process a job in "evaluation" mode (2 ms)
2025-04-15T01:10:53.8915272Z 
2025-04-15T01:10:55.3194935Z PASS src/collaboration/__tests__/collaboration.state.test.ts
2025-04-15T01:10:55.3207853Z   CollaborationState
2025-04-15T01:10:55.3212203Z     addCollaborator
2025-04-15T01:10:55.3215729Z       âœ“ should add workflow user with correct cache key and value (9 ms)
2025-04-15T01:10:55.3218621Z     removeCollaborator
2025-04-15T01:10:55.3221781Z       âœ“ should remove workflow user with correct cache key (1 ms)
2025-04-15T01:10:55.3235020Z     getCollaborators
2025-04-15T01:10:55.3235753Z       âœ“ should get workflows with correct cache key (1 ms)
2025-04-15T01:10:55.3236562Z       âœ“ should get workflow users that are not expired (2 ms)
2025-04-15T01:10:55.3236971Z 
2025-04-15T01:10:55.6119196Z PASS src/decorators/__tests__/on-shutdown.test.ts
2025-04-15T01:10:55.6120266Z   OnShutdown
2025-04-15T01:10:55.6121427Z     âœ“ should register a methods that is decorated with OnShutdown (8 ms)
2025-04-15T01:10:55.6122948Z     âœ“ should register multiple methods in the same class (7 ms)
2025-04-15T01:10:55.6126606Z     âœ“ should use the given priority (1 ms)
2025-04-15T01:10:55.6128294Z     âœ“ should throw an error if the decorated member is not a function (11 ms)
2025-04-15T01:10:55.6129979Z     âœ“ should throw if the priority is invalid (6 ms)
2025-04-15T01:10:55.6130960Z 
2025-04-15T01:10:56.4205465Z PASS src/evaluation.ee/test-runner/__tests__/evaluation-metrics.ee.test.ts
2025-04-15T01:10:56.4210369Z   EvaluationMetrics
2025-04-15T01:10:56.4215221Z     âœ“ should aggregate metrics correctly (9 ms)
2025-04-15T01:10:56.4220211Z     âœ“ should throw when metric value is not number (13 ms)
2025-04-15T01:10:56.4221200Z     âœ“ should handle empty metrics
2025-04-15T01:10:56.4222904Z     âœ“ should handle empty testMetrics
2025-04-15T01:10:56.4225250Z     âœ“ should ignore non-relevant values (1 ms)
2025-04-15T01:10:56.4226440Z     âœ“ should report info on added metrics (2 ms)
2025-04-15T01:10:56.4227461Z 
2025-04-15T01:10:58.9248347Z PASS src/task-runners/task-broker/__tests__/task-broker-ws-server.test.ts
2025-04-15T01:10:58.9253247Z   TaskBrokerWsServer
2025-04-15T01:10:58.9257068Z     removeConnection
2025-04-15T01:10:58.9258433Z       âœ“ should close with 1000 status code by default (6 ms)
2025-04-15T01:10:58.9259906Z     heartbeat timer
2025-04-15T01:10:58.9260760Z       âœ“ should set up heartbeat timer on server start (2 ms)
2025-04-15T01:10:58.9261895Z       âœ“ should clear heartbeat timer on server stop
2025-04-15T01:10:58.9262581Z     sendMessage
2025-04-15T01:10:58.9263417Z       âœ“ should work with a message containing circular references (1 ms)
2025-04-15T01:10:58.9264540Z 
2025-04-15T01:11:00.5373733Z PASS src/workflows/__tests__/workflows.controller.test.ts
2025-04-15T01:11:00.5374397Z   WorkflowsController
2025-04-15T01:11:00.5374745Z     getFromUrl
2025-04-15T01:11:00.5375108Z       should return workflow data
2025-04-15T01:11:00.5375940Z         âœ“ when the URL points to a valid JSON file (5 ms)
2025-04-15T01:11:00.5376483Z       should throw a BadRequestError
2025-04-15T01:11:00.5377606Z         âœ“ when the URL does not point to a valid JSON file (24 ms)
2025-04-15T01:11:00.5378419Z         âœ“ when the data is not a valid n8n workflow JSON
2025-04-15T01:11:00.5379158Z         âœ“ when the data is missing required fields
2025-04-15T01:11:00.5379541Z 
2025-04-15T01:11:03.5869916Z PASS src/metrics/__tests__/license-metrics.service.test.ts
2025-04-15T01:11:03.5874555Z   LicenseMetricsService
2025-04-15T01:11:03.5878671Z     collectPassthroughData
2025-04-15T01:11:03.5883540Z       âœ“ should return an object with active workflow IDs (10 ms)
2025-04-15T01:11:03.5887781Z     collectUsageMetrics
2025-04-15T01:11:03.5892274Z       âœ“ should return an array of expected usage metrics (2 ms)
2025-04-15T01:11:03.5896333Z 
2025-04-15T01:11:24.1151988Z PASS test/integration/workflow-tag-mapping.repository.integration.test.ts (28.579 s)
2025-04-15T01:11:24.1156255Z   WorkflowTagMappingRepository
2025-04-15T01:11:24.1156717Z     overwriteTaggings
2025-04-15T01:11:24.1157593Z       âœ“ should overwrite taggings in a workflow (42 ms)
2025-04-15T01:11:24.1158417Z       âœ“ should delete taggings if no tags are provided (13 ms)
2025-04-15T01:11:24.1158843Z 
2025-04-15T01:11:28.7210923Z PASS test/integration/debug.controller.test.ts (29.573 s)
2025-04-15T01:11:28.7255144Z   DebugController
2025-04-15T01:11:28.7255996Z     GET /debug/multi-main-setup
2025-04-15T01:11:28.7257086Z       âœ“ should return multi-main setup details (37 ms)
2025-04-15T01:11:28.7257969Z 
2025-04-15T01:11:31.0932026Z PASS src/evaluation.ee/test-runner/__tests__/format-test-case-execution-input-data.ee.test.ts
2025-04-15T01:11:31.0933044Z   formatTestCaseExecutionInputData
2025-04-15T01:11:31.0934292Z     âœ“ should format the test case execution input data correctly (8 ms)
2025-04-15T01:11:31.0935719Z 
2025-04-15T01:11:33.3828342Z PASS src/posthog/__tests__/posthog.test.ts
2025-04-15T01:11:33.3829068Z   PostHog
2025-04-15T01:11:33.3829897Z     âœ“ inits PostHog correctly (7 ms)
2025-04-15T01:11:33.3830903Z     âœ“ does not initialize or track if diagnostics are not enabled (1 ms)
2025-04-15T01:11:33.3831860Z     âœ“ captures PostHog events (1 ms)
2025-04-15T01:11:33.3832402Z     âœ“ gets feature flags (1 ms)
2025-04-15T01:11:33.3832661Z 
2025-04-15T01:11:34.4981842Z PASS test/integration/eventbus.test.ts (30.682 s)
2025-04-15T01:11:34.4982516Z   GET /eventbus/destination
2025-04-15T01:11:34.4983409Z     âœ“ should fail due to missing authentication (25 ms)
2025-04-15T01:11:34.4992265Z     âœ“ should fail due to missing license when authenticated (15 ms)
2025-04-15T01:11:34.4992955Z   POST /eventbus/destination
2025-04-15T01:11:34.4993641Z     âœ“ should fail due to missing authentication (3 ms)
2025-04-15T01:11:34.4994489Z     âœ“ should fail due to missing license when authenticated (6 ms)
2025-04-15T01:11:34.4995106Z   DELETE /eventbus/destination
2025-04-15T01:11:34.4995745Z     âœ“ should fail due to missing authentication (4 ms)
2025-04-15T01:11:34.4996603Z     âœ“ should fail due to missing license when authenticated (6 ms)
2025-04-15T01:11:34.4997085Z 
2025-04-15T01:11:37.0618024Z PASS src/task-runners/__tests__/task-runner-process-restart-loop-detector.test.ts
2025-04-15T01:11:37.0646697Z   TaskRunnerProcessRestartLoopDetector
2025-04-15T01:11:37.0648343Z     âœ“ should detect a restart loop if process exits 5 times within 5s (5 ms)
2025-04-15T01:11:37.0651371Z     âœ“ should not detect a restart loop if process exits less than 5 times within 5s (2 ms)
2025-04-15T01:11:37.0652162Z 
2025-04-15T01:11:55.1498178Z PASS test/integration/insights/insights.api.test.ts (30.814 s)
2025-04-15T01:11:55.1500721Z   GET /insights routes work for owner and admins
2025-04-15T01:11:55.1504047Z     âœ“ Call should work and return empty summary for user owner (45 ms)
2025-04-15T01:11:55.1507474Z     âœ“ Call should work and return empty summary for user member (14 ms)
2025-04-15T01:11:55.1508390Z     âœ“ Call should work and return empty summary for user admin (19 ms)
2025-04-15T01:11:55.1508956Z   GET /insights/by-worklow
2025-04-15T01:11:55.1509570Z     âœ“ Call should work with valid query parameters (7 ms)
2025-04-15T01:11:55.1511039Z     âœ“ Call should return internal server error with invalid pagination query parameters (11 ms)
2025-04-15T01:11:55.1512420Z     âœ“ Call should return internal server error with invalid pagination query parameters (6 ms)
2025-04-15T01:11:55.1513471Z     âœ“ Call should return bad request with invalid sortby query parameters (5 ms)
2025-04-15T01:11:55.1513954Z 
2025-04-15T01:11:58.2480334Z PASS src/sso.ee/saml/routes/__tests__/saml.controller.ee.test.ts
2025-04-15T01:11:58.2482976Z   Test views
2025-04-15T01:11:58.2485274Z     âœ“ Should render success with template (5 ms)
2025-04-15T01:11:58.2490042Z     âœ“ Should render failure with template
2025-04-15T01:11:58.2493258Z     âœ“ Should render error with template (1 ms)
2025-04-15T01:11:58.2495720Z 
2025-04-15T01:12:01.4588003Z PASS src/environments.ee/source-control/__tests__/source-control-git.service.test.ts
2025-04-15T01:12:01.4588891Z   SourceControlGitService
2025-04-15T01:12:01.4589342Z     getBranches
2025-04-15T01:12:01.4590164Z       âœ“ should support branch names containing slashes (4 ms)
2025-04-15T01:12:01.4590709Z     initRepository
2025-04-15T01:12:01.4591168Z       when local repo is set up after remote is ready
2025-04-15T01:12:01.4592046Z         âœ“ should track remote (8 ms)
2025-04-15T01:12:01.4592361Z 
2025-04-15T01:12:02.1380189Z PASS src/modules/insights/database/entities/__tests__/insights-raw.test.ts (28.589 s)
2025-04-15T01:12:02.1383441Z   Insights Raw Entity
2025-04-15T01:12:02.1385807Z     âœ“ `success` can be serialized and deserialized correctly (8 ms)
2025-04-15T01:12:02.1388375Z     âœ“ `failure` can be serialized and deserialized correctly (2 ms)
2025-04-15T01:12:02.1389371Z     âœ“ `runtime_ms` can be serialized and deserialized correctly (1 ms)
2025-04-15T01:12:02.1390386Z     âœ“ `time_saved_min` can be serialized and deserialized correctly (1 ms)
2025-04-15T01:12:02.1391407Z     âœ“ `timestamp` can be serialized and deserialized correctly (1 ms)
2025-04-15T01:12:02.1392577Z     âœ“ timestamp uses the correct default value (71 ms)
2025-04-15T01:12:02.1392995Z 
2025-04-15T01:12:03.8790307Z PASS src/task-runners/__tests__/sliding-window-signal.test.ts
2025-04-15T01:12:03.8791095Z   SlidingWindowSignal
2025-04-15T01:12:03.8792337Z     âœ“ should return the last signal if within window size (7 ms)
2025-04-15T01:12:03.8793346Z     âœ“ should return null if there is no signal within the window (3 ms)
2025-04-15T01:12:03.8794356Z     âœ“ should return null if "exit" event is not emitted before timeout (1 ms)
2025-04-15T01:12:03.8795426Z     âœ“ should return the signal emitted on "exit" event before timeout (1 ms)
2025-04-15T01:12:03.8795940Z 
2025-04-15T01:12:04.4900495Z PASS src/services/cache/__tests__/cache-mock.service.test.ts
2025-04-15T01:12:04.4911934Z   CacheService (Mock)
2025-04-15T01:12:04.4916478Z     should prevent use of empty keys
2025-04-15T01:12:04.4924739Z       âœ“ get (9 ms)
2025-04-15T01:12:04.4928979Z       âœ“ getMany (1 ms)
2025-04-15T01:12:04.4933337Z       âœ“ set (2 ms)
2025-04-15T01:12:04.4937505Z       âœ“ setMany (1 ms)
2025-04-15T01:12:04.4941767Z       âœ“ delete
2025-04-15T01:12:04.4945931Z       âœ“ deleteMany (1 ms)
2025-04-15T01:12:04.4949827Z 
2025-04-15T01:12:05.6905752Z PASS test/integration/security-audit/filesystem-risk-reporter.test.ts (28.46 s)
2025-04-15T01:12:05.6913768Z   âœ“ should report filesystem interaction nodes (82 ms)
2025-04-15T01:12:05.6916902Z   âœ“ should not report non-filesystem-interaction node (7 ms)
2025-04-15T01:12:05.6919534Z 
2025-04-15T01:12:06.9676061Z PASS src/services/__tests__/jwt.service.test.ts
2025-04-15T01:12:06.9680680Z   JwtService
2025-04-15T01:12:06.9685180Z     secret initialization
2025-04-15T01:12:06.9688310Z       âœ“ should read the secret from config, when set (7 ms)
2025-04-15T01:12:06.9690967Z       âœ“ should derive the secret from encryption key when not set in config (1 ms)
2025-04-15T01:12:06.9694106Z     with a secret set
2025-04-15T01:12:06.9696577Z       âœ“ should sign (3 ms)
2025-04-15T01:12:06.9699573Z       âœ“ should decode and verify payload (3 ms)
2025-04-15T01:12:06.9703233Z       âœ“ should throw an error on verify if the token is expired (12 ms)
2025-04-15T01:12:06.9704879Z 
2025-04-15T01:12:08.4252152Z PASS src/external-secrets.ee/providers/__tests__/azure-key-vault.test.ts
2025-04-15T01:12:08.4253172Z   AzureKeyVault
2025-04-15T01:12:08.4253939Z     âœ“ should update cached secrets (108 ms)
2025-04-15T01:12:08.4255112Z 
2025-04-15T01:12:09.6335507Z PASS src/task-runners/task-broker/__tests__/task-broker-server.test.ts
2025-04-15T01:12:09.6340085Z   TaskBrokerServer
2025-04-15T01:12:09.6344778Z     handleUpgradeRequest
2025-04-15T01:12:09.6345981Z       âœ“ should close WebSocket when response status code is > 200 (10 ms)
2025-04-15T01:12:09.6347271Z       âœ“ should not close WebSocket when response status code is 200 (2 ms)
2025-04-15T01:12:09.6348601Z 
2025-04-15T01:12:10.7755733Z PASS src/executions/__tests__/execution-data.service.test.ts
2025-04-15T01:12:10.7756448Z   ExecutionDataService
2025-04-15T01:12:10.7756884Z     generateFailedExecutionFromError
2025-04-15T01:12:10.7757948Z       âœ“ should generate a failed execution with error details (12 ms)
2025-04-15T01:12:10.7758887Z       âœ“ should generate a failed execution without node details if node is undefined (1 ms)
2025-04-15T01:12:10.7759378Z 
2025-04-15T01:12:12.9883971Z PASS src/public-api/v1/__tests__/global.middleware.test.ts
2025-04-15T01:12:12.9886936Z   apiKeyHasScope
2025-04-15T01:12:12.9890239Z     âœ“ should return API key scope middleware if "feat:apiKeyScopes" is enabled (7 ms)
2025-04-15T01:12:12.9892034Z     âœ“ should return empty middleware if "feat:apiKeyScopes" is disabled (1 ms)
2025-04-15T01:12:12.9893157Z   apiKeyHasScopeWithGlobalScopeFallback
2025-04-15T01:12:12.9894341Z     âœ“ should return global middleware if "feat:apiKeyScopes" is disabled
2025-04-15T01:12:12.9894960Z 
2025-04-15T01:12:13.2084650Z PASS src/task-runners/errors/__tests__/task-runner-disconnected-error.test.ts
2025-04-15T01:12:13.2093654Z   TaskRunnerDisconnectedError
2025-04-15T01:12:13.2094851Z     âœ“ should have the correct default error message (4 ms)
2025-04-15T01:12:13.2095685Z     âœ“ should have the error level set to "error" (1 ms)
2025-04-15T01:12:13.2096645Z     âœ“ should set the correct description for non-cloud deployments (1 ms)
2025-04-15T01:12:13.2097558Z     âœ“ should set the correct description for cloud deployments (1 ms)
2025-04-15T01:12:13.2097996Z 
2025-04-15T01:12:15.5537313Z PASS src/modules/__tests__/modules.config.test.ts
2025-04-15T01:12:15.5539891Z   ModulesConfig
2025-04-15T01:12:15.5542981Z     âœ“ should initialize with insights modules if no environment variable is set (5 ms)
2025-04-15T01:12:15.5545212Z     âœ“ should parse valid module names from environment variable (1 ms)
2025-04-15T01:12:15.5557400Z     âœ“ should disable valid module names from environment variable
2025-04-15T01:12:15.5558217Z     âœ“ should throw UnexpectedError for invalid module names (14 ms)
2025-04-15T01:12:15.5559145Z     âœ“ should throw UnexpectedError if any module is both enabled and disabled (6 ms)
2025-04-15T01:12:15.5560156Z     âœ“ should throw UnexpectedError if any enabled module name is invalid (1 ms)
2025-04-15T01:12:15.5561119Z     âœ“ should throw UnexpectedError if any disabled module name is invalid (1 ms)
2025-04-15T01:12:15.5561739Z 
2025-04-15T01:12:16.1009646Z PASS src/databases/repositories/__tests__/workflow-statistics.test.ts
2025-04-15T01:12:16.1011198Z   insertWorkflowStatistics
2025-04-15T01:12:16.1012696Z     âœ“ Successfully inserts data when it is not yet present (6 ms)
2025-04-15T01:12:16.1013593Z     âœ“ Does not insert when data is present (1 ms)
2025-04-15T01:12:16.1014298Z     âœ“ throws an error when insertion fails (2 ms)
2025-04-15T01:12:16.1014650Z 
2025-04-15T01:12:17.9377053Z PASS src/__tests__/utils.test.ts
2025-04-15T01:12:17.9385907Z   shouldAssignExecuteMethod
2025-04-15T01:12:17.9406580Z     âœ“ should return true when node has no execute, poll, trigger, webhook (unless declarative), or methods (6 ms)
2025-04-15T01:12:17.9408967Z     âœ“ should return false when node has execute (1 ms)
2025-04-15T01:12:17.9411332Z     âœ“ should return false when node has poll
2025-04-15T01:12:17.9413571Z     âœ“ should return false when node has trigger (1 ms)
2025-04-15T01:12:17.9415735Z     âœ“ should return false when node has webhook and is not declarative
2025-04-15T01:12:17.9418224Z     âœ“ should return true when node has webhook but is declarative (1 ms)
2025-04-15T01:12:17.9419064Z     âœ“ should return false when node has methods
2025-04-15T01:12:17.9419437Z 
2025-04-15T01:12:19.3217788Z PASS src/sso.ee/saml/__tests__/saml-helpers.test.ts
2025-04-15T01:12:19.3222328Z   sso/saml/samlHelpers
2025-04-15T01:12:19.3224662Z     updateUserFromSamlAttributes
2025-04-15T01:12:19.3226640Z       âœ“ does not user `Repository.update`, but `Repository.save` instead (13 ms)
2025-04-15T01:12:19.3230237Z 
2025-04-15T01:12:22.3190259Z PASS test/integration/task-runners/task-runner-module.external.test.ts
2025-04-15T01:12:22.3192677Z   TaskRunnerModule in external mode
2025-04-15T01:12:22.3193764Z     start
2025-04-15T01:12:22.3196059Z       âœ“ should throw if the task runner is disabled (17 ms)
2025-04-15T01:12:22.3197150Z       âœ“ should throw if auth token is missing (10 ms)
2025-04-15T01:12:22.3200047Z       âœ“ should start the task runner (465 ms)
2025-04-15T01:12:22.3200812Z       âœ“ should use DefaultTaskRunnerDisconnectAnalyzer
2025-04-15T01:12:22.3201218Z 
2025-04-15T01:12:25.1308217Z PASS src/modules/insights/__tests__/insights.pre-init.test.ts
2025-04-15T01:12:25.1319900Z   InsightsModulePreInit
2025-04-15T01:12:25.1324713Z     âœ“ should return false if instance type is not "main" (6 ms)
2025-04-15T01:12:25.1329292Z     âœ“ should return false if database type is "sqlite" and poolSize is < 1 (1 ms)
2025-04-15T01:12:25.1334414Z     âœ“ should return true if instance type is "main" and database is not sqlite
2025-04-15T01:12:25.1335552Z     âœ“ should return true if instance type is "main" and database is not sqlite (1 ms)
2025-04-15T01:12:25.1339680Z     âœ“ should return true if instance type is "main" and database is not sqlite (1 ms)
2025-04-15T01:12:25.1344855Z     âœ“ should return true if instance type is "main" and sqlite poolSize is >= 1
2025-04-15T01:12:25.1345378Z 
2025-04-15T01:12:28.0194155Z PASS src/controllers/__tests__/translation.controller.test.ts
2025-04-15T01:12:28.0194809Z   TranslationController
2025-04-15T01:12:28.0195208Z     getCredentialTranslation
2025-04-15T01:12:28.0197167Z       âœ“ should throw 400 on invalid credential types (17 ms)
2025-04-15T01:12:28.0198021Z       âœ“ should return translation json on valid credential types (1 ms)
2025-04-15T01:12:28.0198464Z 
2025-04-15T01:12:33.3762712Z PASS test/integration/services/workflow-static-data.service.test.ts (29.26 s)
2025-04-15T01:12:33.3763929Z   WorkflowStaticDataService
2025-04-15T01:12:33.3765111Z     âœ“ should not change workflow updatedAt when calling saveStaticData (25 ms)
2025-04-15T01:12:33.3769423Z     âœ“ should not change workflow updatedAt when calling saveStaticDataById (5 ms)
2025-04-15T01:12:33.3770216Z 
2025-04-15T01:12:35.6223727Z PASS src/errors/response-errors/__tests__/webhook-not-found.error.test.ts
2025-04-15T01:12:35.6225197Z   utils test webhookNotFoundErrorMessage 
2025-04-15T01:12:35.6226249Z     âœ“ should return a message with path and method (4 ms)
2025-04-15T01:12:35.6230349Z     âœ“ should return a message with path
2025-04-15T01:12:35.6242781Z     âœ“ should return a message with method with tip (1 ms)
2025-04-15T01:12:35.6243939Z     âœ“ should return a message with method with tip
2025-04-15T01:12:35.6245125Z     âœ“ should return a message with method with tip (1 ms)
2025-04-15T01:12:35.6246613Z 
2025-04-15T01:12:49.6421338Z PASS test/integration/auth.mw.test.ts (31.446 s)
2025-04-15T01:12:49.6426681Z   Auth Middleware
2025-04-15T01:12:49.6427389Z     Routes requiring Authentication
2025-04-15T01:12:49.6428630Z       âœ“ patch /me should return 401 Unauthorized if no cookie (25 ms)
2025-04-15T01:12:49.6429645Z       âœ“ patch /me/password should return 401 Unauthorized if no cookie (3 ms)
2025-04-15T01:12:49.6430632Z       âœ“ post /me/survey should return 401 Unauthorized if no cookie (3 ms)
2025-04-15T01:12:49.6432357Z       âœ“ post /invitations should return 401 Unauthorized if no cookie (3 ms)
2025-04-15T01:12:49.6433308Z       âœ“ delete /users/123 should return 401 Unauthorized if no cookie (3 ms)
2025-04-15T01:12:49.6433971Z     Routes requiring Authorization
2025-04-15T01:12:49.6434767Z       âœ“ post /invitations should return 403 Forbidden for member (13 ms)
2025-04-15T01:12:49.6435670Z       âœ“ delete /users/123 should return 403 Forbidden for member (7 ms)
2025-04-15T01:12:49.6436133Z 
2025-04-15T01:12:51.9254190Z PASS src/scaling/__tests__/subscriber.service.test.ts
2025-04-15T01:12:51.9285176Z   Subscriber
2025-04-15T01:12:51.9285696Z     constructor
2025-04-15T01:12:51.9286476Z       âœ“ should init Redis client in scaling mode (7 ms)
2025-04-15T01:12:51.9287161Z       âœ“ should not init Redis client in regular mode (1 ms)
2025-04-15T01:12:51.9287652Z     shutdown
2025-04-15T01:12:51.9288069Z       âœ“ should disconnect Redis client (1 ms)
2025-04-15T01:12:51.9288519Z     subscribe
2025-04-15T01:12:51.9289000Z       âœ“ should subscribe to pubsub channel (1 ms)
2025-04-15T01:12:51.9289338Z 
2025-04-15T01:12:54.9506174Z PASS src/databases/repositories/__tests__/credentials.repository.test.ts
2025-04-15T01:12:54.9510884Z   findMany
2025-04-15T01:12:54.9519371Z     âœ“ return `data` property if `includeData:true` and select is using the record syntax (5 ms)
2025-04-15T01:12:54.9520641Z     âœ“ return `data` property if `includeData:true` and select is using the record syntax
2025-04-15T01:12:54.9521886Z 
2025-04-15T01:12:57.1738459Z PASS src/services/__tests__/url.service.test.ts
2025-04-15T01:12:57.1739068Z   UrlService
2025-04-15T01:12:57.1739351Z     getInstanceBaseUrl
2025-04-15T01:12:57.1740099Z       âœ“ should set URL from N8N_EDITOR_BASE_URL (8 ms)
2025-04-15T01:12:57.1740729Z       âœ“ should set URL from WEBHOOK_URL (1 ms)
2025-04-15T01:12:57.1741507Z       âœ“ should trim quotes when setting URL from N8N_EDITOR_BASE_URL (1 ms)
2025-04-15T01:12:57.1742622Z       âœ“ should trim quotes when setting URL from WEBHOOK_URL (1 ms)
2025-04-15T01:12:57.1743031Z 
2025-04-15T01:12:58.0115702Z PASS test/integration/user.repository.test.ts (29.825 s)
2025-04-15T01:12:58.0116398Z   UserRepository
2025-04-15T01:12:58.0116786Z     countUsersByRole()
2025-04-15T01:12:58.0117686Z       âœ“ should return the number of users in each role (74 ms)
2025-04-15T01:12:58.0118311Z     createUserWithProject()
2025-04-15T01:12:58.0119058Z       âœ“ should create personal project for a user (15 ms)
2025-04-15T01:12:58.0119472Z 
2025-04-15T01:13:00.1897762Z PASS test/integration/task-runners/task-runner-server.test.ts
2025-04-15T01:13:00.1898632Z   TaskBrokerServer
2025-04-15T01:13:00.1899384Z     /healthz
2025-04-15T01:13:00.1900364Z       âœ“ should return 200 (22 ms)
2025-04-15T01:13:00.1901035Z     /runners/_ws
2025-04-15T01:13:00.1902189Z       âœ“ should return 429 when too many requests are made (23 ms)
2025-04-15T01:13:00.1904906Z     /runners/auth
2025-04-15T01:13:00.1906944Z       âœ“ should return 429 when too many requests are made (22 ms)
2025-04-15T01:13:00.1909365Z 
2025-04-15T01:13:01.0423803Z PASS test/integration/task-runners/task-broker-server.test.ts
2025-04-15T01:13:01.0424764Z   TaskBrokerServer
2025-04-15T01:13:01.0425129Z     /healthz
2025-04-15T01:13:01.0426232Z       âœ“ should return 200 (22 ms)
2025-04-15T01:13:01.0426687Z     /runners/_ws
2025-04-15T01:13:01.0427379Z       âœ“ should return 429 when too many requests are made (20 ms)
2025-04-15T01:13:01.0427999Z     /runners/auth
2025-04-15T01:13:01.0428688Z       âœ“ should return 429 when too many requests are made (20 ms)
2025-04-15T01:13:01.0429127Z 
2025-04-15T01:13:05.9076965Z PASS src/controllers/__tests__/users.controller.test.ts
2025-04-15T01:13:05.9090117Z   UsersController
2025-04-15T01:13:05.9090503Z     changeGlobalRole
2025-04-15T01:13:05.9091301Z       âœ“ should emit event user-changed-role (8 ms)
2025-04-15T01:13:05.9091894Z 
2025-04-15T01:13:07.2663767Z PASS test/integration/services/execution-metadata.service.test.ts (31.426 s)
2025-04-15T01:13:07.2666300Z   ProjectService
2025-04-15T01:13:07.2666660Z     save
2025-04-15T01:13:07.2667694Z       âœ“ should deduplicate entries by exeuctionId and key, keeping the latest one (36 ms)
2025-04-15T01:13:07.2668282Z 
2025-04-15T01:13:09.0684201Z PASS src/workflows/workflow-history.ee/__tests__/workflow-history-helper.ee.test.ts
2025-04-15T01:13:09.0696796Z   getWorkflowHistoryPruneTime
2025-04-15T01:13:09.0697801Z     âœ“ should return -1 (infinite) if config and license are -1 (5 ms)
2025-04-15T01:13:09.0698730Z     âœ“ should return config time if license is infinite and config is not
2025-04-15T01:13:09.0699614Z     âœ“ should return license time if config is infinite and license is not
2025-04-15T01:13:09.0700553Z     âœ“ should return lowest of config and license time if both are not -1 (1 ms)
2025-04-15T01:13:09.0701018Z 
2025-04-15T01:13:12.0140763Z PASS src/services/__tests__/password.utility.test.ts
2025-04-15T01:13:12.0143726Z   PasswordUtility
2025-04-15T01:13:12.0144180Z     hash()
2025-04-15T01:13:12.0146501Z       âœ“ should hash a plaintext password (127 ms)
2025-04-15T01:13:12.0147143Z     compare()
2025-04-15T01:13:12.0148247Z       âœ“ should return true on match (201 ms)
2025-04-15T01:13:12.0149090Z       âœ“ should return false on mismatch (200 ms)
2025-04-15T01:13:12.0149586Z 
2025-04-15T01:13:16.2025517Z PASS src/services/__tests__/orchestration.service.test.ts
2025-04-15T01:13:16.2029603Z   Orchestration Service
2025-04-15T01:13:16.2072581Z     âœ“ should initialize (9 ms)
2025-04-15T01:13:16.2073006Z 
2025-04-15T01:13:19.1047017Z PASS src/ldap.ee/__tests__/helpers.test.ts
2025-04-15T01:13:19.1053984Z   Ldap/helpers
2025-04-15T01:13:19.1054379Z     updateLdapUserOnLocalDb
2025-04-15T01:13:19.1058174Z       âœ“ does not use `Repository.update`, but `Repository.save` instead (9 ms)
2025-04-15T01:13:19.1058702Z 
2025-04-15T01:13:21.4184884Z PASS src/evaluation.ee/test-runner/__tests__/get-test-run-final-result.ee.test.ts
2025-04-15T01:13:21.4240317Z   getTestRunFinalResult
2025-04-15T01:13:21.4254869Z     âœ“ should return success if all test cases are successful (8 ms)
2025-04-15T01:13:21.4259540Z     âœ“ should return error if at least one test case is errored (1 ms)
2025-04-15T01:13:21.4264157Z     âœ“ should return warning if at least one test case is warned
2025-04-15T01:13:21.4268447Z     âœ“ should return error if there are errors and warnings (1 ms)
2025-04-15T01:13:21.4270106Z 
2025-04-15T01:13:23.7145520Z PASS src/evaluation.ee/test-runner/__tests__/get-start-node.ee.test.ts
2025-04-15T01:13:23.7146359Z   getPastExecutionStartNode
2025-04-15T01:13:23.7147258Z     âœ“ should return the start node of the past execution (7 ms)
2025-04-15T01:13:23.7148273Z     âœ“ should return the start node of the past execution with multiple triggers (1 ms)
2025-04-15T01:13:23.7149513Z     âœ“ should return the start node of the past execution with multiple triggers - chat trigger (1 ms)
2025-04-15T01:13:23.7150128Z 
2025-04-15T01:13:31.4963247Z PASS test/integration/cta.service.test.ts (31.078 s)
2025-04-15T01:13:31.4967638Z   CtaService
2025-04-15T01:13:31.4971447Z     getBecomeCreatorCta()
2025-04-15T01:13:31.4974894Z       âœ“ should return false if user has 0 active workflows with 0 successful production executions (19 ms)
2025-04-15T01:13:31.4976298Z       âœ“ should return false if user has 2 active workflows with 5 successful production executions (29 ms)
2025-04-15T01:13:31.4977685Z       âœ“ should return false if user has 3 active workflows with 4 successful production executions (28 ms)
2025-04-15T01:13:31.4979088Z       âœ“ should return true if user has 3 active workflows with 5 successful production executions (20 ms)
2025-04-15T01:13:31.4979730Z 
2025-04-15T01:13:33.7605819Z PASS test/integration/middlewares/body-parser.test.ts
2025-04-15T01:13:33.7607203Z   bodyParser
2025-04-15T01:13:33.7608399Z     âœ“ should handle uncompressed data (24 ms)
2025-04-15T01:13:33.7609191Z     âœ“ should handle gzip data (5 ms)
2025-04-15T01:13:33.7610963Z     âœ“ should handle deflate data (4 ms)
2025-04-15T01:13:33.7611931Z 
2025-04-15T01:13:36.2270222Z PASS src/databases/entities/__tests__/user.entity.test.ts
2025-04-15T01:13:36.2271953Z   User Entity
2025-04-15T01:13:36.2275200Z     JSON.stringify
2025-04-15T01:13:36.2276421Z       âœ“ should not serialize sensitive data (5 ms)
2025-04-15T01:13:36.2277293Z     createPersonalProjectName
2025-04-15T01:13:36.2279050Z       âœ“ given fistName: Nathan, lastName: Nathaniel and email: nathan@nathaniel.n8n this gives the projectName: "Nathan Nathaniel <nathan@nathaniel.n8n>"
2025-04-15T01:13:36.2281434Z       âœ“ given fistName: undefined, lastName: Nathaniel and email: nathan@nathaniel.n8n this gives the projectName: "<nathan@nathaniel.n8n>" (1 ms)
2025-04-15T01:13:36.2283861Z       âœ“ given fistName: Nathan, lastName: undefined and email: nathan@nathaniel.n8n this gives the projectName: "<nathan@nathaniel.n8n>"
2025-04-15T01:13:36.2290906Z       âœ“ given fistName: undefined, lastName: undefined and email: nathan@nathaniel.n8n this gives the projectName: "<nathan@nathaniel.n8n>"
2025-04-15T01:13:36.2292829Z       âœ“ given fistName: undefined, lastName: undefined and email: undefined this gives the projectName: "Unnamed Project" (1 ms)
2025-04-15T01:13:36.2294364Z       âœ“ given fistName: Nathan, lastName: Nathaniel and email: undefined this gives the projectName: "Unnamed Project"
2025-04-15T01:13:36.2295050Z 
2025-04-15T01:13:39.1713516Z PASS test/integration/task-runners/task-runner-module.internal.test.ts
2025-04-15T01:13:39.1725392Z   TaskRunnerModule in internal mode
2025-04-15T01:13:39.1726380Z     start
2025-04-15T01:13:39.1727236Z       âœ“ should throw if the task runner is disabled (19 ms)
2025-04-15T01:13:39.1729496Z       âœ“ should start the task runner (461 ms)
2025-04-15T01:13:39.1730315Z       âœ“ should use InternalTaskRunnerDisconnectAnalyzer (1 ms)
2025-04-15T01:13:39.1731202Z 
2025-04-15T01:13:39.3501244Z PASS test/integration/workflows/workflows.controller-with-active-workflow-manager.ee.test.ts (31.825 s)
2025-04-15T01:13:39.3518315Z   PUT /:workflowId/transfer
2025-04-15T01:13:39.3519187Z     âœ“ can transfer an active workflow (117 ms)
2025-04-15T01:13:39.3519540Z 
2025-04-15T01:13:41.6517943Z PASS src/utils/__tests__/object-to-error.test.ts
2025-04-15T01:13:41.6518561Z   objectToError
2025-04-15T01:13:41.6518910Z     node error handling
2025-04-15T01:13:41.6519842Z       âœ“ should create `NodeOperationError` when node is found (9 ms)
2025-04-15T01:13:41.6520723Z       âœ“ should create `Error` when node is not found (1 ms)
2025-04-15T01:13:41.6521168Z 
2025-04-15T01:13:43.6033965Z PASS src/services/__tests__/credentials-tester.service.test.ts
2025-04-15T01:13:43.6034918Z   CredentialsTester
2025-04-15T01:13:43.6036056Z     âœ“ should find the OAuth2 credential test for a generic OAuth2 API credential (8 ms)
2025-04-15T01:13:43.6036601Z 
2025-04-15T01:13:47.7781015Z PASS src/task-runners/__tests__/node-process-oom-detector.test.ts
2025-04-15T01:13:47.7783232Z   NodeProcessOomDetector
2025-04-15T01:13:47.7786437Z     âœ“ should detect an out-of-memory error in a monitored process (1381 ms)
2025-04-15T01:13:47.7787634Z     âœ“ should not detect an out-of-memory error in a process that exits normally (43 ms)
2025-04-15T01:13:47.7788188Z 
2025-04-15T01:13:50.7758546Z PASS src/execution-lifecycle/shared/__tests__/shared-hook-functions.test.ts
2025-04-15T01:13:50.7763050Z   determineFinalExecutionStatus
2025-04-15T01:13:50.7767395Z     âœ“ should return "error" when resultData.error exists (1 ms)
2025-04-15T01:13:50.7770154Z     âœ“ should return "waiting" when waitTill is defined
2025-04-15T01:13:50.7772740Z     When waitTill is not set
2025-04-15T01:13:50.7775199Z       âœ“ should return "canceled" (6 ms)
2025-04-15T01:13:50.7777537Z       âœ“ should return "crashed"
2025-04-15T01:13:50.7779555Z       âœ“ should return "error"
2025-04-15T01:13:50.7781839Z       âœ“ should return "success"
2025-04-15T01:13:50.7782103Z 
2025-04-15T01:13:55.0434397Z PASS src/modules/insights/database/entities/__tests__/insights-by-period.test.ts (31.111 s)
2025-04-15T01:13:55.0435506Z   Insights By Period
2025-04-15T01:13:55.0437215Z     âœ“ `time_saved_min` can be serialized and deserialized correctly (8 ms)
2025-04-15T01:13:55.0440211Z     âœ“ `runtime_ms` can be serialized and deserialized correctly (2 ms)
2025-04-15T01:13:55.0441119Z     âœ“ `failure` can be serialized and deserialized correctly (1 ms)
2025-04-15T01:13:55.0442304Z     âœ“ `success` can be serialized and deserialized correctly (2 ms)
2025-04-15T01:13:55.0443130Z     âœ“ `hour` can be serialized and deserialized correctly (1 ms)
2025-04-15T01:13:55.0443931Z     âœ“ `day` can be serialized and deserialized correctly (1 ms)
2025-04-15T01:13:55.0444701Z     âœ“ `week` can be serialized and deserialized correctly (1 ms)
2025-04-15T01:13:55.0445095Z 
2025-04-15T01:13:57.2212139Z PASS src/utils/__tests__/path-util.test.ts
2025-04-15T01:13:57.2217975Z   isContainedWithin
2025-04-15T01:13:57.2218948Z     âœ“ should return true when parent and child paths are the same (6 ms)
2025-04-15T01:13:57.2221878Z     âœ“ should return true for parent /some/parent/folder and child /some/parent/folder/subfolder/file.txt (1 ms)
2025-04-15T01:13:57.2223463Z     âœ“ should return true for parent /some/parent/folder and child /some/parent/folder/../folder/subfolder/file.txt
2025-04-15T01:13:57.2224970Z     âœ“ should return true for parent /some/parent/folder/ and child /some/parent/folder/subfolder/file.txt (1 ms)
2025-04-15T01:13:57.2226319Z     âœ“ should return true for parent /some/parent/folder and child /some/parent/folder/subfolder/
2025-04-15T01:13:57.2228080Z     âœ“ should return false for parent /some/parent/folder and child /some/other/folder/file.txt (1 ms)
2025-04-15T01:13:57.2229438Z     âœ“ should return false for parent /some/parent/folder and child /some/parent/folder_but_not_really
2025-04-15T01:13:57.2230611Z     âœ“ should return false for parent /one/path and child /another/path (1 ms)
2025-04-15T01:13:57.2231113Z 
2025-04-15T01:14:00.0427230Z PASS src/services/__tests__/execution-metadata.service.test.ts
2025-04-15T01:14:00.0429513Z   ExecutionMetadataService
2025-04-15T01:14:00.0431895Z     âœ“ Execution metadata is saved in a batch (8 ms)
2025-04-15T01:14:00.0434179Z 
2025-04-15T01:14:02.4133484Z PASS src/decorators/__tests__/module.test.ts
2025-04-15T01:14:02.4138498Z   registerLifecycleHooks
2025-04-15T01:14:02.4139589Z     âœ“ is called when ModuleRegistry.registerLifecycleHooks is called (6 ms)
2025-04-15T01:14:02.4140112Z 
2025-04-15T01:14:05.7112973Z PASS src/environments.ee/source-control/__tests__/source-control-preferences.service.ee.test.ts
2025-04-15T01:14:05.7123890Z   SourceControlPreferencesService
2025-04-15T01:14:05.7125683Z     âœ“ should class validate correct preferences (8 ms)
2025-04-15T01:14:05.7126086Z 
2025-04-15T01:14:15.0407351Z PASS test/integration/commands/license.cmd.test.ts (33.172 s)
2025-04-15T01:14:15.0413038Z   âœ“ license:clear invokes clear() to release any floating entitlements and deletes the license cert from the DB (22 ms)
2025-04-15T01:14:15.0413857Z 
2025-04-15T01:14:17.3040596Z PASS src/validators/__tests__/no-url.validator.test.ts
2025-04-15T01:14:17.3042306Z   NoUrl
2025-04-15T01:14:17.3044068Z     URLs
2025-04-15T01:14:17.3045102Z       âœ“ should block http://google.com (9 ms)
2025-04-15T01:14:17.3050002Z       âœ“ should block www.domain.tld (1 ms)
2025-04-15T01:14:17.3051136Z       âœ“ should block n8n.io (1 ms)
2025-04-15T01:14:17.3053051Z 
2025-04-15T01:14:19.7393353Z PASS src/config/__tests__/index.test.ts
2025-04-15T01:14:19.7397546Z   userManagement.jwtRefreshTimeoutHours
2025-04-15T01:14:19.7402737Z     âœ“ resets jwtRefreshTimeoutHours to 0 if it's greater than or equal to jwtSessionDurationHours (6 ms)
2025-04-15T01:14:19.7403486Z 
2025-04-15T01:14:21.4634436Z PASS test/integration/saml/saml-helpers.test.ts (30.491 s)
2025-04-15T01:14:21.4639243Z   sso/saml/samlHelpers
2025-04-15T01:14:21.4639733Z     createUserFromSamlAttributes
2025-04-15T01:14:21.4640610Z       âœ“ Creates personal project for user (125 ms)
2025-04-15T01:14:21.4640978Z 
2025-04-15T01:14:33.0425465Z PASS test/integration/healthcheck.controller.test.ts (27.104 s)
2025-04-15T01:14:33.0452551Z   HealthcheckController
2025-04-15T01:14:33.0453790Z     âœ“ should return ok when DB is connected and migrated (16 ms)
2025-04-15T01:14:33.0454816Z     âœ“ should return error when DB is not connected (3 ms)
2025-04-15T01:14:33.0455501Z 
2025-04-15T01:14:33.1653360Z Test Suites: 252 passed, 252 total
2025-04-15T01:14:33.1654984Z Tests:       2884 passed, 2884 total
2025-04-15T01:14:33.1655477Z Snapshots:   3 passed, 3 total
2025-04-15T01:14:33.1655876Z Time:        747.92 s
2025-04-15T01:14:33.1656252Z Ran all test suites.

##[group]Run nix flake check
[36;1mnix flake check[0m
shell: /usr/bin/bash -e {<:NUM:>}
env:
DETSYS_BACKTRACE_COLLECTOR: c6c3b3a4-023c-4264-946b-5aa2c703c032
DETERMINATE_NIX_KVM: 1
##[endgroup]
evaluating flake...
checking flake output 'formatter'...
copying path '/nix/store/v0g0bxsd5gw6k0jz2855f8h7l1218925-source' from 'https://cache.nixos.org'...
unpacking 'github:nix-systems/default/da67096a3b9bf56a91d16901293e51ba5b49a27e?narHash=sha256-Vy1rq5AaRuLzOxct8nz4T6wlgyUR7zLU309k9mBC768%3D' into the Git cache...
checking derivation formatter.x86_64-linux...
unpacking 'github:numtide/treefmt-nix/13c913f5deb3a5c08bb810efd89dc8cb24dd968b?narHash=sha256-p2r8xhQZ3TYIEKBoiEhllKWQqWNJNoT9v64Vmg4q8Zw%3D' into the Git cache...
derivation evaluated to /nix/store/5cmn667g6zsa4l3hvklc423yzi9hihfh-treefmt.drv
checking flake output 'checks'...
checking derivation checks.x86_64-linux.formatting...
derivation evaluated to /nix/store/vxiv73afxkl1x5zx9wc0mx9ni91r64a1-treefmt-check.drv
checking flake output 'devShells'...
checking derivation devShells.x86_64-linux.default...
unpacking 'github:nix-community/gomod2nix/514283ec89c39ad0079ff2f3b1437404e4cba608?narHash=sha256-tPsqU00FhgdFr0JiQUiBMgPVbl1jbPCY5gbFiJycL3I%3D' into the Git cache...
unpacking 'github:numtide/flake-utils/ff7b65b44d01cf9ba6a71320833626af21126384?narHash=sha256-zsNZZGTGnMOf9YpHKJqMSsa0dXbfmxeoJ7xHlrt%2BxmY%3D' into the Git cache...
derivation evaluated to /nix/store/jdmgz1x8smaqmplip260cjp2y7kxy6ws-nix-shell.drv
checking flake output 'packages'...
checking derivation packages.x86_64-linux.gomod2nix...
derivation evaluated to /nix/store/i4lg9fpq4in0w1ml4g82d92wi22jshz8-gomod2nix-dev.drv
checking derivation packages.x86_64-linux.default...
derivation evaluated to /nix/store/d37hdvd2wx9dv4cjln86a3wnyqhr21pj-fabric-ai-1.4.167.drv
checking derivation packages.x86_64-linux.fabric...
derivation evaluated to /nix/store/d37hdvd2wx9dv4cjln86a3wnyqhr21pj-fabric-ai-1.4.167.drv
running 1 flake checks...
copying path '/nix/store/kn855hkv6yda9wi7g48lxwgplijqijb9-git-2.47.0-doc' from 'https://cache.nixos.org'...
copying path '/nix/store/gxv330afrspz91xzicqc291mvkgwfh5j-perl5.40.0-Digest-HMAC-1.04' from 'https://cache.nixos.org'...
copying path '/nix/store/1bp6wq4j24zjc9wlcnp2r2ffh4pwxfpc-perl5.40.0-FCGI-ProcManager-0.28' from 'https://cache.nixos.org'...
copying path '/nix/store/d43yysnlknxiq8q0fl338dxgxnyhx7ia-perl5.40.0-HTML-TagCloud-0.38' from 'https://cache.nixos.org'...
copying path '/nix/store/dh93rwf25khgdm3sqrsdzlzi1w09az9h-perl5.40.0-URI-5.21' from 'https://cache.nixos.org'...
copying path '/nix/store/mb0q4c1b7ag16vgjhy4zc32sy8c9ljfv-perl5.40.0-libnet-3.15' from 'https://cache.nixos.org'...
copying path '/nix/store/17v0ywnr3akp85pvdi56gwl99ljv95kx-gcc-14-20241116-libgcc' from 'https://cache.nixos.org'...
copying path '/nix/store/q2bw5vb464sam6bdsbb6lc0jaabf424l-perl5.40.0-IO-HTML-1.004' from 'https://cache.nixos.org'...
copying path '/nix/store/2adzrcjbs8rrij7inakslzpv5fcq276i-perl5.40.0-Encode-Locale-1.05' from 'https://cache.nixos.org'...
copying path '/nix/store/80nv8li5cbzrzkd4zgw79xnh7yq84wnf-perl5.40.0-Mozilla-CA-20230821' from 'https://cache.nixos.org'...
copying path '/nix/store/mynqz5pq27vc61wprpvr9qf3p41hnd1w-perl5.40.0-Test-Needs-0.002010' from 'https://cache.nixos.org'...
copying path '/nix/store/1m67ipsk39xvhyqrxnzv2m2p48pil8kl-gnu-config-2024-01-01' from 'https://cache.nixos.org'...
copying path '/nix/store/390dg8pwcx489m9dpjdwqn6vzvrwfij0-perl5.40.0-LWP-MediaTypes-6.04' from 'https://cache.nixos.org'...
copying path '/nix/store/ky5k49f2byfjg49ci75ci89szy29hk4k-mailcap-2.1.54' from 'https://cache.nixos.org'...
copying path '/nix/store/288yl27wjpamsijf2wwxvc21dhm4r7fv-perl5.40.0-HTML-Tagset-3.20' from 'https://cache.nixos.org'...
copying path '/nix/store/2b6gl02f7cmz2gzpw80jnygma6mmv965-perl5.40.0-Test-RequiresInternet-0.05' from 'https://cache.nixos.org'...
copying path '/nix/store/pmvskik4cp4vh4gy0affdavpwm79k2mf-iana-etc-20240318' from 'https://cache.nixos.org'...
copying path '/nix/store/xcqcgqazykf6s7fsn08k0blnh0wisdcl-libunistring-1.3' from 'https://cache.nixos.org'...
copying path '/nix/store/gfkyf4hw4riqwgf5scfk8r8g69crbn4x-tzdata-2024b' from 'https://cache.nixos.org'...
copying path '/nix/store/8bsvp7nbfr5kiw7clq0rwgzd6jfpzznz-perl5.40.0-Authen-SASL-2.1700' from 'https://cache.nixos.org'...
copying path '/nix/store/4whjf69dbgvlnxiy5jimdq89z200xv2j-perl5.40.0-Try-Tiny-0.31' from 'https://cache.nixos.org'...
copying path '/nix/store/acfkqzj5qrqs88a4a6ixnybbjxja663d-xgcc-14-20241116-libgcc' from 'https://cache.nixos.org'...
copying path '/nix/store/rzr5p0k0qmypknx41rnkwdzkmrp90ywa-perl5.40.0-TimeDate-2.33' from 'https://cache.nixos.org'...
copying path '/nix/store/0lj0851s55mkwmylmkcw4m71m7ggl772-publicsuffix-list-0-unstable-2024-12-06' from 'https://cache.nixos.org'...
copying path '/nix/store/d29r1bdmlvwmj52apgcdxfl1mm9c5782-update-autotools-gnu-config-scripts-hook' from 'https://cache.nixos.org'...
copying path '/nix/store/1731fryiiiafq9y9py8mhf05wldfm0wv-perl5.40.0-Net-HTTP-6.23' from 'https://cache.nixos.org'...
copying path '/nix/store/la59y3p1cdiz0n0xh54n4dqriggdysyj-perl5.40.0-WWW-RobotRules-6.02' from 'https://cache.nixos.org'...
copying path '/nix/store/chqcxl717ah0k021pfvfa7vrcl3gmnsb-perl5.40.0-Test-Fatal-0.017' from 'https://cache.nixos.org'...
copying path '/nix/store/a4qk8l5j6j2npm75wdwr0vb16ghccf2g-perl5.40.0-HTTP-Date-6.06' from 'https://cache.nixos.org'...
copying path '/nix/store/70alxzrz9bmb4n0jicr3vidckpgbjcby-perl5.40.0-File-Listing-6.16' from 'https://cache.nixos.org'...
copying path '/nix/store/s017walqrqjyr8r0qy1xxz0v0vsm9kin-perl5.40.0-HTTP-CookieJar-0.014' from 'https://cache.nixos.org'...
copying path '/nix/store/34z2792zyd4ayl5186vx0s98ckdaccz9-libidn2-2.3.7' from 'https://cache.nixos.org'...
copying path '/nix/store/65h17wjrrlsj2rj540igylrx7fqcd6vq-glibc-2.40-36' from 'https://cache.nixos.org'...
copying path '/nix/store/a9jgnlhkjkxav6qrc3rzg2q84pkl2wvr-attr-2.5.2' from 'https://cache.nixos.org'...
copying path '/nix/store/5mh7kaj2fyv8mk4sfq1brwxgc02884wi-bash-5.2p37' from 'https://cache.nixos.org'...
copying path '/nix/store/8zvalh0pmrmzypynv2gh8mw1vkkys19i-brotli-1.1.0-lib' from 'https://cache.nixos.org'...
copying path '/nix/store/74h4z8k82pmp24xryflv4lxkz8jlpqqd-ed-1.20.2' from 'https://cache.nixos.org'...
copying path '/nix/store/5ayb629gzbkc3amm6zd5jp1aciprb2zs-expat-2.6.4' from 'https://cache.nixos.org'...
copying path '/nix/store/ivl2v8rgg7qh1jkj5pwpqycax3rc2hnl-bzip2-1.0.8' from 'https://cache.nixos.org'...
copying path '/nix/store/a3c47r5z1q2c4rz0kvq8hlilkhx2s718-gawk-5.3.1' from 'https://cache.nixos.org'...
copying path '/nix/store/abm77lnrkrkb58z6xp1qwjcr1xgkcfwm-gnused-4.9' from 'https://cache.nixos.org'...
copying path '/nix/store/bpq1s72cw9qb2fs8mnmlw6hn2c7iy0ss-gcc-14-20241116-lib' from 'https://cache.nixos.org'...
copying path '/nix/store/fp6cjl1zcmm6mawsnrb5yak1wkz2ma8l-gnumake-4.4.1' from 'https://cache.nixos.org'...
copying path '/nix/store/2h8rk9xwa6xqy2pqk2lr2s57qbrx5p30-gdbm-1.24-lib' from 'https://cache.nixos.org'...
copying path '/nix/store/i1mjz7h6bx4yv5x32wf726b1mgl4yygd-json-c-0.18' from 'https://cache.nixos.org'...
copying path '/nix/store/fkfhss4k4zqi3rqzwgisqa8gm8xjb0b2-libpsl-0.21.5' from 'https://cache.nixos.org'...
copying path '/nix/store/r04wysx6yl7ys1rdv1b1lih6in1810r0-libffi-3.4.6' from 'https://cache.nixos.org'...
copying path '/nix/store/mnnv5iqsa1hcc9v1snyxai3yqzmav9kf-gotools-0.25.0' from 'https://cache.nixos.org'...
copying path '/nix/store/2wh1gqyzf5xsvxpdz2k0bxiz583wwq29-keyutils-1.6.3-lib' from 'https://cache.nixos.org'...
copying path '/nix/store/srz64fswvjbph7i00ffvr3wbyjw87a06-libyaml-0.2.5' from 'https://cache.nixos.org'...
copying path '/nix/store/wm1qn5jqrxpcjkc640gq8a90ns5gw3cn-ncurses-6.4.20221231' from 'https://cache.nixos.org'...
copying path '/nix/store/6cr0spsvymmrp1hj5n0kbaxw55w1lqyp-libxcrypt-4.4.36' from 'https://cache.nixos.org'...
copying path '/nix/store/1aybnfshx1vxh7vi04bhfh1n69k15335-mpdecimal-4.0.0' from 'https://cache.nixos.org'...
copying path '/nix/store/mglixp03lsp0w986svwdvm7vcy17rdax-bzip2-1.0.8-bin' from 'https://cache.nixos.org'...
copying path '/nix/store/82lh8f5wi6ya5jkcwr036md8630j652d-nghttp2-1.64.0-lib' from 'https://cache.nixos.org'...
copying path '/nix/store/h1ydpxkw9qhjdxjpic1pdc2nirggyy6f-openssl-3.3.2' from 'https://cache.nixos.org'...
copying path '/nix/store/5yja5dpk2qw1v5mbfbl2d7klcdfrh90w-patch-2.7.6' from 'https://cache.nixos.org'...
copying path '/nix/store/cf7gkacyxmm66lwl5nj6j6yykbrg4q5c-acl-2.3.2' from 'https://cache.nixos.org'...
copying path '/nix/store/3j1p598fivxs69wx3a657ysv3rw8k06l-pcre2-10.44' from 'https://cache.nixos.org'...
copying path '/nix/store/fxbqrwsfc6q63alynldajiw95lxsnajs-perl5.40.0-Clone-0.46' from 'https://cache.nixos.org'...
copying path '/nix/store/pjdkig8favrhn300cdyn6lzn52xch3an-perl5.40.0-FCGI-0.82' from 'https://cache.nixos.org'...
copying path '/nix/store/8n58sbly7gdjscz5wkr6kia72dcf1qs5-treefmt-2.1.1' from 'https://cache.nixos.org'...
copying path '/nix/store/h60rh960bjnzmhgm2ab3bw86r2mma0g3-perl5.40.0-TermReadKey-2.38' from 'https://cache.nixos.org'...
copying path '/nix/store/jfv85qbj4vb1dafcg6kncg4vrbq2bbxv-go-1.23.4' from 'https://cache.nixos.org'...
copying path '/nix/store/nvvj6sk0k6px48436drlblf4gafgbvzr-gzip-1.13' from 'https://cache.nixos.org'...
copying path '/nix/store/c2njy6bv84kw1i4bjf5k5gn7gz8hn57n-xz-5.6.3' from 'https://cache.nixos.org'...
copying path '/nix/store/cqlaa2xf6lslnizyj9xqa8j0ii1yqw0x-zlib-1.3.1' from 'https://cache.nixos.org'...
copying path '/nix/store/9cwwj1c9csmc85l2cqzs3h9hbf1vwl6c-gnutar-1.35' from 'https://cache.nixos.org'...
copying path '/nix/store/whf0g8g2yymkj5511bp4jl4v17s1kd23-perl5.40.0-HTTP-Message-6.45' from 'https://cache.nixos.org'...
copying path '/nix/store/dj96qp9vps02l3n8xgc2vallqa9rhafb-sqlite-3.47.0' from 'https://cache.nixos.org'...
copying path '/nix/store/c4rj90r2m89rxs64hmm857mipwjhig5d-file-5.46' from 'https://cache.nixos.org'...
copying path '/nix/store/h18s640fnhhj2qdh5vivcfbxvz377srg-xz-5.6.3-bin' from 'https://cache.nixos.org'...
copying path '/nix/store/d6m831pl6cmsihdi8j5pywhsz75sbpwm-perl5.40.0-HTTP-Daemon-6.16' from 'https://cache.nixos.org'...
copying path '/nix/store/wjjpmk5a9mbpdz45bgamymmry86b4zx1-perl5.40.0-HTTP-Negotiate-6.01' from 'https://cache.nixos.org'...
copying path '/nix/store/8bybx6196xzn1c60kda1snpgf4x1zcfy-perl5.40.0-HTTP-Cookies-6.10' from 'https://cache.nixos.org'...
copying path '/nix/store/8hdac0chc55s1ssv9xiksq96qr4r9g0r-perl5.40.0-HTML-Parser-3.81' from 'https://cache.nixos.org'...
copying path '/nix/store/aap6cq56amx4mzbyxp2wpgsf1kqjcr1f-gnugrep-3.11' from 'https://cache.nixos.org'...
copying path '/nix/store/w1mlpianxzqcwk98mvcwrffm8dv2ymgb-perl5.40.0-CGI-4.59' from 'https://cache.nixos.org'...
copying path '/nix/store/9a46kza0vbb4vdsdmpzbdc7f31y7hs0i-gettext-0.22.5' from 'https://cache.nixos.org'...
copying path '/nix/store/a2byxfv4lc8f2g5xfzw8cz5q8k05wi29-gmp-with-cxx-6.3.0' from 'https://cache.nixos.org'...
copying path '/nix/store/srfxqk119fijwnprgsqvn68ys9kiw0bn-patchelf-0.15.0' from 'https://cache.nixos.org'...
copying path '/nix/store/c748z5q1ac6yc92xf69lm7mjaj52m4xx-deadnix-1.2.1' from 'https://cache.nixos.org'...
copying path '/nix/store/ghb61mqc90qf1nx6kyahhhagicyxvcyg-gmp-with-cxx-6.3.0' from 'https://cache.nixos.org'...
copying path '/nix/store/zc1f5d889k3xb33vdxw56mhah1q8a8lb-statix-0.5.8' from 'https://cache.nixos.org'...
copying path '/nix/store/s0zynhz13rhg0gg8cy0ga4c0lnv3yqdn-zstd-1.5.6' from 'https://cache.nixos.org'...
copying path '/nix/store/fp0l21s4j49wcp9l4w59nlb4biy0dr8f-libssh2-1.11.1' from 'https://cache.nixos.org'...
copying path '/nix/store/zqkizm9zn19bf9n58xcfxl4ks7yfs8my-krb5-1.21.3-lib' from 'https://cache.nixos.org'...
copying path '/nix/store/zw1nv1w3fkmdklmsw9zp5l4hhfqlvf42-perl5.40.0-Net-SSLeay-1.92' from 'https://cache.nixos.org'...
copying path '/nix/store/wg7lvwiv4nc41p4a075dikgshwbqkk2h-perl5.40.0-CGI-Fast-2.16' from 'https://cache.nixos.org'...
copying path '/nix/store/4s9rah4cwaxflicsk5cndnknqlk9n4p3-coreutils-9.5' from 'https://cache.nixos.org'...
copying path '/nix/store/jwlvx6cl4s7dnh8i2vw7p8g35p6k0ln7-perl5.40.0-IO-Socket-SSL-2.083' from 'https://cache.nixos.org'...
copying path '/nix/store/8yfak7dis3yqqls4mclzp5jb1ic2jzab-curl-8.11.0' from 'https://cache.nixos.org'...
copying path '/nix/store/9jzrcxf9wi9yp679il6j6zh6cq81p4s9-readline-8.2p13' from 'https://cache.nixos.org'...
copying path '/nix/store/zk4ixqhn7hl77g1qlnpy40ccjzjrwpn2-perl5.40.0-Net-SMTP-SSL-1.04' from 'https://cache.nixos.org'...
copying path '/nix/store/c9m6yd8fg1flz2j5r4bif1ib5j20a0cy-python3-3.12.8' from 'https://cache.nixos.org'...
copying path '/nix/store/1i003ijlh9i0mzp6alqby5hg3090pjdx-perl-5.40.0' from 'https://cache.nixos.org'...
copying path '/nix/store/jqrz1vq5nz4lnv9pqzydj0ir58wbjfy1-findutils-4.10.0' from 'https://cache.nixos.org'...
copying path '/nix/store/00g69vw7c9lycy63h45ximy0wmzqx5y6-diffutils-3.10' from 'https://cache.nixos.org'...
copying path '/nix/store/wkysiv0sxqs6wn44nb46bbyig4plzsy4-elfutils-0.192' from 'https://cache.nixos.org'...
copying path '/nix/store/4ig84cyqi6qy4n0sanrbzsw1ixa497jx-stdenv-linux' from 'https://cache.nixos.org'...
copying path '/nix/store/lch913ar0a3w3f6d63crf5vfvpckddk1-nixfmt-unstable-2024-12-04' from 'https://cache.nixos.org'...
copying path '/nix/store/zjwgaram0g5v8k3nkrrxkj8zjvrrkqld-perl5.40.0-libwww-perl-6.72' from 'https://cache.nixos.org'...
copying path '/nix/store/iwq58rpn6idjnxbnyjh351776qzvsd0r-git-2.47.0' from 'https://cache.nixos.org'...
copying path '/nix/store/ka3h6h9gj6wf24yckrch9844pd4bklfc-python3.12-cbor2-5.6.4' from 'https://cache.nixos.org'...
copying path '/nix/store/a7p8w035ri614k9y82y7c9cs9fkvb6ac-python3.12-colorama-0.4.6' from 'https://cache.nixos.org'...
copying path '/nix/store/f3a35ljg6yaxf4cxb5fqc562r3v978x7-python3.12-mdurl-0.1.2' from 'https://cache.nixos.org'...
copying path '/nix/store/ncvqa6aazrsh3lyjwrd0q5wjvng8si8w-python3.12-pygments-2.18.0' from 'https://cache.nixos.org'...
copying path '/nix/store/ls6dyvvnxji760drr228z8v5n6mivzdh-python3.12-u-msgpack-python-2.8.0' from 'https://cache.nixos.org'...
copying path '/nix/store/iqjg6b78n41i9r2z7i70q0nk6m1d8h6k-python3.12-ruamel-yaml-clib-0.2.7' from 'https://cache.nixos.org'...
copying path '/nix/store/svijjywn5mk2ljh4c9lx2my1w2jmr8hy-python3.12-ruamel-base-1.0.0' from 'https://cache.nixos.org'...
copying path '/nix/store/r5kb9400ihayy81jgj6rw6cwxlq6k24a-python3.12-pyyaml-6.0.2' from 'https://cache.nixos.org'...
copying path '/nix/store/03kwj7hvj4f32ss5g99zm2wq18h8r0wf-python3.12-six-1.17.0' from 'https://cache.nixos.org'...
copying path '/nix/store/v9vdk698r9jk17z6ipph79cj9wjqb573-python3.12-tomlkit-0.13.2' from 'https://cache.nixos.org'...
copying path '/nix/store/vnkay8zkgfh38biyhgj1rp2886qlw9bz-python3.12-markdown-it-py-3.0.0' from 'https://cache.nixos.org'...
copying path '/nix/store/mv5jpzs99allm6ni5zfjbhmyvjw8mdcj-python3.12-python-dateutil-2.9.0.post0' from 'https://cache.nixos.org'...
copying path '/nix/store/ipci9bcpb3kaxq88f5wwcyf3spvqk265-python3.12-ruamel-yaml-0.18.6' from 'https://cache.nixos.org'...
copying path '/nix/store/8cipdqyzsiyqx1d73lzs89anz2sb9pzs-python3.12-rich-13.9.4' from 'https://cache.nixos.org'...
copying path '/nix/store/zqsb4b4rdf5yl7i76vwjhg49hbgp3nli-python3.12-rich-argparse-1.6.0' from 'https://cache.nixos.org'...
copying path '/nix/store/lmzwm13gz7am129ihxg2zjmm51vinaaf-python3.12-remarshal-0.20.0' from 'https://cache.nixos.org'...
building '/nix/store/zpykvf42zcd44mif9y3sfv2l7zkvjnlz-statix.toml.drv'...
building '/nix/store/h2wyc6zpxd83yipm3y33gf2ygqiar5w6-statix-config.drv'...
building '/nix/store/f0pci68fildnfn38bjwfm4fx0dcy1wbq-statix-fix.drv'...
building '/nix/store/ybkhyn9wxyx9sbga5j8cf67g1xd0d6fk-treefmt.toml.drv'...
building '/nix/store/5cmn667g6zsa4l3hvklc423yzi9hihfh-treefmt.drv'...
building '/nix/store/vxiv73afxkl1x5zx9wc0mx9ni91r64a1-treefmt-check.drv'...
error: builder for '/nix/store/vxiv73afxkl1x5zx9wc0mx9ni91r64a1-treefmt-check.drv' failed with exit code 1;
last 25 log lines:
>
>                  if headerApiKey != apiKey {
> -           c.AbortWithStatusJSON(http.StatusUnauthorized, gin.H{"error": fmt.Sprintf("Wrong or missing API Key")})
> +                       c.AbortWithStatusJSON(http.StatusUnauthorized, gin.H{"error": fmt.Sprintf("Wrong or missing API Key")})
>                         return
>                  }
>
>             c.Next()
>        }
> -}
> \ No newline at end of file
> +}
> diff --git a/restapi/serve.go b/restapi/serve.go
> index c9b364a..90bf6c0 100644
> --- a/restapi/serve.go
> +++ b/restapi/serve.go
> @@ -13,7 +13,7 @@ func Serve(registry *core.PluginRegistry, address string, apiKey string) (err er
>     r.Use(gin.Recovery())
>
>         if apiKey != "" {
> -         r.Use(ApiKeyMiddleware(apiKey))
> +           r.Use(ApiKeyMiddleware(apiKey))
>         }
>
>     // Register routes
For full logs, run:
nix log /nix/store/vxiv73afxkl1x5zx9wc0mx9ni91r64a1-treefmt-check.drv
##[error]Process completed with exit code 1.
